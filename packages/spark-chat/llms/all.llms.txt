

# Welcome
对话的落地欢迎页



## 示例

```tsx
import { Welcome, ChatInput } from '@agentscope-ai/chat';
import { Flex } from 'antd';

export default function () {
  return <Flex vertical  style={{ height: '100%', }}>
    <Welcome
      style={{ justifyContent: 'center', flex: 1 }}
      logo={null}
      title={<div style={{ textAlign: 'center' }}>Nice to meet you!</div>}
      desc="How can I help you today?"
    />
    <ChatInput placeholder='Please type here...' />
  </Flex>
}
```

import { Welcome } from '@agentscope-ai/chat'

#### 欢迎页示例

以下是欢迎页组件的示例和变体



## 附带品牌 - A

```tsx
import { ChatInput, Welcome } from '@agentscope-ai/chat';
import { Flex } from "antd";


export default function () {
  return <Flex vertical style={{ height: '100%', }}>
    <Welcome
      style={{ justifyContent: 'center', flex: 1 }}
      title="Nice to meet you!"
      desc="How can I help you today?"
      logo="https://gw.alicdn.com/imgextra/i3/O1CN01VFloZL1oERpBMx2Nv_!!6000000005193-55-tps-56-56.svg"
    />

    <ChatInput placeholder='Please type here...' />
  </Flex>
}
```


## 附带品牌 - B

```tsx
import React from "react";
import { ChatInput, Welcome } from '@agentscope-ai/chat';
import { Flex } from "antd";


export default function () {
  return <Flex vertical style={{ height: '100%', }}>


    <Welcome
      style={{ display: 'block', marginTop: 32,  flex: 1 }}
      title="How can I help you today?"
      desc={null}
      logo={
        <img
          style={{
            width: 40,
            height: 40,
            marginBottom: 10,
          }}
          src="https://gw.alicdn.com/imgextra/i3/O1CN01VFloZL1oERpBMx2Nv_!!6000000005193-55-tps-56-56.svg" />
      }
    />


    <ChatInput placeholder='Please type here...' />


  </Flex>
}
```


## 自定义

```tsx
import { ChatInput } from '@agentscope-ai/chat';
import { Flex } from "antd";
import EyeFollower from './EyeFollower';


export default function () {

  return <Flex vertical style={{ height: '100%', }}>
    <Flex justify='center' style={{ margin: '64px 0 32px 0', }}>
      <EyeFollower />
    </Flex>

    <ChatInput placeholder='Please type here...' />
  </Flex>
}


```


#### API

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| title | 欢迎页面的主标题，支持文本或React元素 | React.ReactNode \| string |  | 
| desc | 欢迎页面的描述文本，用于补充说明或引导用户 | React.ReactNode \| string |  | 
| logo | 欢迎页面的品牌标识，支持图片URL或自定义React元素 | React.ReactNode \| string |  | 
| style | 欢迎组件的内联样式对象，用于自定义外观 | React.CSSProperties |  | 




## 组件概览

您可以在这里找到本库中所有可用的组件，我们正在持续添加更多组件。

<ComponentsOverview ></ComponentsOverview>



<DemoTitle title="ChatInput" desc="AI输入框" llmTxtName="Sender"></DemoTitle>



## 示例

```tsx
import React, { useState } from 'react';
import { ChatInput } from '@agentscope-ai/chat';

export default function () {
  const [value, setValue] = useState('Hello, Alibaba Cloud Spark Chat!');
  return <ChatInput placeholder='Please type here...' value={value} onChange={setValue}></ChatInput>
}
```

import { ChatInput } from '@agentscope-ai/chat'


#### 对话输入框示例

以下是此组件的示例和变体



## 生成中暂停

```tsx
import { ChatInput } from '@agentscope-ai/chat';

export default function () {
  return <ChatInput loading placeholder='Please type here...'></ChatInput>
}
```


## 上传图片

```tsx
import React from 'react';
import { Attachments, ChatInput } from '@agentscope-ai/chat';
import { Button, GetProp, Upload } from 'antd';
import { IconButton } from '@agentscope-ai/design';
import { SparkAttachmentLine } from '@agentscope-ai/icons';

export default function () {
  // mock data
  const [attachedFiles, setAttachedFiles] = React.useState<GetProp<typeof Attachments, 'items'>>([
    {
      uid: '-1',
      name: 'image.png',
      status: 'done',
      url: 'https://gw.alicdn.com/imgextra/i4/O1CN01sjZ4Uu1erFDOC6IkA_!!6000000003924-2-tps-396-224.png',
    },
    {
      uid: '-2',
      name: 'image.png',
      status: 'done',
      url: 'https://gw.alicdn.com/imgextra/i4/O1CN01sjZ4Uu1erFDOC6IkA_!!6000000003924-2-tps-396-224.png',
    },
    {
      uid: '-3',
      name: 'image.png',
      status: 'done',
      url: 'https://gw.alicdn.com/imgextra/i4/O1CN01sjZ4Uu1erFDOC6IkA_!!6000000003924-2-tps-396-224.png',
    },
  ]);
  const handleFileChange: GetProp<typeof Attachments, 'onChange'> = async ({ fileList }) => {
    setAttachedFiles(fileList);
  }

  const senderHeader = (
    <ChatInput.Header
      closable={false}
      open={attachedFiles?.length > 0}
    >
      <Attachments
        items={attachedFiles}
        onChange={handleFileChange}
      />
    </ChatInput.Header>
  );
  const attachmentsNode = (
    <Upload onChange={handleFileChange} fileList={attachedFiles} showUploadList={false} key="upload">
      <IconButton icon={<SparkAttachmentLine />} bordered={false} />
    </Upload>
  );

  return <ChatInput placeholder='Please type here...' header={senderHeader}
    prefix={attachmentsNode}></ChatInput>
}
```


## 上传文件

```tsx
import React from 'react';
import { Attachments, ChatInput } from '@agentscope-ai/chat';
import { Button, GetProp, Upload } from 'antd';
import { IconButton } from '@agentscope-ai/design';
import { SparkAttachmentLine } from '@agentscope-ai/icons';

export default function () {
  // mock data
  const [attachedFiles, setAttachedFiles] = React.useState<GetProp<typeof Attachments, 'items'>>([
    {
      uid: '-1',
      name: 'file.pdf',
      status: 'done',
      size: 1000,
    },
    {
      uid: '-2',
      name: 'file.pdf',
      status: 'done',
      size: 2000,

    },
    {
      uid: '-3',
      name: 'file.pdf',
      status: 'done',
      size: 3000,
    },
  ]);

  const handleFileChange: GetProp<typeof Attachments, 'onChange'> = async ({ fileList }) => {
    setAttachedFiles(fileList);
  }

  const senderHeader = (
    <ChatInput.Header
      closable={false}
      open={attachedFiles?.length > 0}
    >
      <Attachments
        items={attachedFiles}
        onChange={handleFileChange}
      />
    </ChatInput.Header>
  );
  const attachmentsNode = (
    <Upload onChange={handleFileChange} fileList={attachedFiles} showUploadList={false} key="upload">
      <IconButton icon={<SparkAttachmentLine />} bordered={false} />
    </Upload>
  );

  return <ChatInput placeholder='Please type here...' header={senderHeader}
    prefix={attachmentsNode}></ChatInput>
}
```


## 自定义模式

```tsx
import React from 'react';
import { ChatInput } from '@agentscope-ai/chat';
import { SparkMagicNoteLine } from '@agentscope-ai/icons';

export default function () {
  const [mode, setMode] = React.useState('');
  return <div style={{ width: '100%' }}>
    <ChatInput.ModeSelect options={[
      {
        icon: <SparkMagicNoteLine style={{ fontSize: 16 }} />,
        label: '文本',
        value: 'text',
        tooltip: '文本 tooltip'
      },
      {
        icon: <SparkMagicNoteLine style={{ fontSize: 16 }} />,
        label: '图片',
        selectedLabel: <div style={{
          overflow: 'hidden',
          textOverflow: 'ellipsis',
          whiteSpace: 'nowrap',
        }}>图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片图片',
        </div>,
        value: 'image',
      },
      {
        icon: <SparkMagicNoteLine style={{ fontSize: 16 }} />,
        label: '文件',
        value: 'file',
      },
    ]}
      value={mode}
      closeTip='close tooltip'
      onChange={setMode}
      desc={<div
        style={{ fontSize: 12 }}
        onClick={() => {
          setMode('')
        }}>
        description of {mode}
      </div>}
    />
    <ChatInput placeholder='Please type here...' ></ChatInput>
  </div>
}
```


## 自定义功能

```tsx
import React from 'react';
import { Attachments, ChatInput } from '@agentscope-ai/chat';
import { GetProp, Upload } from 'antd';
import { IconButton, Button } from '@agentscope-ai/design';
import { SparkAttachmentLine, SparkDeepSearchLine, SparkKeyboardLine } from '@agentscope-ai/icons';

export default function () {
  const [search, setSearch] = React.useState(false);
  const [attachedFiles, setAttachedFiles] = React.useState<GetProp<typeof Attachments, 'items'>>([]);
  const handleFileChange: GetProp<typeof Attachments, 'onChange'> = async ({ fileList }) => {
    setAttachedFiles(fileList);
  }

  const senderHeader = (
    <ChatInput.Header
      closable={false}
      open={attachedFiles?.length > 0}
    >
      <Attachments
        items={attachedFiles}
        onChange={handleFileChange}
      />
    </ChatInput.Header>
  );
  const attachmentsNode = (
    <Upload onChange={handleFileChange} fileList={attachedFiles} showUploadList={false} key="upload">
      <IconButton icon={<SparkAttachmentLine />} bordered={false} />
    </Upload>
  );

  return <ChatInput
    placeholder='Please type here...'
    zoomable
    header={senderHeader}
    prefix={[
      attachmentsNode,
      <Button type="text" color={search ? 'primary' : 'default'} variant={search ? 'filled' : 'text'} icon={<SparkDeepSearchLine />} style={{ padding: '0 6px', gap: 6 }} onClick={() => setSearch(!search)}>联网搜索</Button>,
    ]}>
  </ChatInput>
}

```


## 语音发送

```tsx
import React, { useState } from 'react';
import { ChatInput } from '@agentscope-ai/chat';

export default function () {
  const [value, setValue] = useState('');
  return <ChatInput placeholder='Please type here...' value={value} onChange={setValue} allowSpeech></ChatInput>
}
```


#### API

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| defaultValue | 输入框的默认初始值，仅在非受控模式下生效 | string |  | 
| value | 输入框的当前值，用于受控组件模式 | string |  | 
| loading | 是否显示回复中的加载状态，影响按钮和输入框的交互 | boolean |  | 
| readOnly | 是否将输入框设置为只读模式，禁止用户编辑 | boolean |  | 
| submitType | 消息提交的方式，影响发送按钮的行为和快捷键 | SubmitType |  | 
| disabled | 是否禁用整个发送器组件，包括输入框和按钮 | boolean |  | 
| onSubmit | 用户提交消息时的回调函数，接收消息内容作为参数 | (message: string) => void |  | 
| onChange | 输入框值发生变化时的回调函数，用于实时处理用户输入 | (
    value: string,
    event?: React.FormEvent<HTMLTextAreaElement> \| React.ChangeEvent<HTMLTextAreaElement>,
  ) => void |  | 
| onCancel | 用户取消操作时的回调函数，通常用于清空输入或重置状态 | VoidFunction |  | 
| onKeyDown | 键盘事件处理函数，用于自定义键盘快捷键和特殊按键行为 | React.KeyboardEventHandler<any> |  | 
| styles | 语义化样式对象，用于精确控制不同区域的样式 | {
    prefix?: React.CSSProperties;
    input?: React.CSSProperties;
    actions?: React.CSSProperties;
  } |  | 
| rootClassName | 自定义根容器的CSS类名，用于覆盖默认样式 | string |  | 
| classNames | 语义化CSS类名，用于为不同区域添加自定义类名 | {
    prefix?: string;
    input?: string;
    actions?: string;
  } |  | 
| style | 样式 | React.CSSProperties |  | 
| className | 类名 | string |  | 
| prefix | 前缀 UI | React.ReactNode \| React.ReactNode[] |  | 
| header | 头部 UI | React.ReactNode |  | 
| maxLength | 最大文本长度 | number |  | 
| zoomable | 是否可缩放 | boolean |  | 
| initialRows | 初始行数，默认 2，移动端使用建议设置 1 行 | number |  | 
| allowSpeech | 是否支持语音输入 | boolean |  | 




# Voice
语音输入



# StatusCard
表达LLM或Agent的执行任务状态



## 示例

```tsx
import { StatusCard } from '@agentscope-ai/chat';
import { Flex } from 'antd';
import { useState } from 'react';


export default function () {
  const [done, setDone] = useState(false);
  return <Flex vertical gap={16}>
    <StatusCard title="Success" status="success">

      <StatusCard.Statistic values={[
        { title: 'Runtime', value: '23min' },
        { title: 'Input Token', value: '200k' },
        { title: 'Output Token', value: '1000k' },
      ]} />
    </StatusCard>
    <StatusCard title="Execution Failed" description="Failed to load resource: net::ERR_CONNECTION_CLOSED" status="error" />
    <StatusCard title="Warning" status="warning" />


    <StatusCard.HITL
      done={done}
      onDone={() => setDone(true)}
      title="Human intervention required"
      description="Please log in after entering your account and password"
      waitButtonText="I have completed, continue task"
      doneButtonText="User has confirmed"
    />


  </Flex>
}
```

import { StatusCard } from '@agentscope-ai/chat'

#### API

##### IStatusCardProps

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| title | 标题 | string | (必填) | 
| status | 状态 | 'success' \| 'error' \| 'warning' \| 'info' | (必填) | 
| description | 描述 | string |  | 
| icon | 图标 | React.ReactNode |  | 
| children | 子元素 | React.ReactNode |  | 


##### IStatusCardHITLProps

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| title | 标题 | string | (必填) | 
| description | 描述 | string | '需要用户人工干预' | 
| waitButtonText | 等待按钮文本 | string | '我已完成，继续任务' | 
| doneButtonText | 完成按钮文本 | string | '用户已确认' | 
| done | 是否完成 | boolean | (必填) | 
| onDone | 完成回调 | () => void | (必填) | 


##### IStatusCardStatisticProps

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| values | 统计数据 | {
    title: string;
    value: string;
  }[] | (必填) | 




<DemoTitle title="OperateCard" desc="一种展示对话流中AI操作行为的卡片" llmTxtName="OperateCard"></DemoTitle>



## 示例

```tsx
import { OperateCard } from '@agentscope-ai/chat';
import { SparkBookLine } from '@agentscope-ai/icons';
import { Flex } from 'antd';


export default function () {

  return <Flex vertical gap={16}>
    <OperateCard header={{
      icon: <SparkBookLine />,
      title: 'OperateCard',
      description: 'OperateCard Description',
    }} />



    <OperateCard header={{
      icon: <SparkBookLine />,
      title: 'OperateCard',
      description: 'OperateCard Description',
    }} body={{
      children: <OperateCard.LineBody>
        <div style={{ marginLeft: 16 }}>
          <div>
            OperateCard Body
          </div>
          <div>
            OperateCard Body
          </div>
        </div>
      </OperateCard.LineBody>,
      defaultOpen: true,
    }} />
  </Flex>
}
```

import { OperateCard } from '@agentscope-ai/chat'

#### 更多 OperateCard 示例



## RAG

```tsx
import { Rag } from '@agentscope-ai/chat';

export default function () {
  return <Rag
    subTitle="GPT-5技术博客、行业分析、技术特性"
    list={[
      { title: '【文档库】GPT-5 技术博客', content: 'Aliyun Bailianis a product offered by Alibaba Cloud, which is the cloud computing arm of Alibaba Group. Bailian is a high-performance AI development platform designed to help users build, deploy, and manage machine learning models and AI applications more efficiently.', footer: '来源文档：（真）拟定稿。GPT 的制度研究' },
      { title: '【文档库】GPT-5 行业分析', content: 'Aliyun Bailianis a product offered by Alibaba Cloud, which is the cloud computing arm of Alibaba Group. Bailian is a high-performance AI development platform designed to help users build, deploy, and manage machine learning models and AI applications more efficiently.', footer: '来源文档：（真）拟定稿。GPT 的制度研究' },
      { title: '【文档库】GPT-5 技术特性', content: 'Aliyun Bailianis a product offered by Alibaba Cloud, which is the cloud computing arm of Alibaba Group. Bailian is a high-performance AI development platform designed to help users build, deploy, and manage machine learning models and AI applications more efficiently.', footer: '来源文档：（真）拟定稿。GPT 的制度研究' },
    ]}
  />
}
```


## 工具调用

```tsx
import { ToolCall } from "@agentscope-ai/chat";
export default function () {
  return <ToolCall
    title="Call Tool"
    subTitle="I am the name of a tool that is being called"
    input={{
      foo: 'bar',
      baz: 'qux',
    }}
    output={{
      result: 'result',
    }}
  />
}
```


## 联网搜索

```tsx
import { WebSearch } from "@agentscope-ai/chat";

export default function () {
  return <WebSearch
    subTitle="Transformer 领域的重要研究"
    list={[
      { title: 'Transformer登上nature，被誉为大模型基石的它到底凭什么这么火？', subTitle: '新浪新闻', link: 'https://www.baidu.com', icon: 'https://www.baidu.com/favicon.ico' },
      { title: 'Transformer登上nature，它的技术核心是什么？', subTitle: '网易新闻', link: 'https://www.baidu.com', icon: 'https://www.baidu.com/favicon.ico' },

    ]}
  />
}
```


## 待办

```tsx
import { Flex } from 'antd';
import { TodoList } from "@agentscope-ai/chat";


export default function () {
  return <Flex vertical gap={16}>

    <TodoList
      title="Task List"
      defaultOpen={true}
      list={[
        { title: '1、搜索GPT-5的官方发布信息，确认新特性', status: 'todo' },
        { title: '2、找技术博客和行业分析，获取GPT-5详细技术特性', status: 'todo' },
        { title: '3、交叉验证多个来源信息，确保准确性', status: 'todo' },
        { title: '4、整理信息并生成结构化文本报告', status: 'todo' },
      ]}
    />
    <TodoList
      title="Task List"
      defaultOpen={false}
      list={[
        { title: '1、搜索GPT-5的官方发布信息，确认新特性', status: 'done' },
        { title: '2、找技术博客和行业分析，获取GPT-5详细技术特性', status: 'running' },
        { title: '3、交叉验证多个来源信息，确保准确性', status: 'todo' },
        { title: '4、整理信息并生成结构化文本报告', status: 'todo' },
      ]}
    /></Flex>
}
```


## 思考

```tsx
import { Thinking } from "@agentscope-ai/chat";

export default function () {
  return <Thinking
    title="Deep thinking"
    subTitle="I am the name of a concept that is being thought about"
    content={`Okay, the user is asking about "citypop." Let me start by recalling what I know about that term. I remember that City Pop is a genre of music, but I need to make sure I'm accurate.

First, when did City Pop originate? I think it was in Japan during the late 1970s and 1980s. That makes sense because Japan's economy was booming then, leading to a vibrant urban culture. The genre probably blends Western styles like funk, jazz, and disco with Japanese pop elements. Artists like Tatsuro Yamashita and Mariya Takeuchi come to mind. Oh, and there's that song "Plastic Love" by Mariya Takeuchi that went viral online recently, which might have sparked renewed interest.

I should also mention the themes of City Pop songs—they often reflect city life, romance, and leisure, fitting the upbeat and cosmopolitan vibe of the time. The visual style associated with it includes retro anime and vibrant cityscapes, which adds to its aesthetic appeal. It's interesting how the internet, especially platforms like YouTube and Spotify, helped revive this genre internationally. Maybe I should note that connection between modern digital culture and the resurgence of City Pop.

Wait, are there any subgenres or key characteristics I should highlight? The use of synthesizers, smooth vocals, and lush production are typical. Also, City Pop was influenced by yacht rock and soft rock from the West. It's important to link it to Japan's economic bubble era, as that context explains the music's optimistic and luxurious feel.

I need to ensure I don't confuse it with other Japanese genres like J-pop or Enka. City Pop is distinct in its fusion with Western sounds. Including notable albums, like Tatsuro Yamashita's "For You" or Anri's "Timely!!", could be helpful. Oh, and the connection to future funk and vaporwave genres that sample City Pop tracks is a good point for its modern influence.`}
  />
}
```

#### API

##### IOperateCardProps

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| header | 头部配置 | {
    className?: string;
    style?: React.CSSProperties;
    icon: React.ReactNode;
    title: React.ReactNode \| string;
    description?: React.ReactNode \| string;
  } | (必填) | 
| body | 内容配置 | {
    children?: React.ReactNode;
    defaultOpen?: boolean;
  } | {} | 


##### IRagProps

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| title | 标题 | string | '知识库检索' | 
| subTitle | 副标题 | string | '' | 
| list | 召回知识列表 | {
    title: string;
    content: string;
    footer: string;
    link?: string;
  }[] | (必填) | 


##### IThinkingProps

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| title | 标题 | string | (必填) | 
| subTitle | 副标题 | string | '' | 
| content | 思考内容 | string | (必填) | 


##### ITodoListProps

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| title | 标题 | string | 'Task List' | 
| defaultOpen | 默认展开 | boolean | false | 
| list | Todo 列表 | {
    title: string;
    status: 'done' \| 'todo' \| 'running';
  }[] | (必填) | 


##### IToolCallProps

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| title | 标题 | string | 'Call Tool' | 
| subTitle | 副标题 | string | '' | 
| input | 工具调用入参 | string \| Record<string, any> | (必填) | 
| output | 工具调用输出 | string \| Record<string, any> | (必填) | 


##### IWebSearchProps

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| title | 标题 | string | '联网搜索' | 
| subTitle | 副标题 | string | '' | 
| list | 列表 | {
    title: string;
    subTitle?: string;
    link: string;
    icon: string;
  }[] | (必填) | 




# Mermaid
Mermaid 是 React 中用于渲染 Mermaid 图表的组件。它支持多种图表类型，如流程图、序列图、类图等，具有可定制的样式和交互功能。



## 示例

```tsx
import { Mermaid } from '@agentscope-ai/chat';
import React from 'react';

const content = `sequenceDiagram
    Alice->>John: Hello John, how are you?
    John-->>Alice: Great!
    Alice-)John: See you later!
`;

export default function () {
  return <Mermaid content={content} height={300} />;
}

```

import { Mermaid } from '@agentscope-ai/chat'

#### Mermaid 更多示例



## Flowchart

```tsx
import { Mermaid } from '@agentscope-ai/chat';
import React from 'react';

const content = `flowchart LR
    A[Hard edge] -->|Link text| B(Round edge)
    B --> C{Decision}
    C -->|One| D[Result one]
    C -->|Two| E[Result two]
`;

export default () => {
  return <Mermaid content={content} height={200} />;
};

```


## Sequence Diagram

```tsx
import { Mermaid } from '@agentscope-ai/chat';
import React from 'react';

const content = `sequenceDiagram
    autonumber
    Alice->>John: Hello John, how are you?
    loop HealthCheck
        John->>John: Fight against hypochondria
    end
    Note right of John: Rational thoughts!
    John-->>Alice: Great!
    John->>Bob: How about you?
    Bob-->>John: Jolly good!
`;

export default () => {
  return <Mermaid content={content} height={400} />;
};

```


## Class Diagram

```tsx
import { Mermaid } from '@agentscope-ai/chat';
import React from 'react';

const classDiagram = `classDiagram
    note "From Duck till Zebra"
    Animal <|-- Duck
    note for Duck "can fly\\ncan swim\\ncan dive\\ncan help in debugging"
    Animal <|-- Fish
    Animal <|-- Zebra
    Animal : +int age
    Animal : +String gender
    Animal: +isMammal()
    Animal: +mate()
    class Duck{
        +String beakColor
        +swim()
        +quack()
    }
    class Fish{
        -int sizeInFeet
        -canEat()
    }
    class Zebra{
        +bool is_wild
        +run()
    }
`;

export default () => {
  return <Mermaid content={classDiagram} height={400} />;
};

```


## State Diagram

```tsx
import { Mermaid } from '@agentscope-ai/chat';
import React from 'react';

const content = `stateDiagram-v2
    [*] --> Still
    Still --> [*]

    Still --> Moving
    Moving --> Still
    Moving --> Crash
    Crash --> [*]
 `;

export default function () {
  return <Mermaid content={content} height={400} />;
}

```


## Timeline

```tsx
import { Mermaid } from '@agentscope-ai/chat';
import React from 'react';

const content = `timeline
    title History of Social Media Platform
    2002 : LinkedIn
    2004 : Facebook
         : Google
    2005 : YouTube
    2006 : Twitter
`;

export default function () {
  return <Mermaid content={content} height={300} />;
}

```

更多示例请参考 [Mermaid Docs](https://mermaid.js.org/intro/)

#### API

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| content | Mermaid 图表的源代码，包含图表定义和配置 | string | (必填) | 
| width | 图表的宽度，支持数字（像素）或字符串（CSS单位） | number \| string |  | 
| height | 图表的高度，支持数字（像素）或字符串（CSS单位） | number \| string |  | 




# Markdown
是一个用于渲染 Markdown 文本的 React 组件。它支持各种 Markdown 语法，例如标题、列表、链接、图片、代码块等。



## 示例

```tsx
import { SparkEditLine } from '@agentscope-ai/icons';
import { IconButton, Input, Modal } from '@agentscope-ai/design';
import { Markdown } from '@agentscope-ai/chat';
import { useState } from 'react';

let content = `# 这是一个一级标题
## 这是一个二级标题
### 这是一个三级标题
#### 这是一个四级标题
##### 这是一个五级标题
###### 这是一个六级标题

---

这是第一个段落。

这是第二个段落。

city pop, short for city pop, is a genre of music that originated in japan during the late 1970s and early 1980s. it blends elements of jazz, folk, easy listening, and aor (adult oriented rock) with a distinctly urban feel. the term "city pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of tokyo and other major japanese cities during this period. city pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. common themes include city life, summer vibes, nature, and romantic encounters. the music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban japan in the 1980s. some notable city pop artists include mariya takeuchi, known for her iconic song " plastic love," and joe hisaishi, a composer famous for his work on studio ghibli films, though he is not strictly considered a city pop artist. today, city pop has experienced a resurgence in popularity, particularly among younger generations who appreciate its unique sound and the nostalgic value it holds.

---

- 项目1
- 项目2
  - 子项目2.1
  - 子项目2.2
- 项目3

---

1. 第一项
2. 第二项
   1. 第二项的第一子项
   2. 第二项的第二子项
3. 第三项

---

> 这是一个引用。

---

*这是斜体文本*
_这是斜体文本_
**这是粗体文本**
__这是粗体文本__
  
***这是粗斜体文本***
**_这是粗斜体文本_**
_**这是粗斜体文本**_
___这是粗斜体文本___
~~这是删除线文本~~

---

[https://www.aliyun.com](https://www.aliyun.com)

![](https://gw.alicdn.com/imgextra/i4/O1CN01sjZ4Uu1erFDOC6IkA_!!6000000003924-2-tps-396-224.png)

![](https://cloud.video.taobao.com/vod/HGJp6c7KVGDDfyeN8eimSccR_OnaS9E7PTqNzbVoAfE.mp4)

![](https://cloud.video.taobao.com/vod/HGJp6c7KVGDDfyeN8eimSccR_OnaS9E7PTqNzbVoAfE.mp3)

---
\`这是单行代码\`

\`\`\`java
class HelloWorld {
    public static void main(String[] args) {
        System.out.println("Hello World!"); 
        // Hello World!
    }
}
\`\`\`


---

| 标题1 | 标题2 | 标题3 |标题2 | 标题3 |标题1 | 标题2 | 标题3 |标题2 | 标题3 |标题1 | 标题2 | 标题3 |标题2 | 标题3 |
|-------|-------|-------|----|-------|------|-------|-------|----|-------|------|-------|-------|----|-------|
| 单元格1 | 单元格2 | 单元格3 |单元格3 |单元格3 |单元格1 | 单元格2 | 单元格3 |单元格3 |单元格3 |单元格1 | 单元格2 | 单元格3 |单元格3 |单元格3 |
| 单元格4 | 单元格5 | 单元格6 |单元格6 |单元格6 |单元格4 | 单元格5 | 单元格6 |单元格6 |单元格6 |单元格4 | 单元格5 | 单元格6 |单元格6 |单元格6 |

---
`;



export default function () {
  const [value, setValue] = useState(content);
  const [open, setOpen] = useState(false);

  return <>
    <div style={{ display: 'flex', justifyContent: 'flex-end' }}>
      <IconButton icon={<SparkEditLine />} onClick={() => setOpen(true)} />
      <Modal open={open} onCancel={() => setOpen(false)} title="markdown editor" footer={null} centered>
        <Input.TextArea value={value} onChange={(e) => setValue(e.target.value)} autoSize={{ minRows: 30, maxRows: 30 }} />
      </Modal>
    </div>
    <Markdown content={value} />
  </>;
}
```


import { Markdown } from '@agentscope-ai/chat';



#### 更多示例



## 数学公式

```tsx
import React from 'react';
import { Markdown } from '@agentscope-ai/chat';

const content = `三角函数是一类数学函数，主要用来描述直角三角形中的角度与边长之间的关系。最常用的三角函数包括正弦（sine, 简写为sin）、余弦（cosine, 简写为cos）和正切（tangent, 简写为tan）。此外还有它们的倒数：余割（cosecant, 简写为csc或cosec）、正割（secant, 简写为sec）和余切（cotangent, 简写为cot）。

这些函数的基本定义如下：

1. **正弦（sin）**：对于一个角θ，在直角三角形中，正弦是该角对边与斜边的比值。
   \\[ 1 + 2 = 3 \\]

2. **余弦（cos）**：对于一个角θ，在直角三角形中，余弦是该角邻边与斜边的比值。
   \\[ \\cos(\\theta) = \\frac{\\text{邻边}}{\\text{斜边}} \\]

3. **正切（tan）**：对于一个角θ，在直角三角形中，正切是对边与邻边的比值。
   \\[ \\tan(\\theta) = \\frac{\\text{对边}}{\\text{邻边}} \\]

4. **余割（csc）**：是正弦的倒数。
   \\[ \\csc(\\theta) = \\frac{1}{\\sin(\\theta)} \\]

5. **正割（sec）**：是余弦的倒数。
   \\[ \\sec(\\theta) = \\frac{1}{\\cos(\\theta)} \\]

6. **余切（cot）**：是正切的倒数。
   \\[ \\cot(\\theta) = \\frac{1}{\\tan(\\theta)} \\]

三角函数在数学、物理学、工程学等领域有着广泛的应用，尤其是在处理周期性现象时。

矩阵是数学中一种重要的工具，广泛应用于线性代数、计算机科学、物理学等领域。以下是关于矩阵形式的详细说明：
矩阵是一个**按矩形排列的数表**，由 **m 行 n 列** 的元素组成，通常用大写字母表示（如 A、B）。 

一般形式如下：
$$
A = \\begin{bmatrix}
a_{11} & a_{12} & \\cdots & a_{1n} \\\\
a_{21} & a_{22} & \\cdots & a_{2n} \\\\
\\vdots & \\vdots & \\ddots & \\vdots \\\\
a_{m1} & a_{m2} & \\cdots & a_{mn}
\\end{bmatrix}
$$

---

其中 \( C \) 表示圆的周长，\( \pi \) 是圆周率（大约等于 3.14159），而 \( r \) 是圆的半径。

其中 $ C $ 表示圆的周长，$ \pi $ 是圆周率（大约等于 3.14159），而 $ r $ 是圆的半径。

---

\\[
x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}
\\]

\\[
\\begin{align*}
1. & \\quad x + y = 10 \\\\
2. & \\quad 2x - y = 0
\\end{align*}
\\]


$$ x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} $$

$$
\\begin{align*}
1. & \\quad x + y = 10 \\\\
2. & \\quad 2x - y = 0
\\end{align*}
$$
`;

export default function () {
  return <Markdown content={content} />;
}
```


## 引用

```tsx
import React from 'react';
import { Markdown } from '@agentscope-ai/chat';

const content = `杭州今天和未来几天的天气预报如下：

今天（2月18日）多云，气温在4-12℃之间[two][3]。白天多云，夜间转阴[7]。风力较大，上午为偏东风2-3级，傍晚增大到4级[7]。

未来几天天气概况：
- 2月19日（明天）：阴天，有小雨，气温11℃左右[3][7]
- 2月20日：阴天，小到中雨，气温7℃左右[3][7]
- 2月21日：多云，气温7℃左右[3]
- 2月22日：小雨，气温7℃左右[3]

总体来看，未来几天杭州天气较凉，以阴天和雨天为主，气温在7-11℃之间波动。建议市民适当增添衣物，注意保暖，外出时携带雨具[2][3][7]。
`;

const citations = [
  'https://www.weather.com.cn/weather/101210101.shtml',
  'https://tianqi.moji.com/weather/china/zhejiang/hangzhou',
  'https://weather.cma.cn/web/weather/58457.html',
  'https://tianqi.so.com/weather/101210101',
  'https://www.accuweather.com/zh/cn/hangzhou/106832/weather-forecast/106832',
  'https://www.hzqx.com',
  'https://www.hzqx.com/pc/hztq/',
].map((url, index) => {
  return {
    url,
    title: `参考${index + 1}`,
    content: url,
  };
})

export default function () {
  return <Markdown cursor content={content} citations={citations} citationsMap={{
    'two': {
      url: 'https://www.weather.com.cn/weather/101210101.shtml',
      title: '参考2',
      content: 'https://www.weather.com.cn/weather/101210101.shtml',
    },
  }} />;
}
```


## 打字效果

```tsx
import React, { useRef } from 'react';
import { Markdown } from '@agentscope-ai/chat';
import { useInViewport } from 'ahooks';

const content = `三角函数是一类数学函数，主要用来描述直角三角形中的角度与边长之间的关系。最常用的三角函数包括正弦（sine, 简写为sin）、余弦（cosine, 简写为cos）和正切（tangent, 简写为tan）。此外还有它们的倒数：余割（cosecant, 简写为csc或cosec）、正割（secant, 简写为sec）和余切（cotangent, 简写为cot）。

这些函数的基本定义如下：

1. **正弦（sin）**：对于一个角θ，在直角三角形中，正弦是该角对边与斜边的比值。
   \\[ 1 + 2 = 3 \\]

2. **余弦（cos）**：对于一个角θ，在直角三角形中，余弦是该角邻边与斜边的比值。
   \\[ \\cos(\\theta) = \\frac{\\text{邻边}}{\\text{斜边}} \\]

3. **正切（tan）**：对于一个角θ，在直角三角形中，正切是对边与邻边的比值。
   \\[ \\tan(\\theta) = \\frac{\\text{对边}}{\\text{邻边}} \\]

4. **余割（csc）**：是正弦的倒数。
   \\[ \\csc(\\theta) = \\frac{1}{\\sin(\\theta)} \\]

5. **正割（sec）**：是余弦的倒数。
   \\[ \\sec(\\theta) = \\frac{1}{\\cos(\\theta)} \\]

6. **余切（cot）**：是正切的倒数。
   \\[ \\cot(\\theta) = \\frac{1}{\\tan(\\theta)} \\]

三角函数在数学、物理学、工程学等领域有着广泛的应用，尤其是在处理周期性现象时。

矩阵是数学中一种重要的工具，广泛应用于线性代数、计算机科学、物理学等领域。以下是关于矩阵形式的详细说明：
矩阵是一个**按矩形排列的数表**，由 **m 行 n 列** 的元素组成，通常用大写字母表示（如 A、B）。 

一般形式如下：
$$
A = \\begin{bmatrix}
a_{11} & a_{12} & \\cdots & a_{1n} \\\\
a_{21} & a_{22} & \\cdots & a_{2n} \\\\
\\vdots & \\vdots & \\ddots & \\vdots \\\\
a_{m1} & a_{m2} & \\cdots & a_{mn}
\\end{bmatrix}
$$

---

其中 \( C \) 表示圆的周长，\( \pi \) 是圆周率（大约等于 3.14159），而 \( r \) 是圆的半径。

其中 $ C $ 表示圆的周长，$ \pi $ 是圆周率（大约等于 3.14159），而 $ r $ 是圆的半径。

---

\\[
x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}
\\]

\\[
\\begin{align*}
1. & \\quad x + y = 10 \\\\
2. & \\quad 2x - y = 0
\\end{align*}
\\]


$$ x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} $$

$$
\\begin{align*}
1. & \\quad x + y = 10 \\\\
2. & \\quad 2x - y = 0
\\end{align*}
$$
`;

export default function () {
  const ref = useRef(null);
  const [inViewport] = useInViewport(ref);

  return <div ref={ref}><Markdown content={content} typing={inViewport} cursor /></div>;
}
```


#### API

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| content | 要渲染的Markdown内容字符串 | string |  | 
| cursor | 光标样式类型，支持点状、下划线或布尔值控制 | boolean \| 'dot' \| 'underline' |  | 
| baseFontSize | 基础字体大小，影响整个Markdown内容的字体大小 | number |  | 
| baseLineHeight | 基础行高，影响文本的行间距 | number |  | 
| citations | 引用数据数组，用于显示引用信息 | InnerMarkdownProps['citations'] |  | 
| citationsMap | 引用映射对象，用于快速查找引用信息 | InnerMarkdownProps['citationsMap'] |  | 
| components | 自定义组件映射，用于覆盖默认的Markdown元素渲染 | Components & Record<string, FC> |  | 
| allowHtml | 是否允许渲染HTML标签，影响安全性 | boolean |  | 
| typing | 是否启用打字机效果，逐字显示内容 | boolean |  | 
| raw | 是否以原始文本形式显示，跳过Markdown解析 | boolean |  | 
| className | 组件的CSS类名 | string |  | 




# ImageGenerator
生图类Query的过程展示



## 示例

```tsx
import { ImageGenerator } from '@agentscope-ai/chat';
import { useTimeout } from 'ahooks';
import { Flex } from 'antd';
import { useState } from 'react';

export default function () {
  const [src, setSrc] = useState('');

  useTimeout(() => {
    setSrc('https://img.alicdn.com/imgextra/i1/O1CN01lS5S0a1yl6FKoBZHl_!!6000000006618-0-tps-1280-1280.jpg');
  }, 20 * 1000)

  return <Flex vertical gap="middle">
    <ImageGenerator
      src={src}
      skeletonText="Painting..."
    />

    <ImageGenerator
      src="https://img.alicdn.com/imgextra/i1/O1CN01lS5S0a1yl6FKoBZHl_!!6000000006618-0-tps-1280-1280.jpg"
    />
  </Flex>
}
```

import { ImageGenerator } from '@agentscope-ai/chat'

#### 更多示例



## 自定义尺寸

```tsx
import { ImageGenerator } from '@agentscope-ai/chat';
import { useTimeout } from 'ahooks';
import { Flex } from 'antd';
import { useState } from 'react';

export default function () {

  return <Flex vertical gap="middle">
    <ImageGenerator
      width={16}
      height={9}
      block
    />
  </Flex>
}
```



## 自定义骨架 loading

```tsx
import { ImageGenerator } from '@agentscope-ai/chat';
import { Flex } from 'antd';
import { createStyles } from 'antd-style';


const useStyles = createStyles(({ token }) => {
  return {
    skeleton: {
      position: 'relative',
      overflow: 'hidden',
      borderRadius: 8,
      display: 'flex',
      alignItems: 'center',
      justifyContent: 'center',
    },
    bg: {
      position: 'absolute',
      top: '50%',
      left: '50%',
      width: '200%',
      height: '200%',
      transform: 'translate(-50%, -50%) rotate(0deg)',
      objectFit: 'cover',
    },
    icon: {
      width: 64,
      height: 64,
      zIndex: 1,
    }
  };
});

export default function () {
  const { styles } = useStyles();
  return <Flex vertical gap="middle">
    <ImageGenerator

      skeleton={<div className={styles.skeleton} style={{ width: 320, height: 320 }}>
        <img
          className={styles.bg}
          src="https://img.alicdn.com/imgextra/i2/O1CN01j5MC6r1scV7D2cNYt_!!6000000005787-2-tps-1366-1354.png"
          alt=""
        />

        <img
          className={styles.icon}
          src="https://img.alicdn.com/imgextra/i2/O1CN01tLbrX11xwGHaPhX0F_!!6000000006507-54-tps-500-500.apng"
        />


      </div>}
    />


  </Flex>
}
```

#### API

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| width | 生成图片的宽度，单位为像素 | number | 320 | 
| height | 生成图片的高度，单位为像素 | number | 320 | 
| src | 图片的URL地址，为空时显示加载状态 | string | '' | 
| loadingText | 图片生成过程中的提示文本 | string | 'Painting...' | 
| doneText | 图片生成完成后的提示文本 | string | 'Paint Completed' | 
| skeleton | 自定义骨架屏组件，用于加载状态显示 | ReactNode | null | 
| skeletonText | 自定义骨架屏组件的加载态提示 | string | 'Painting...' | 
| block | 是否为块级元素，使得图片宽高比为 width / height | boolean | false | 




<DemoTitle title="DeviceAction" desc="一种展示AI对设备进行实时操作行为的卡片" llmTxtName="DeviceAction"></DemoTitle>



## 示例

```tsx
import { DeviceAction, IDeviceActionProps } from "@agentscope-ai/chat";
import { Flex } from "antd";

const actions = [
  {
    time: "2:00:00",
    action: "Click",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:00:05",
    action: "Swipe",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:00:10",
    action: "Type",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:00:15",
    action: "Back",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:00:20",
    action: "Home",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:00:25",
    action: "Done",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:00:30",
    action: "Wait",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:00:35",
    action: "call_user",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:00:40",
    action: "click",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:00:45",
    action: "right click",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:00:50",
    action: "open app",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:00:55",
    action: "computer_double_click",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:01:00",
    action: "hotkey",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:01:05",
    action: "presskey",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:01:10",
    action: "scroll",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:01:15",
    action: "drag",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:01:20",
    action: "type_with_clear_enter_pos",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:01:25",
    action: "triple_click",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:01:30",
    action: "drag_end",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:01:35",
    action: "type",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:01:40",
    action: "hscroll",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:01:45",
    action: "done",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },
  {
    time: "2:01:50",
    action: "wait",
    image: "https://gw.alicdn.com/imgextra/i3/O1CN01jnIWvS1OQC0DWx9Tu_!!6000000001699-0-tps-1200-687.jpg"
  },

]

export default function () {
  return <Flex gap={16} vertical>
    {
      actions.map((item, index) => {
        return <DeviceAction key={index} {...item} description={`description for ${item.action}...`} action={item.action as IDeviceActionProps['action']} />
      })
    }

  </Flex>
}
```

import { DeviceAction } from '@agentscope-ai/chat'

#### API

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| time | 时间 | string | '' | 
| action | 动作 | 'Click' \| 'Swipe' \| 'Type' \| 'Back' \| 'Home' \| 'Done' \| 'Wait' \| 'click' \| 'right click' \| 'open app' \| 'computer_double_click' \| 'hotkey' \| 'presskey' \| 'scroll' \| 'drag' \| 'type_with_clear_enter_pos' \| 'triple_click' \| 'drag_end' \| 'type' \| 'hscroll' \| 'done' \| 'wait' \| 'call_user' | (必填) | 
| actionName | 动作名称，通常不用传入，会根据 action 自动生成 | string | '' | 
| description | 描述 | string | (必填) | 
| image | 操作截图 | string | '' | 




# Disclaimer
免责声明



## 示例

```tsx
import React from 'react';
import { Disclaimer } from '@agentscope-ai/chat';

export default () => <Disclaimer />;
```

import { Disclaimer } from '@agentscope-ai/chat'


#### 免责声明示例

以下是此组件的示例和变体


## 嵌入链接

```tsx
import React from 'react';
import { Disclaimer } from '@agentscope-ai/chat';

export default () => <Disclaimer afterLink={{  text: 'See More', href: 'https://www.aliyun.com'}}/>;
```

#### API

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| desc | 免责声明的文本内容，用于提醒用户AI的局限性 | React.ReactElement \| string |  | 
| style | 免责声明组件的内联样式对象，用于自定义外观 | React.CSSProperties |  | 
| afterLink | 免责声明后的链接配置，用于提供更多相关信息 | {
    href: string
    text: string
  } |  | 




<DemoTitle title="HistoryPanel" desc="对话历史面板" llmTxtName="Conversations"></DemoTitle>



## 示例

```tsx
import { Button, IconButton } from '@agentscope-ai/design';
import { createStyles } from 'antd-style';
import { ReactNode, useState } from 'react';
import { HistoryPanel } from '@agentscope-ai/chat';
import { SparkDeleteLine, SparkOperateLeftLine, SparkOperateRightLine, SparkPlusLine } from '@agentscope-ai/icons';

const useStyles = createStyles(({ token }) => {
  return {
    layout: {
      position: 'relative',
      display: 'flex',
      height: 416,
      border: `1px solid ${token.colorBorderSecondary}`,
      borderRadius: 8,
      overflow: 'hidden',
    },
    left: {
      display: 'flex',
      flexDirection: 'column',
      width: 280,
      background: token.colorBgLayout,
      transition: 'margin-left 0.3s ease-in-out',
      zIndex: 1,
    },
    open: {
      position: 'absolute',
      left: 20,
      top: 16,
    },
    close: {
      marginLeft: -280,
    },
    header: {
      margin: '16px 20px 8px 20px',
      height: 32,
      display: 'flex',
      justifyContent: 'space-between',
      alignItems: 'center',
      gap: 8,
      fontSize: 16,
    },
    btn: {
      margin: '0 20px 16px 20px',

    },
    list: {
      height: 0,
      flex: 1,
      overflowY: 'scroll',
      padding: '0 16px 16px 20px',

      '&::-webkit-scrollbar': {
        width: 4,
      },

      '&::-webkit-scrollbar-thumb': {
        backgroundColor: 'transparent !important',

        '&:hover': {
          backgroundColor: `${token.colorFill} !important`,
        }
      },

    }
  };
});

const items = Array.from({ length: 10 }).map((_, index) => ({
  key: `item${index + 1}`,
  label: `What is Spark Design?`,
  disabled: index === 3,
}));

function Layout(props: { children: ReactNode }) {
  const { styles, cx, theme } = useStyles();

  return <div className={styles.layout}>{props.children}</div>
}

export default function () {
  const [open, setOpen] = useState(true);
  const { styles, cx, theme } = useStyles();


  return <Layout>
    <div className={styles.open}>
      <IconButton bordered={false} icon={<SparkOperateRightLine />} onClick={() => setOpen(!open)} />

    </div>
    <div className={cx(styles.left, open ? '' : styles.close)}>
      <div className={styles.header}>
        <strong>SPARK CHAT</strong>
        <IconButton bordered={false} icon={<SparkOperateLeftLine />} onClick={() => setOpen(!open)} />
      </div>
      <div className={styles.btn}>
        <Button block type="primary" icon={<SparkPlusLine />}>
          New Chat
        </Button>
      </div>
      <div className={styles.list}>
        <HistoryPanel
          menu={(session) => ({
            items: [
              {
                label: '删除',
                key: 'delete',
                icon: <SparkDeleteLine />,
                danger: true,
              },
            ],
            onClick: (e) => {
              e.domEvent.stopPropagation();
            },
          })}
          items={items} defaultActiveKey="item1" />
      </div>
    </div>
  </Layout>
}
```

import { HistoryPanel } from '@agentscope-ai/chat'

#### 历史面板示例

以下是此组件的示例和变体



## 展示时间戳

```tsx
import { Button } from '@agentscope-ai/design';
import { createStyles } from 'antd-style';
import { ReactNode, useState } from 'react';
import { HistoryPanel } from '@agentscope-ai/chat';
import { SparkDeleteLine, SparkEditLine, SparkPlusLine } from '@agentscope-ai/icons';


const useStyles = createStyles(({ token }) => {
  return {
    layout: {
      display: 'flex',
      height: 416,
      border: `1px solid ${token.colorBorderSecondary}`,
      borderRadius: 8,
      overflow: 'hidden',
    },
    left: {
      display: 'flex',
      flexDirection: 'column',
      width: 280,
      background: token.colorBgLayout,
    },
    header: {
      margin: '16px 20px 8px 20px',
      height: 32,
      display: 'flex',
      alignItems: 'center',
      gap: 8,
      fontSize: 16,
    },
    btn: {
      margin: '0 20px 16px 20px',

    },
    list: {
      height: 0,
      flex: 1,
      overflowY: 'scroll',
      padding: '0 16px 16px 20px',

      '&::-webkit-scrollbar': {
        width: 4,
      },

      '&::-webkit-scrollbar-thumb': {
        backgroundColor: 'transparent !important',

        '&:hover': {
          backgroundColor: `${token.colorFill} !important`,
        }
      },

    }
  };
});

const items = Array.from({ length: 10 }).map((_, index) => ({
  key: `item${index + 1}`,
  label: `What is Spark Design?`,
  desc: new Date(Date.now() - index * 1000).toLocaleString(),
  disabled: index === 3,
}));

function Layout(props: { children: ReactNode }) {
  const { styles, cx, theme } = useStyles();

  return <div className={styles.layout}>{props.children}</div>
}

export default function () {
  const [open, setOpen] = useState(false);
  const { styles, cx, theme } = useStyles();

  return <Layout>
    <div className={styles.left}>
      <div className={styles.header}>
        <strong>SPARK CHAT</strong>
      </div>
      <div className={styles.btn}>
        <Button block type="primary" icon={<SparkPlusLine />}>
          New Chat
        </Button>
      </div>
      <div className={styles.list}>
        <HistoryPanel
          menu={(session) => ({
            items: [
              {
                label: '编辑',
                key: 'edit',
                icon: <SparkEditLine />,
              },
              {
                label: '删除',
                key: 'delete',
                icon: <SparkDeleteLine />,
                danger: true,
              },
            ],
            onEdit(label: string) {
              if (label) return Promise.resolve();
              return Promise.reject();
            },
            onClick: (e) => {
            },
          })}
          items={items} defaultActiveKey="item1" />
      </div>
    </div>
  </Layout>
}
```


## 展示时间戳 & 时间线

```tsx
import { Button } from '@agentscope-ai/design';
import { createStyles } from 'antd-style';
import { ReactNode, useState } from 'react';
import { HistoryPanel } from '@agentscope-ai/chat';
import { SparkDeleteLine, SparkEditLine, SparkPlusLine } from '@agentscope-ai/icons';


const useStyles = createStyles(({ token }) => {
  return {
    layout: {
      display: 'flex',
      height: 416,
      border: `1px solid ${token.colorBorderSecondary}`,
      borderRadius: 8,
      overflow: 'hidden',
    },
    left: {
      display: 'flex',
      flexDirection: 'column',
      width: 280,
      background: token.colorBgLayout,
    },
    header: {
      margin: '16px 20px 8px 20px',
      height: 32,
      display: 'flex',
      alignItems: 'center',
      gap: 8,
      fontSize: 16,
    },
    btn: {
      margin: '0 20px 16px 20px',

    },
    list: {
      height: 0,
      flex: 1,
      overflowY: 'scroll',
      padding: '0 16px 16px 20px',

      '&::-webkit-scrollbar': {
        width: 4,
      },

      '&::-webkit-scrollbar-thumb': {
        backgroundColor: 'transparent !important',

        '&:hover': {
          backgroundColor: `${token.colorFill} !important`,
        }
      },

    }
  };
});

const items = Array.from({ length: 10 }).map((_, index) => ({
  key: `item${index + 1}`,
  label: `What is Spark Design?`,
  desc: new Date(Date.now() - index * 1000).toLocaleString(),
  disabled: index === 3,
  timeline: true,
}));

function Layout(props: { children: ReactNode }) {
  const { styles, cx, theme } = useStyles();

  return <div className={styles.layout}>{props.children}</div>
}

export default function () {
  const [open, setOpen] = useState(false);
  const { styles, cx, theme } = useStyles();

  return <Layout>
    <div className={styles.left}>
      <div className={styles.header}>
        <strong>SPARK CHAT</strong>
      </div>
      <div className={styles.btn}>
        <Button block type="primary" icon={<SparkPlusLine />}>
          New Chat
        </Button>
      </div>
      <div className={styles.list}>
        <HistoryPanel
          menu={(session) => ({
            items: [
              {
                label: '编辑',
                key: 'edit',
                icon: <SparkEditLine />,
              },
              {
                label: '删除',
                key: 'delete',
                icon: <SparkDeleteLine />,
                danger: true,
              },
            ],
            
            onClick: (e) => {
              if (e.key === 'edit') {
                if (e.label) return Promise.resolve();
                return Promise.reject();
              }
              debugger;
              e.domEvent.stopPropagation();
            },
          })}
          items={items} defaultActiveKey="item1" />
      </div>
    </div>
  </Layout>
}
```

#### API

##### HistoryPanel

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| items | 会话列表的数据源数组，包含所有会话信息 | Conversation[] |  | 
| activeKey | 当前激活的会话标识符，用于高亮显示选中项 | Conversation['key'] |  | 
| defaultActiveKey | 组件初始化时的默认选中会话标识符 | Conversation['key'] |  | 
| onActiveChange | 会话选择发生变化时的回调函数，接收新的会话标识符 | (value: string) => void |  | 
| menu | 会话操作菜单配置，支持静态配置或动态函数返回 | MenuProps \| ((value: Conversation) => MenuProps) |  | 
| styles | 语义化样式对象，用于精确控制不同区域的样式 | Partial<Record<'item', React.CSSProperties>> |  | 
| classNames | 语义化CSS类名，用于为不同区域添加自定义类名 | Partial<Record<'item', string>> |  | 
| prefixCls | 自定义CSS类名前缀，用于样式隔离和主题定制 | string |  | 
| rootClassName | 自定义根容器的CSS类名，用于覆盖默认样式 | string |  | 


##### Conversation

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| key | 会话的唯一标识符，用于区分不同的聊天会话 | string | (必填) | 
| label | 会话的显示名称，支持文本或React元素 | React.ReactNode |  | 
| timestamp | 会话创建或最后活动的时间戳，用于排序和显示 | number |  | 
| icon | 会话的图标元素，用于视觉识别 | React.ReactNode |  | 
| disabled | 是否禁用该会话，影响交互功能 | boolean |  | 
| timeline | 是否在时间线中显示该会话，用于分组显示 | boolean |  | 




# Bubble
对话气泡



## 示例

```tsx
import { Bubble, DefaultCards } from '@agentscope-ai/chat';
import { Flex } from 'antd';
import { SparkCopyLine, SparkThumbsUpLine, SparkThumbsDownLine, SparkReplaceLine } from '@agentscope-ai/icons';


export default function () {
  return <Flex vertical gap={24}>
    <Bubble cards={[
      {
        code: 'Text',
        data: {
          content: 'what is citypop'
        }
      },
    ]} role="user"></Bubble>
    <Bubble cards={[
      {
        code: 'Text',
        data: {
          content: `City Pop, short for City Pop, is a genre of music that originated in Japan during the late 1970s and early 1980s. It blends elements of jazz, folk, easy listening, and AOR (Adult Oriented Rock) with a distinctly urban feel. The term "City Pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of Tokyo and other major Japanese cities during this period.
City Pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. Common themes include city life, summer vibes, nature, and romantic encounters. The music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban Japan in the 1980s.
Some notable City Pop artists include Mariya Takeuchi, known for her iconic song " Plastic Love," and Joe Hisaishi, a composer famous for his work on Studio Ghibli films, though he is not strictly considered a City Pop artist.
Today, City Pop has experienced a resurgence in popularity, particularly among younger generations who appreciate its unique sound and the nostalgic value it holds.`
        },
      }, {
        code: 'Footer',
        data: {
          left: <DefaultCards.FooterActions data={[
            {
              icon: <SparkCopyLine />, onClick: () => {
              }
            },
            {
              icon: <SparkThumbsUpLine />, onClick: () => {
              }
            },
            {
              icon: <SparkThumbsDownLine />, onClick: () => {
              }
            },

            {
              icon: <SparkReplaceLine />, onClick: () => {
              }
            },
          ]} />,
        },
      }

    ]}
      role="assistant"></Bubble>
    {/* 空消息的时候会有 loading */}
    {/* <Bubble msgStatus="generating" role="assistant"></Bubble> */}
  </Flex >
}
```

#### 用户气泡示例

以下是此组件的示例和变体



## 附带图片

```tsx
import { Bubble, DefaultCards } from '@agentscope-ai/chat';

export default function () {
  return <Bubble cards={[
    {
      code: 'Text',
      data: {
        content: 'what is citypop'
      }
    },
    {
      code: 'Images',
      data: [
        {
          url: 'https://gw.alicdn.com/imgextra/i4/O1CN01sjZ4Uu1erFDOC6IkA_!!6000000003924-2-tps-396-224.png',
        },
        {
          url: 'https://gw.alicdn.com/imgextra/i4/O1CN01sjZ4Uu1erFDOC6IkA_!!6000000003924-2-tps-396-224.png',
        },
        {
          url: 'https://gw.alicdn.com/imgextra/i4/O1CN01sjZ4Uu1erFDOC6IkA_!!6000000003924-2-tps-396-224.png',
        },
      ]
    },
  ]} role="user"></Bubble>
}
```


## 附带文件

```tsx
import { Bubble, DefaultCards } from '@agentscope-ai/chat';

export default function () {
  return <Bubble cards={[
    {
      code: 'Text',
      data: {
        content: 'what is citypop'
      }
    },
    {
      code: 'Files',
      data: [
        {
          url: 'https://aliyun.com',
          name: 'test.txt',
          size: 1000,
        },
        {
          name: 'test.pdf',
          size: 10000,
        },
        
      ]
    },
  ]} role="user"></Bubble>
}
```

#### 模型气泡示例

以下是此组件的示例和变体



## 附带 Code

```tsx
import { Bubble, DefaultCards } from "@agentscope-ai/chat";
import { SparkCopyLine, SparkThumbsUpLine, SparkThumbsDownLine, SparkReplaceLine } from '@agentscope-ai/icons';

export default function () {
  return <Bubble cards={[
    {
      code: 'Text',
      data: {
        content: `City Pop, short for City Pop, is a genre of music that originated in Japan during the late 1970s and early 1980s. It blends elements of jazz, folk, easy listening, and AOR (Adult Oriented Rock) with a distinctly urban feel. The term "City Pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of Tokyo and other major Japanese cities during this period.
City Pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. Common themes include city life, summer vibes, nature, and romantic encounters. The music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban Japan in the 1980s.
Some notable City Pop artists include Mariya Takeuchi, known for her iconic song " Plastic Love," and Joe Hisaishi, a composer famous for his work on Studio Ghibli films, though he is not strictly considered a City Pop artist.
Today, City Pop has experienced a resurgence in popularity, particularly among younger generations who appreciate its unique sound and the nostalgic value it holds.

\`\`\`javascript
function bubbleSort(arr) {
  const n = arr.length;
  for (let i = 0; i < n - 1; i++) {
    for (let j = 0; j < n - i - 1; j++) {
      if (arr[j] > arr[j + 1]) {
        [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
      }
    }
  }
  return arr;
}
\`\`\`

City Pop, short for City Pop, is a genre of music that originated in Japan during the late 1970s and early 1980s. It blends elements of jazz, folk, easy listening, and AOR (Adult Oriented Rock) with a distinctly urban feel. The term "City Pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of Tokyo and other major Japanese cities during this period.`
      },
    }, {
      code: 'Footer',
      data: {
        left: <DefaultCards.FooterActions data={[
          {
            icon: <SparkCopyLine />, onClick: () => {
            }
          },
          {
            icon: <SparkThumbsUpLine />, onClick: () => {
            }
          },
          {
            icon: <SparkThumbsDownLine />, onClick: () => {
            }
          },

          {
            icon: <SparkReplaceLine />, onClick: () => {
            }
          },
        ]} />,
      },
    }

  ]}



    role="assistant"></Bubble>
}
```


## 附带图片

```tsx
import { Bubble, DefaultCards } from "@agentscope-ai/chat";
import { SparkCopyLine, SparkThumbsUpLine, SparkThumbsDownLine, SparkReplaceLine } from '@agentscope-ai/icons';


export default function () {
  return <Bubble cards={[
    {
      code: 'Text',
      data: {
        content: `City Pop, short for City Pop, is a genre of music that originated in Japan during the late 1970s and early 1980s. It blends elements of jazz, folk, easy listening, and AOR (Adult Oriented Rock) with a distinctly urban feel. The term "City Pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of Tokyo and other major Japanese cities during this period.
City Pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. Common themes include city life, summer vibes, nature, and romantic encounters. The music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban Japan in the 1980s.
Some notable City Pop artists include Mariya Takeuchi, known for her iconic song " Plastic Love," and Joe Hisaishi, a composer famous for his work on Studio Ghibli films, though he is not strictly considered a City Pop artist.
Today, City Pop has experienced a resurgence in popularity, particularly among younger generations who appreciate its unique sound and the nostalgic value it holds.

![](https://gw.alicdn.com/imgextra/i4/O1CN01sjZ4Uu1erFDOC6IkA_!!6000000003924-2-tps-396-224.png)`
      },
    }, {
      code: 'Footer',
      data: {
        left: <DefaultCards.FooterActions data={[
          {
            icon: <SparkCopyLine />, onClick: () => {
            }
          },
          {
            icon: <SparkThumbsUpLine />, onClick: () => {
            }
          },
          {
            icon: <SparkThumbsDownLine />, onClick: () => {
            }
          },
          {
            icon: <SparkReplaceLine />, onClick: () => {
            }
          },
        ]} />,
      },
    }

  ]}



    role="assistant"></Bubble>
}
```


## 包含思考

```tsx
import { Bubble, DefaultCards } from "@agentscope-ai/chat";
import { SparkCopyLine, SparkThumbsUpLine, SparkThumbsDownLine, SparkReplaceLine } from '@agentscope-ai/icons';


export default function () {
  return <Bubble cards={[
    {
      code: 'DeepThink',
      data: {
        content: `Okay, the user is asking about "citypop." Let me start by recalling what I know about that term. I remember that City Pop is a genre of music, but I need to make sure I'm accurate.

First, when did City Pop originate? I think it was in Japan during the late 1970s and 1980s. That makes sense because Japan's economy was booming then, leading to a vibrant urban culture. The genre probably blends Western styles like funk, jazz, and disco with Japanese pop elements. Artists like Tatsuro Yamashita and Mariya Takeuchi come to mind. Oh, and there's that song "Plastic Love" by Mariya Takeuchi that went viral online recently, which might have sparked renewed interest.

I should also mention the themes of City Pop songs—they often reflect city life, romance, and leisure, fitting the upbeat and cosmopolitan vibe of the time. The visual style associated with it includes retro anime and vibrant cityscapes, which adds to its aesthetic appeal. It's interesting how the internet, especially platforms like YouTube and Spotify, helped revive this genre internationally. Maybe I should note that connection between modern digital culture and the resurgence of City Pop.

Wait, are there any subgenres or key characteristics I should highlight? The use of synthesizers, smooth vocals, and lush production are typical. Also, City Pop was influenced by yacht rock and soft rock from the West. It's important to link it to Japan's economic bubble era, as that context explains the music's optimistic and luxurious feel.

I need to ensure I don't confuse it with other Japanese genres like J-pop or Enka. City Pop is distinct in its fusion with Western sounds. Including notable albums, like Tatsuro Yamashita's "For You" or Anri's "Timely!!", could be helpful. Oh, and the connection to future funk and vaporwave genres that sample City Pop tracks is a good point for its modern influence.`,
      },
    },
    {
      code: 'Text',
      data: {
        content: `City Pop, short for City Pop, is a genre of music that originated in Japan during the late 1970s and early 1980s. It blends elements of jazz, folk, easy listening, and AOR (Adult Oriented Rock) with a distinctly urban feel. The term "City Pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of Tokyo and other major Japanese cities during this period.
City Pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. Common themes include city life, summer vibes, nature, and romantic encounters. The music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban Japan in the 1980s.
Some notable City Pop artists include Mariya Takeuchi, known for her iconic song " Plastic Love," and Joe Hisaishi, a composer famous for his work on Studio Ghibli films, though he is not strictly considered a City Pop artist.
Today, City Pop has experienced a resurgence in popularity, particularly among younger generations who appreciate its unique sound and the nostalgic value it holds.`
      },
    }, {
      code: 'Footer',
      data: {
        left: <DefaultCards.FooterActions data={[
          {
            icon: <SparkCopyLine />, onClick: () => {
            }
          },
          {
            icon: <SparkThumbsUpLine />, onClick: () => {
            }
          },
          {
            icon: <SparkThumbsDownLine />, onClick: () => {
            }
          },
          {
            icon: <SparkReplaceLine />, onClick: () => {
            }
          },
        ]} />,
      },
    }
  ]}
    role="assistant"></Bubble>
}
```


## 包含步骤处理

```tsx
import { CodeBlock } from "@agentscope-ai/design";
import { Accordion, Bubble, DefaultCards } from "@agentscope-ai/chat";
import { SparkCopyLine, SparkThumbsUpLine, SparkThumbsDownLine, SparkReplaceLine, SparkCheckCircleLine } from '@agentscope-ai/icons';

import { Flex } from "antd";

const input = JSON.stringify({
  'query': 'What is city pop?',
  'top_k': 1,
  'threshold': 0.5,
  'return_metadata': true,
});

const output = JSON.stringify({
  'results': [
    {
      'score': 0.9999999999999998,
      'metadata': {
        'source': 'https://en.wikipedia.org/wiki/City_population',
        'title': 'City population',
      },
      'content': 'city pop, short for city pop, is a genre of music that originated in japan during the late 1970s and early 1980s. it blends elements of jazz, folk, easy listening, and aor (adult oriented rock) with a distinctly urban feel. the term "city pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of tokyo and other major japanese cities during this period.'
    }
  ]

})
function MutiProcess(props) {
  return <Accordion
    title="Completed"
    status="finished"
    defaultOpen
    steps={[{
      icon: <SparkCheckCircleLine />,
      iconLine: true,
      title: 'Knowledge base search',
      rightChildren: <span>52.21ms</span>,
      children: <Accordion.BodyContent headerLeft="What is city pop?" headerRight="Similarity: 78%">
        <div style={{ padding: 12 }}>
          city pop, short for city pop, is a genre of music that originated in japan during the late 1970s and early 1980s. it blends elements of jazz, folk, easy listening, and aor (adult oriented rock) with a distinctly urban feel. the term "city pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of tokyo and other major japanese cities during this period.
          city pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. common themes include city life, summer vibes, nature, and romantic encounters. the music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban japan in the 1980s.
          some notable city pop artists include mariya takeuchi, known for her iconic song " plastic love," and joe hisaishi, a composer famous for his work on studio ghibli films, though he is not strictly considered a city pop artist.
        </div>
      </Accordion.BodyContent>,
    }, {
      defaultOpen: true,
      icon: <SparkCheckCircleLine />,
      iconLine: true,
      title: 'Long Memory',
      children: <Flex gap={8} vertical>
        <Accordion.BodyContent headerLeft="input">
          <CodeBlock language="json" value={input} />
        </Accordion.BodyContent>
        <Accordion.BodyContent headerLeft="output">
          <CodeBlock language="json" value={output} />
        </Accordion.BodyContent>
      </Flex>,
    }
    ]}
  >
  </Accordion>
}

export default function () {
  return <Bubble cards={[
    {
      code: 'CustomCard',
      data: {},
      component: MutiProcess,
    },
    {
      code: 'Text',
      data: {
        content: `City Pop, short for City Pop, is a genre of music that originated in Japan during the late 1970s and early 1980s. It blends elements of jazz, folk, easy listening, and AOR (Adult Oriented Rock) with a distinctly urban feel. The term "City Pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of Tokyo and other major Japanese cities during this period.
City Pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. Common themes include city life, summer vibes, nature, and romantic encounters. The music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban Japan in the 1980s.
Some notable City Pop artists include Mariya Takeuchi, known for her iconic song " Plastic Love," and Joe Hisaishi, a composer famous for his work on Studio Ghibli films, though he is not strictly considered a City Pop artist.
Today, City Pop has experienced a resurgence in popularity, particularly among younger generations who appreciate its unique sound and the nostalgic value it holds.`
      },
    }, {
      code: 'Footer',
      data: {
        left: <DefaultCards.FooterActions data={[
          {
            icon: <SparkCopyLine />, onClick: () => {
            }
          },
          {
            icon: <SparkThumbsUpLine />, onClick: () => {
            }
          },
          {
            icon: <SparkThumbsDownLine />, onClick: () => {
            }
          },
          {
            icon: <SparkReplaceLine />, onClick: () => {
            }
          },
        ]} />,
      },
    }
  ]}
    role="assistant"></Bubble>
}
```


## 包含链接引用

```tsx
import { SparkDeepSearchLine } from "@agentscope-ai/icons";
import { Accordion, Bubble, DefaultCards } from "@agentscope-ai/chat";
import { SparkCopyLine, SparkThumbsUpLine, SparkThumbsDownLine, SparkReplaceLine, SparkCheckCircleLine } from '@agentscope-ai/icons';

function SearchProcess(props) {
  return <Accordion
    defaultOpen
    status="finished"
    icon={<SparkDeepSearchLine />}
    title={"Searching from 10 pages"}
    steps={[{
      icon: <SparkCheckCircleLine />,
      title: 'File analysis',
    }, {
      icon: <SparkCheckCircleLine />,
      title: 'Url analysis',
    }]}
  >
  </Accordion>
}

export default function () {
  return <Bubble cards={[
    {
      code: 'CustomCard',
      data: {},
      component: SearchProcess,
    },
    {
      code: 'Text',
      data: {
        citations: [
          {
            url: 'https://www.zhihu.com/question/48784242',
            content: 'https://www.zhihu.com/question/48784242',
            title: 'What is city pop?',
          }
        ],
        content: `City Pop[1], short for City Pop, is a genre of music that originated in Japan during the late 1970s and early 1980s. It blends elements of jazz, folk, easy listening, and AOR (Adult Oriented Rock) with a distinctly urban feel. The term "City Pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of Tokyo and other major Japanese cities during this period.
City Pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. Common themes include city life, summer vibes, nature, and romantic encounters. The music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban Japan in the 1980s.
Some notable City Pop artists include Mariya Takeuchi, known for her iconic song " Plastic Love," and Joe Hisaishi, a composer famous for his work on Studio Ghibli films, though he is not strictly considered a City Pop artist.
Today, City Pop has experienced a resurgence in popularity, particularly among younger generations who appreciate its unique sound and the nostalgic value it holds.[1]`
      },
    }, {
      code: 'Footer',
      data: {
        left: <DefaultCards.FooterActions data={[
          {
            icon: <SparkCopyLine />, onClick: () => {
            }
          },
          {
            icon: <SparkThumbsUpLine />, onClick: () => {
            }
          },
          {
            icon: <SparkThumbsDownLine />, onClick: () => {
            }
          },
          {
            icon: <SparkReplaceLine />, onClick: () => {
            }
          },
        ]} />,
      },
    }
  ]}
    role="assistant"></Bubble>
}
```


## 状态展示

```tsx
import { Accordion, Bubble, DefaultCards } from "@agentscope-ai/chat";
import { Flex } from "antd";
import { SparkCopyLine, SparkThumbsUpLine, SparkThumbsDownLine, SparkReplaceLine } from '@agentscope-ai/icons';

function footerCard() {
  return {
    code: 'Footer',
    data: {
      left: <DefaultCards.FooterActions data={[
        {
          icon: <SparkCopyLine />, onClick: () => {
          }
        },
        {
          icon: <SparkThumbsUpLine />, onClick: () => {
          }
        },
        {
          icon: <SparkThumbsDownLine />, onClick: () => {
          }
        },
        {
          icon: <SparkReplaceLine />, onClick: () => {
          }
        },
      ]} />,
    },
  }
}

export default function () {
  return <Flex vertical gap={32}>
    <Bubble
      cards={[
        {
          code: 'Text',
          data: {
            content: `City Pop, short for City Pop, is a genre of music that originated in Japan during the late 1970s and early 1980s. It blends elements of jazz, folk, easy listening, and AOR (Adult Oriented Rock) with a distinctly urban feel. The term "City Pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of Tokyo and other major Japanese cities during this period.
City Pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. Common themes include city life, summer vibes, nature, and romantic encounters. The music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban Japan in the 1980s.
Some notable City Pop artists include Mariya Takeuchi, known for her iconic song " Plastic Love," and Joe Hisaishi, a composer famous for his work on Studio Ghibli films, though he is not strictly considered a City Pop artist.
Today, City Pop has experienced a resurgence in popularity, particularly among younger generations who appreciate its unique sound and the nostalgic value it holds.`
          },
        },
        {
          code: 'Interrupted',
          data: {
            title: 'Answers have stopped',
            type: 'interrupted',
          },
        },
        footerCard(),
      ]}
      role="assistant" />

    <Bubble
      cards={[
        {
          code: 'Text',
          data: {
            content: `City Pop, short for City Pop, is a genre of music that originated in Japan during the late 1970s and early 1980s. It blends elements of jazz, folk, easy listening, and AOR (Adult Oriented Rock) with a distinctly urban feel. The term "City Pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of Tokyo and other major Japanese cities during this period.
City Pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. Common themes include city life, summer vibes, nature, and romantic encounters. The music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban Japan in the 1980s.
Some notable City Pop artists include Mariya Takeuchi, known for her iconic song " Plastic Love," and Joe Hisaishi, a composer famous for his work on Studio Ghibli films, though he is not strictly considered a City Pop artist.
Today, City Pop has experienced a resurgence in popularity, particularly among younger generations who appreciate its unique sound and the nostalgic value it holds.`
          },
        },
        {
          code: 'Interrupted',
          data: {
            type: 'error',
            title: 'Network Error',
          },
        },
        footerCard(),
      ]}
      role="assistant" />

    <Bubble
      cards={[
        {
          code: 'Text',
          data: {
            content: `City Pop, short for City Pop, is a genre of music that originated in Japan during the late 1970s and early 1980s. It blends elements of jazz, folk, easy listening, and AOR (Adult Oriented Rock) with a distinctly urban feel. The term "City Pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of Tokyo and other major Japanese cities during this period.
City Pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. Common themes include city life, summer vibes, nature, and romantic encounters. The music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban Japan in the 1980s.
Some notable City Pop artists include Mariya Takeuchi, known for her iconic song " Plastic Love," and Joe Hisaishi, a composer famous for his work on Studio Ghibli films, though he is not strictly considered a City Pop artist.
Today, City Pop has experienced a resurgence in popularity, particularly among younger generations who appreciate its unique sound and the nostalgic value it holds.`
          },
        },
        {
          code: 'Interrupted',
          data: {
            type: 'error',
            title: 'Network Error',
            desc: 'This is a description this is a description  this is a description this is a description',
          },
        },
        footerCard(),
      ]}
      role="assistant" />


  </Flex>
}
```

#### API

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| prefixCls | 自定义CSS类名前缀，用于样式隔离和主题定制 | string |  | 
| rootClassName | 自定义根容器的CSS类名，用于覆盖默认样式 | string |  | 
| styles | 语义化样式对象，用于精确控制不同区域的样式 | Partial<Record<SemanticType, React.CSSProperties>> |  | 
| classNames | 语义化CSS类名，用于为不同区域添加自定义类名 | Partial<Record<SemanticType, string>> |  | 
| avatar | 用户头像配置，支持Antd Avatar属性或自定义React元素 | AvatarProps \| React.ReactElement |  | 
| loading | 是否显示加载状态，影响组件的视觉反馈 | boolean |  | 
| content | 气泡内容，支持文本、React元素或复杂数据结构 | BubbleContentType |  | 
| cards | 自定义渲染卡片配置，用于展示特殊类型的内容 | { code: string; data?: string \| any; component?: any }[] |  | 
| msgStatus | 消息处理状态，影响显示样式和交互行为 | 'finished' \| 'generating' \| 'interrupted' \| 'error' |  | 
| id | 消息的唯一标识符，用于状态管理和事件处理 | any |  | 




<DemoTitle title="Process" desc="模型处理问题的过程展示" llmTxtName="Accordion"></DemoTitle>



## 示例

```tsx
import { DeepThinking } from '@agentscope-ai/chat';
import { Flex } from 'antd'


const App = () => <>
  <Flex gap={32} vertical>
    <DeepThinking
      loading={true}
      content='你好，我是AI智能助手，我正在思考...'
    />

    <DeepThinking
      defaultOpen
      loading={false}
      content={`Okay, the user is asking about "citypop." Let me start by recalling what I know about that term. I remember that City Pop is a genre of music, but I need to make sure I'm accurate.

First, when did City Pop originate? I think it was in Japan during the late 1970s and 1980s. That makes sense because Japan's economy was booming then, leading to a vibrant urban culture. The genre probably blends Western styles like funk, jazz, and disco with Japanese pop elements. Artists like Tatsuro Yamashita and Mariya Takeuchi come to mind. Oh, and there's that song "Plastic Love" by Mariya Takeuchi that went viral online recently, which might have sparked renewed interest.

I should also mention the themes of City Pop songs—they often reflect city life, romance, and leisure, fitting the upbeat and cosmopolitan vibe of the time. The visual style associated with it includes retro anime and vibrant cityscapes, which adds to its aesthetic appeal. It's interesting how the internet, especially platforms like YouTube and Spotify, helped revive this genre internationally. Maybe I should note that connection between modern digital culture and the resurgence of City Pop.

Wait, are there any subgenres or key characteristics I should highlight? The use of synthesizers, smooth vocals, and lush production are typical. Also, City Pop was influenced by yacht rock and soft rock from the West. It's important to link it to Japan's economic bubble era, as that context explains the music's optimistic and luxurious feel.

I need to ensure I don't confuse it with other Japanese genres like J-pop or Enka. City Pop is distinct in its fusion with Western sounds. Including notable albums, like Tatsuro Yamashita's "For You" or Anri's "Timely!!", could be helpful. Oh, and the connection to future funk and vaporwave genres that sample City Pop tracks is a good point for its modern influence.`}
    />
  </Flex>
</>;

export default App;

```

import { Process, DeepThinking } from '@agentscope-ai/chat'

#### 模型处理过程示例

以下是此组件的示例和变体


## 包含多个步骤

```tsx
import { Accordion } from '@agentscope-ai/chat';
import { Flex } from 'antd'
import { CodeBlock } from '@agentscope-ai/design';
import { SparkCheckCircleLine, SparkTimeLine, SparkTimestampLine } from '@agentscope-ai/icons';

const input = JSON.stringify({
  'query': 'What is city pop?',
  'top_k': 1,
  'threshold': 0.5,
  'return_metadata': true,
});

const output = JSON.stringify({
  'results': [
    {
      'score': 0.9999999999999998,
      'metadata': {
        'source': 'https://en.wikipedia.org/wiki/City_population',
        'title': 'City population',
      },
      'content': 'city pop, short for city pop, is a genre of music that originated in japan during the late 1970s and early 1980s. it blends elements of jazz, folk, easy listening, and aor (adult oriented rock) with a distinctly urban feel. the term "city pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of tokyo and other major japanese cities during this period.'
    }
  ]

})

const App = () => <>
  <Flex gap={24} vertical>
    <Accordion
      title="Completed"
      status="finished"
      defaultOpen
      steps={[{
        icon: <SparkCheckCircleLine />,
        iconLine: true,
        title: 'Knowledge base search',
        rightChildren: <span>52.21ms</span>,
        children: <Accordion.BodyContent headerLeft="What is city pop?" headerRight="Similarity: 78%">
          <div style={{ padding: 12 }}>
            city pop, short for city pop, is a genre of music that originated in japan during the late 1970s and early 1980s. it blends elements of jazz, folk, easy listening, and aor (adult oriented rock) with a distinctly urban feel. the term "city pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of tokyo and other major japanese cities during this period.
            city pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. common themes include city life, summer vibes, nature, and romantic encounters. the music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban japan in the 1980s.
            some notable city pop artists include mariya takeuchi, known for her iconic song " plastic love," and joe hisaishi, a composer famous for his work on studio ghibli films, though he is not strictly considered a city pop artist.
          </div>
        </Accordion.BodyContent>,
      }, {
        defaultOpen: true,
        icon: <SparkCheckCircleLine />,
        iconLine: true,
        title: 'Long Memory',
        children: <Flex gap={8} vertical>
          <Accordion.BodyContent headerLeft="Input">
            <CodeBlock language="json" value={input} />
          </Accordion.BodyContent>
          <Accordion.BodyContent headerLeft="Output">
            <CodeBlock language="json" value={output} />
          </Accordion.BodyContent>
        </Flex>,
      }
      ]}
    >
    </Accordion>


    {[{ label: 'steps error', value: 'error' },
    { label: 'steps interrupted', value: 'interrupted' },
    { label: 'steps generating', value: 'generating' }].map(({ label, value }) => (
      <Accordion
        title={label}
        // @ts-ignore
        status={value}
        defaultOpen={false}
        steps={[{
          icon: <SparkCheckCircleLine />,
          iconLine: true,
          title: 'Knowledge base search',
          rightChildren: <span>52.21ms</span>,
          children: <Accordion.BodyContent headerLeft="What is city pop?" headerRight="Similarity: 78%">
            <div style={{ padding: 12 }}>
              city pop, short for city pop, is a genre of music that originated in japan during the late 1970s and early 1980s. it blends elements of jazz, folk, easy listening, and aor (adult oriented rock) with a distinctly urban feel. the term "city pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of tokyo and other major japanese cities during this period.
              city pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. common themes include city life, summer vibes, nature, and romantic encounters. the music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban japan in the 1980s.
              some notable city pop artists include mariya takeuchi, known for her iconic song " plastic love," and joe hisaishi, a composer famous for his work on studio ghibli films, though he is not strictly considered a city pop artist.
            </div>
          </Accordion.BodyContent>,
        }]}
      >
      </Accordion>
    ))}


    <Accordion
      title="Completed deep thinking"
      status="generating"
      defaultOpen
      steps={[{
        icon: <SparkCheckCircleLine />,
        iconLine: true,
        title: 'File analysis',
        rightChildren: <span>52.21ms</span>,
        children: <Accordion.BodyContent headerLeft="What is city pop?" headerRight="Similarity: 78%">
          <div style={{ padding: 12 }}>
            city pop, short for city pop, is a genre of music that originated in japan during the late 1970s and early 1980s. it blends elements of jazz, folk, easy listening, and aor (adult oriented rock) with a distinctly urban feel. the term "city pop" often evokes images of the sophisticated, stylish, and sometimes nostalgic lifestyle of tokyo and other major japanese cities during this period.
            city pop is characterized by its smooth melodies, mellow rhythms, and often dreamy or introspective lyrics. common themes include city life, summer vibes, nature, and romantic encounters. the music is frequently associated with a particular aesthetic that reflects the fashion, design, and cultural trends of urban japan in the 1980s.
            some notable city pop artists include mariya takeuchi, known for her iconic song " plastic love," and joe hisaishi, a composer famous for his work on studio ghibli films, though he is not strictly considered a city pop artist.
          </div>
        </Accordion.BodyContent>,
      }, {
        status: "generating",
        iconLine: true,
        title: <b>MCP Call</b>,
        children: <Flex gap={8} vertical>
          <Accordion.BodyContent headerLeft="input">
            <CodeBlock language="json" value={input} />
          </Accordion.BodyContent>
          <Accordion.BodyContent headerLeft="output">
            <CodeBlock language="json" value={output} />
          </Accordion.BodyContent>
        </Flex>,
      },
      {
        icon: <SparkTimestampLine />,
        iconLine: true,
        title: 'Long Memory',
      },
      {
        icon: <SparkTimestampLine />,
        iconLine: true,
        title: 'Final output',
      },
      ]}
    >
    </Accordion>
  </Flex>
</>;

export default App;

```


## 搜索场景的步骤展示

```tsx
import React from 'react';
import { Accordion } from '@agentscope-ai/chat';
import { Flex } from 'antd'
import { SparkDeepSearchLine, SparkCheckCircleLine } from '@agentscope-ai/icons'
const App = () => <>
  <Flex gap={32} vertical>
    <Accordion
      status="generating"
      icon={<SparkDeepSearchLine />}
      title={<Accordion.SoftLightTitle>Searching from 10 pages</Accordion.SoftLightTitle>}

      steps={[{
        icon: <SparkCheckCircleLine />,
        title: 'File analysis',
      }, {
        icon: <SparkCheckCircleLine />,
        title: 'Url analysis',
      }]}
    >
    </Accordion>

    <Accordion
      defaultOpen
      status="finished"
      icon={<SparkDeepSearchLine />}
      title={"Searching from 10 pages"}
      steps={[{
        icon: <SparkCheckCircleLine />,
        title: 'File analysis',
      }, {
        icon: <SparkCheckCircleLine />,
        title: 'Url analysis',
      }]}
    >
    </Accordion>
  </Flex>
</>;

export default App;

```

#### API

##### IAccordionProps

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| status | 组件的当前执行状态，用于显示不同的图标和样式 | 'finished' \| 'interrupted' \| 'generating' \| 'error' |  | 
| title | 组件的标题内容，支持文本或React元素 | string \| React.ReactElement | (必填) | 
| children | 组件展开时显示的主要内容 | string \| React.ReactElement |  | 
| icon | 自定义图标，会覆盖默认的状态图标 | string \| React.ReactElement |  | 
| iconLine | 是否显示图标与内容之间的连接线 | boolean |  | 
| id | 组件的唯一标识符，用于React的key属性 | string |  | 
| rightChildren | 显示在标题右侧的额外内容 | string \| React.ReactElement |  | 
| steps | 子步骤数组，支持递归嵌套结构 | IAccordionProps[] |  | 
| defaultOpen | 组件初始化时是否默认展开 | boolean |  | 
| bodyStyle | 内容区域的样式对象 | React.CSSProperties |  | 
| inline | 是否使用内联模式，影响布局和交互方式 | boolean |  | 


##### IDeepThinking

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| title | 深度思考过程的标题，用于描述思考的主题或方向 | string |  | 
| loading | 是否正在生成思考内容，影响显示状态和动画效果 | boolean |  | 
| content | 深度思考的具体内容，包含思考过程和结果 | string |  | 
| defaultOpen | 组件初始化时是否默认展开，控制初始显示状态 | boolean |  | 
| className | 组件的CSS类名，用于自定义样式 | string |  | 




# 在 Umi 中使用

在真实项目开发中，我们可能会还会需要构建工具、路由方案、CSS 方案、数据流方案、请求库和请求方案、国际化方案、权限方案、Icons 方案等等，才能完成一个完整的项目。推荐使用基于 React 的企业级应用框架 <a href="https://umijs.org/" target="_blank" rel="noopener noreferrer">Umi</a> 来解决相关问题。

本文会引导你使用 Umi、 Alibaba Cloud Spark Chat 从 0 开始创建一个简单应用。

## 安装和初始化


## 这里选「Simple App」，因为我们要从 “0” 开始。

```bash
$ mkdir spark-chat-demo-umi
$ cd spark-chat-demo-umi
$ npm create umi
```


## 可以选择最接触「npm」直接开始，你也可以选择其他的包管理工具。

```bash
? Pick Umi App Template › - Use arrow-keys. Return to submit.
❯   Simple App
    Ant Design Pro
    Vue Simple App
```


## 这里国内的朋友建议选「taobao」，否则选「npm」。选择 npm taobao 源在安装依赖时通常会更快一些。

```bash
? Pick Npm Client › - Use arrow-keys. Return to submit.
❯   npm
    cnpm
    tnpm
    yarn
    pnpm
```


## 然后工具会自动安装依赖，并执行 Umi 的初始化脚本。在启动项目之前，我们再安装一些本教程会用到的依赖。

```bash
? Pick Npm Registry › - Use arrow-keys. Return to submit.
    npm
❯   taobao
```


## 完成后，执行以下命令启动项目。跟着提示点击命令行里的 url，会自动打开浏览器。如果顺利，你会看到如下界面。

```bash
$ npm install antd @agentscope-ai/design @agentscope-ai/chat --save

```


## <img src="https://gw.alicdn.com/imgextra/i4/O1CN011GmAwE1q7Eqt9vDUQ_!!6000000005448-2-tps-2452-1654.png" style="max-width: 50%;" alt="Umi 项目结构" />

```bash
$ npm run dev
umi dev
info  - Umi v4.4.12
        ╔════════════════════════════════════════════════════╗
        ║ App listening at:                                  ║
        ║  >   Local: http://localhost:8000                  ║
ready - ║  > Network: http://*********:8000                  ║
        ║                                                    ║
        ║ Now you can open browser with the above addresses↑ ║
        ╚════════════════════════════════════════════════════╝
```

## 新建 Chat 路由

我们通过命令即可创建路由。


## 然后修改配置文件 

```bash
npx umi g page chat
Write: src/pages/chat.tsx
Write: src/pages/chat.less
````.umirc.ts` 加上新增的路由声明。


## 由于脚手架默认使用的是配置式路由，顾名思义，就是路由是自己一行行配出来的，虽然繁琐，但灵活性更高，这种方式需要在配置里加上 routes 字段，详见 <a href="https://umijs.org/docs/guides/routes" target="_blank">Umi 文档之路由</a>。此外，Umi 还支持约定式路由，意思是文件系统即路由，所以无需配置路由即可生效。

```diff
import { defineConfig } from 'umi';

export default defineConfig({
  routes: [
    { path: '/', component: 'index' },
    { path: '/docs', component: 'docs' },
+   { path: '/chat', component: 'chat' },
  ],
  npmClient: 'npm',
});
```

然后我们编辑下 `src/layouts/index.tsx` 文件，在全局布局路由里加上到 `/chat` 路径的导航。


## ## 开启 Tailwind CSS 插件

```diff
<li>
  <Link to="/docs">Docs</Link>
</li>
+ <li>
+   <Link to="/chat">Chat</Link>
+ </li>
```

为了方便后续项目的编写，我们开启 [Tailwind CSS 插件](https://umijs.org/docs/max/tailwindcss)


## 至此就可以在项目中使用 Tailwind CSS 的样式；项目根目录的 

```bash
$ npx umi g tailwindcss

info  - Update package.json for devDependencies
set config:tailwindcss on /YOUR_PWD/.umirc.ts
info  - Update .umirc.ts
info  - Write tailwind.config.js
info  - Write tailwind.css
````tailwind.config.js` 和 `tailwind.css` 根据需要修改配置。

## 完善 Chat 页面

修改 `src/pages/chat.tsx`，内容如下。


## <img src="https://gw.alicdn.com/imgextra/i1/O1CN01B9MUtz1ZX1gUhPrfs_!!6000000003203-2-tps-2452-1654.png" style="max-width: 50%;" alt="完整的聊天页面" />

```tsx
import { ConfigProvider, carbonTheme } from '@agentscope-ai/design';
import { Bubble, ChatInput, type TMessage } from '@agentscope-ai/chat';
import { useState } from 'react';

function App() {
  const [messages, setMessages] = useState<TMessage[]>([]);
  const [input, setInput] = useState('');

  const handleSend = (input: string) => {
    setMessages((v) => [
      ...v,
      {
        role: 'user',
        content: input,
        id: Date.now().toString(),
      },
    ]);
    setInput('');

    setTimeout(() => {
      setMessages((v) => [
        ...v,
        {
          role: 'assistant',
          content: `Echo: ${input}`,
          id: Date.now().toString(),
        },
      ]);
    }, 1000);
  };

  return (
    <ConfigProvider {...carbonTheme} prefix="spark-chat" prefixCls="spark-chat">
      <div className="h-[80vh] m-[20px] flex flex-col">
        <Bubble.List
          items={messages}
          classNames={{
            wrapper: 'flex-1 h-[0]',
          }}
        />
        <ChatInput value={input} onChange={setInput} onSubmit={handleSend} />
      </div>
    </ConfigProvider>
  );
}

export default App;
```

## 构建应用

完成开发并且在开发环境验证之后，就需要部署给我们的用户了，执行以下命令。


## 构建会打包所有的资源，包含 JavaScript, CSS, Web Fonts, 图片, HTML 等。你可以在

```bash
$ npm run build
info  - Umi v4.4.12
✔ Webpack
  Compiled successfully in 1.36s
info  - File sizes after gzip:
  123.4 kB  dist/umi.js
  1.37 kB   dist/umi.css
  660 B     dist/layouts__index.async.js
  656 B     dist/p__index.async.js
  567 B     dist/p__chat.async.js
  531 B     dist/p__docs.async.js
  100 B     dist/layouts__index.chunk.css
  55 B      dist/p__chat.chunk.css
event - Build index.html
````dist/`目录下找到这些文件。

## 下一步

我们已经完成了一个简单应用，你可能还有很多疑问，比如：


- 如何统一处理出错？
- 如何处理更多路由，比如动态路由、嵌套路由、权限路由等？
- 如何使用数据流方案？
- 如何修改 webpack 配置或切换到 vite 构建模式？
- 等等

你可以：


- 访问  [Umi 官网](https://umijs.org/)
- 了解  [Umi 的路由](https://umijs.org/docs/guides/routes)
- 了解比 Umi 集成度更高的  [Umi Max](https://umijs.org/docs/max/introduce)
- 了解开箱即用的中后台脚手架  [Ant Design Pro](https://pro.ant.design/)
- 了解高级布局  [ProLayout](https://procomponents.ant.design/components/layout)
- 了解高级表格  [ProTable](https://procomponents.ant.design/components/table)

## FAQ


- 为什么看不见对话列表渲染？,
  - `Bubble.List` 和 `ChatInput` 需要指定他们的父元素拥有高度，并且`flex-direction: column`



# 通义千问

Qwen 的模型推理服务支持「兼容 OpenAI 模式」。详见官方文档: [阿里云百炼 - 通义千问](https://help.aliyun.com/zh/model-studio/developer-reference/compatibility-of-openai-with-dashscope)

## 相关参数获取


- 如何获取 baseURL - [https://help.aliyun.com/zh/model-studio/getting-started/what-is-model-studio](https://help.aliyun.com/zh/model-studio/getting-started/what-is-model-studio)
- 如何获取 API Key - [https://help.aliyun.com/zh/model-studio/developer-reference/get-api-key](https://help.aliyun.com/zh/model-studio/developer-reference/get-api-key)
- 模型列表 - [https://help.aliyun.com/zh/model-studio/getting-started/models](https://help.aliyun.com/zh/model-studio/getting-started/models)

## 兼容 OpenAI 模式

是指在接口设计和使用方式上与 OpenAI 的 API 保持一致的模型推理服务。这意味着开发者可以使用与调用 OpenAI 模型相同的代码和方法，来调用这些兼容服务，从而减少开发接入成本。

## 使用 [openai-node](https://github.com/openai/openai-node) 接入

### 安装依赖


## ### 调用示例

```bash
$ npm install openai-node --save
```


## <img src="https://gw.alicdn.com/imgextra/i3/O1CN0180qH4s1WvoGlqDdbx_!!6000000002851-2-tps-2452-1654.png" style="max-width: 50%;" alt="Qwen 集成示例" />

```tsx
import { ConfigProvider, carbonTheme } from '@agentscope-ai/design';
import { Bubble, ChatInput, type TMessage } from '@agentscope-ai/chat';
import { useRef, useState } from 'react';
import OpenAI from 'openai';
import { produce } from 'immer';
import { ChatCompletionMessageParam } from 'openai/resources.mjs';

const client = new OpenAI({
  baseURL: 'https://dashscope.aliyuncs.com/compatible-mode/v1',
  apiKey: 'sk-xxxx', // 请替换成你的 API Key
  dangerouslyAllowBrowser: true, // 允许在浏览器中运行
});

function Sender({
  handleSend,
  loading,
}: {
  handleSend: (input: string) => void;
  loading: boolean;
}) {
  const [input, setInput] = useState('');

  return (
    <ChatInput
      value={input}
      onChange={setInput}
      onSubmit={(input) => {
        handleSend(input);
        setInput('');
      }}
      loading={loading}
    />
  );
}

function App() {
  const [messages, setMessages] = useState<TMessage[]>([]);
  const [loading, setLoading] = useState(false);

  const currentAnswer = useRef<TMessage | null>(null);

  const handleSend = async (input: string) => {
    const id = 'a' + Date.now().toString();
    const query = {
      role: 'user',
      content: input,
      id: 'q' + Date.now().toString(),
    } as TMessage;

    currentAnswer.current = {
      role: 'assistant',
      content: '',
      msgStatus: 'generating',
      id,
    };

    setMessages((v) => [...v, query, currentAnswer.current as TMessage]);
    setLoading(true);

    const stream = await client.chat.completions.create({
      model: 'qwen-plus',
      messages: [...messages, query] as ChatCompletionMessageParam[],
      stream: true,
    });

    for await (const chunk of stream) {
      currentAnswer.current = produce(currentAnswer.current, (draft) => {
        if (chunk.choices[0]?.finish_reason === 'stop') {
          draft.msgStatus = 'finished';
        }
        draft.content += chunk.choices[0]?.delta?.content || '';
      });
      setMessages((v) =>
        v.map((item) =>
          item.id === currentAnswer.current?.id ? currentAnswer.current : item,
        ),
      );
    }

    setLoading(false);
  };

  return (
    <ConfigProvider {...carbonTheme} prefix="spark-chat" prefixCls="spark-chat">
      <div className="h-[80vh] m-[20px] flex flex-col">
        <Bubble.List
          items={messages}
          classNames={{
            wrapper: 'flex-1 h-[0]',
          }}
        />
        <Sender handleSend={handleSend} loading={loading} />
      </div>
    </ConfigProvider>
  );
}

export default App;
```



## 使用 API 接入


## ## dangerouslyAllowBrowser

```tsx
import { ConfigProvider, carbonTheme } from '@agentscope-ai/design';
import {
  Bubble,
  ChatInput,
  Stream,
  type TMessage,
} from '@agentscope-ai/chat';
import { useRef, useState } from 'react';
import { produce } from 'immer';

function Sender({
  handleSend,
  loading,
}: {
  handleSend: (input: string) => void;
  loading: boolean;
}) {
  const [input, setInput] = useState('');

  return (
    <ChatInput
      value={input}
      onChange={setInput}
      onSubmit={(input) => {
        handleSend(input);
        setInput('');
      }}
      loading={loading}
    />
  );
}

function App() {
  const [messages, setMessages] = useState<TMessage[]>([]);
  const [loading, setLoading] = useState(false);

  const currentAnswer = useRef<TMessage | null>(null);

  const handleSend = async (input: string) => {
    const id = 'a' + Date.now().toString();
    const query = {
      role: 'user',
      content: input,
      id: 'q' + Date.now().toString(),
    } as TMessage;

    currentAnswer.current = {
      role: 'assistant',
      content: '',
      msgStatus: 'generating',
      id,
    };

    setMessages((v) => [...v, query, currentAnswer.current as TMessage]);
    setLoading(true);

    const response = await fetch(
      'https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions',
      {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer sk-xxxx`,
        },
        body: JSON.stringify({
          model: 'qwen-plus',
          messages: [...messages, query],
          stream: true,
        }),
      },
    );

    if (response.body) {
      for await (const chunk of Stream(
        {
          readableStream: response.body,
        },
        {
          openaiCompatible: true,
        },
      )) {
        if (chunk.data === '[DONE]') {
          break;
        }
        const data = JSON.parse(chunk.data);
        currentAnswer.current = produce(currentAnswer.current, (draft) => {
          if (data.choices[0]?.finish_reason === 'stop') {
            draft.msgStatus = 'finished';
          }
          draft.content += data.choices[0]?.delta?.content || '';
        });
        setMessages((v) =>
          v.map((item) =>
            item.id === currentAnswer.current?.id
              ? currentAnswer.current
              : item,
          ),
        );
      }
    }
    setLoading(false);
  };

  return (
    <ConfigProvider {...carbonTheme} prefix="spark-chat" prefixCls="spark-chat">
      <div className="h-[80vh] m-[20px] flex flex-col">
        <Bubble.List
          items={messages}
          classNames={{
            wrapper: 'flex-1 h-[0]',
          }}
        />
        <Sender handleSend={handleSend} loading={loading} />
      </div>
    </ConfigProvider>
  );
}

export default App;
```

启用此`dangerouslyApiKey`选项可能会很危险，因为它会在客户端代码中暴露您的秘密 API 凭据。Web 浏览器本质上不如服务器环境安全，任何有权访问浏览器的用户都可能检查、提取和滥用这些凭据。这可能会导致使用您的凭据进行未经授权的访问，并可能危及敏感数据或功能。以上代码主要是示例代码，实际开发中请不要使用。

更正确的做法是调用大模型的代码在后端（含 apiKey 的配置）。



# 在 Vite 中使用

<a href="https://cn.vitejs.dev/" target="_blank" rel="noopener noreferrer">Vite</a> 是业界最优秀的 React 应用开发工具之一，本文会尝试在 Vite 创建的工程中使用 Alibaba Cloud Spark Chat。

## 安装和初始化


## 选择 React 后，工具会自动初始化一个脚手架并安装 React 项目的各种必要依赖。如果在过程中出现网络问题，请尝试配置代理，或使用其他 npm registry。然后我们进入项目安装依赖并启动。

```bash
$ npm create vite spark-chat-demo
```


## 此时使用浏览器访问 [http://localhost:5173/](http://localhost:5173/) ，看到 Vite + React 的界面就算成功了。

```bash
$ cd spark-chat-demo
$ npm install
$ npm run dev
```

<img src="https://gw.alicdn.com/imgextra/i2/O1CN013SGv2B1wOzu6obfxI_!!6000000006299-2-tps-2452-1654.png" style="max-width: 50%;" alt="Vite + React 界面" />

## 引入 @agentscope-ai/chat

这是 vite 生成的默认目录结构。请先移除 `App.css` 和 `index.css`后安装依赖。

<Tree>
  <ul>
    <li>public
      <ul>
        <li>vite.svg</li>
      </ul>
    </li>
    <li>src
      <ul>
        <li>assets
          <ul>
            <li>react.svg</li>
          </ul>
        </li>
        <li>App.css</li>
        <li>App.tsx</li>
        <li>index.css</li>
        <li>main.tsx</li>
        <li>logo.svg</li>
      </ul>
    </li>
    <li>index.html</li>
    <li>package.json</li>
    <li>vite.config.ts</li>
  </ul>
</Tree>


## ### 修改 

```bash
$ cd spark-chat-demo
$ rm src/App.css
$ rm src/index.css
$ npm install antd @agentscope-ai/design @agentscope-ai/chat --save
````src/App.tsx`


## ### 修改 

```tsx
import { ConfigProvider, carbonTheme } from '@agentscope-ai/design';
import { Bubble, ChatInput, type TMessage } from '@agentscope-ai/chat';
import { useState } from 'react';

function App() {
  const [messages, setMessages] = useState<TMessage[]>([]);
  const [input, setInput] = useState('');

  const handleSend = (input: string) => {
    setMessages([
      ...messages,
      {
        role: 'user',
        content: input,
        id: Date.now().toString(),
      },
    ]);
    setInput('');
  };

  return (
    <ConfigProvider {...carbonTheme} prefix="spark-chat" prefixCls="spark-chat">
      <div>
        <Bubble.List items={messages} />
        <ChatInput value={input} onChange={setInput} onSubmit={handleSend} />
      </div>
    </ConfigProvider>
  );
}

export default App;
````src/main.tsx`


## OK，现在你应该能看到页面上渲染了一个最基础的对话 UI 了，接下来就可以继续选用其他组件开发应用了。其他工程化配置你可以参考 <a href="https://cn.vitejs.dev/" target="_blank" rel="noopener noreferrer">Vite</a> 的官方文档。

```tsx
import { StrictMode } from 'react';
import { createRoot } from 'react-dom/client';
import App from './App.tsx';

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <App />
  </StrictMode>,
);
```

<img src="https://gw.alicdn.com/imgextra/i3/O1CN01T2DkJE1KIczqXgh8l_!!6000000001141-2-tps-2452-1654.png" style="max-width: 50%;" alt="基础对话 UI" />

## FAQ


- 为什么看不见对话列表渲染？,
  - `Bubble.List` 和 `ChatInput` 需要指定他们的父元素拥有高度，并且`flex-direction: column`



# AGUI




# 其他

Alibaba Cloud Spark Chat 作为一个 UI 类库不会强要求对话服务的后端一定要完全按照 「兼容 OpenAI 模式」来处理，你可以使用各种常见的应用层协议，比如 HTTP(SSE)、WebSocket 等，来接入 LLM 对话服务。

在这些应用层协议中，我们通常会使用 SSE，因此 Alibaba Cloud Spark Chat 也提供了对应的工具帮助开发者解决通讯问题。

## 流解析工具


```tsx
import { Stream } from '@agentscope-ai/chat';

async function request() {
  const response = await fetch();
  // ...
  // .....

  for await (const chunk of Stream({
    readableStream: response.body,
  })) {
    // 你的协议
    // 在此处更新 UI 数据
    console.log(chunk);
  }
}
```




# Vibe Coding

如何让 Cursor、Claude Code 等工具理解 Spark Chat。我们支持 LLMs.txt 文件，使 Spark Chat 的文档可供大型语言模型使用。

## 目录概览

以下文件可供使用：


- [index.llms.txt](https://g.alicdn.com/code/npm/@ali/agentscope-ai-chat/1.1.9/llms/index.llms.txt)：主要的 LLMs.txt 目录文件
- [all.llms.txt](https://g.alicdn.com/code/npm/@ali/agentscope-ai-chat/1.1.9/llms/all.llms.txt)：Spark Chat 的完整文档

## 使用方法

### Cursor

在 Cursor 中使用 @Docs 功能来将 LLMs.txt 文件包含到你的项目中。[阅读更多](https://docs.cursor.com/en/context/@-symbols/@-docs)



# 百炼

这篇指南将介绍如何在使用 Alibaba Cloud Spark Chat 接入在阿里云百炼上搭建的智能体。

## 前置准备


- 如何获取 baseURL - [https://help.aliyun.com/zh/model-studio/getting-started/what-is-model-studio](https://help.aliyun.com/zh/model-studio/getting-started/what-is-model-studio)
- 如何获取 API Key - [https://help.aliyun.com/zh/model-studio/developer-reference/get-api-key](https://help.aliyun.com/zh/model-studio/developer-reference/get-api-key)
- 已创建智能体应用，并已获取 APP_ID（阿里云百炼应用 ID）：在应用管理页面的应用卡片上获取。,
  - [https://help.aliyun.com/zh/model-studio/single-agent-application](https://help.aliyun.com/zh/model-studio/single-agent-application)
  - [https://bailian.console.aliyun.com/?tab=app#/app-center](https://bailian.console.aliyun.com/?tab=app#/app-center)

## 工作流调用

### 工作流搭建

demo 比较简单，实际可以开启各种 RAG、MCP、循环调用 等相关功能

<img src="https://gw.alicdn.com/imgextra/i1/O1CN01djpE1e280W7hW930J_!!6000000007870-2-tps-2452-1654.png" width="50%" />

### 代码编写

demo 使用了自定义卡片实现了一个表单，用来获取用户输入的参数，并调用工作流进行执行

<img src="https://gw.alicdn.com/imgextra/i1/O1CN01n0tmbe1kYp0hcR83z_!!6000000004696-1-tps-1068-720.gif" width="50%" />


## ## 智能体调用

```tsx
import { ConfigProvider, carbonTheme, Card, Input, Select, Button } from '@agentscope-ai/design';
import { Bubble, ChatInput, Stream, type TMessage, CustomCardsProvider } from '@agentscope-ai/chat';
import { useRef, useState } from 'react';
import { produce } from 'immer';
import './App.css';
import { Flex, Space } from 'antd';
import React from 'react';

const MessagesContext = React.createContext<{
  messages: TMessage[];
  setMessages: React.Dispatch<React.SetStateAction<TMessage[]>>;
  loading?: boolean;
  setLoading: React.Dispatch<React.SetStateAction<boolean>>;
}>({
  messages: [],
  setMessages: () => { },
  setLoading: () => { },
  loading: false,
});

function Sender({
  handleSend,
  loading,
}: {
  handleSend: (input: string) => void;
  loading: boolean;
}) {
  const [input, setInput] = useState('');

  return (
    <ChatInput
      value={input}
      onChange={setInput}
      onSubmit={(input) => {
        handleSend(input);
        setInput('');
      }}
      loading={loading}
    />
  );
}

function TranslateStart() {
  const { setMessages, loading, setLoading } = React.useContext(MessagesContext);
  const [originText, setOriginText] = useState('');
  const [targetLang, setTargetLang] = useState('英语');
  const currentAnswer = useRef<TMessage | null>(null);
  const [disabled, setDisabled] = useState(false);

  return <Card title="Translate Start">
    <Space direction="vertical" size={8}>
      <Flex align='center'>
        <label className='w-[80px] flex-none'>originText</label>
        <Input placeholder="请输入翻译内容" value={originText} onChange={(e) => setOriginText(e.target.value)} />
      </Flex>
      <Flex align='center'>
        <label className='w-[80px] flex-none'>targetLang</label>
        <Select placeholder="请选择目标语言"
          value={targetLang}
          onChange={(value) => setTargetLang(value)}
          options={[
            { label: '英语', value: '英语' },
            { label: '日语', value: '日语' },
            { label: '法语', value: '法语' },
          ]}
        />
      </Flex>

      <Button type="primary"

        disabled={disabled}
        loading={!disabled && loading} onClick={async () => {
          setLoading(true);
          const id = 'a' + Date.now().toString();


          currentAnswer.current = {
            role: 'assistant',
            content: '',
            msgStatus: 'generating',
            id,
          };

          setMessages((v) => [...v, currentAnswer.current as TMessage]);



          const response = await fetch(`https://dashscope.aliyuncs.com/api/v1/apps/YOUR_APP_ID/completion`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer sk-xxxx`,
              'X-DashScope-SSE': 'enable',
            },
            body: JSON.stringify({
              session_id: Date.now().toString(),
              input: {
                prompt: '开始翻译', biz_params: {
                  originText: originText,
                  targetLang: targetLang
                }
              },
              parameters: {
                incremental_output: false
              },
            }),
          });

          if (response.body) {
            for await (const chunk of Stream({
              readableStream: response.body,
            }, {})) {

              const data = JSON.parse(chunk.data);

              currentAnswer.current = produce(currentAnswer.current, (draft) => {
                if (data.output?.finish_reason === 'stop') {
                  draft.msgStatus = 'finished';
                }
                draft.content = data.output?.text || '';
              });
              setMessages((v) => v.map((item) => item.id === currentAnswer.current?.id ? currentAnswer.current : item));

            }
          };

          setLoading(false);
          setDisabled(true);
        }}>翻译</Button>
    </Space>
  </Card>;
}

function App() {
  const [messages, setMessages] = useState<TMessage[]>([]);
  const [loading, setLoading] = useState(false);

  const handleSend = async (input: string) => {
    const query = {
      role: 'user',
      content: input,
      id: 'q' + Date.now().toString(),
    } as TMessage;

    setMessages((v) => [...v, query]);
  };

  return (
    <ConfigProvider {...carbonTheme} prefix="spark-chat" prefixCls="spark-chat">
      <CustomCardsProvider cardConfig={{
        TranslateStart,
      }}>
        <MessagesContext.Provider value={{ messages, setMessages, loading, setLoading }}>
          <div className="h-[100vh] p-[20px] flex flex-col">
            <Bubble.List
              items={messages}
              classNames={{
                wrapper: 'flex-1 h-[0]',
              }}
            />
            <div className='mb-[8px]'>
              <Button onClick={() => {
                setMessages((v) => [...v, {
                  role: 'assistant',
                  cards: [{ code: 'TranslateStart', }],
                  id: 'q' + Date.now().toString(),
                }]);

              }}>翻译模式</Button>
            </div>
            <Sender handleSend={handleSend} loading={loading} />
          </div>
        </MessagesContext.Provider>
      </CustomCardsProvider>
    </ConfigProvider>
  );
}

export default App;
```

### 智能体搭建

demo 比较简单，实际可以开启各种 RAG、MCP 等相关功能

<img src="https://gw.alicdn.com/imgextra/i2/O1CN01oduDVS1cOjMACqWMp_!!6000000003591-2-tps-2452-1654.png" width="50%" />

### 代码编写


## <img src="https://gw.alicdn.com/imgextra/i2/O1CN01tAh5r71D07gMq9kfP_!!6000000000153-2-tps-2452-1654.png" width="50%" />

```tsx
import { ConfigProvider, carbonTheme } from '@agentscope-ai/design';
import { Bubble, ChatInput, Stream, type TMessage } from '@agentscope-ai/chat';
import { useRef, useState } from 'react';
import { produce } from 'immer';
import './App.css';

function Sender({
  handleSend,
  loading,
}: {
  handleSend: (input: string) => void;
  loading: boolean;
}) {
  const [input, setInput] = useState('');

  return (
    <ChatInput
      value={input}
      onChange={setInput}
      onSubmit={(input) => {
        handleSend(input);
        setInput('');
      }}
      loading={loading}
    />
  );
}

function App() {
  const [messages, setMessages] = useState<TMessage[]>([]);
  const [loading, setLoading] = useState(false);
  const sessionIdRef = useRef<string>(Date.now().toString());
  const currentAnswer = useRef<TMessage | null>(null);

  const handleSend = async (input: string) => {
    const query = {
      role: 'user',
      content: input,
      id: 'q' + Date.now().toString(),
    } as TMessage;

    const id = 'a' + Date.now().toString();

    currentAnswer.current = {
      role: 'assistant',
      content: '',
      msgStatus: 'generating',
      id,
    };

    setMessages((v) => [...v, query, currentAnswer.current as TMessage]);
    setLoading(true);

    const response = await fetch(
      `https://dashscope.aliyuncs.com/api/v1/apps/YOUR_APP_ID/completion`,
      {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer sk-xxxx`,
          'X-DashScope-SSE': 'enable',
        },
        body: JSON.stringify({
          session_id: sessionIdRef.current,
          input: {
            prompt: '推荐一下美食',
            biz_params: {
              user_prompt_params: {
                city: input,
              },
            },
          },
          parameters: {
            incremental_output: false,
          },
        }),
      },
    );

    if (response.body) {
      for await (const chunk of Stream(
        {
          readableStream: response.body,
        },
        {},
      )) {
        const data = JSON.parse(chunk.data);
        currentAnswer.current = produce(currentAnswer.current, (draft) => {
          if (data.output?.finish_reason === 'stop') {
            draft.msgStatus = 'finished';
          }
          draft.content = data.output?.text || '';
        });
        setMessages((v) =>
          v.map((item) =>
            item.id === currentAnswer.current?.id
              ? currentAnswer.current
              : item,
          ),
        );
      }
    }

    setLoading(false);
  };

  return (
    <ConfigProvider {...carbonTheme} prefix="spark-chat" prefixCls="spark-chat">
      <div className="h-[100vh] p-[20px] flex flex-col">
        <Bubble.List
          items={messages}
          classNames={{
            wrapper: 'flex-1 h-[0]',
          }}
        />
        <Sender handleSend={handleSend} loading={loading} />
      </div>
    </ConfigProvider>
  );
}

export default App;
```



# CustomCard

在实际的 LLM 对话应用开发中，除了基础的文本类型（Markdown）答案以外，还有很多的交互丰富的答案回复效果，比如：

<div style="display: flex;gap: 32px">
  <div>
    <img src="https://gw.alicdn.com/imgextra/i2/O1CN01ylWEJy1vCnk1z86IB_!!6000000006137-2-tps-3200-1800.png"></img>
    <p style="font-size: 14px;">即便是最自然流畅的对话，也难以消除通过反复询问来收敛用户需求时的无力感与低效感 : (</p>
  </div>
  <div>
    <img src="https://gw.alicdn.com/imgextra/i3/O1CN01e76Zm71WmBwzb5P4B_!!6000000002830-2-tps-3200-1800.png"></img>
    <p style="font-size: 14px;">在对话中的必要时刻提供更强大的交互支持（表单录入、二次确认、功能引导...），发挥 GUI 交互在结构化、效率化信息交换中的优势</p>
  </div>
</div>

我们可以使用 CustomCard 来实现类似需求。



## 如何开发

### 创建一个 CustomCard

CustomCard 只是一个 React Component


## <div height="32px" ></div>

```tsx
import React, { useState } from 'react';
import { Button, Card, Select } from '@agentscope-ai/design';
import { Flex } from 'antd';

function SelectPageCard(props: { data: { pages: string[] } }) {
  const [page, setPage] = useState<string>(props.data.pages[0]);
  return (
    <Card title="Please select a page">
      <Flex gap={8}>
        <Select
          value={page}
          onChange={setPage}
          options={props.data.pages.map((page) => ({
            label: page,
            value: page,
          }))}
        />
        <Button>OK</Button>
      </Flex>
    </Card>
  );
}

export default SelectPageCard;
```


## ### 注册 CustomCard

```tsx
// 还可以实现更多其他卡片
function PagePVChartCard() {...};

export default PagePVChartCard;
```


## ### 构造数据并渲染

```tsx
import { Bubble, CustomCardsProvider } from '@agentscope-ai/chat';
import SelectPageCard from './SelectPageCard';
import PagePVChartCard from './PagePVChartCard';

export default () => (
  <CustomCardsProvider
    cardConfig={{
      SelectPageCard: SelectPageCard,
      PagePVChartCard: PagePVChartCard,
    }}
  ></CustomCardsProvider>
);
```


## tsx
import { Bubble, CustomCardsProvider } from "@agentscope-ai/chat";
import SelectPageCard from "./SelectPageCard";
import PagePVChartCard from "./PagePVChartCard";

```tsx
import { Bubble, CustomCardsProvider } from '@agentscope-ai/chat';
import SelectPageCard from './SelectPageCard';
import PagePVChartCard from './PagePVChartCard';

export default function () {
  return (
    <CustomCardsProvider
      cardConfig={{
        SelectPageCard: SelectPageCard,
        PagePVChartCard: PagePVChartCard,
      }}
    >
      <Bubble.List
        items={[
          {
            id: '0',
            role: 'user',
            content: 'I want to View page PV data',
          },
          {
            id: '1',
            role: 'assistant',
            cards: [
              {
                code: 'SelectPageCard',
                data: {
                  pages: [
                    'https://foo.com/page1',
                    'https://foo.com/page2',
                    'https://foo.com/page3',
                  ],
                },
              },
            ],
          },
          {
            id: '2',
            role: 'assistant',
            cards: [
              {
                code: 'PagePVChartCard',
                data: {
                  page: 'https://foo.com/page1',
                },
              },
            ],
          },
        ]}
      ></Bubble.List>
    </CustomCardsProvider>
  );
}
```




```

export default function () {
  return <CustomCardsProvider cardConfig={{
    SelectPageCard: SelectPageCard,
    PagePVChartCard: PagePVChartCard,
  }}>
    <Bubble.List
      items={[{
        id: '0',
        role: 'user',
        content: 'I want to View page PV data',
      }, {
        id: '1',
        role: 'assistant',
        cards: [{
          code: 'SelectPageCard',
          data: {
            pages: ['https://foo.com/page1', 'https://foo.com/page2', 'https://foo.com/page3'],
          }
        }],
      }, {
        id: '2',
        role: 'assistant',
        cards: [{
          code: 'PagePVChartCard',
          data: {
            page: 'https://foo.com/page1',
          }
        }]
      }]}
    >
    </Bubble.List>
  </CustomCardsProvider>
}
## tsx
import { ChatAnywhere, ChatAnywhereRef, DefaultCards, sleep, TMessage, uuid } from '@agentscope-ai/chat';
import SelectPageCard from "./SelectPageCard";
import PagePVChartCard from "./PagePVChartCard";
import { useCallback, useEffect, useRef } from 'react';
import { useAsyncEffect } from 'ahooks';

```



### 在 ChatAnywhere 中使用 CustomCard



```

export default function () {
  const ref = useRef<ChatAnywhereRef>();

  useAsyncEffect(async () => {
    ref.current.updateMessage({
      id: uuid(),
      role: 'user',
      content: 'I want to View page PV data',
    });

    await sleep(100);

    ref.current.updateMessage({
      id: uuid(),
      role: 'assistant',
      cards: [{
        code: 'SelectPageCard',
        data: {
          pages: ['https://foo.com/page1', 'https://foo.com/page2', 'https://foo.com/page3'],
        }
      }]
    })

  }, []);


  const onSubmit = useCallback(async (data) => {
    ref.current.updateMessage({
      id: uuid(),
      role: 'user',
      content: data.query,
    });
    await sleep(100);

    ref.current.updateMessage({
      id: uuid(),
      role: 'assistant',
      cards: [{
        code: 'PagePVChartCard',
        data: {
          page: data.query,
        }
      }]
    });

  }, []);

  const onStop = useCallback(async () => {

  }, []);

  return <ChatAnywhere
    ref={ref}
    cardConfig={{
      SelectPageCard,
      PagePVChartCard,
    }}
    uiConfig={{}}
    onInput={{
      onSubmit,
    }}
    onStop={onStop}
  >

  </ChatAnywhere>
}
```





# 概述

<b class="montserrat">Alibaba Cloud Spark Chat</b> 是基于 <b class="montserrat" style="margin: 0 -0.5em">Alibaba Cloud Spark Design</b> 的一个免费、开源的 <a href="https://react.dev/" target="_blank" rel="noopener noreferrer">React</a> 对话框架，用于构建优秀的 LLM 对话体验。

## 特性


- 🏆 源自阿里云百炼最佳实践：包含了众多我们的想法与真实业务实践，帮助业务快速构建优秀的 LLM 对话体验。
- 🤖 开箱即用的模型对接能力：轻松对接符合 OpenAI 标准的模型推理服务。
- 🧩 极致的拓展能力：通过卡片形式（自定义组件）展示模型输出，支持多种格式的输出展示。
- 📝 TypeScript 全覆盖：采用 TypeScript 开发，提供完整类型支持，提升开发体验与可靠性。
- 🎨 CSS-in-JS 实践：采用更现代的 CSS-in-JS 样式方案，样式自动按需加载，不强依赖开发者工程化环境配置。



## 快速体验

```tsx
import React from 'react';
import { DemoContextProvider } from './DemoContext';
import Chat from './Chat';
import { ConfigProvider, carbonTheme } from '@agentscope-ai/design';


export default function () {
  return <div style={{ height: '100vh' }} >
    <ConfigProvider {...carbonTheme}
      prefix='sps'
      prefixCls="sps">
      <DemoContextProvider>
        <Chat />
      </DemoContextProvider>
    </ConfigProvider>
  </div>
}


```

## 兼容环境


- 现代浏览器
- <a href="https://www.electronjs.org/" target="_blank" rel="noopener noreferrer">Electron</a>
- <a href="https://v2.tauri.app/" target="_blank" rel="noopener noreferrer">tauri</a>

| Edge | Firefox | Chrome | Safari | Opera | Electron | 
|--------|--------|--------|--------|--------|--------|
| last 2 versions | last 2 versions | last 2 versions | last 2 versions | last 2 versions | last 2 versions | 


## 安装

### 使用 npm 进行安装

yarn, pnpm, bun 安装的方式不再赘述， 如果你的网络环境不佳，推荐使用 <a href="https://github.com/cnpm/cnpm" target="_blank" rel="noopener noreferrer">cnpm</a>。


## 注意：如果你是阿里内网开发者，请使用 

```bash
$ npm install antd --save
$ npm install @agentscope-ai/design --save
$ npm install @agentscope-ai/chat --save
````tnpm install @ali/agentscope-ai-chat @ali/agentscope-ai-design --save`

## 按需加载

`@agentscope-ai/chat` 默认支持基于 ES modules 的 tree shaking。

## TypeScript

`@agentscope-ai/chat` 使用 TypeScript 进行书写并提供了完整的定义文件。

## 开源

`@agentscope-ai/design` 和 `@agentscope-ai/chat` 仍在加速推进开源中，我们预计在 2025 年年底完成开源。目前可以通过 npm 使用我们的项目。



# ChatAnywhere

ChatAnywhere 是使用 Alibaba Cloud Spark Chat 基础组件整合一起的开箱即用的对话容器，使用 ChatAnywhere 可以不再关心对话消息的状态管理（比如 `setMessages(...)`），同时可以更加快速地构建优秀的 LLM 对话体验。

<div style="display: flex;gap: 16px">
  <div>
    <img src="https://gw.alicdn.com/imgextra/i1/O1CN01hDxvBo1SFRABmCu2q_!!6000000002217-2-tps-2880-1800.png"></img>
  </div>
  <div>
    <img src="https://gw.alicdn.com/imgextra/i1/O1CN011m5rNF1zGhZtJ8NKb_!!6000000006687-2-tps-2880-1800.png"></img>
  </div>
  <div>
    <img src="https://gw.alicdn.com/imgextra/i2/O1CN014r9Tm11JGVY1KeN0H_!!6000000001001-2-tps-2880-1800.png"></img>
  </div>
</div>

## 试一下



## ## 快速开始

```tsx
import React from 'react';
import { DemoContextProvider } from './DemoContext';
import Chat from './Chat';
import { ConfigProvider, carbonTheme } from '@agentscope-ai/design';


export default function () {
  return <div style={{ height: '100vh' }} >
    <ConfigProvider {...carbonTheme}
      prefix='sps'
      prefixCls="sps">
      <DemoContextProvider>
        <Chat />
      </DemoContextProvider>
    </ConfigProvider>
  </div>
}


```

在`ChatAnywhere`里，我们可以不在使用 React 状态管理去更新对话流，而是使用 「**核心 API `updateMessage(...)`」** 即可实时更新上屏消息。


## ## API & Types

```tsx
import {
  ChatAnywhere,
  ChatAnywhereRef,
  DefaultCards,
  sleep,
  TMessage,
  uuid,
} from '@agentscope-ai/chat';
import { useCallback, useEffect, useRef } from 'react';
import { useAsyncEffect } from 'ahooks';

export default function () {
  const ref = useRef<ChatAnywhereRef>();

  const onSubmit = useCallback(async (data) => {
    ref.current.updateMessage({
      id: uuid(),
      role: 'user',
      content: data.query,
    });
    await sleep(100);

    const answer = {
      id: uuid(), // 后续使用这个 id 来更新消息
      role: 'assistant',
      content: 'assistant content',
    };

    ref.current.updateMessage(answer);

    // 1. 发送 query
    // 2. 根据实际的后端要求通过 SSE 等协议持续获取数据，循环调用 updateMessage
    // const response = await fetch();

    // for await (const chunk of Stream({
    //   readableStream: response.body,
    // })) {
    //   ref.current.updateMessage(answer);
    // }
  }, []);

  const onStop = useCallback(async () => {}, []);

  useAsyncEffect(async () => {
    // 适合调用后端接口查询历史消息后设置历史消息
    ref.current.updateMessage({
      id: uuid(),
      role: 'user',
      content: 'I want to View page PV data',
    });
  }, []);

  return (
    <ChatAnywhere
      ref={ref}
      uiConfig={{}}
      onInput={{
        onSubmit,
      }}
      onStop={onStop}
    ></ChatAnywhere>
  );
}
```

### TSession

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| key | 会话的唯一标识符，用于区分不同的聊天会话 | string | (必填) | 
| messages | 会话中的消息列表，按组进行组织 | TMessage[][] | (必填) | 
| label | 会话的显示名称 | string | (必填) | 


### TMessage

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| id | 消息的唯一标识符 | string | (必填) | 
| content | 消息的文本内容 | string |  | 
| cards | 消息中的卡片组件配置 | TMessageCard[] |  | 
| role | 消息的角色类型，区分用户、助手和系统消息 | 'user' \| 'assistant' \| 'system' | (必填) | 
| msgStatus | 消息的处理状态，影响显示效果 | 'finished' \| 'interrupted' \| 'generating' \| 'error' |  | 


### TMessageCard

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| id | 卡片的唯一标识符 | string |  | 
| code | 卡片的类型代码 | string | (必填) | 
| component | 卡片的渲染组件 | React.FC |  | 
| data | 卡片的数据内容 | string \| any |  | 


### ChatAnywhere Props

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| cardConfig | 卡片组件的配置映射，用于自定义不同类型卡片的渲染 | {
    [key: string]: React.FC<any>;
  } |  | 
| uiConfig | UI界面的配置选项，用于自定义外观和布局 | IChatAnywhereConfigUIConfig |  | 
| onInput | 输入功能的配置选项 | IChatAnywhereConfigOnInput | (必填) | 
| onStop | 停止生成的回调函数 | void |  | 
| onRegenerate | 重新生成消息的回调函数 | void |  | 
| onSessionKeyChange | 会话切换时的回调函数 | void |  | 
| onUpload | 文件上传功能的配置选项 | IChatAnywhereConfigOnUpload[] |  | 


### IChatAnywhereConfigUIConfig

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| narrowScreen | 是否启用窄屏模式，影响响应式布局 | boolean |  | 
| background | 背景样式配置 | string |  | 
| header | 自定义头部组件 | React.ReactElement |  | 
| quickInput | 快速输入组件，用于提供预设的输入选项 | React.ReactElement \| React.ReactElement[] |  | 
| logo | 应用logo组件 | React.ReactElement |  | 
| welcome | 欢迎页面组件 | React.ReactElement |  | 
| disclaimer | 免责声明组件或文本 | React.ReactElement \| string |  | 


### IChatAnywhereConfigOnInput

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| beforeUI | 输入框前的UI组件 | React.ReactElement |  | 
| afterUI | 输入框后的UI组件 | React.ReactElement |  | 
| morePrefixActions | 更多前缀操作组件 | React.ReactElement \| React.ReactElement[] |  | 
| hide | 是否隐藏输入框 | boolean |  | 
| header | 输入框头部组件 | React.ReactElement \| React.ReactElement[] |  | 
| onSubmit | 提交消息时的回调函数 | void | (必填) | 
| maxLength | 输入内容的最大长度限制 | number |  | 
| beforeSubmit | 提交前的验证函数 | () => Promise<Boolean> |  | 
| zoomable | 是否支持缩放功能 | boolean |  | 
| placeholder | 输入框的占位符文本 | string |  | 
| disabled | 输入框是否禁用 | boolean |  | 


### IChatAnywhereConfigOnUpload

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| renderType | 上传组件的渲染类型，影响上传附件样式 | 'simple' \| 'default' |  | 
| maxCount | 最大上传文件数量 | GetProp<typeof Upload, 'maxCount'> |  | 
| beforeUpload | 上传前的处理函数 | GetProp<typeof Upload, 'beforeUpload'> |  | 
| customRequest | 自定义上传请求函数 | GetProp<typeof Upload, 'customRequest'> | (必填) | 
| multiple | 是否支持多文件上传 | boolean |  | 
| accept | 接受的文件类型 | string |  | 
| icon | 上传按钮的图标 | string \| React.ReactElement |  | 
| disabled | 是否禁用上传组件 | boolean |  | 


### ChatAnywhereRef

| 属性名 | 描述 | 类型 | 默认值 | 
|--------|--------|--------|--------|
| setInputContent | 设置输入框内容的方法 | (content: string) => void | (必填) | 
| scrollToBottom | 滚动到底部的方法 | (options?: ScrollToBottomOptions) => void | (必填) | 
| reload | 重新加载的方法 | () => void | (必填) | 
| messages | 当前会话的消息列表 | TMessage[] | (必填) | 
| updateMessage | 更新消息的方法 | (message: Partial<TMessage> & { id: string }) => void | (必填) | 
| getMessages | 获取当前消息列表的同步函数 | () => TMessage[] | (必填) | 
| removeMessage | 删除消息的方法 | (message: Partial<TMessage>) => void | (必填) | 
| removeAllMessages | 删除所有消息的方法 | () => void | (必填) | 
| loading | 是否正在加载状态，影响UI的交互性 | boolean | (必填) | 
| setLoading | 设置加载状态的状态更新函数 | React.Dispatch<React.SetStateAction<boolean>> | (必填) | 
| getLoading | 获取当前加载状态的同步函数 | () => boolean | (必填) | 
| disabled | 是否禁用组件，影响所有交互功能 | boolean | (必填) | 
| setDisabled | 设置禁用状态的状态更新函数 | React.Dispatch<React.SetStateAction<boolean>> | (必填) | 
| getDisabled | 获取当前禁用状态的同步函数 | () => boolean | (必填) | 




## tsx
import { createStyles } from "antd-style";
import Background from "./Background";
import Chat from "./Chat";
import { ConfigProvider, carbonDarkTheme } from '@agentscope-ai/design';

```tsx
import React from 'react';
import { DemoContextProvider } from './DemoContext';
import Chat from './Chat';
import { ConfigProvider, carbonTheme } from '@agentscope-ai/design';


export default function () {
  return <div style={{ height: '100vh' }} >
    <ConfigProvider {...carbonTheme}
      prefix='sps'
      prefixCls="sps">
      <DemoContextProvider>
        <Chat />
      </DemoContextProvider>
    </ConfigProvider>
  </div>
}


```




```

carbonDarkTheme.theme.token.borderRadius = 20;
carbonDarkTheme.theme.token.borderRadiusLG = 20;
carbonDarkTheme.theme.token.borderRadiusSM = 20;

export default function LiquidGlass() {
  const { styles } = useStyles();
  return <ConfigProvider
    {...carbonDarkTheme}
  >
    <div className={styles.container}>
      <Background>
        <Chat />
      </Background>
    </div>
  </ConfigProvider>;
}


const useStyles = createStyles(({ token }) => {
  return {
    container: {
      width: '100vw',
      height: '100vh',
    },
  };
});
## tsx
import Chat from './components/Chat';
import ConfigProvider from './context/ConfigProvider';
import DemoProvider from './context/DemoProvider';
import Style from './style';

```




```

export default function () {

  return <ConfigProvider>
    <Style />
    <DemoProvider>
      <Chat />
    </DemoProvider>
  </ConfigProvider>
}
## tsx
import Chat from './components/Chat';
import ConfigProvider from './context/ConfigProvider';
import DemoProvider from './context/DemoProvider';
import Style from './style';

```




```

export default function () {

  return <ConfigProvider>
    <Style />
    <DemoProvider>
      <Chat />
    </DemoProvider>
  </ConfigProvider>
}
## tsx
import React from 'react';
import { TasksList } from './TasksList';
import { TasksProvider } from './hook';
import { CopilotKit } from "@agentscope-ai/chat";
import { createStyles } from 'antd-style';
import Chat from './Chat';
import { ConfigProvider, carbonTheme } from '@ali/agentscope-ai-design';

```




```

const useStyles = createStyles(({ css, token }) => ({
  container: css`
    display: flex;
    height: 100%;
  `,

  left: css`
    flex: 1;
  `,
  right: css`
    padding: 16px;
    flex: 1;
    display: flex;
    flex-direction: column;
    border-left: 1px solid ${token.colorBorderSecondary};
  `
}));


export default function () {
  const { styles } = useStyles();

  return <ConfigProvider {...carbonTheme} style={{ height: '100%' }}>
    <CopilotKit runtimeUrl="https://func-jfa-zedphfubal.cn-hangzhou.fcapp.run/ag-ui">
      <div className={styles.container}>
        <div className={styles.left}>
          <TasksProvider>
            <TasksList />
          </TasksProvider>
        </div>
        <div className={styles.right}>
          <Chat />
        </div>
      </div>
    </CopilotKit>
  </ConfigProvider>
}
```

