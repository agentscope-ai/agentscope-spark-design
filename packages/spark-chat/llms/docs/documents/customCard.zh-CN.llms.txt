

# CustomCard

在实际的 LLM 对话应用开发中，除了基础的文本类型（Markdown）答案以外，还有很多的交互丰富的答案回复效果，比如：

<div style="display: flex;gap: 32px">
  <div>
    <img src="https://gw.alicdn.com/imgextra/i2/O1CN01ylWEJy1vCnk1z86IB_!!6000000006137-2-tps-3200-1800.png"></img>
    <p style="font-size: 14px;">即便是最自然流畅的对话，也难以消除通过反复询问来收敛用户需求时的无力感与低效感 : (</p>
  </div>
  <div>
    <img src="https://gw.alicdn.com/imgextra/i3/O1CN01e76Zm71WmBwzb5P4B_!!6000000002830-2-tps-3200-1800.png"></img>
    <p style="font-size: 14px;">在对话中的必要时刻提供更强大的交互支持（表单录入、二次确认、功能引导...），发挥 GUI 交互在结构化、效率化信息交换中的优势</p>
  </div>
</div>

我们可以使用 CustomCard 来实现类似需求。



## 如何开发

### 创建一个 CustomCard

CustomCard 只是一个 React Component


## <div height="32px" ></div>

```tsx
import React, { useState } from 'react';
import { Button, Card, Select } from '@agentscope-ai/design';
import { Flex } from 'antd';

function SelectPageCard(props: { data: { pages: string[] } }) {
  const [page, setPage] = useState<string>(props.data.pages[0]);
  return (
    <Card title="Please select a page">
      <Flex gap={8}>
        <Select
          value={page}
          onChange={setPage}
          options={props.data.pages.map((page) => ({
            label: page,
            value: page,
          }))}
        />
        <Button>OK</Button>
      </Flex>
    </Card>
  );
}

export default SelectPageCard;
```


## ### 注册 CustomCard

```tsx
// 还可以实现更多其他卡片
function PagePVChartCard() {...};

export default PagePVChartCard;
```


## ### 构造数据并渲染

```tsx
import { Bubble, CustomCardsProvider } from '@agentscope-ai/chat';
import SelectPageCard from './SelectPageCard';
import PagePVChartCard from './PagePVChartCard';

export default () => (
  <CustomCardsProvider
    cardConfig={{
      SelectPageCard: SelectPageCard,
      PagePVChartCard: PagePVChartCard,
    }}
  ></CustomCardsProvider>
);
```


## tsx
import { Bubble, CustomCardsProvider } from "@agentscope-ai/chat";
import SelectPageCard from "./SelectPageCard";
import PagePVChartCard from "./PagePVChartCard";

```tsx
import { Bubble, CustomCardsProvider } from '@agentscope-ai/chat';
import SelectPageCard from './SelectPageCard';
import PagePVChartCard from './PagePVChartCard';

export default function () {
  return (
    <CustomCardsProvider
      cardConfig={{
        SelectPageCard: SelectPageCard,
        PagePVChartCard: PagePVChartCard,
      }}
    >
      <Bubble.List
        items={[
          {
            id: '0',
            role: 'user',
            content: 'I want to View page PV data',
          },
          {
            id: '1',
            role: 'assistant',
            cards: [
              {
                code: 'SelectPageCard',
                data: {
                  pages: [
                    'https://foo.com/page1',
                    'https://foo.com/page2',
                    'https://foo.com/page3',
                  ],
                },
              },
            ],
          },
          {
            id: '2',
            role: 'assistant',
            cards: [
              {
                code: 'PagePVChartCard',
                data: {
                  page: 'https://foo.com/page1',
                },
              },
            ],
          },
        ]}
      ></Bubble.List>
    </CustomCardsProvider>
  );
}
```




```

export default function () {
  return <CustomCardsProvider cardConfig={{
    SelectPageCard: SelectPageCard,
    PagePVChartCard: PagePVChartCard,
  }}>
    <Bubble.List
      items={[{
        id: '0',
        role: 'user',
        content: 'I want to View page PV data',
      }, {
        id: '1',
        role: 'assistant',
        cards: [{
          code: 'SelectPageCard',
          data: {
            pages: ['https://foo.com/page1', 'https://foo.com/page2', 'https://foo.com/page3'],
          }
        }],
      }, {
        id: '2',
        role: 'assistant',
        cards: [{
          code: 'PagePVChartCard',
          data: {
            page: 'https://foo.com/page1',
          }
        }]
      }]}
    >
    </Bubble.List>
  </CustomCardsProvider>
}
## tsx
import { ChatAnywhere, ChatAnywhereRef, DefaultCards, sleep, TMessage, uuid } from '@agentscope-ai/chat';
import SelectPageCard from "./SelectPageCard";
import PagePVChartCard from "./PagePVChartCard";
import { useCallback, useEffect, useRef } from 'react';
import { useAsyncEffect } from 'ahooks';

```



### 在 ChatAnywhere 中使用 CustomCard



```

export default function () {
  const ref = useRef<ChatAnywhereRef>();

  useAsyncEffect(async () => {
    ref.current.updateMessage({
      id: uuid(),
      role: 'user',
      content: 'I want to View page PV data',
    });

    await sleep(100);

    ref.current.updateMessage({
      id: uuid(),
      role: 'assistant',
      cards: [{
        code: 'SelectPageCard',
        data: {
          pages: ['https://foo.com/page1', 'https://foo.com/page2', 'https://foo.com/page3'],
        }
      }]
    })

  }, []);


  const onSubmit = useCallback(async (data) => {
    ref.current.updateMessage({
      id: uuid(),
      role: 'user',
      content: data.query,
    });
    await sleep(100);

    ref.current.updateMessage({
      id: uuid(),
      role: 'assistant',
      cards: [{
        code: 'PagePVChartCard',
        data: {
          page: data.query,
        }
      }]
    });

  }, []);

  const onStop = useCallback(async () => {

  }, []);

  return <ChatAnywhere
    ref={ref}
    cardConfig={{
      SelectPageCard,
      PagePVChartCard,
    }}
    uiConfig={{}}
    onInput={{
      onSubmit,
    }}
    onStop={onStop}
  >

  </ChatAnywhere>
}
```

