!(function(){var HF=Object.defineProperty,$F=Object.defineProperties;var UF=Object.getOwnPropertyDescriptors;var Ef=Object.getOwnPropertySymbols;var nw=Object.prototype.hasOwnProperty,rw=Object.prototype.propertyIsEnumerable;var xc=Math.pow,dp=(ee,Ot,Y)=>Ot in ee?HF(ee,Ot,{enumerable:!0,configurable:!0,writable:!0,value:Y}):ee[Ot]=Y,$e=(ee,Ot)=>{for(var Y in Ot||(Ot={}))nw.call(Ot,Y)&&dp(ee,Y,Ot[Y]);if(Ef)for(var Y of Ef(Ot))rw.call(Ot,Y)&&dp(ee,Y,Ot[Y]);return ee},hr=(ee,Ot)=>$F(ee,UF(Ot));var rn=(ee,Ot)=>{var Y={};for(var Q in ee)nw.call(ee,Q)&&Ot.indexOf(Q)<0&&(Y[Q]=ee[Q]);if(ee!=null&&Ef)for(var Q of Ef(ee))Ot.indexOf(Q)<0&&rw.call(ee,Q)&&(Y[Q]=ee[Q]);return Y};var Ec=(ee,Ot,Y)=>dp(ee,typeof Ot!="symbol"?Ot+"":Ot,Y);var iw=(ee,Ot,Y)=>new Promise((Q,wt)=>{var yt=$=>{try{dt(Y.next($))}catch(I){wt(I)}},xt=$=>{try{dt(Y.throw($))}catch(I){wt(I)}},dt=$=>$.done?Q($.value):Promise.resolve($.value).then(yt,xt);dt((Y=Y.apply(ee,Ot)).next())});(self.webpackChunk_agentscope_ai_chat=self.webpackChunk_agentscope_ai_chat||[]).push([[7151],{70833:function(ee,Ot,Y){"use strict";Y.r(Ot),Y.d(Ot,{CollapseExpandIcon:function(){return xt},Dendrogram:function(){return cF},Fishbone:function(){return vF},FlowDirectionGraph:function(){return mF},FlowGraph:function(){return wF},G6:function(){return yt},IndentedTree:function(){return kF},MindMap:function(){return NF},NetworkGraph:function(){return LF},OrganizationChart:function(){return FF},RCNode:function(){return dt},getNodeSide:function(){return Oi},measureTextSize:function(){return ii},mergeOptions:function(){return ri}});var Q={};Y.r(Q),Y.d(Q,{add:function(){return Nw},adjoint:function(){return bw},clone:function(){return xp},copy:function(){return Ts},create:function(){return Ce},decompose:function(){return Sw},determinant:function(){return Sp},equals:function(){return Dw},exactEquals:function(){return Tf},frob:function(){return Aw},fromQuat:function(){return Mf},fromQuat2:function(){return ww},fromRotation:function(){return Op},fromRotationTranslation:function(){return Pp},fromRotationTranslationScale:function(){return Mw},fromRotationTranslationScaleOrigin:function(){return So},fromScaling:function(){return Na},fromTranslation:function(){return ta},fromValues:function(){return Ep},fromXRotation:function(){return kp},fromYRotation:function(){return _p},fromZRotation:function(){return Sf},frustum:function(){return Tw},getRotation:function(){return Oc},getScaling:function(){return Os},getTranslation:function(){return Cc},identity:function(){return Ji},invert:function(){return ci},lookAt:function(){return Dp},mul:function(){return Bp},multiply:function(){return An},multiplyScalar:function(){return Rw},multiplyScalarAndAdd:function(){return Lw},ortho:function(){return Rp},orthoNO:function(){return Np},orthoZO:function(){return Lp},perspective:function(){return Cw},perspectiveFromFieldOfView:function(){return kw},perspectiveNO:function(){return Ap},perspectiveZO:function(){return Ow},rotate:function(){return xw},rotateX:function(){return Tp},rotateY:function(){return Cp},rotateZ:function(){return Ew},scale:function(){return Mp},set:function(){return wf},str:function(){return Pw},sub:function(){return Iw},subtract:function(){return Ip},targetTo:function(){return _w},translate:function(){return Cs},transpose:function(){return wp}});var wt={};Y.r(wt),Y.d(wt,{circle:function(){return k3},diamond:function(){return _3},rect:function(){return A3},simple:function(){return R3},triangle:function(){return X1},triangleRect:function(){return N3},vee:function(){return P3}});var yt={};Y.r(yt),Y.d(yt,{AntVDagreLayout:function(){return vb.b},AutoAdaptLabel:function(){return Ko},Background:function(){return Al},Badge:function(){return rs},BaseBehavior:function(){return sr},BaseCombo:function(){return as},BaseEdge:function(){return Zi},BaseLayout:function(){return Sl},BaseNode:function(){return Lr},BasePlugin:function(){return ln},BaseShape:function(){return Gs},BaseTransform:function(){return cr},BrushSelect:function(){return Zs},BubbleSets:function(){return Ll},CameraSetting:function(){return KN},Canvas:function(){return T0},CanvasEvent:function(){return yi},Circle:function(){return pa},CircleCombo:function(){return F1},CircularLayout:function(){return pb.S},ClickSelect:function(){return tl},CollapseExpand:function(){return bl},ComboCombinedLayout:function(){return gb.u},ComboEvent:function(){return oa},CommonEvent:function(){return tt},CompactBoxLayout:function(){return ba.compactBox},ConcentricLayout:function(){return yb.W},ContainerEvent:function(){return qa},Contextmenu:function(){return Dl},CreateEdge:function(){return xl},Cubic:function(){return ya},CubicHorizontal:function(){return hl},CubicRadial:function(){return fl},CubicVertical:function(){return dl},D3ForceLayout:function(){return mb.j},DagreLayout:function(){return bb.V},DendrogramLayout:function(){return ba.dendrogram},Diamond:function(){return E1},Donut:function(){return il},DragCanvas:function(){return wl},DragElement:function(){return Hs},DragElementForce:function(){return cb},EdgeBundling:function(){return Il},EdgeEvent:function(){return Ho},EdgeFilterLens:function(){return Bl},Ellipse:function(){return al},ExtensionCategory:function(){return Fs},FishboneLayout:function(){return _l},Fisheye:function(){return Fl},FixElementSize:function(){return Ml},FocusElement:function(){return Tl},ForceAtlas2Layout:function(){return xb.E},ForceLayout:function(){return Eb.y},FruchtermanLayout:function(){return wb.O},Fullscreen:function(){return zl},Graph:function(){return cc},GraphEvent:function(){return lt},GridLayout:function(){return Sb.M},GridLine:function(){return Zl},HTML:function(){return js},Hexagon:function(){return w1},History:function(){return Gl},HistoryEvent:function(){return Di},HoverActivate:function(){return os},Hull:function(){return jl},Icon:function(){return nv},Image:function(){return ll},IndentedLayout:function(){return ba.indented},Label:function(){return Kr},LassoSelect:function(){return hb},Legend:function(){return Hl},Line:function(){return vl},MDSLayout:function(){return Mb.A},MapNodeSize:function(){return uc},MindmapLayout:function(){return ba.mindmap},Minimap:function(){return $l},NodeEvent:function(){return pr},OptimizeViewportTransform:function(){return Cl},PlaceRadialLabels:function(){return hc},Polyline:function(){return Vs},ProcessParallelEdges:function(){return fc},Quadratic:function(){return pl},RadialLayout:function(){return Tb.D},RandomLayout:function(){return Cb._},Rect:function(){return D1},RectCombo:function(){return z1},ScrollCanvas:function(){return Ol},Shortcut:function(){return ts},SnakeLayout:function(){return Pl},Snapline:function(){return Ul},Star:function(){return I1},Timebar:function(){return nc},Title:function(){return fE},Toolbar:function(){return rc},Tooltip:function(){return ic},Triangle:function(){return cl},Watermark:function(){return ac},ZoomCanvas:function(){return kl},effect:function(){return q6},getExtension:function(){return mi},getExtensions:function(){return _k},iconfont:function(){return G5},idOf:function(){return V},invokeLayoutMethod:function(){return ch},isCollapsed:function(){return Vn},omitStyleProps:function(){return qd},parseSize:function(){return Hn},positionOf:function(){return Fe},register:function(){return M0},setVisibility:function(){return fa},subStyleProps:function(){return We},treeToGraphData:function(){return VE},version:function(){return em}});var xt={};Y.r(xt),Y.d(xt,{ArrowCountIcon:function(){return mB},PlusMinusIcon:function(){return xB}});var dt={};Y.r(dt),Y.d(dt,{OrganizationChartNode:function(){return wB},TextNode:function(){return GB}});var $=Y(1413),I=Y(15671),D=Y(43144),B=Y(74902),G=Y(53640),F=Y(60136),W=Y(97685),ut=Y(26729),q=ut,it=1e-6,ot=typeof Float32Array!="undefined"?Float32Array:Array,gt=Math.random,Rt="zyx";function Vt(a){return a>=0?Math.round(a):a%.5===0?Math.floor(a):Math.round(a)}function ue(a){ot=a}var Lt=Math.PI/180,Bt=180/Math.PI;function ne(a){return a*Lt}function Mt(a){return a*Bt}function H(a,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:it;return Math.abs(a-n)<=r*Math.max(1,Math.abs(a),Math.abs(n))}function j(){var a=new ot(3);return ot!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function et(a){var n=new ot(3);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n}function ft(a){var n=a[0],r=a[1],s=a[2];return Math.sqrt(n*n+r*r+s*s)}function vt(a,n,r){var s=new ot(3);return s[0]=a,s[1]=n,s[2]=r,s}function Et(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a}function Dt(a,n,r,s){return a[0]=n,a[1]=r,a[2]=s,a}function Jt(a,n,r){return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a[2]=n[2]+r[2],a}function Ht(a,n,r){return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],a}function xe(a,n,r){return a[0]=n[0]*r[0],a[1]=n[1]*r[1],a[2]=n[2]*r[2],a}function si(a,n,r){return a[0]=n[0]/r[0],a[1]=n[1]/r[1],a[2]=n[2]/r[2],a}function go(a,n){return a[0]=Math.ceil(n[0]),a[1]=Math.ceil(n[1]),a[2]=Math.ceil(n[2]),a}function wc(a,n){return a[0]=Math.floor(n[0]),a[1]=Math.floor(n[1]),a[2]=Math.floor(n[2]),a}function Ai(a,n,r){return a[0]=Math.min(n[0],r[0]),a[1]=Math.min(n[1],r[1]),a[2]=Math.min(n[2],r[2]),a}function Pn(a,n,r){return a[0]=Math.max(n[0],r[0]),a[1]=Math.max(n[1],r[1]),a[2]=Math.max(n[2],r[2]),a}function Tr(a,n){return a[0]=glMatrix.round(n[0]),a[1]=glMatrix.round(n[1]),a[2]=glMatrix.round(n[2]),a}function Zr(a,n,r){return a[0]=n[0]*r,a[1]=n[1]*r,a[2]=n[2]*r,a}function oi(a,n,r,s){return a[0]=n[0]+r[0]*s,a[1]=n[1]+r[1]*s,a[2]=n[2]+r[2]*s,a}function Ni(a,n){var r=n[0]-a[0],s=n[1]-a[1],l=n[2]-a[2];return Math.sqrt(r*r+s*s+l*l)}function Ki(a,n){var r=n[0]-a[0],s=n[1]-a[1],l=n[2]-a[2];return r*r+s*s+l*l}function Qi(a){var n=a[0],r=a[1],s=a[2];return n*n+r*r+s*s}function aw(a,n){return a[0]=-n[0],a[1]=-n[1],a[2]=-n[2],a}function sw(a,n){return a[0]=1/n[0],a[1]=1/n[1],a[2]=1/n[2],a}function Cr(a,n){var r=n[0],s=n[1],l=n[2],u=r*r+s*s+l*l;return u>0&&(u=1/Math.sqrt(u)),a[0]=n[0]*u,a[1]=n[1]*u,a[2]=n[2]*u,a}function Qn(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]}function Ms(a,n,r){var s=n[0],l=n[1],u=n[2],h=r[0],f=r[1],d=r[2];return a[0]=l*d-u*f,a[1]=u*h-s*d,a[2]=s*f-l*h,a}function yo(a,n,r,s){var l=n[0],u=n[1],h=n[2];return a[0]=l+s*(r[0]-l),a[1]=u+s*(r[1]-u),a[2]=h+s*(r[2]-h),a}function vp(a,n,r,s){var l=Math.acos(Math.min(Math.max(Qn(n,r),-1),1)),u=Math.sin(l),h=Math.sin((1-s)*l)/u,f=Math.sin(s*l)/u;return a[0]=h*n[0]+f*r[0],a[1]=h*n[1]+f*r[1],a[2]=h*n[2]+f*r[2],a}function Sc(a,n,r,s,l,u){var h=u*u,f=h*(2*u-3)+1,d=h*(u-2)+u,v=h*(u-1),p=h*(3-2*u);return a[0]=n[0]*f+r[0]*d+s[0]*v+l[0]*p,a[1]=n[1]*f+r[1]*d+s[1]*v+l[1]*p,a[2]=n[2]*f+r[2]*d+s[2]*v+l[2]*p,a}function mo(a,n,r,s,l,u){var h=1-u,f=h*h,d=u*u,v=f*h,p=3*u*f,g=3*d*h,y=d*u;return a[0]=n[0]*v+r[0]*p+s[0]*g+l[0]*y,a[1]=n[1]*v+r[1]*p+s[1]*g+l[1]*y,a[2]=n[2]*v+r[2]*p+s[2]*g+l[2]*y,a}function bo(a,n){n=n===void 0?1:n;var r=glMatrix.RANDOM()*2*Math.PI,s=glMatrix.RANDOM()*2-1,l=Math.sqrt(1-s*s)*n;return a[0]=Math.cos(r)*l,a[1]=Math.sin(r)*l,a[2]=s*n,a}function dn(a,n,r){var s=n[0],l=n[1],u=n[2],h=r[3]*s+r[7]*l+r[11]*u+r[15];return h=h||1,a[0]=(r[0]*s+r[4]*l+r[8]*u+r[12])/h,a[1]=(r[1]*s+r[5]*l+r[9]*u+r[13])/h,a[2]=(r[2]*s+r[6]*l+r[10]*u+r[14])/h,a}function Mc(a,n,r){var s=n[0],l=n[1],u=n[2];return a[0]=s*r[0]+l*r[3]+u*r[6],a[1]=s*r[1]+l*r[4]+u*r[7],a[2]=s*r[2]+l*r[5]+u*r[8],a}function Tc(a,n,r){var s=r[0],l=r[1],u=r[2],h=r[3],f=n[0],d=n[1],v=n[2],p=l*v-u*d,g=u*f-s*v,y=s*d-l*f;return p=p+p,g=g+g,y=y+y,a[0]=f+h*p+l*y-u*g,a[1]=d+h*g+u*p-s*y,a[2]=v+h*y+s*g-l*p,a}function xo(a,n,r,s){var l=[],u=[];return l[0]=n[0]-r[0],l[1]=n[1]-r[1],l[2]=n[2]-r[2],u[0]=l[0],u[1]=l[1]*Math.cos(s)-l[2]*Math.sin(s),u[2]=l[1]*Math.sin(s)+l[2]*Math.cos(s),a[0]=u[0]+r[0],a[1]=u[1]+r[1],a[2]=u[2]+r[2],a}function pp(a,n,r,s){var l=[],u=[];return l[0]=n[0]-r[0],l[1]=n[1]-r[1],l[2]=n[2]-r[2],u[0]=l[2]*Math.sin(s)+l[0]*Math.cos(s),u[1]=l[1],u[2]=l[2]*Math.cos(s)-l[0]*Math.sin(s),a[0]=u[0]+r[0],a[1]=u[1]+r[1],a[2]=u[2]+r[2],a}function gp(a,n,r,s){var l=[],u=[];return l[0]=n[0]-r[0],l[1]=n[1]-r[1],l[2]=n[2]-r[2],u[0]=l[0]*Math.cos(s)-l[1]*Math.sin(s),u[1]=l[0]*Math.sin(s)+l[1]*Math.cos(s),u[2]=l[2],a[0]=u[0]+r[0],a[1]=u[1]+r[1],a[2]=u[2]+r[2],a}function yp(a,n){var r=a[0],s=a[1],l=a[2],u=n[0],h=n[1],f=n[2],d=Math.sqrt((r*r+s*s+l*l)*(u*u+h*h+f*f)),v=d&&Qn(a,n)/d;return Math.acos(Math.min(Math.max(v,-1),1))}function YF(a){return a[0]=0,a[1]=0,a[2]=0,a}function XF(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}function qF(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]}function Eo(a,n){var r=a[0],s=a[1],l=a[2],u=n[0],h=n[1],f=n[2];return Math.abs(r-u)<=it*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(s-h)<=it*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(l-f)<=it*Math.max(1,Math.abs(l),Math.abs(f))}var ow=Ht,KF=null,QF=null,mp=Ni,JF=null,bp=ft,t8=null,e8=function(){var a=j();return function(n,r,s,l,u,h){var f,d;for(r||(r=3),s||(s=0),l?d=Math.min(l*r+s,n.length):d=n.length,f=s;f<d;f+=r)a[0]=n[f],a[1]=n[f+1],a[2]=n[f+2],u(a,a,h),n[f]=a[0],n[f+1]=a[1],n[f+2]=a[2];return n}}();function li(){var a=new ot(4);return ot!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0),a}function lw(a){var n=new ot(4);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n}function wo(a,n,r,s){var l=new ot(4);return l[0]=a,l[1]=n,l[2]=r,l[3]=s,l}function cw(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a}function uw(a,n,r,s,l){return a[0]=n,a[1]=r,a[2]=s,a[3]=l,a}function hw(a,n,r){return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a[2]=n[2]+r[2],a[3]=n[3]+r[3],a}function n8(a,n,r){return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],a[3]=n[3]-r[3],a}function r8(a,n,r){return a[0]=n[0]*r[0],a[1]=n[1]*r[1],a[2]=n[2]*r[2],a[3]=n[3]*r[3],a}function i8(a,n,r){return a[0]=n[0]/r[0],a[1]=n[1]/r[1],a[2]=n[2]/r[2],a[3]=n[3]/r[3],a}function a8(a,n){return a[0]=Math.ceil(n[0]),a[1]=Math.ceil(n[1]),a[2]=Math.ceil(n[2]),a[3]=Math.ceil(n[3]),a}function s8(a,n){return a[0]=Math.floor(n[0]),a[1]=Math.floor(n[1]),a[2]=Math.floor(n[2]),a[3]=Math.floor(n[3]),a}function o8(a,n,r){return a[0]=Math.min(n[0],r[0]),a[1]=Math.min(n[1],r[1]),a[2]=Math.min(n[2],r[2]),a[3]=Math.min(n[3],r[3]),a}function l8(a,n,r){return a[0]=Math.max(n[0],r[0]),a[1]=Math.max(n[1],r[1]),a[2]=Math.max(n[2],r[2]),a[3]=Math.max(n[3],r[3]),a}function c8(a,n){return a[0]=glMatrix.round(n[0]),a[1]=glMatrix.round(n[1]),a[2]=glMatrix.round(n[2]),a[3]=glMatrix.round(n[3]),a}function fw(a,n,r){return a[0]=n[0]*r,a[1]=n[1]*r,a[2]=n[2]*r,a[3]=n[3]*r,a}function u8(a,n,r,s){return a[0]=n[0]+r[0]*s,a[1]=n[1]+r[1]*s,a[2]=n[2]+r[2]*s,a[3]=n[3]+r[3]*s,a}function h8(a,n){var r=n[0]-a[0],s=n[1]-a[1],l=n[2]-a[2],u=n[3]-a[3];return Math.sqrt(r*r+s*s+l*l+u*u)}function f8(a,n){var r=n[0]-a[0],s=n[1]-a[1],l=n[2]-a[2],u=n[3]-a[3];return r*r+s*s+l*l+u*u}function dw(a){var n=a[0],r=a[1],s=a[2],l=a[3];return Math.sqrt(n*n+r*r+s*s+l*l)}function vw(a){var n=a[0],r=a[1],s=a[2],l=a[3];return n*n+r*r+s*s+l*l}function d8(a,n){return a[0]=-n[0],a[1]=-n[1],a[2]=-n[2],a[3]=-n[3],a}function v8(a,n){return a[0]=1/n[0],a[1]=1/n[1],a[2]=1/n[2],a[3]=1/n[3],a}function pw(a,n){var r=n[0],s=n[1],l=n[2],u=n[3],h=r*r+s*s+l*l+u*u;return h>0&&(h=1/Math.sqrt(h)),a[0]=r*h,a[1]=s*h,a[2]=l*h,a[3]=u*h,a}function gw(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]+a[3]*n[3]}function p8(a,n,r,s){var l=r[0]*s[1]-r[1]*s[0],u=r[0]*s[2]-r[2]*s[0],h=r[0]*s[3]-r[3]*s[0],f=r[1]*s[2]-r[2]*s[1],d=r[1]*s[3]-r[3]*s[1],v=r[2]*s[3]-r[3]*s[2],p=n[0],g=n[1],y=n[2],m=n[3];return a[0]=g*v-y*d+m*f,a[1]=-(p*v)+y*h-m*u,a[2]=p*d-g*h+m*l,a[3]=-(p*f)+g*u-y*l,a}function yw(a,n,r,s){var l=n[0],u=n[1],h=n[2],f=n[3];return a[0]=l+s*(r[0]-l),a[1]=u+s*(r[1]-u),a[2]=h+s*(r[2]-h),a[3]=f+s*(r[3]-f),a}function g8(a,n){n=n===void 0?1:n;var r,s,l,u,h,f,d;d=glMatrix.RANDOM(),r=d*2-1,s=(4*glMatrix.RANDOM()-2)*Math.sqrt(d*-d+d),h=r*r+s*s,d=glMatrix.RANDOM(),l=d*2-1,u=(4*glMatrix.RANDOM()-2)*Math.sqrt(d*-d+d),f=l*l+u*u;var v=Math.sqrt((1-h)/f);return a[0]=n*r,a[1]=n*s,a[2]=n*l*v,a[3]=n*u*v,a}function Ri(a,n,r){var s=n[0],l=n[1],u=n[2],h=n[3];return a[0]=r[0]*s+r[4]*l+r[8]*u+r[12]*h,a[1]=r[1]*s+r[5]*l+r[9]*u+r[13]*h,a[2]=r[2]*s+r[6]*l+r[10]*u+r[14]*h,a[3]=r[3]*s+r[7]*l+r[11]*u+r[15]*h,a}function y8(a,n,r){var s=r[0],l=r[1],u=r[2],h=r[3],f=n[0],d=n[1],v=n[2],p=l*v-u*d,g=u*f-s*v,y=s*d-l*f;return p=p+p,g=g+g,y=y+y,a[0]=f+h*p+l*y-u*g,a[1]=d+h*g+u*p-s*y,a[2]=v+h*y+s*g-l*p,a[3]=n[3],a}function m8(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a}function b8(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}function mw(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]&&a[3]===n[3]}function x8(a,n){var r=a[0],s=a[1],l=a[2],u=a[3],h=n[0],f=n[1],d=n[2],v=n[3];return Math.abs(r-h)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(s-f)<=glMatrix.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(l-d)<=glMatrix.EPSILON*Math.max(1,Math.abs(l),Math.abs(d))&&Math.abs(u-v)<=glMatrix.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))}var E8=null,w8=null,S8=null,M8=null,T8=null,C8=null,O8=null,k8=function(){var a=li();return function(n,r,s,l,u,h){var f,d;for(r||(r=4),s||(s=0),l?d=Math.min(l*r+s,n.length):d=n.length,f=s;f<d;f+=r)a[0]=n[f],a[1]=n[f+1],a[2]=n[f+2],a[3]=n[f+3],u(a,a,h),n[f]=a[0],n[f+1]=a[1],n[f+2]=a[2],n[f+3]=a[3];return n}}();function Ce(){var a=new ot(16);return ot!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a}function xp(a){var n=new ot(16);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[5],n[6]=a[6],n[7]=a[7],n[8]=a[8],n[9]=a[9],n[10]=a[10],n[11]=a[11],n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15],n}function Ts(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a}function Ep(a,n,r,s,l,u,h,f,d,v,p,g,y,m,b,x){var E=new ot(16);return E[0]=a,E[1]=n,E[2]=r,E[3]=s,E[4]=l,E[5]=u,E[6]=h,E[7]=f,E[8]=d,E[9]=v,E[10]=p,E[11]=g,E[12]=y,E[13]=m,E[14]=b,E[15]=x,E}function wf(a,n,r,s,l,u,h,f,d,v,p,g,y,m,b,x,E){return a[0]=n,a[1]=r,a[2]=s,a[3]=l,a[4]=u,a[5]=h,a[6]=f,a[7]=d,a[8]=v,a[9]=p,a[10]=g,a[11]=y,a[12]=m,a[13]=b,a[14]=x,a[15]=E,a}function Ji(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function wp(a,n){if(a===n){var r=n[1],s=n[2],l=n[3],u=n[6],h=n[7],f=n[11];a[1]=n[4],a[2]=n[8],a[3]=n[12],a[4]=r,a[6]=n[9],a[7]=n[13],a[8]=s,a[9]=u,a[11]=n[14],a[12]=l,a[13]=h,a[14]=f}else a[0]=n[0],a[1]=n[4],a[2]=n[8],a[3]=n[12],a[4]=n[1],a[5]=n[5],a[6]=n[9],a[7]=n[13],a[8]=n[2],a[9]=n[6],a[10]=n[10],a[11]=n[14],a[12]=n[3],a[13]=n[7],a[14]=n[11],a[15]=n[15];return a}function ci(a,n){var r=n[0],s=n[1],l=n[2],u=n[3],h=n[4],f=n[5],d=n[6],v=n[7],p=n[8],g=n[9],y=n[10],m=n[11],b=n[12],x=n[13],E=n[14],w=n[15],S=r*f-s*h,M=r*d-l*h,C=r*v-u*h,T=s*d-l*f,O=s*v-u*f,k=l*v-u*d,P=p*x-g*b,A=p*E-y*b,N=p*w-m*b,L=g*E-y*x,R=g*w-m*x,z=y*w-m*E,Z=S*z-M*R+C*L+T*N-O*A+k*P;return Z?(Z=1/Z,a[0]=(f*z-d*R+v*L)*Z,a[1]=(l*R-s*z-u*L)*Z,a[2]=(x*k-E*O+w*T)*Z,a[3]=(y*O-g*k-m*T)*Z,a[4]=(d*N-h*z-v*A)*Z,a[5]=(r*z-l*N+u*A)*Z,a[6]=(E*C-b*k-w*M)*Z,a[7]=(p*k-y*C+m*M)*Z,a[8]=(h*R-f*N+v*P)*Z,a[9]=(s*N-r*R-u*P)*Z,a[10]=(b*O-x*C+w*S)*Z,a[11]=(g*C-p*O-m*S)*Z,a[12]=(f*A-h*L-d*P)*Z,a[13]=(r*L-s*A+l*P)*Z,a[14]=(x*M-b*T-E*S)*Z,a[15]=(p*T-g*M+y*S)*Z,a):null}function bw(a,n){var r=n[0],s=n[1],l=n[2],u=n[3],h=n[4],f=n[5],d=n[6],v=n[7],p=n[8],g=n[9],y=n[10],m=n[11],b=n[12],x=n[13],E=n[14],w=n[15],S=r*f-s*h,M=r*d-l*h,C=r*v-u*h,T=s*d-l*f,O=s*v-u*f,k=l*v-u*d,P=p*x-g*b,A=p*E-y*b,N=p*w-m*b,L=g*E-y*x,R=g*w-m*x,z=y*w-m*E;return a[0]=f*z-d*R+v*L,a[1]=l*R-s*z-u*L,a[2]=x*k-E*O+w*T,a[3]=y*O-g*k-m*T,a[4]=d*N-h*z-v*A,a[5]=r*z-l*N+u*A,a[6]=E*C-b*k-w*M,a[7]=p*k-y*C+m*M,a[8]=h*R-f*N+v*P,a[9]=s*N-r*R-u*P,a[10]=b*O-x*C+w*S,a[11]=g*C-p*O-m*S,a[12]=f*A-h*L-d*P,a[13]=r*L-s*A+l*P,a[14]=x*M-b*T-E*S,a[15]=p*T-g*M+y*S,a}function Sp(a){var n=a[0],r=a[1],s=a[2],l=a[3],u=a[4],h=a[5],f=a[6],d=a[7],v=a[8],p=a[9],g=a[10],y=a[11],m=a[12],b=a[13],x=a[14],E=a[15],w=n*h-r*u,S=n*f-s*u,M=r*f-s*h,C=v*b-p*m,T=v*x-g*m,O=p*x-g*b,k=n*O-r*T+s*C,P=u*O-h*T+f*C,A=v*M-p*S+g*w,N=m*M-b*S+x*w;return d*k-l*P+E*A-y*N}function An(a,n,r){var s=n[0],l=n[1],u=n[2],h=n[3],f=n[4],d=n[5],v=n[6],p=n[7],g=n[8],y=n[9],m=n[10],b=n[11],x=n[12],E=n[13],w=n[14],S=n[15],M=r[0],C=r[1],T=r[2],O=r[3];return a[0]=M*s+C*f+T*g+O*x,a[1]=M*l+C*d+T*y+O*E,a[2]=M*u+C*v+T*m+O*w,a[3]=M*h+C*p+T*b+O*S,M=r[4],C=r[5],T=r[6],O=r[7],a[4]=M*s+C*f+T*g+O*x,a[5]=M*l+C*d+T*y+O*E,a[6]=M*u+C*v+T*m+O*w,a[7]=M*h+C*p+T*b+O*S,M=r[8],C=r[9],T=r[10],O=r[11],a[8]=M*s+C*f+T*g+O*x,a[9]=M*l+C*d+T*y+O*E,a[10]=M*u+C*v+T*m+O*w,a[11]=M*h+C*p+T*b+O*S,M=r[12],C=r[13],T=r[14],O=r[15],a[12]=M*s+C*f+T*g+O*x,a[13]=M*l+C*d+T*y+O*E,a[14]=M*u+C*v+T*m+O*w,a[15]=M*h+C*p+T*b+O*S,a}function Cs(a,n,r){var s=r[0],l=r[1],u=r[2],h,f,d,v,p,g,y,m,b,x,E,w;return n===a?(a[12]=n[0]*s+n[4]*l+n[8]*u+n[12],a[13]=n[1]*s+n[5]*l+n[9]*u+n[13],a[14]=n[2]*s+n[6]*l+n[10]*u+n[14],a[15]=n[3]*s+n[7]*l+n[11]*u+n[15]):(h=n[0],f=n[1],d=n[2],v=n[3],p=n[4],g=n[5],y=n[6],m=n[7],b=n[8],x=n[9],E=n[10],w=n[11],a[0]=h,a[1]=f,a[2]=d,a[3]=v,a[4]=p,a[5]=g,a[6]=y,a[7]=m,a[8]=b,a[9]=x,a[10]=E,a[11]=w,a[12]=h*s+p*l+b*u+n[12],a[13]=f*s+g*l+x*u+n[13],a[14]=d*s+y*l+E*u+n[14],a[15]=v*s+m*l+w*u+n[15]),a}function Mp(a,n,r){var s=r[0],l=r[1],u=r[2];return a[0]=n[0]*s,a[1]=n[1]*s,a[2]=n[2]*s,a[3]=n[3]*s,a[4]=n[4]*l,a[5]=n[5]*l,a[6]=n[6]*l,a[7]=n[7]*l,a[8]=n[8]*u,a[9]=n[9]*u,a[10]=n[10]*u,a[11]=n[11]*u,a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a}function xw(a,n,r,s){var l=s[0],u=s[1],h=s[2],f=Math.sqrt(l*l+u*u+h*h),d,v,p,g,y,m,b,x,E,w,S,M,C,T,O,k,P,A,N,L,R,z,Z,X;return f<it?null:(f=1/f,l*=f,u*=f,h*=f,d=Math.sin(r),v=Math.cos(r),p=1-v,g=n[0],y=n[1],m=n[2],b=n[3],x=n[4],E=n[5],w=n[6],S=n[7],M=n[8],C=n[9],T=n[10],O=n[11],k=l*l*p+v,P=u*l*p+h*d,A=h*l*p-u*d,N=l*u*p-h*d,L=u*u*p+v,R=h*u*p+l*d,z=l*h*p+u*d,Z=u*h*p-l*d,X=h*h*p+v,a[0]=g*k+x*P+M*A,a[1]=y*k+E*P+C*A,a[2]=m*k+w*P+T*A,a[3]=b*k+S*P+O*A,a[4]=g*N+x*L+M*R,a[5]=y*N+E*L+C*R,a[6]=m*N+w*L+T*R,a[7]=b*N+S*L+O*R,a[8]=g*z+x*Z+M*X,a[9]=y*z+E*Z+C*X,a[10]=m*z+w*Z+T*X,a[11]=b*z+S*Z+O*X,n!==a&&(a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a)}function Tp(a,n,r){var s=Math.sin(r),l=Math.cos(r),u=n[4],h=n[5],f=n[6],d=n[7],v=n[8],p=n[9],g=n[10],y=n[11];return n!==a&&(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[4]=u*l+v*s,a[5]=h*l+p*s,a[6]=f*l+g*s,a[7]=d*l+y*s,a[8]=v*l-u*s,a[9]=p*l-h*s,a[10]=g*l-f*s,a[11]=y*l-d*s,a}function Cp(a,n,r){var s=Math.sin(r),l=Math.cos(r),u=n[0],h=n[1],f=n[2],d=n[3],v=n[8],p=n[9],g=n[10],y=n[11];return n!==a&&(a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=u*l-v*s,a[1]=h*l-p*s,a[2]=f*l-g*s,a[3]=d*l-y*s,a[8]=u*s+v*l,a[9]=h*s+p*l,a[10]=f*s+g*l,a[11]=d*s+y*l,a}function Ew(a,n,r){var s=Math.sin(r),l=Math.cos(r),u=n[0],h=n[1],f=n[2],d=n[3],v=n[4],p=n[5],g=n[6],y=n[7];return n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=u*l+v*s,a[1]=h*l+p*s,a[2]=f*l+g*s,a[3]=d*l+y*s,a[4]=v*l-u*s,a[5]=p*l-h*s,a[6]=g*l-f*s,a[7]=y*l-d*s,a}function ta(a,n){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=n[0],a[13]=n[1],a[14]=n[2],a[15]=1,a}function Na(a,n){return a[0]=n[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=n[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=n[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Op(a,n,r){var s=r[0],l=r[1],u=r[2],h=Math.sqrt(s*s+l*l+u*u),f,d,v;return h<it?null:(h=1/h,s*=h,l*=h,u*=h,f=Math.sin(n),d=Math.cos(n),v=1-d,a[0]=s*s*v+d,a[1]=l*s*v+u*f,a[2]=u*s*v-l*f,a[3]=0,a[4]=s*l*v-u*f,a[5]=l*l*v+d,a[6]=u*l*v+s*f,a[7]=0,a[8]=s*u*v+l*f,a[9]=l*u*v-s*f,a[10]=u*u*v+d,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}function kp(a,n){var r=Math.sin(n),s=Math.cos(n);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s,a[6]=r,a[7]=0,a[8]=0,a[9]=-r,a[10]=s,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function _p(a,n){var r=Math.sin(n),s=Math.cos(n);return a[0]=s,a[1]=0,a[2]=-r,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=r,a[9]=0,a[10]=s,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Sf(a,n){var r=Math.sin(n),s=Math.cos(n);return a[0]=s,a[1]=r,a[2]=0,a[3]=0,a[4]=-r,a[5]=s,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Pp(a,n,r){var s=n[0],l=n[1],u=n[2],h=n[3],f=s+s,d=l+l,v=u+u,p=s*f,g=s*d,y=s*v,m=l*d,b=l*v,x=u*v,E=h*f,w=h*d,S=h*v;return a[0]=1-(m+x),a[1]=g+S,a[2]=y-w,a[3]=0,a[4]=g-S,a[5]=1-(p+x),a[6]=b+E,a[7]=0,a[8]=y+w,a[9]=b-E,a[10]=1-(p+m),a[11]=0,a[12]=r[0],a[13]=r[1],a[14]=r[2],a[15]=1,a}function ww(a,n){var r=new ot(3),s=-n[0],l=-n[1],u=-n[2],h=n[3],f=n[4],d=n[5],v=n[6],p=n[7],g=s*s+l*l+u*u+h*h;return g>0?(r[0]=(f*h+p*s+d*u-v*l)*2/g,r[1]=(d*h+p*l+v*s-f*u)*2/g,r[2]=(v*h+p*u+f*l-d*s)*2/g):(r[0]=(f*h+p*s+d*u-v*l)*2,r[1]=(d*h+p*l+v*s-f*u)*2,r[2]=(v*h+p*u+f*l-d*s)*2),Pp(a,n,r),a}function Cc(a,n){return a[0]=n[12],a[1]=n[13],a[2]=n[14],a}function Os(a,n){var r=n[0],s=n[1],l=n[2],u=n[4],h=n[5],f=n[6],d=n[8],v=n[9],p=n[10];return a[0]=Math.sqrt(r*r+s*s+l*l),a[1]=Math.sqrt(u*u+h*h+f*f),a[2]=Math.sqrt(d*d+v*v+p*p),a}function Oc(a,n){var r=new ot(3);Os(r,n);var s=1/r[0],l=1/r[1],u=1/r[2],h=n[0]*s,f=n[1]*l,d=n[2]*u,v=n[4]*s,p=n[5]*l,g=n[6]*u,y=n[8]*s,m=n[9]*l,b=n[10]*u,x=h+p+b,E=0;return x>0?(E=Math.sqrt(x+1)*2,a[3]=.25*E,a[0]=(g-m)/E,a[1]=(y-d)/E,a[2]=(f-v)/E):h>p&&h>b?(E=Math.sqrt(1+h-p-b)*2,a[3]=(g-m)/E,a[0]=.25*E,a[1]=(f+v)/E,a[2]=(y+d)/E):p>b?(E=Math.sqrt(1+p-h-b)*2,a[3]=(y-d)/E,a[0]=(f+v)/E,a[1]=.25*E,a[2]=(g+m)/E):(E=Math.sqrt(1+b-h-p)*2,a[3]=(f-v)/E,a[0]=(y+d)/E,a[1]=(g+m)/E,a[2]=.25*E),a}function Sw(a,n,r,s){n[0]=s[12],n[1]=s[13],n[2]=s[14];var l=s[0],u=s[1],h=s[2],f=s[4],d=s[5],v=s[6],p=s[8],g=s[9],y=s[10];r[0]=Math.sqrt(l*l+u*u+h*h),r[1]=Math.sqrt(f*f+d*d+v*v),r[2]=Math.sqrt(p*p+g*g+y*y);var m=1/r[0],b=1/r[1],x=1/r[2],E=l*m,w=u*b,S=h*x,M=f*m,C=d*b,T=v*x,O=p*m,k=g*b,P=y*x,A=E+C+P,N=0;return A>0?(N=Math.sqrt(A+1)*2,a[3]=.25*N,a[0]=(T-k)/N,a[1]=(O-S)/N,a[2]=(w-M)/N):E>C&&E>P?(N=Math.sqrt(1+E-C-P)*2,a[3]=(T-k)/N,a[0]=.25*N,a[1]=(w+M)/N,a[2]=(O+S)/N):C>P?(N=Math.sqrt(1+C-E-P)*2,a[3]=(O-S)/N,a[0]=(w+M)/N,a[1]=.25*N,a[2]=(T+k)/N):(N=Math.sqrt(1+P-E-C)*2,a[3]=(w-M)/N,a[0]=(O+S)/N,a[1]=(T+k)/N,a[2]=.25*N),a}function Mw(a,n,r,s){var l=n[0],u=n[1],h=n[2],f=n[3],d=l+l,v=u+u,p=h+h,g=l*d,y=l*v,m=l*p,b=u*v,x=u*p,E=h*p,w=f*d,S=f*v,M=f*p,C=s[0],T=s[1],O=s[2];return a[0]=(1-(b+E))*C,a[1]=(y+M)*C,a[2]=(m-S)*C,a[3]=0,a[4]=(y-M)*T,a[5]=(1-(g+E))*T,a[6]=(x+w)*T,a[7]=0,a[8]=(m+S)*O,a[9]=(x-w)*O,a[10]=(1-(g+b))*O,a[11]=0,a[12]=r[0],a[13]=r[1],a[14]=r[2],a[15]=1,a}function So(a,n,r,s,l){var u=n[0],h=n[1],f=n[2],d=n[3],v=u+u,p=h+h,g=f+f,y=u*v,m=u*p,b=u*g,x=h*p,E=h*g,w=f*g,S=d*v,M=d*p,C=d*g,T=s[0],O=s[1],k=s[2],P=l[0],A=l[1],N=l[2],L=(1-(x+w))*T,R=(m+C)*T,z=(b-M)*T,Z=(m-C)*O,X=(1-(y+w))*O,nt=(E+S)*O,K=(b+M)*k,rt=(E-S)*k,U=(1-(y+x))*k;return a[0]=L,a[1]=R,a[2]=z,a[3]=0,a[4]=Z,a[5]=X,a[6]=nt,a[7]=0,a[8]=K,a[9]=rt,a[10]=U,a[11]=0,a[12]=r[0]+P-(L*P+Z*A+K*N),a[13]=r[1]+A-(R*P+X*A+rt*N),a[14]=r[2]+N-(z*P+nt*A+U*N),a[15]=1,a}function Mf(a,n){var r=n[0],s=n[1],l=n[2],u=n[3],h=r+r,f=s+s,d=l+l,v=r*h,p=s*h,g=s*f,y=l*h,m=l*f,b=l*d,x=u*h,E=u*f,w=u*d;return a[0]=1-g-b,a[1]=p+w,a[2]=y-E,a[3]=0,a[4]=p-w,a[5]=1-v-b,a[6]=m+x,a[7]=0,a[8]=y+E,a[9]=m-x,a[10]=1-v-g,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Tw(a,n,r,s,l,u,h){var f=1/(r-n),d=1/(l-s),v=1/(u-h);return a[0]=u*2*f,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=u*2*d,a[6]=0,a[7]=0,a[8]=(r+n)*f,a[9]=(l+s)*d,a[10]=(h+u)*v,a[11]=-1,a[12]=0,a[13]=0,a[14]=h*u*2*v,a[15]=0,a}function Ap(a,n,r,s,l){var u=1/Math.tan(n/2);if(a[0]=u/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=u,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,l!=null&&l!==1/0){var h=1/(s-l);a[10]=(l+s)*h,a[14]=2*l*s*h}else a[10]=-1,a[14]=-2*s;return a}var Cw=Ap;function Ow(a,n,r,s,l){var u=1/Math.tan(n/2);if(a[0]=u/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=u,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,l!=null&&l!==1/0){var h=1/(s-l);a[10]=l*h,a[14]=l*s*h}else a[10]=-1,a[14]=-s;return a}function kw(a,n,r,s){var l=Math.tan(n.upDegrees*Math.PI/180),u=Math.tan(n.downDegrees*Math.PI/180),h=Math.tan(n.leftDegrees*Math.PI/180),f=Math.tan(n.rightDegrees*Math.PI/180),d=2/(h+f),v=2/(l+u);return a[0]=d,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=v,a[6]=0,a[7]=0,a[8]=-((h-f)*d*.5),a[9]=(l-u)*v*.5,a[10]=s/(r-s),a[11]=-1,a[12]=0,a[13]=0,a[14]=s*r/(r-s),a[15]=0,a}function Np(a,n,r,s,l,u,h){var f=1/(n-r),d=1/(s-l),v=1/(u-h);return a[0]=-2*f,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*d,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*v,a[11]=0,a[12]=(n+r)*f,a[13]=(l+s)*d,a[14]=(h+u)*v,a[15]=1,a}var Rp=Np;function Lp(a,n,r,s,l,u,h){var f=1/(n-r),d=1/(s-l),v=1/(u-h);return a[0]=-2*f,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*d,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=v,a[11]=0,a[12]=(n+r)*f,a[13]=(l+s)*d,a[14]=u*v,a[15]=1,a}function Dp(a,n,r,s){var l,u,h,f,d,v,p,g,y,m,b=n[0],x=n[1],E=n[2],w=s[0],S=s[1],M=s[2],C=r[0],T=r[1],O=r[2];return Math.abs(b-C)<it&&Math.abs(x-T)<it&&Math.abs(E-O)<it?Ji(a):(p=b-C,g=x-T,y=E-O,m=1/Math.sqrt(p*p+g*g+y*y),p*=m,g*=m,y*=m,l=S*y-M*g,u=M*p-w*y,h=w*g-S*p,m=Math.sqrt(l*l+u*u+h*h),m?(m=1/m,l*=m,u*=m,h*=m):(l=0,u=0,h=0),f=g*h-y*u,d=y*l-p*h,v=p*u-g*l,m=Math.sqrt(f*f+d*d+v*v),m?(m=1/m,f*=m,d*=m,v*=m):(f=0,d=0,v=0),a[0]=l,a[1]=f,a[2]=p,a[3]=0,a[4]=u,a[5]=d,a[6]=g,a[7]=0,a[8]=h,a[9]=v,a[10]=y,a[11]=0,a[12]=-(l*b+u*x+h*E),a[13]=-(f*b+d*x+v*E),a[14]=-(p*b+g*x+y*E),a[15]=1,a)}function _w(a,n,r,s){var l=n[0],u=n[1],h=n[2],f=s[0],d=s[1],v=s[2],p=l-r[0],g=u-r[1],y=h-r[2],m=p*p+g*g+y*y;m>0&&(m=1/Math.sqrt(m),p*=m,g*=m,y*=m);var b=d*y-v*g,x=v*p-f*y,E=f*g-d*p;return m=b*b+x*x+E*E,m>0&&(m=1/Math.sqrt(m),b*=m,x*=m,E*=m),a[0]=b,a[1]=x,a[2]=E,a[3]=0,a[4]=g*E-y*x,a[5]=y*b-p*E,a[6]=p*x-g*b,a[7]=0,a[8]=p,a[9]=g,a[10]=y,a[11]=0,a[12]=l,a[13]=u,a[14]=h,a[15]=1,a}function Pw(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}function Aw(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]+a[3]*a[3]+a[4]*a[4]+a[5]*a[5]+a[6]*a[6]+a[7]*a[7]+a[8]*a[8]+a[9]*a[9]+a[10]*a[10]+a[11]*a[11]+a[12]*a[12]+a[13]*a[13]+a[14]*a[14]+a[15]*a[15])}function Nw(a,n,r){return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a[2]=n[2]+r[2],a[3]=n[3]+r[3],a[4]=n[4]+r[4],a[5]=n[5]+r[5],a[6]=n[6]+r[6],a[7]=n[7]+r[7],a[8]=n[8]+r[8],a[9]=n[9]+r[9],a[10]=n[10]+r[10],a[11]=n[11]+r[11],a[12]=n[12]+r[12],a[13]=n[13]+r[13],a[14]=n[14]+r[14],a[15]=n[15]+r[15],a}function Ip(a,n,r){return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],a[3]=n[3]-r[3],a[4]=n[4]-r[4],a[5]=n[5]-r[5],a[6]=n[6]-r[6],a[7]=n[7]-r[7],a[8]=n[8]-r[8],a[9]=n[9]-r[9],a[10]=n[10]-r[10],a[11]=n[11]-r[11],a[12]=n[12]-r[12],a[13]=n[13]-r[13],a[14]=n[14]-r[14],a[15]=n[15]-r[15],a}function Rw(a,n,r){return a[0]=n[0]*r,a[1]=n[1]*r,a[2]=n[2]*r,a[3]=n[3]*r,a[4]=n[4]*r,a[5]=n[5]*r,a[6]=n[6]*r,a[7]=n[7]*r,a[8]=n[8]*r,a[9]=n[9]*r,a[10]=n[10]*r,a[11]=n[11]*r,a[12]=n[12]*r,a[13]=n[13]*r,a[14]=n[14]*r,a[15]=n[15]*r,a}function Lw(a,n,r,s){return a[0]=n[0]+r[0]*s,a[1]=n[1]+r[1]*s,a[2]=n[2]+r[2]*s,a[3]=n[3]+r[3]*s,a[4]=n[4]+r[4]*s,a[5]=n[5]+r[5]*s,a[6]=n[6]+r[6]*s,a[7]=n[7]+r[7]*s,a[8]=n[8]+r[8]*s,a[9]=n[9]+r[9]*s,a[10]=n[10]+r[10]*s,a[11]=n[11]+r[11]*s,a[12]=n[12]+r[12]*s,a[13]=n[13]+r[13]*s,a[14]=n[14]+r[14]*s,a[15]=n[15]+r[15]*s,a}function Tf(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]&&a[3]===n[3]&&a[4]===n[4]&&a[5]===n[5]&&a[6]===n[6]&&a[7]===n[7]&&a[8]===n[8]&&a[9]===n[9]&&a[10]===n[10]&&a[11]===n[11]&&a[12]===n[12]&&a[13]===n[13]&&a[14]===n[14]&&a[15]===n[15]}function Dw(a,n){var r=a[0],s=a[1],l=a[2],u=a[3],h=a[4],f=a[5],d=a[6],v=a[7],p=a[8],g=a[9],y=a[10],m=a[11],b=a[12],x=a[13],E=a[14],w=a[15],S=n[0],M=n[1],C=n[2],T=n[3],O=n[4],k=n[5],P=n[6],A=n[7],N=n[8],L=n[9],R=n[10],z=n[11],Z=n[12],X=n[13],nt=n[14],K=n[15];return Math.abs(r-S)<=it*Math.max(1,Math.abs(r),Math.abs(S))&&Math.abs(s-M)<=it*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(l-C)<=it*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(u-T)<=it*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(h-O)<=it*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(f-k)<=it*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(d-P)<=it*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(v-A)<=it*Math.max(1,Math.abs(v),Math.abs(A))&&Math.abs(p-N)<=it*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(g-L)<=it*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(y-R)<=it*Math.max(1,Math.abs(y),Math.abs(R))&&Math.abs(m-z)<=it*Math.max(1,Math.abs(m),Math.abs(z))&&Math.abs(b-Z)<=it*Math.max(1,Math.abs(b),Math.abs(Z))&&Math.abs(x-X)<=it*Math.max(1,Math.abs(x),Math.abs(X))&&Math.abs(E-nt)<=it*Math.max(1,Math.abs(E),Math.abs(nt))&&Math.abs(w-K)<=it*Math.max(1,Math.abs(w),Math.abs(K))}var Bp=An,Iw=Ip;function Fp(){var a=new ot(9);return ot!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function Bw(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[4],a[4]=n[5],a[5]=n[6],a[6]=n[8],a[7]=n[9],a[8]=n[10],a}function _8(a){var n=new glMatrix.ARRAY_TYPE(9);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[5],n[6]=a[6],n[7]=a[7],n[8]=a[8],n}function P8(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a}function Fw(a,n,r,s,l,u,h,f,d){var v=new ot(9);return v[0]=a,v[1]=n,v[2]=r,v[3]=s,v[4]=l,v[5]=u,v[6]=h,v[7]=f,v[8]=d,v}function A8(a,n,r,s,l,u,h,f,d,v){return a[0]=n,a[1]=r,a[2]=s,a[3]=l,a[4]=u,a[5]=h,a[6]=f,a[7]=d,a[8]=v,a}function N8(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a}function R8(a,n){if(a===n){var r=n[1],s=n[2],l=n[5];a[1]=n[3],a[2]=n[6],a[3]=r,a[5]=n[7],a[6]=s,a[7]=l}else a[0]=n[0],a[1]=n[3],a[2]=n[6],a[3]=n[1],a[4]=n[4],a[5]=n[7],a[6]=n[2],a[7]=n[5],a[8]=n[8];return a}function L8(a,n){var r=n[0],s=n[1],l=n[2],u=n[3],h=n[4],f=n[5],d=n[6],v=n[7],p=n[8],g=p*h-f*v,y=-p*u+f*d,m=v*u-h*d,b=r*g+s*y+l*m;return b?(b=1/b,a[0]=g*b,a[1]=(-p*s+l*v)*b,a[2]=(f*s-l*h)*b,a[3]=y*b,a[4]=(p*r-l*d)*b,a[5]=(-f*r+l*u)*b,a[6]=m*b,a[7]=(-v*r+s*d)*b,a[8]=(h*r-s*u)*b,a):null}function D8(a,n){var r=n[0],s=n[1],l=n[2],u=n[3],h=n[4],f=n[5],d=n[6],v=n[7],p=n[8];return a[0]=h*p-f*v,a[1]=l*v-s*p,a[2]=s*f-l*h,a[3]=f*d-u*p,a[4]=r*p-l*d,a[5]=l*u-r*f,a[6]=u*v-h*d,a[7]=s*d-r*v,a[8]=r*h-s*u,a}function I8(a){var n=a[0],r=a[1],s=a[2],l=a[3],u=a[4],h=a[5],f=a[6],d=a[7],v=a[8];return n*(v*u-h*d)+r*(-v*l+h*f)+s*(d*l-u*f)}function B8(a,n,r){var s=n[0],l=n[1],u=n[2],h=n[3],f=n[4],d=n[5],v=n[6],p=n[7],g=n[8],y=r[0],m=r[1],b=r[2],x=r[3],E=r[4],w=r[5],S=r[6],M=r[7],C=r[8];return a[0]=y*s+m*h+b*v,a[1]=y*l+m*f+b*p,a[2]=y*u+m*d+b*g,a[3]=x*s+E*h+w*v,a[4]=x*l+E*f+w*p,a[5]=x*u+E*d+w*g,a[6]=S*s+M*h+C*v,a[7]=S*l+M*f+C*p,a[8]=S*u+M*d+C*g,a}function F8(a,n,r){var s=n[0],l=n[1],u=n[2],h=n[3],f=n[4],d=n[5],v=n[6],p=n[7],g=n[8],y=r[0],m=r[1];return a[0]=s,a[1]=l,a[2]=u,a[3]=h,a[4]=f,a[5]=d,a[6]=y*s+m*h+v,a[7]=y*l+m*f+p,a[8]=y*u+m*d+g,a}function z8(a,n,r){var s=n[0],l=n[1],u=n[2],h=n[3],f=n[4],d=n[5],v=n[6],p=n[7],g=n[8],y=Math.sin(r),m=Math.cos(r);return a[0]=m*s+y*h,a[1]=m*l+y*f,a[2]=m*u+y*d,a[3]=m*h-y*s,a[4]=m*f-y*l,a[5]=m*d-y*u,a[6]=v,a[7]=p,a[8]=g,a}function Z8(a,n,r){var s=r[0],l=r[1];return a[0]=s*n[0],a[1]=s*n[1],a[2]=s*n[2],a[3]=l*n[3],a[4]=l*n[4],a[5]=l*n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a}function G8(a,n){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=n[0],a[7]=n[1],a[8]=1,a}function W8(a,n){var r=Math.sin(n),s=Math.cos(n);return a[0]=s,a[1]=r,a[2]=0,a[3]=-r,a[4]=s,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a}function j8(a,n){return a[0]=n[0],a[1]=0,a[2]=0,a[3]=0,a[4]=n[1],a[5]=0,a[6]=0,a[7]=0,a[8]=1,a}function V8(a,n){return a[0]=n[0],a[1]=n[1],a[2]=0,a[3]=n[2],a[4]=n[3],a[5]=0,a[6]=n[4],a[7]=n[5],a[8]=1,a}function H8(a,n){var r=n[0],s=n[1],l=n[2],u=n[3],h=r+r,f=s+s,d=l+l,v=r*h,p=s*h,g=s*f,y=l*h,m=l*f,b=l*d,x=u*h,E=u*f,w=u*d;return a[0]=1-g-b,a[3]=p-w,a[6]=y+E,a[1]=p+w,a[4]=1-v-b,a[7]=m-x,a[2]=y-E,a[5]=m+x,a[8]=1-v-g,a}function $8(a,n){var r=n[0],s=n[1],l=n[2],u=n[3],h=n[4],f=n[5],d=n[6],v=n[7],p=n[8],g=n[9],y=n[10],m=n[11],b=n[12],x=n[13],E=n[14],w=n[15],S=r*f-s*h,M=r*d-l*h,C=r*v-u*h,T=s*d-l*f,O=s*v-u*f,k=l*v-u*d,P=p*x-g*b,A=p*E-y*b,N=p*w-m*b,L=g*E-y*x,R=g*w-m*x,z=y*w-m*E,Z=S*z-M*R+C*L+T*N-O*A+k*P;return Z?(Z=1/Z,a[0]=(f*z-d*R+v*L)*Z,a[1]=(d*N-h*z-v*A)*Z,a[2]=(h*R-f*N+v*P)*Z,a[3]=(l*R-s*z-u*L)*Z,a[4]=(r*z-l*N+u*A)*Z,a[5]=(s*N-r*R-u*P)*Z,a[6]=(x*k-E*O+w*T)*Z,a[7]=(E*C-b*k-w*M)*Z,a[8]=(b*O-x*C+w*S)*Z,a):null}function U8(a,n,r){return a[0]=2/n,a[1]=0,a[2]=0,a[3]=0,a[4]=-2/r,a[5]=0,a[6]=-1,a[7]=1,a[8]=1,a}function Y8(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"}function X8(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]+a[3]*a[3]+a[4]*a[4]+a[5]*a[5]+a[6]*a[6]+a[7]*a[7]+a[8]*a[8])}function q8(a,n,r){return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a[2]=n[2]+r[2],a[3]=n[3]+r[3],a[4]=n[4]+r[4],a[5]=n[5]+r[5],a[6]=n[6]+r[6],a[7]=n[7]+r[7],a[8]=n[8]+r[8],a}function K8(a,n,r){return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],a[3]=n[3]-r[3],a[4]=n[4]-r[4],a[5]=n[5]-r[5],a[6]=n[6]-r[6],a[7]=n[7]-r[7],a[8]=n[8]-r[8],a}function Q8(a,n,r){return a[0]=n[0]*r,a[1]=n[1]*r,a[2]=n[2]*r,a[3]=n[3]*r,a[4]=n[4]*r,a[5]=n[5]*r,a[6]=n[6]*r,a[7]=n[7]*r,a[8]=n[8]*r,a}function J8(a,n,r,s){return a[0]=n[0]+r[0]*s,a[1]=n[1]+r[1]*s,a[2]=n[2]+r[2]*s,a[3]=n[3]+r[3]*s,a[4]=n[4]+r[4]*s,a[5]=n[5]+r[5]*s,a[6]=n[6]+r[6]*s,a[7]=n[7]+r[7]*s,a[8]=n[8]+r[8]*s,a}function t9(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]&&a[3]===n[3]&&a[4]===n[4]&&a[5]===n[5]&&a[6]===n[6]&&a[7]===n[7]&&a[8]===n[8]}function e9(a,n){var r=a[0],s=a[1],l=a[2],u=a[3],h=a[4],f=a[5],d=a[6],v=a[7],p=a[8],g=n[0],y=n[1],m=n[2],b=n[3],x=n[4],E=n[5],w=n[6],S=n[7],M=n[8];return Math.abs(r-g)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(s-y)<=glMatrix.EPSILON*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(l-m)<=glMatrix.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(u-b)<=glMatrix.EPSILON*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(h-x)<=glMatrix.EPSILON*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(f-E)<=glMatrix.EPSILON*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(d-w)<=glMatrix.EPSILON*Math.max(1,Math.abs(d),Math.abs(w))&&Math.abs(v-S)<=glMatrix.EPSILON*Math.max(1,Math.abs(v),Math.abs(S))&&Math.abs(p-M)<=glMatrix.EPSILON*Math.max(1,Math.abs(p),Math.abs(M))}var n9=null,r9=null;function an(){var a=new ot(4);return ot!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function i9(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function ea(a,n,r){r=r*.5;var s=Math.sin(r);return a[0]=s*n[0],a[1]=s*n[1],a[2]=s*n[2],a[3]=Math.cos(r),a}function a9(a,n){var r=Math.acos(n[3])*2,s=Math.sin(r/2);return s>glMatrix.EPSILON?(a[0]=n[0]/s,a[1]=n[1]/s,a[2]=n[2]/s):(a[0]=1,a[1]=0,a[2]=0),r}function s9(a,n){var r=Vw(a,n);return Math.acos(2*r*r-1)}function na(a,n,r){var s=n[0],l=n[1],u=n[2],h=n[3],f=r[0],d=r[1],v=r[2],p=r[3];return a[0]=s*p+h*f+l*v-u*d,a[1]=l*p+h*d+u*f-s*v,a[2]=u*p+h*v+s*d-l*f,a[3]=h*p-s*f-l*d-u*v,a}function o9(a,n,r){r*=.5;var s=n[0],l=n[1],u=n[2],h=n[3],f=Math.sin(r),d=Math.cos(r);return a[0]=s*d+h*f,a[1]=l*d+u*f,a[2]=u*d-l*f,a[3]=h*d-s*f,a}function l9(a,n,r){r*=.5;var s=n[0],l=n[1],u=n[2],h=n[3],f=Math.sin(r),d=Math.cos(r);return a[0]=s*d-u*f,a[1]=l*d+h*f,a[2]=u*d+s*f,a[3]=h*d-l*f,a}function c9(a,n,r){r*=.5;var s=n[0],l=n[1],u=n[2],h=n[3],f=Math.sin(r),d=Math.cos(r);return a[0]=s*d+l*f,a[1]=l*d-s*f,a[2]=u*d+h*f,a[3]=h*d-u*f,a}function u9(a,n){var r=n[0],s=n[1],l=n[2];return a[0]=r,a[1]=s,a[2]=l,a[3]=Math.sqrt(Math.abs(1-r*r-s*s-l*l)),a}function zw(a,n){var r=n[0],s=n[1],l=n[2],u=n[3],h=Math.sqrt(r*r+s*s+l*l),f=Math.exp(u),d=h>0?f*Math.sin(h)/h:0;return a[0]=r*d,a[1]=s*d,a[2]=l*d,a[3]=f*Math.cos(h),a}function Zw(a,n){var r=n[0],s=n[1],l=n[2],u=n[3],h=Math.sqrt(r*r+s*s+l*l),f=h>0?Math.atan2(h,u)/h:0;return a[0]=r*f,a[1]=s*f,a[2]=l*f,a[3]=.5*Math.log(r*r+s*s+l*l+u*u),a}function h9(a,n,r){return Zw(a,n),jw(a,a,r),zw(a,a),a}function Cf(a,n,r,s){var l=n[0],u=n[1],h=n[2],f=n[3],d=r[0],v=r[1],p=r[2],g=r[3],y,m,b,x,E;return m=l*d+u*v+h*p+f*g,m<0&&(m=-m,d=-d,v=-v,p=-p,g=-g),1-m>it?(y=Math.acos(m),b=Math.sin(y),x=Math.sin((1-s)*y)/b,E=Math.sin(s*y)/b):(x=1-s,E=s),a[0]=x*l+E*d,a[1]=x*u+E*v,a[2]=x*h+E*p,a[3]=x*f+E*g,a}function f9(a){var n=glMatrix.RANDOM(),r=glMatrix.RANDOM(),s=glMatrix.RANDOM(),l=Math.sqrt(1-n),u=Math.sqrt(n);return a[0]=l*Math.sin(2*Math.PI*r),a[1]=l*Math.cos(2*Math.PI*r),a[2]=u*Math.sin(2*Math.PI*s),a[3]=u*Math.cos(2*Math.PI*s),a}function Of(a,n){var r=n[0],s=n[1],l=n[2],u=n[3],h=r*r+s*s+l*l+u*u,f=h?1/h:0;return a[0]=-r*f,a[1]=-s*f,a[2]=-l*f,a[3]=u*f,a}function d9(a,n){return a[0]=-n[0],a[1]=-n[1],a[2]=-n[2],a[3]=n[3],a}function Gw(a,n){var r=n[0]+n[4]+n[8],s;if(r>0)s=Math.sqrt(r+1),a[3]=.5*s,s=.5/s,a[0]=(n[5]-n[7])*s,a[1]=(n[6]-n[2])*s,a[2]=(n[1]-n[3])*s;else{var l=0;n[4]>n[0]&&(l=1),n[8]>n[l*3+l]&&(l=2);var u=(l+1)%3,h=(l+2)%3;s=Math.sqrt(n[l*3+l]-n[u*3+u]-n[h*3+h]+1),a[l]=.5*s,s=.5/s,a[3]=(n[u*3+h]-n[h*3+u])*s,a[u]=(n[u*3+l]+n[l*3+u])*s,a[h]=(n[h*3+l]+n[l*3+h])*s}return a}function kc(a,n,r,s){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:Rt,u=Math.PI/360;n*=u,s*=u,r*=u;var h=Math.sin(n),f=Math.cos(n),d=Math.sin(r),v=Math.cos(r),p=Math.sin(s),g=Math.cos(s);switch(l){case"xyz":a[0]=h*v*g+f*d*p,a[1]=f*d*g-h*v*p,a[2]=f*v*p+h*d*g,a[3]=f*v*g-h*d*p;break;case"xzy":a[0]=h*v*g-f*d*p,a[1]=f*d*g-h*v*p,a[2]=f*v*p+h*d*g,a[3]=f*v*g+h*d*p;break;case"yxz":a[0]=h*v*g+f*d*p,a[1]=f*d*g-h*v*p,a[2]=f*v*p-h*d*g,a[3]=f*v*g+h*d*p;break;case"yzx":a[0]=h*v*g+f*d*p,a[1]=f*d*g+h*v*p,a[2]=f*v*p-h*d*g,a[3]=f*v*g-h*d*p;break;case"zxy":a[0]=h*v*g-f*d*p,a[1]=f*d*g+h*v*p,a[2]=f*v*p+h*d*g,a[3]=f*v*g-h*d*p;break;case"zyx":a[0]=h*v*g-f*d*p,a[1]=f*d*g+h*v*p,a[2]=f*v*p-h*d*g,a[3]=f*v*g+h*d*p;break;default:throw new Error("Unknown angle order "+l)}return a}function v9(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}var p9=lw,Ww=wo,_c=cw,zp=uw,g9=hw,Zp=na,jw=fw,Vw=gw,y9=yw,m9=dw,b9=null,x9=vw,E9=null,Pc=pw,w9=mw;function S9(a,n){return Math.abs(vec4.dot(a,n))>=1-glMatrix.EPSILON}var M9=function(){var a=j(),n=vt(1,0,0),r=vt(0,1,0);return function(s,l,u){var h=Qn(l,u);return h<-.999999?(Ms(a,n,l),bp(a)<1e-6&&Ms(a,r,l),Cr(a,a),ea(s,a,Math.PI),s):h>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(Ms(a,l,u),s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=1+h,Pc(s,s))}}(),T9=function(){var a=an(),n=an();return function(r,s,l,u,h,f){return Cf(a,s,h,f),Cf(n,l,u,f),Cf(r,a,n,2*f*(1-f)),r}}(),C9=function(){var a=Fp();return function(n,r,s,l){return a[0]=s[0],a[3]=s[1],a[6]=s[2],a[1]=l[0],a[4]=l[1],a[7]=l[2],a[2]=-r[0],a[5]=-r[1],a[8]=-r[2],Pc(n,Gw(n,a))}}();function kf(){var a=new ot(2);return ot!=Float32Array&&(a[0]=0,a[1]=0),a}function O9(a){var n=new glMatrix.ARRAY_TYPE(2);return n[0]=a[0],n[1]=a[1],n}function k9(a,n){var r=new glMatrix.ARRAY_TYPE(2);return r[0]=a,r[1]=n,r}function Hw(a,n){return a[0]=n[0],a[1]=n[1],a}function $w(a,n,r){return a[0]=n,a[1]=r,a}function _9(a,n,r){return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a}function P9(a,n,r){return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a}function A9(a,n,r){return a[0]=n[0]*r[0],a[1]=n[1]*r[1],a}function N9(a,n,r){return a[0]=n[0]/r[0],a[1]=n[1]/r[1],a}function R9(a,n){return a[0]=Math.ceil(n[0]),a[1]=Math.ceil(n[1]),a}function L9(a,n){return a[0]=Math.floor(n[0]),a[1]=Math.floor(n[1]),a}function D9(a,n,r){return a[0]=Math.min(n[0],r[0]),a[1]=Math.min(n[1],r[1]),a}function I9(a,n,r){return a[0]=Math.max(n[0],r[0]),a[1]=Math.max(n[1],r[1]),a}function B9(a,n){return a[0]=glMatrix.round(n[0]),a[1]=glMatrix.round(n[1]),a}function F9(a,n,r){return a[0]=n[0]*r,a[1]=n[1]*r,a}function z9(a,n,r,s){return a[0]=n[0]+r[0]*s,a[1]=n[1]+r[1]*s,a}function Z9(a,n){var r=n[0]-a[0],s=n[1]-a[1];return Math.sqrt(r*r+s*s)}function G9(a,n){var r=n[0]-a[0],s=n[1]-a[1];return r*r+s*s}function W9(a){var n=a[0],r=a[1];return Math.sqrt(n*n+r*r)}function j9(a){var n=a[0],r=a[1];return n*n+r*r}function V9(a,n){return a[0]=-n[0],a[1]=-n[1],a}function H9(a,n){return a[0]=1/n[0],a[1]=1/n[1],a}function Uw(a,n){var r=n[0],s=n[1],l=r*r+s*s;return l>0&&(l=1/Math.sqrt(l)),a[0]=n[0]*l,a[1]=n[1]*l,a}function Yw(a,n){return a[0]*n[0]+a[1]*n[1]}function $9(a,n,r){var s=n[0]*r[1]-n[1]*r[0];return a[0]=a[1]=0,a[2]=s,a}function U9(a,n,r,s){var l=n[0],u=n[1];return a[0]=l+s*(r[0]-l),a[1]=u+s*(r[1]-u),a}function Y9(a,n){n=n===void 0?1:n;var r=glMatrix.RANDOM()*2*Math.PI;return a[0]=Math.cos(r)*n,a[1]=Math.sin(r)*n,a}function X9(a,n,r){var s=n[0],l=n[1];return a[0]=r[0]*s+r[2]*l,a[1]=r[1]*s+r[3]*l,a}function q9(a,n,r){var s=n[0],l=n[1];return a[0]=r[0]*s+r[2]*l+r[4],a[1]=r[1]*s+r[3]*l+r[5],a}function K9(a,n,r){var s=n[0],l=n[1];return a[0]=r[0]*s+r[3]*l+r[6],a[1]=r[1]*s+r[4]*l+r[7],a}function Q9(a,n,r){var s=n[0],l=n[1];return a[0]=r[0]*s+r[4]*l+r[12],a[1]=r[1]*s+r[5]*l+r[13],a}function J9(a,n,r,s){var l=n[0]-r[0],u=n[1]-r[1],h=Math.sin(s),f=Math.cos(s);return a[0]=l*f-u*h+r[0],a[1]=l*h+u*f+r[1],a}function tz(a,n){var r=a[0],s=a[1],l=n[0],u=n[1];return Math.abs(Math.atan2(s*l-r*u,r*l+s*u))}function ez(a,n){var r=a[0],s=a[1],l=n[0],u=n[1];return Math.atan2(r*u-s*l,r*l+s*u)}function nz(a){return a[0]=0,a[1]=0,a}function rz(a){return"vec2("+a[0]+", "+a[1]+")"}function Xw(a,n){return a[0]===n[0]&&a[1]===n[1]}function iz(a,n){var r=a[0],s=a[1],l=n[0],u=n[1];return Math.abs(r-l)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(s-u)<=glMatrix.EPSILON*Math.max(1,Math.abs(s),Math.abs(u))}var az=null,sz=null,oz=null,lz=null,cz=null,uz=null,hz=null,fz=function(){var a=kf();return function(n,r,s,l,u,h){var f,d;for(r||(r=2),s||(s=0),l?d=Math.min(l*r+s,n.length):d=n.length,f=s;f<d;f+=r)a[0]=n[f],a[1]=n[f+1],u(a,a,h),n[f]=a[0],n[f+1]=a[1];return n}}(),se=Y(25897);function Jn(a,n){return Math.sqrt((a[0]-n[0])*(a[0]-n[0])+(a[1]-n[1])*(a[1]-n[1]))}var At=Y(95147),ve=Y(76714),qw=function(a,n,r){return a<n?n:a>r?r:a},Ze=qw,_=Y(97582),Mo={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function Gp(a){return Array.isArray(a)&&a.every(function(n){var r=n[0].toLowerCase();return Mo[r]===n.length-1&&"achlmqstvz".includes(r)})}function Wp(a){return Gp(a)&&a.every(function(n){var r=n[0];return r===r.toUpperCase()})}function jp(a){return Wp(a)&&a.every(function(n){var r=n[0];return"ACLMQZ".includes(r)})}var Vp={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function Hp(a){for(var n=a.pathValue[a.segmentStart],r=n.toLowerCase(),s=a.data;s.length>=Mo[r]&&(r==="m"&&s.length>2?(a.segments.push([n].concat(s.splice(0,2))),r="l",n=n==="m"?"l":"L"):a.segments.push([n].concat(s.splice(0,Mo[r]))),!!Mo[r]););}function Kw(a){var n=a.index,r=a.pathValue,s=r.charCodeAt(n);if(s===48){a.param=0,a.index+=1;return}if(s===49){a.param=1,a.index+=1;return}a.err='[path-util]: invalid Arc flag "'.concat(r[n],'", expecting 0 or 1 at index ').concat(n)}function Qw(a){return a>=48&&a<=57||a===43||a===45||a===46}function ks(a){return a>=48&&a<=57}function Jw(a){var n=a.max,r=a.pathValue,s=a.index,l=s,u=!1,h=!1,f=!1,d=!1,v;if(l>=n){a.err="[path-util]: Invalid path value at index ".concat(l,', "pathValue" is missing param');return}if(v=r.charCodeAt(l),(v===43||v===45)&&(l+=1,v=r.charCodeAt(l)),!ks(v)&&v!==46){a.err="[path-util]: Invalid path value at index ".concat(l,', "').concat(r[l],'" is not a number');return}if(v!==46){if(u=v===48,l+=1,v=r.charCodeAt(l),u&&l<n&&v&&ks(v)){a.err="[path-util]: Invalid path value at index ".concat(s,', "').concat(r[s],'" illegal number');return}for(;l<n&&ks(r.charCodeAt(l));)l+=1,h=!0;v=r.charCodeAt(l)}if(v===46){for(d=!0,l+=1;ks(r.charCodeAt(l));)l+=1,f=!0;v=r.charCodeAt(l)}if(v===101||v===69){if(d&&!h&&!f){a.err="[path-util]: Invalid path value at index ".concat(l,', "').concat(r[l],'" invalid float exponent');return}if(l+=1,v=r.charCodeAt(l),(v===43||v===45)&&(l+=1),l<n&&ks(r.charCodeAt(l)))for(;l<n&&ks(r.charCodeAt(l));)l+=1;else{a.err="[path-util]: Invalid path value at index ".concat(l,', "').concat(r[l],'" invalid integer exponent');return}}a.index=l,a.param=+a.pathValue.slice(s,l)}function tS(a){var n=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return a===10||a===13||a===8232||a===8233||a===32||a===9||a===11||a===12||a===160||a>=5760&&n.includes(a)}function Ac(a){for(var n=a.pathValue,r=a.max;a.index<r&&tS(n.charCodeAt(a.index));)a.index+=1}function eS(a){switch(a|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function nS(a){return(a|32)===97}function rS(a){var n=a.max,r=a.pathValue,s=a.index,l=r.charCodeAt(s),u=Mo[r[s].toLowerCase()];if(a.segmentStart=s,!eS(l)){a.err='[path-util]: Invalid path value "'.concat(r[s],'" is not a path command');return}if(a.index+=1,Ac(a),a.data=[],!u){Hp(a);return}for(;;){for(var h=u;h>0;h-=1){if(nS(l)&&(h===3||h===4)?Kw(a):Jw(a),a.err.length)return;a.data.push(a.param),Ac(a),a.index<n&&r.charCodeAt(a.index)===44&&(a.index+=1,Ac(a))}if(a.index>=a.max||!Qw(r.charCodeAt(a.index)))break}Hp(a)}var iS=function(){function a(n){this.pathValue=n,this.segments=[],this.max=n.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return a}();function aS(a){if(Gp(a))return[].concat(a);var n=new iS(a);for(Ac(n);n.index<n.max&&!n.err.length;)rS(n);return n.err?n.err:n.segments}function sS(a){if(Wp(a))return[].concat(a);var n=aS(a),r=0,s=0,l=0,u=0;return n.map(function(h){var f=h.slice(1).map(Number),d=h[0],v=d.toUpperCase();if(d==="M")return r=f[0],s=f[1],l=r,u=s,["M",r,s];var p;if(d!==v)switch(v){case"A":p=[v,f[0],f[1],f[2],f[3],f[4],f[5]+r,f[6]+s];break;case"V":p=[v,f[0]+s];break;case"H":p=[v,f[0]+r];break;default:{var g=f.map(function(m,b){return m+(b%2?s:r)});p=[v].concat(g)}}else p=[v].concat(f);var y=p.length;switch(v){case"Z":r=l,s=u;break;case"H":r=p[1];break;case"V":s=p[1];break;default:r=p[y-2],s=p[y-1],v==="M"&&(l=r,u=s)}return p})}function oS(a,n){var r=a[0],s=n.x1,l=n.y1,u=n.x2,h=n.y2,f=a.slice(1).map(Number),d=a;if("TQ".includes(r)||(n.qx=null,n.qy=null),r==="H")d=["L",a[1],l];else if(r==="V")d=["L",s,a[1]];else if(r==="S"){var v=s*2-u,p=l*2-h;n.x1=v,n.y1=p,d=["C",v,p].concat(f)}else if(r==="T"){var g=s*2-n.qx,y=l*2-n.qy;n.qx=g,n.qy=y,d=["Q",g,y].concat(f)}else if(r==="Q"){var m=f[0],b=f[1];n.qx=m,n.qy=b}return d}function Nc(a){if(jp(a))return[].concat(a);for(var n=sS(a),r=(0,_.pi)({},Vp),s=0;s<n.length;s+=1){n[s]=oS(n[s],r);var l=n[s],u=l.length;r.x1=+l[u-2],r.y1=+l[u-1],r.x2=+l[u-4]||r.x1,r.y2=+l[u-3]||r.y1}return n}function ra(a,n,r){var s=a[0],l=a[1],u=n[0],h=n[1];return[s+(u-s)*r,l+(h-l)*r]}function _f(a,n,r,s,l){var u=Jn([a,n],[r,s]),h={x:0,y:0};if(typeof l=="number")if(l<=0)h={x:a,y:n};else if(l>=u)h={x:r,y:s};else{var f=ra([a,n],[r,s],l/u),d=f[0],v=f[1];h={x:d,y:v}}return{length:u,point:h,min:{x:Math.min(a,r),y:Math.min(n,s)},max:{x:Math.max(a,r),y:Math.max(n,s)}}}function $p(a,n){var r=a.x,s=a.y,l=n.x,u=n.y,h=r*l+s*u,f=Math.sqrt((Math.pow(r,2)+Math.pow(s,2))*(Math.pow(l,2)+Math.pow(u,2))),d=r*u-s*l<0?-1:1,v=d*Math.acos(h/f);return v}function lS(a,n,r,s,l,u,h,f,d,v){var p=Math.abs,g=Math.sin,y=Math.cos,m=Math.sqrt,b=Math.PI,x=p(r),E=p(s),w=(l%360+360)%360,S=w*(b/180);if(a===f&&n===d)return{x:a,y:n};if(x===0||E===0)return _f(a,n,f,d,v).point;var M=(a-f)/2,C=(n-d)/2,T={x:y(S)*M+g(S)*C,y:-g(S)*M+y(S)*C},O=Math.pow(T.x,2)/Math.pow(x,2)+Math.pow(T.y,2)/Math.pow(E,2);O>1&&(x*=m(O),E*=m(O));var k=Math.pow(x,2)*Math.pow(E,2)-Math.pow(x,2)*Math.pow(T.y,2)-Math.pow(E,2)*Math.pow(T.x,2),P=Math.pow(x,2)*Math.pow(T.y,2)+Math.pow(E,2)*Math.pow(T.x,2),A=k/P;A=A<0?0:A;var N=(u!==h?1:-1)*m(A),L={x:N*(x*T.y/E),y:N*(-(E*T.x)/x)},R={x:y(S)*L.x-g(S)*L.y+(a+f)/2,y:g(S)*L.x+y(S)*L.y+(n+d)/2},z={x:(T.x-L.x)/x,y:(T.y-L.y)/E},Z=$p({x:1,y:0},z),X={x:(-T.x-L.x)/x,y:(-T.y-L.y)/E},nt=$p(z,X);!h&&nt>0?nt-=2*b:h&&nt<0&&(nt+=2*b),nt%=2*b;var K=Z+nt*v,rt=x*y(K),U=E*g(K),at={x:y(S)*rt-g(S)*U+R.x,y:g(S)*rt+y(S)*U+R.y};return at}function cS(a,n,r,s,l,u,h,f,d,v,p){var g,y=p.bbox,m=y===void 0?!0:y,b=p.length,x=b===void 0?!0:b,E=p.sampleSize,w=E===void 0?30:E,S=typeof v=="number",M=a,C=n,T=0,O=[M,C,T],k=[M,C],P=0,A={x:0,y:0},N=[{x:M,y:C}];S&&v<=0&&(A={x:M,y:C});for(var L=0;L<=w;L+=1){if(P=L/w,g=lS(a,n,r,s,l,u,h,f,d,P),M=g.x,C=g.y,m&&N.push({x:M,y:C}),x&&(T+=Jn(k,[M,C])),k=[M,C],S&&T>=v&&v>O[2]){var R=(T-v)/(T-O[2]);A={x:k[0]*(1-R)+O[0]*R,y:k[1]*(1-R)+O[1]*R}}O=[M,C,T]}return S&&v>=T&&(A={x:f,y:d}),{length:T,point:A,min:{x:Math.min.apply(null,N.map(function(z){return z.x})),y:Math.min.apply(null,N.map(function(z){return z.y}))},max:{x:Math.max.apply(null,N.map(function(z){return z.x})),y:Math.max.apply(null,N.map(function(z){return z.y}))}}}function uS(a,n,r,s,l,u,h,f,d){var v=1-d;return{x:Math.pow(v,3)*a+3*Math.pow(v,2)*d*r+3*v*Math.pow(d,2)*l+Math.pow(d,3)*h,y:Math.pow(v,3)*n+3*Math.pow(v,2)*d*s+3*v*Math.pow(d,2)*u+Math.pow(d,3)*f}}function Up(a,n,r,s,l,u,h,f,d,v){var p,g=v.bbox,y=g===void 0?!0:g,m=v.length,b=m===void 0?!0:m,x=v.sampleSize,E=x===void 0?10:x,w=typeof d=="number",S=a,M=n,C=0,T=[S,M,C],O=[S,M],k=0,P={x:0,y:0},A=[{x:S,y:M}];w&&d<=0&&(P={x:S,y:M});for(var N=0;N<=E;N+=1){if(k=N/E,p=uS(a,n,r,s,l,u,h,f,k),S=p.x,M=p.y,y&&A.push({x:S,y:M}),b&&(C+=Jn(O,[S,M])),O=[S,M],w&&C>=d&&d>T[2]){var L=(C-d)/(C-T[2]);P={x:O[0]*(1-L)+T[0]*L,y:O[1]*(1-L)+T[1]*L}}T=[S,M,C]}return w&&d>=C&&(P={x:h,y:f}),{length:C,point:P,min:{x:Math.min.apply(null,A.map(function(R){return R.x})),y:Math.min.apply(null,A.map(function(R){return R.y}))},max:{x:Math.max.apply(null,A.map(function(R){return R.x})),y:Math.max.apply(null,A.map(function(R){return R.y}))}}}function hS(a,n,r,s,l,u,h){var f=1-h;return{x:Math.pow(f,2)*a+2*f*h*r+Math.pow(h,2)*l,y:Math.pow(f,2)*n+2*f*h*s+Math.pow(h,2)*u}}function fS(a,n,r,s,l,u,h,f){var d,v=f.bbox,p=v===void 0?!0:v,g=f.length,y=g===void 0?!0:g,m=f.sampleSize,b=m===void 0?10:m,x=typeof h=="number",E=a,w=n,S=0,M=[E,w,S],C=[E,w],T=0,O={x:0,y:0},k=[{x:E,y:w}];x&&h<=0&&(O={x:E,y:w});for(var P=0;P<=b;P+=1){if(T=P/b,d=hS(a,n,r,s,l,u,T),E=d.x,w=d.y,p&&k.push({x:E,y:w}),y&&(S+=Jn(C,[E,w])),C=[E,w],x&&S>=h&&h>M[2]){var A=(S-h)/(S-M[2]);O={x:C[0]*(1-A)+M[0]*A,y:C[1]*(1-A)+M[1]*A}}M=[E,w,S]}return x&&h>=S&&(O={x:l,y:u}),{length:S,point:O,min:{x:Math.min.apply(null,k.map(function(N){return N.x})),y:Math.min.apply(null,k.map(function(N){return N.y}))},max:{x:Math.max.apply(null,k.map(function(N){return N.x})),y:Math.max.apply(null,k.map(function(N){return N.y}))}}}function Yp(a,n,r){for(var s,l,u,h,f,d,v=Nc(a),p=typeof n=="number",g,y=[],m,b=0,x=0,E=0,w=0,S,M=[],C=[],T=0,O={x:0,y:0},k=O,P=O,A=O,N=0,L=0,R=v.length;L<R;L+=1)S=v[L],m=S[0],g=m==="M",y=g?y:[b,x].concat(S.slice(1)),g?(E=S[1],w=S[2],O={x:E,y:w},k=O,T=0,p&&n<.001&&(A=O)):m==="L"?(s=_f(y[0],y[1],y[2],y[3],(n||0)-N),T=s.length,O=s.min,k=s.max,P=s.point):m==="A"?(l=cS(y[0],y[1],y[2],y[3],y[4],y[5],y[6],y[7],y[8],(n||0)-N,r||{}),T=l.length,O=l.min,k=l.max,P=l.point):m==="C"?(u=Up(y[0],y[1],y[2],y[3],y[4],y[5],y[6],y[7],(n||0)-N,r||{}),T=u.length,O=u.min,k=u.max,P=u.point):m==="Q"?(h=fS(y[0],y[1],y[2],y[3],y[4],y[5],(n||0)-N,r||{}),T=h.length,O=h.min,k=h.max,P=h.point):m==="Z"&&(y=[b,x,E,w],f=_f(y[0],y[1],y[2],y[3],(n||0)-N),T=f.length,O=f.min,k=f.max,P=f.point),p&&N<n&&N+T>=n&&(A=P),C.push(k),M.push(O),N+=T,d=m!=="Z"?S.slice(-2):[E,w],b=d[0],x=d[1];return p&&n>=N&&(A={x:b,y:x}),{length:N,point:A,min:{x:Math.min.apply(null,M.map(function(z){return z.x})),y:Math.min.apply(null,M.map(function(z){return z.y}))},max:{x:Math.max.apply(null,C.map(function(z){return z.x})),y:Math.max.apply(null,C.map(function(z){return z.y}))}}}function dS(a,n){return Yp(a,void 0,(0,_.pi)((0,_.pi)({},n),{bbox:!1,length:!0})).length}var Gr=Y(5199),Rc=function(a){if((0,Gr.Z)(a))return a.reduce(function(n,r){return Math.min(n,r)},a[0])};function Lc(a){if(!Array.isArray(a))return-1/0;var n=a.length;if(!n)return-1/0;for(var r=a[0],s=1;s<n;s++)r=Math.max(r,a[s]);return r}var vS=1e-5;function To(a,n,r){return r===void 0&&(r=vS),a===n||Math.abs(a-n)<r}var pS=function(a,n){return(a%n+n)%n},Xp=pS;function gS(a,n,r){if(a[r].length>7){a[r].shift();for(var s=a[r],l=r;s.length;)n[r]="A",a.splice(l+=1,0,["C"].concat(s.splice(0,6)));a.splice(r,1)}}function yS(a){return jp(a)&&a.every(function(n){var r=n[0];return"MC".includes(r)})}function Dc(a,n,r){var s=a*Math.cos(r)-n*Math.sin(r),l=a*Math.sin(r)+n*Math.cos(r);return{x:s,y:l}}function Pf(a,n,r,s,l,u,h,f,d,v){var p=a,g=n,y=r,m=s,b=f,x=d,E=Math.PI*120/180,w=Math.PI/180*(+l||0),S=[],M,C,T,O,k;if(v)C=v[0],T=v[1],O=v[2],k=v[3];else{M=Dc(p,g,-w),p=M.x,g=M.y,M=Dc(b,x,-w),b=M.x,x=M.y;var P=(p-b)/2,A=(g-x)/2,N=P*P/(y*y)+A*A/(m*m);N>1&&(N=Math.sqrt(N),y*=N,m*=N);var L=y*y,R=m*m,z=(u===h?-1:1)*Math.sqrt(Math.abs((L*R-L*A*A-R*P*P)/(L*A*A+R*P*P)));O=z*y*A/m+(p+b)/2,k=z*-m*P/y+(g+x)/2,C=Math.asin(((g-k)/m*Math.pow(10,9)>>0)/Math.pow(10,9)),T=Math.asin(((x-k)/m*Math.pow(10,9)>>0)/Math.pow(10,9)),C=p<O?Math.PI-C:C,T=b<O?Math.PI-T:T,C<0&&(C=Math.PI*2+C),T<0&&(T=Math.PI*2+T),h&&C>T&&(C-=Math.PI*2),!h&&T>C&&(T-=Math.PI*2)}var Z=T-C;if(Math.abs(Z)>E){var X=T,nt=b,K=x;T=C+E*(h&&T>C?1:-1),b=O+y*Math.cos(T),x=k+m*Math.sin(T),S=Pf(b,x,y,m,l,0,h,nt,K,[T,X,O,k])}Z=T-C;var rt=Math.cos(C),U=Math.sin(C),at=Math.cos(T),ht=Math.sin(T),pt=Math.tan(Z/4),Ct=4/3*y*pt,Zt=4/3*m*pt,Nt=[p,g],Pt=[p+Ct*U,g-Zt*rt],ie=[b+Ct*ht,x-Zt*at],Kt=[b,x];if(Pt[0]=2*Nt[0]-Pt[0],Pt[1]=2*Nt[1]-Pt[1],v)return Pt.concat(ie,Kt,S);S=Pt.concat(ie,Kt,S);for(var re=[],te=0,ze=S.length;te<ze;te+=1)re[te]=te%2?Dc(S[te-1],S[te],w).y:Dc(S[te],S[te+1],w).x;return re}function mS(a,n,r,s,l,u){var h=.3333333333333333,f=2/3;return[h*a+f*r,h*n+f*s,h*l+f*r,h*u+f*s,l,u]}var qp=function(a,n,r,s){var l=.5,u=ra([a,n],[r,s],l);return(0,_.ev)((0,_.ev)([],u,!0),[r,s,r,s],!1)};function bS(a,n){var r=a[0],s=a.slice(1).map(Number),l=s[0],u=s[1],h,f=n.x1,d=n.y1,v=n.x,p=n.y;switch("TQ".includes(r)||(n.qx=null,n.qy=null),r){case"M":return n.x=l,n.y=u,a;case"A":return h=[f,d].concat(s),["C"].concat(Pf(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8],h[9]));case"Q":return n.qx=l,n.qy=u,h=[f,d].concat(s),["C"].concat(mS(h[0],h[1],h[2],h[3],h[4],h[5]));case"L":return["C"].concat(qp(f,d,l,u));case"Z":return f===v&&d===p?["C",f,d,v,p,v,p]:["C"].concat(qp(f,d,v,p));default:}return a}function Af(a,n){if(n===void 0&&(n=!1),yS(a)){var r=[].concat(a);return n?[r,[]]:r}for(var s=Nc(a),l=(0,_.pi)({},Vp),u=[],h="",f=s.length,d,v,p=[],g=0;g<f;g+=1){s[g]&&(h=s[g][0]),u[g]=h;var y=bS(s[g],l);s[g]=y,gS(s,u,g),f=s.length,h==="Z"&&p.push(g),d=s[g],v=d.length,l.x1=+d[v-2],l.y1=+d[v-1],l.x2=+d[v-4]||l.x1,l.y2=+d[v-3]||l.y1}return n?[s,p]:s}var xS=50;function ES(a,n){n===void 0&&(n=.5);var r=a.slice(0,2),s=a.slice(2,4),l=a.slice(4,6),u=a.slice(6,8),h=ra(r,s,n),f=ra(s,l,n),d=ra(l,u,n),v=ra(h,f,n),p=ra(f,d,n),g=ra(v,p,n);return[["C"].concat(h,v,g),["C"].concat(p,d,u)]}function Kp(a){return a.map(function(n,r,s){var l=r&&s[r-1].slice(-2).concat(n.slice(1)),u=r?Up(l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],l[8],{bbox:!1}).length:0,h;return r?h=u?ES(l):[n,n]:h=[n],{s:n,ss:h,l:u}})}function Qp(a,n,r,s){if(s===void 0&&(s=0),s>xS)return console.warn("Maximum recursion depth reached in equalizeSegments"),[a,n];var l=Kp(a),u=Kp(n),h=l.length,f=u.length,d=l.filter(function(w){return w.l}).length,v=u.filter(function(w){return w.l}).length,p=l.filter(function(w){return w.l}).reduce(function(w,S){var M=S.l;return w+M},0)/d||0,g=u.filter(function(w){return w.l}).reduce(function(w,S){var M=S.l;return w+M},0)/v||0,y=r||Math.max(h,f),m=[p,g],b=[y-h,y-f],x=0,E=[l,u].map(function(w,S){return w.l===y?w.map(function(M){return M.s}):w.map(function(M,C){return x=C&&b[S]&&M.l>=m[S],b[S]-=x?1:0,x?M.ss:[M.s]}).flat()});return E[0].length===E[1].length?E:Qp(E[0],E[1],y,s+1)}function wS(a,n,r,s,l,u,h,f){return 3*((f-n)*(r+l)-(h-a)*(s+u)+s*(a-l)-r*(n-u)+f*(l+a/3)-h*(u+n/3))/20}function SS(a){var n=0,r=0,s=0;return Af(a).map(function(l){var u;switch(l[0]){case"M":return n=l[1],r=l[2],0;default:var h=l.slice(1),f=h[0],d=h[1],v=h[2],p=h[3],g=h[4],y=h[5];return s=wS(n,r,f,d,v,p,g,y),u=l.slice(-2),n=u[0],r=u[1],s}}).reduce(function(l,u){return l+u},0)}function Jp(a){return SS(a)>=0}function MS(a){var n=a.slice(1).map(function(r,s,l){return s?l[s-1].slice(-2).concat(r.slice(1)):a[0].slice(1).concat(r.slice(1))}).map(function(r){return r.map(function(s,l){return r[r.length-l-2*(1-l%2)]})}).reverse();return[["M"].concat(n[0].slice(0,2))].concat(n.map(function(r){return["C"].concat(r.slice(2))}))}function TS(a){return a.map(function(n){return Array.isArray(n)?[].concat(n):n})}function CS(a){var n=a.length,r=n-1;return a.map(function(s,l){return a.map(function(u,h){var f=l+h,d;return h===0||a[f]&&a[f][0]==="M"?(d=a[f],["M"].concat(d.slice(-2))):(f>=n&&(f-=r),a[f])})})}function OS(a,n){var r=a.length-1,s=[],l=0,u=0,h=CS(a);return h.forEach(function(f,d){a.slice(1).forEach(function(v,p){u+=Jn(a[(d+p)%r].slice(-2),n[p%r].slice(-2))}),s[d]=u,u=0}),l=s.indexOf(Math.min.apply(null,s)),h[l]}var kS=function(a){return a===void 0},Ft=kS,_S=Y(95456),PS=function(a){return(0,_S.Z)(a,"Boolean")},Co=PS,_t=Y(45607),Zn=Y(4637);function AS(a,n,r){return Yp(a,n,(0,_.pi)((0,_.pi)({},r),{bbox:!1,length:!0})).point}var St=Y(4942),tg=Y(61120);function NS(a,n){for(;!{}.hasOwnProperty.call(a,n)&&(a=(0,tg.Z)(a))!==null;);return a}function Nf(){return Nf=typeof Reflect!="undefined"&&Reflect.get?Reflect.get.bind():function(a,n,r){var s=NS(a,n);if(s){var l=Object.getOwnPropertyDescriptor(s,n);return l.get?l.get.call(arguments.length<3?a:r):l.value}},Nf.apply(null,arguments)}function eg(a,n,r,s){var l=Nf((0,tg.Z)(1&s?a.prototype:a),n,r);return 2&s&&typeof l=="function"?function(u){return l.apply(r,u)}:l}function Nn(a,n,r,s){var l=a-r,u=n-s;return Math.sqrt(l*l+u*u)}function Ic(a,n){var r=Math.min.apply(Math,(0,B.Z)(a)),s=Math.min.apply(Math,(0,B.Z)(n)),l=Math.max.apply(Math,(0,B.Z)(a)),u=Math.max.apply(Math,(0,B.Z)(n));return{x:r,y:s,width:l-r,height:u-s}}function ng(a){return(a+Math.PI*2)%(Math.PI*2)}function rg(a,n){var r=Math.abs(a);return n>0?r:r*-1}function RS(a,n,r,s,l,u){var h=r,f=s;if(h===0||f===0)return{x:a,y:n};for(var d=l-a,v=u-n,p=Math.abs(d),g=Math.abs(v),y=h*h,m=f*f,b=Math.PI/4,x=0,E=0,w=0;w<4;w++){x=h*Math.cos(b),E=f*Math.sin(b);var S=(y-m)*Math.pow(Math.cos(b),3)/h,M=(m-y)*Math.pow(Math.sin(b),3)/f,C=x-S,T=E-M,O=p-S,k=g-M,P=Math.hypot(T,C),A=Math.hypot(k,O),N=P*Math.asin((C*k-T*O)/(P*A)),L=N/Math.sqrt(y+m-x*x-E*E);b+=L,b=Math.min(Math.PI/2,Math.max(0,b))}return{x:a+rg(x,d),y:n+rg(E,v)}}function LS(a,n,r,s,l,u,h,f){return-1*r*Math.cos(l)*Math.sin(f)-s*Math.sin(l)*Math.cos(f)}function DS(a,n,r,s,l,u,h,f){return-1*r*Math.sin(l)*Math.sin(f)+s*Math.cos(l)*Math.cos(f)}function IS(a,n,r){return Math.atan(-n/a*Math.tan(r))}function BS(a,n,r){return Math.atan(n/(a*Math.tan(r)))}function FS(a,n,r,s,l,u){return r*Math.cos(l)*Math.cos(u)-s*Math.sin(l)*Math.sin(u)+a}function zS(a,n,r,s,l,u){return r*Math.sin(l)*Math.cos(u)+s*Math.cos(l)*Math.sin(u)+n}function ZS(a,n,r,s){var l=Math.atan2(s*a,r*n);return(l+Math.PI*2)%(Math.PI*2)}function ig(a,n,r){return{x:a*Math.cos(r),y:n*Math.sin(r)}}function ag(a,n,r){var s=Math.cos(r),l=Math.sin(r);return[a*s-n*l,a*l+n*s]}function GS(a,n,r,s,l,u,h){for(var f=IS(r,s,l),d=1/0,v=-1/0,p=[u,h],g=-Math.PI*2;g<=Math.PI*2;g+=Math.PI){var y=f+g;u<h?u<y&&y<h&&p.push(y):h<y&&y<u&&p.push(y)}for(var m=0;m<p.length;m++){var b=FS(a,n,r,s,l,p[m]);b<d&&(d=b),b>v&&(v=b)}for(var x=BS(r,s,l),E=1/0,w=-1/0,S=[u,h],M=-Math.PI*2;M<=Math.PI*2;M+=Math.PI){var C=x+M;u<h?u<C&&C<h&&S.push(C):h<C&&C<u&&S.push(C)}for(var T=0;T<S.length;T++){var O=zS(a,n,r,s,l,S[T]);O<E&&(E=O),O>w&&(w=O)}return{x:d,y:E,width:v-d,height:w-E}}function dz(a,n,r,s,l,u,h,f,d){var v=ag(f-a,d-n,-l),p=_slicedToArray(v,2),g=p[0],y=p[1],m=RS(0,0,r,s,g,y),b=ZS(r,s,m.x,m.y);b<u?m=ig(r,s,u):b>h&&(m=ig(r,s,h));var x=ag(m.x,m.y,l);return{x:x[0]+a,y:x[1]+n}}function vz(a,n,r,s,l,u,h,f){var d=(h-u)*f+u,v=LS(a,n,r,s,l,u,h,d),p=DS(a,n,r,s,l,u,h,d);return ng(Math.atan2(p,v))}var WS=1e-4;function sg(a,n,r,s,l,u){var h=-1,f=1/0,d=[r,s],v=20;u&&u>200&&(v=u/10);for(var p=1/v,g=p/10,y=0;y<=v;y++){var m=y*p,b=[l.apply(void 0,(0,B.Z)(a.concat([m]))),l.apply(void 0,(0,B.Z)(n.concat([m])))],x=Nn(d[0],d[1],b[0],b[1]);x<f&&(h=m,f=x)}if(h===0)return{x:a[0],y:n[0]};if(h===1){var E=a.length;return{x:a[E-1],y:n[E-1]}}f=1/0;for(var w=0;w<32&&!(g<WS);w++){var S=h-g,M=h+g,C=[l.apply(void 0,(0,B.Z)(a.concat([S]))),l.apply(void 0,(0,B.Z)(n.concat([S])))],T=Nn(d[0],d[1],C[0],C[1]);if(S>=0&&T<f)h=S,f=T;else{var O=[l.apply(void 0,(0,B.Z)(a.concat([M]))),l.apply(void 0,(0,B.Z)(n.concat([M])))],k=Nn(d[0],d[1],O[0],O[1]);M<=1&&k<f?(h=M,f=k):g*=.5}}return{x:l.apply(void 0,(0,B.Z)(a.concat([h]))),y:l.apply(void 0,(0,B.Z)(n.concat([h])))}}function jS(a,n){for(var r=0,s=a.length,l=0;l<s;l++){var u=a[l],h=n[l],f=a[(l+1)%s],d=n[(l+1)%s];r+=Nn(u,h,f,d)}return r/2}function pz(a,n,r,s){return Ic([a,r],[n,s])}function og(a,n,r,s){return Nn(a,n,r,s)}function ui(a,n,r,s,l){return{x:(1-l)*a+l*r,y:(1-l)*n+l*s}}function VS(a,n,r,s,l,u){var h=(r-a)*(l-a)+(s-n)*(u-n);if(h<0)return Nn(a,n,l,u);var f=(r-a)*(r-a)+(s-n)*(s-n);return h>f?Nn(r,s,l,u):lg(a,n,r,s,l,u)}function lg(a,n,r,s,l,u){var h=[r-a,s-n];if(Xw(h,[0,0]))return Math.sqrt((l-a)*(l-a)+(u-n)*(u-n));var f=[-h[1],h[0]];Uw(f,f);var d=[l-a,u-n];return Math.abs(Yw(d,f))}function gz(a,n,r,s){return Math.atan2(s-n,r-a)}function Ra(a,n,r,s,l){var u=1-l;return u*u*u*a+3*n*l*u*u+3*r*l*l*u+s*l*l*l}function cg(a,n,r,s,l){var u=1-l;return 3*(u*u*(n-a)+2*u*l*(r-n)+l*l*(s-r))}function ug(a,n,r,s){var l=-3*a+9*n-9*r+3*s,u=6*a-12*n+6*r,h=3*n-3*a,f=[],d,v,p;if(To(l,0))To(u,0)||(d=-h/u,d>=0&&d<=1&&f.push(d));else{var g=u*u-4*l*h;To(g,0)?f.push(-u/(2*l)):g>0&&(p=Math.sqrt(g),d=(-u+p)/(2*l),v=(-u-p)/(2*l),d>=0&&d<=1&&f.push(d),v>=0&&v<=1&&f.push(v))}return f}function HS(a,n,r,s,l,u,h,f,d){var v=Ra(a,r,l,h,d),p=Ra(n,s,u,f,d),g=ui(a,n,r,s,d),y=ui(r,s,l,u,d),m=ui(l,u,h,f,d),b=ui(g.x,g.y,y.x,y.y,d),x=ui(y.x,y.y,m.x,m.y,d);return[[a,n,g.x,g.y,b.x,b.y,v,p],[v,p,x.x,x.y,m.x,m.y,h,f]]}function Rf(a,n,r,s,l,u,h,f,d){if(d===0)return jS([a,r,l,h],[n,s,u,f]);var v=HS(a,n,r,s,l,u,h,f,.5),p=[].concat(_toConsumableArray(v[0]),[d-1]),g=[].concat(_toConsumableArray(v[1]),[d-1]);return Rf.apply(void 0,_toConsumableArray(p))+Rf.apply(void 0,_toConsumableArray(g))}function $S(a,n,r,s,l,u,h,f){for(var d=[a,h],v=[n,f],p=ug(a,r,l,h),g=ug(n,s,u,f),y=0;y<p.length;y++)d.push(Ra(a,r,l,h,p[y]));for(var m=0;m<g.length;m++)v.push(Ra(n,s,u,f,g[m]));return Ic(d,v)}function yz(a,n,r,s,l,u,h,f){return Rf(a,n,r,s,l,u,h,f,3)}function US(a,n,r,s,l,u,h,f,d,v,p){return sg([a,r,l,h],[n,s,u,f],d,v,Ra,p)}function hg(a,n,r,s,l,u,h,f,d,v,p){var g=US(a,n,r,s,l,u,h,f,d,v,p);return Nn(g.x,g.y,d,v)}function mz(a,n,r,s,l,u,h,f,d){return{x:Ra(a,r,l,h,d),y:Ra(n,s,u,f,d)}}function bz(a,n,r,s,l,u,h,f,d){var v=cg(a,r,l,h,d),p=cg(n,s,u,f,d);return ng(Math.atan2(p,v))}function fg(a){for(var n=0,r=[],s=0;s<a.length-1;s++){var l=a[s],u=a[s+1],h=Nn(l[0],l[1],u[0],u[1]),f={from:l,to:u,length:h};r.push(f),n+=h}return{segments:r,totalLength:n}}function dg(a){if(a.length<2)return 0;for(var n=0,r=0;r<a.length-1;r++){var s=a[r],l=a[r+1];n+=Nn(s[0],s[1],l[0],l[1])}return n}function vg(a,n){if(n>1||n<0||a.length<2)return null;var r=fg(a),s=r.segments,l=r.totalLength;if(l===0)return{x:a[0][0],y:a[0][1]};for(var u=0,h=null,f=0;f<s.length;f++){var d=s[f],v=d.from,p=d.to,g=d.length/l;if(n>=u&&n<=u+g){var y=(n-u)/g;h=ui(v[0],v[1],p[0],p[1],y);break}u+=g}return h}function pg(a,n){if(n>1||n<0||a.length<2)return 0;for(var r=fg(a),s=r.segments,l=r.totalLength,u=0,h=0,f=0;f<s.length;f++){var d=s[f],v=d.from,p=d.to,g=d.length/l;if(n>=u&&n<=u+g){h=Math.atan2(p[1]-v[1],p[0]-v[0]);break}u+=g}return h}function gg(a,n,r){for(var s=1/0,l=0;l<a.length-1;l++){var u=a[l],h=a[l+1],f=VS(u[0],u[1],h[0],h[1],n,r);f<s&&(s=f)}return s}function YS(a){for(var n=[],r=[],s=0;s<a.length;s++){var l=a[s];n.push(l[0]),r.push(l[1])}return Ic(n,r)}function XS(a){return dg(a)}function xz(a,n){return vg(a,n)}function Ez(a,n,r){return gg(a,n,r)}function wz(a,n){return pg(a,n)}function Bc(a){var n=a.slice(0);return a.length&&n.push(a[0]),n}function Sz(a){return YS(a)}function Mz(a){return dg(Bc(a))}function Tz(a,n){return vg(Bc(a),n)}function Cz(a,n,r){return gg(Bc(a),n,r)}function Oz(a,n){return pg(Bc(a),n)}function Oo(a,n,r,s){var l=1-s;return l*l*a+2*s*l*n+s*s*r}function yg(a,n,r){var s=a+r-2*n;if(To(s,0))return[.5];var l=(a-n)/s;return l<=1&&l>=0?[l]:[]}function qS(a,n,r,s,l,u,h){var f=Oo(a,r,l,h),d=Oo(n,s,u,h),v=ui(a,n,r,s,h),p=ui(r,s,l,u,h);return[[a,n,v.x,v.y,f,d],[f,d,p.x,p.y,l,u]]}function Lf(a,n,r,s,l,u,h){if(h===0)return(Nn(a,n,r,s)+Nn(r,s,l,u)+Nn(a,n,l,u))/2;var f=qS(a,n,r,s,l,u,.5),d=f[0],v=f[1];return d.push(h-1),v.push(h-1),Lf.apply(void 0,_toConsumableArray(d))+Lf.apply(void 0,_toConsumableArray(v))}function KS(a,n,r,s,l,u){var h=yg(a,r,l)[0],f=yg(n,s,u)[0],d=[a,l],v=[n,u];return h!==void 0&&d.push(Oo(a,r,l,h)),f!==void 0&&v.push(Oo(n,s,u,f)),Ic(d,v)}function kz(a,n,r,s,l,u){return Lf(a,n,r,s,l,u,3)}function QS(a,n,r,s,l,u,h,f){return sg([a,r,l],[n,s,u],h,f,Oo)}function JS(a,n,r,s,l,u,h,f){var d=QS(a,n,r,s,l,u,h,f);return Nn(d.x,d.y,h,f)}var Rn=Y(55850),ia=Y(15861),La=Y(37762),Da=Y(45987);var tM=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof Y.g!="undefined"?Y.g:typeof self!="undefined"?self:{},mg={exports:{}};(function(a,n){(function(r,s){a.exports=s()})(tM,function(){function r(T,O,k,P,A){s(T,O,k||0,P||T.length-1,A||u)}function s(T,O,k,P,A){for(;P>k;){if(P-k>600){var N=P-k+1,L=O-k+1,R=Math.log(N),z=.5*Math.exp(2*R/3),Z=.5*Math.sqrt(R*z*(N-z)/N)*(L-N/2<0?-1:1),X=Math.max(k,Math.floor(O-L*z/N+Z)),nt=Math.min(P,Math.floor(O+(N-L)*z/N+Z));s(T,O,X,nt,A)}var K=T[O],rt=k,U=P;for(l(T,k,O),A(T[P],K)>0&&l(T,k,P);rt<U;){for(l(T,rt,U),rt++,U--;A(T[rt],K)<0;)rt++;for(;A(T[U],K)>0;)U--}A(T[k],K)===0?l(T,k,U):(U++,l(T,U,P)),U<=O&&(k=U+1),O<=U&&(P=U-1)}}function l(T,O,k){var P=T[O];T[O]=T[k],T[k]=P}function u(T,O){return T<O?-1:T>O?1:0}var h=function(O){O===void 0&&(O=9),this._maxEntries=Math.max(4,O),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};h.prototype.all=function(){return this._all(this.data,[])},h.prototype.search=function(O){var k=this.data,P=[];if(!S(O,k))return P;for(var A=this.toBBox,N=[];k;){for(var L=0;L<k.children.length;L++){var R=k.children[L],z=k.leaf?A(R):R;S(O,z)&&(k.leaf?P.push(R):w(O,z)?this._all(R,P):N.push(R))}k=N.pop()}return P},h.prototype.collides=function(O){var k=this.data;if(!S(O,k))return!1;for(var P=[];k;){for(var A=0;A<k.children.length;A++){var N=k.children[A],L=k.leaf?this.toBBox(N):N;if(S(O,L)){if(k.leaf||w(O,L))return!0;P.push(N)}}k=P.pop()}return!1},h.prototype.load=function(O){if(!(O&&O.length))return this;if(O.length<this._minEntries){for(var k=0;k<O.length;k++)this.insert(O[k]);return this}var P=this._build(O.slice(),0,O.length-1,0);if(!this.data.children.length)this.data=P;else if(this.data.height===P.height)this._splitRoot(this.data,P);else{if(this.data.height<P.height){var A=this.data;this.data=P,P=A}this._insert(P,this.data.height-P.height-1,!0)}return this},h.prototype.insert=function(O){return O&&this._insert(O,this.data.height-1),this},h.prototype.clear=function(){return this.data=M([]),this},h.prototype.remove=function(O,k){if(!O)return this;for(var P=this.data,A=this.toBBox(O),N=[],L=[],R,z,Z;P||N.length;){if(P||(P=N.pop(),z=N[N.length-1],R=L.pop(),Z=!0),P.leaf){var X=f(O,P.children,k);if(X!==-1)return P.children.splice(X,1),N.push(P),this._condense(N),this}!Z&&!P.leaf&&w(P,A)?(N.push(P),L.push(R),R=0,z=P,P=P.children[0]):z?(R++,P=z.children[R],Z=!1):P=null}return this},h.prototype.toBBox=function(O){return O},h.prototype.compareMinX=function(O,k){return O.minX-k.minX},h.prototype.compareMinY=function(O,k){return O.minY-k.minY},h.prototype.toJSON=function(){return this.data},h.prototype.fromJSON=function(O){return this.data=O,this},h.prototype._all=function(O,k){for(var P=[];O;)O.leaf?k.push.apply(k,O.children):P.push.apply(P,O.children),O=P.pop();return k},h.prototype._build=function(O,k,P,A){var N=P-k+1,L=this._maxEntries,R;if(N<=L)return R=M(O.slice(k,P+1)),d(R,this.toBBox),R;A||(A=Math.ceil(Math.log(N)/Math.log(L)),L=Math.ceil(N/Math.pow(L,A-1))),R=M([]),R.leaf=!1,R.height=A;var z=Math.ceil(N/L),Z=z*Math.ceil(Math.sqrt(L));C(O,k,P,Z,this.compareMinX);for(var X=k;X<=P;X+=Z){var nt=Math.min(X+Z-1,P);C(O,X,nt,z,this.compareMinY);for(var K=X;K<=nt;K+=z){var rt=Math.min(K+z-1,nt);R.children.push(this._build(O,K,rt,A-1))}}return d(R,this.toBBox),R},h.prototype._chooseSubtree=function(O,k,P,A){for(;A.push(k),!(k.leaf||A.length-1===P);){for(var N=1/0,L=1/0,R=void 0,z=0;z<k.children.length;z++){var Z=k.children[z],X=m(Z),nt=x(O,Z)-X;nt<L?(L=nt,N=X<N?X:N,R=Z):nt===L&&X<N&&(N=X,R=Z)}k=R||k.children[0]}return k},h.prototype._insert=function(O,k,P){var A=P?O:this.toBBox(O),N=[],L=this._chooseSubtree(A,this.data,k,N);for(L.children.push(O),p(L,A);k>=0&&N[k].children.length>this._maxEntries;)this._split(N,k),k--;this._adjustParentBBoxes(A,N,k)},h.prototype._split=function(O,k){var P=O[k],A=P.children.length,N=this._minEntries;this._chooseSplitAxis(P,N,A);var L=this._chooseSplitIndex(P,N,A),R=M(P.children.splice(L,P.children.length-L));R.height=P.height,R.leaf=P.leaf,d(P,this.toBBox),d(R,this.toBBox),k?O[k-1].children.push(R):this._splitRoot(P,R)},h.prototype._splitRoot=function(O,k){this.data=M([O,k]),this.data.height=O.height+1,this.data.leaf=!1,d(this.data,this.toBBox)},h.prototype._chooseSplitIndex=function(O,k,P){for(var A,N=1/0,L=1/0,R=k;R<=P-k;R++){var z=v(O,0,R,this.toBBox),Z=v(O,R,P,this.toBBox),X=E(z,Z),nt=m(z)+m(Z);X<N?(N=X,A=R,L=nt<L?nt:L):X===N&&nt<L&&(L=nt,A=R)}return A||P-k},h.prototype._chooseSplitAxis=function(O,k,P){var A=O.leaf?this.compareMinX:g,N=O.leaf?this.compareMinY:y,L=this._allDistMargin(O,k,P,A),R=this._allDistMargin(O,k,P,N);L<R&&O.children.sort(A)},h.prototype._allDistMargin=function(O,k,P,A){O.children.sort(A);for(var N=this.toBBox,L=v(O,0,k,N),R=v(O,P-k,P,N),z=b(L)+b(R),Z=k;Z<P-k;Z++){var X=O.children[Z];p(L,O.leaf?N(X):X),z+=b(L)}for(var nt=P-k-1;nt>=k;nt--){var K=O.children[nt];p(R,O.leaf?N(K):K),z+=b(R)}return z},h.prototype._adjustParentBBoxes=function(O,k,P){for(var A=P;A>=0;A--)p(k[A],O)},h.prototype._condense=function(O){for(var k=O.length-1,P=void 0;k>=0;k--)O[k].children.length===0?k>0?(P=O[k-1].children,P.splice(P.indexOf(O[k]),1)):this.clear():d(O[k],this.toBBox)};function f(T,O,k){if(!k)return O.indexOf(T);for(var P=0;P<O.length;P++)if(k(T,O[P]))return P;return-1}function d(T,O){v(T,0,T.children.length,O,T)}function v(T,O,k,P,A){A||(A=M(null)),A.minX=1/0,A.minY=1/0,A.maxX=-1/0,A.maxY=-1/0;for(var N=O;N<k;N++){var L=T.children[N];p(A,T.leaf?P(L):L)}return A}function p(T,O){return T.minX=Math.min(T.minX,O.minX),T.minY=Math.min(T.minY,O.minY),T.maxX=Math.max(T.maxX,O.maxX),T.maxY=Math.max(T.maxY,O.maxY),T}function g(T,O){return T.minX-O.minX}function y(T,O){return T.minY-O.minY}function m(T){return(T.maxX-T.minX)*(T.maxY-T.minY)}function b(T){return T.maxX-T.minX+(T.maxY-T.minY)}function x(T,O){return(Math.max(O.maxX,T.maxX)-Math.min(O.minX,T.minX))*(Math.max(O.maxY,T.maxY)-Math.min(O.minY,T.minY))}function E(T,O){var k=Math.max(T.minX,O.minX),P=Math.max(T.minY,O.minY),A=Math.min(T.maxX,O.maxX),N=Math.min(T.maxY,O.maxY);return Math.max(0,A-k)*Math.max(0,N-P)}function w(T,O){return T.minX<=O.minX&&T.minY<=O.minY&&O.maxX<=T.maxX&&O.maxY<=T.maxY}function S(T,O){return O.minX<=T.maxX&&O.minY<=T.maxY&&O.maxX>=T.minX&&O.maxY>=T.minY}function M(T){return{children:T,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function C(T,O,k,P,A){for(var N=[O,k];N.length;)if(k=N.pop(),O=N.pop(),!(k-O<=P)){var L=O+Math.ceil((k-O)/P/2)*P;r(T,L,O,k,A),N.push(O,L,L,k)}}return h})})(mg);var eM=mg.exports,J=function(a){return a.GROUP="g",a.FRAGMENT="fragment",a.CIRCLE="circle",a.ELLIPSE="ellipse",a.IMAGE="image",a.RECT="rect",a.LINE="line",a.POLYLINE="polyline",a.POLYGON="polygon",a.TEXT="text",a.PATH="path",a.HTML="html",a.MESH="mesh",a}({}),Fc=function(a){return a[a.ZERO=0]="ZERO",a[a.NEGATIVE_ONE=1]="NEGATIVE_ONE",a}({}),aa=function(){function a(){(0,I.Z)(this,a),this.plugins=[]}return(0,D.Z)(a,[{key:"addRenderingPlugin",value:function(r){this.plugins.push(r),this.context.renderingPlugins.push(r)}},{key:"removeAllRenderingPlugins",value:function(){var r=this;this.plugins.forEach(function(s){var l=r.context.renderingPlugins.indexOf(s);l>=0&&r.context.renderingPlugins.splice(l,1)})}}])}(),nM=function(){function a(n){(0,I.Z)(this,a),this.clipSpaceNearZ=Fc.NEGATIVE_ONE,this.plugins=[],this.config=(0,$.Z)({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},n)}return(0,D.Z)(a,[{key:"registerPlugin",value:function(r){var s=this.plugins.findIndex(function(l){return l===r});s===-1&&this.plugins.push(r)}},{key:"unregisterPlugin",value:function(r){var s=this.plugins.findIndex(function(l){return l===r});s>-1&&this.plugins.splice(s,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(r){return this.plugins.find(function(s){return s.name===r})}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(r){Object.assign(this.config,r)}}])}(),Df=Jt,_s=Et,rM=Pn,iM=Ai,bg=Zr,If=ow,ke=function(){function a(){(0,I.Z)(this,a),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return(0,D.Z)(a,[{key:"update",value:function(r,s){_s(this.center,r),_s(this.halfExtents,s),If(this.min,this.center,this.halfExtents),Df(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(r,s){Df(this.center,s,r),bg(this.center,this.center,.5),If(this.halfExtents,s,r),bg(this.halfExtents,this.halfExtents,.5),_s(this.min,r),_s(this.max,s)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(r){if(!a.isEmpty(r)){if(a.isEmpty(this)){this.setMinMax(r.getMin(),r.getMax());return}var s=this.center,l=s[0],u=s[1],h=s[2],f=this.halfExtents,d=f[0],v=f[1],p=f[2],g=l-d,y=l+d,m=u-v,b=u+v,x=h-p,E=h+p,w=r.center,S=w[0],M=w[1],C=w[2],T=r.halfExtents,O=T[0],k=T[1],P=T[2],A=S-O,N=S+O,L=M-k,R=M+k,z=C-P,Z=C+P;A<g&&(g=A),N>y&&(y=N),L<m&&(m=L),R>b&&(b=R),z<x&&(x=z),Z>E&&(E=Z),s[0]=(g+y)*.5,s[1]=(m+b)*.5,s[2]=(x+E)*.5,f[0]=(y-g)*.5,f[1]=(b-m)*.5,f[2]=(E-x)*.5,this.min[0]=g,this.min[1]=m,this.min[2]=x,this.max[0]=y,this.max[1]=b,this.max[2]=E}}},{key:"setFromTransformedAABB",value:function(r,s){var l=this.center,u=this.halfExtents,h=r.center,f=r.halfExtents,d=s[0],v=s[4],p=s[8],g=s[1],y=s[5],m=s[9],b=s[2],x=s[6],E=s[10],w=Math.abs(d),S=Math.abs(v),M=Math.abs(p),C=Math.abs(g),T=Math.abs(y),O=Math.abs(m),k=Math.abs(b),P=Math.abs(x),A=Math.abs(E);l[0]=s[12]+d*h[0]+v*h[1]+p*h[2],l[1]=s[13]+g*h[0]+y*h[1]+m*h[2],l[2]=s[14]+b*h[0]+x*h[1]+E*h[2],u[0]=w*f[0]+S*f[1]+M*f[2],u[1]=C*f[0]+T*f[1]+O*f[2],u[2]=k*f[0]+P*f[1]+A*f[2],If(this.min,l,u),Df(this.max,l,u)}},{key:"intersects",value:function(r){var s=this.getMax(),l=this.getMin(),u=r.getMax(),h=r.getMin();return l[0]<=u[0]&&s[0]>=h[0]&&l[1]<=u[1]&&s[1]>=h[1]&&l[2]<=u[2]&&s[2]>=h[2]}},{key:"intersection",value:function(r){if(!this.intersects(r))return null;var s=new a,l=rM([0,0,0],this.getMin(),r.getMin()),u=iM([0,0,0],this.getMax(),r.getMax());return s.setMinMax(l,u),s}},{key:"getNegativeFarPoint",value:function(r){return r.pnVertexFlag===273?_s([0,0,0],this.min):r.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:r.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:r.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:r.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:r.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:r.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(r){return r.pnVertexFlag===273?_s([0,0,0],this.max):r.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:r.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:r.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:r.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:r.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:r.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(r){return!r||r.halfExtents[0]===0&&r.halfExtents[1]===0&&r.halfExtents[2]===0}}])}(),aM=function(){function a(n,r){(0,I.Z)(this,a),this.distance=n||0,this.normal=r||vt(0,1,0),this.updatePNVertexFlag()}return(0,D.Z)(a,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(r){return Qn(r,this.normal)-this.distance}},{key:"normalize",value:function(){var r=1/bp(this.normal);Zr(this.normal,this.normal,r),this.distance*=r}},{key:"intersectsLine",value:function(r,s,l){var u=this.distanceToPoint(r),h=this.distanceToPoint(s),f=u/(u-h),d=f>=0&&f<=1;return d&&l&&yo(l,r,s,f),d}}])}(),Ps=function(a){return a[a.OUTSIDE=4294967295]="OUTSIDE",a[a.INSIDE=0]="INSIDE",a[a.INDETERMINATE=2147483647]="INDETERMINATE",a}({}),sM=function(){function a(n){if((0,I.Z)(this,a),this.planes=[],n)this.planes=n;else for(var r=0;r<6;r++)this.planes.push(new aM)}return(0,D.Z)(a,[{key:"extractFromVPMatrix",value:function(r){var s=(0,W.Z)(r,16),l=s[0],u=s[1],h=s[2],f=s[3],d=s[4],v=s[5],p=s[6],g=s[7],y=s[8],m=s[9],b=s[10],x=s[11],E=s[12],w=s[13],S=s[14],M=s[15];Dt(this.planes[0].normal,f-l,g-d,x-y),this.planes[0].distance=M-E,Dt(this.planes[1].normal,f+l,g+d,x+y),this.planes[1].distance=M+E,Dt(this.planes[2].normal,f+u,g+v,x+m),this.planes[2].distance=M+w,Dt(this.planes[3].normal,f-u,g-v,x-m),this.planes[3].distance=M-w,Dt(this.planes[4].normal,f-h,g-p,x-b),this.planes[4].distance=M-S,Dt(this.planes[5].normal,f+h,g+p,x+b),this.planes[5].distance=M+S,this.planes.forEach(function(C){C.normalize(),C.updatePNVertexFlag()})}}])}(),wn=function(){function a(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;(0,I.Z)(this,a),this.x=0,this.y=0,this.x=n,this.y=r}return(0,D.Z)(a,[{key:"clone",value:function(){return new a(this.x,this.y)}},{key:"copyFrom",value:function(r){this.x=r.x,this.y=r.y}}])}(),As=function(){function a(n,r,s,l){(0,I.Z)(this,a),this.x=n,this.y=r,this.width=s,this.height=l,this.left=n,this.right=n+s,this.top=r,this.bottom=r+l}return(0,D.Z)(a,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(r){return new a(r.x,r.y,r.width,r.height)}},{key:"applyTransform",value:function(r,s){var l=wo(r.x,r.y,0,1),u=wo(r.x+r.width,r.y,0,1),h=wo(r.x,r.y+r.height,0,1),f=wo(r.x+r.width,r.y+r.height,0,1),d=li(),v=li(),p=li(),g=li();Ri(d,l,s),Ri(v,u,s),Ri(p,h,s),Ri(g,f,s);var y=Math.min(d[0],v[0],p[0],g[0]),m=Math.min(d[1],v[1],p[1],g[1]),b=Math.max(d[0],v[0],p[0],g[0]),x=Math.max(d[1],v[1],p[1],g[1]);return a.fromRect({x:y,y:m,width:b-y,height:x-m})}}])}(),Ee="Method not implemented.",Ns="Use document.documentElement instead.",oM="Cannot append a destroyed element.";function Rs(a){return a===void 0?0:a>360||a<-360?a%360:a}var Bf=j();function Gn(a){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return Array.isArray(a)&&a.length===3?s?et(a):Et(Bf,a):(0,se.Z)(a)?s?vt(a,n,r):Dt(Bf,a,n,r):s?vt(a[0],a[1]||n,a[2]||r):Dt(Bf,a[0],a[1]||n,a[2]||r)}var lM=Math.PI/180;function we(a){return a*lM}var cM=180/Math.PI;function tr(a){return a*cM}var uM=.9;function _z(a){return a%=400,a<0&&(a+=400),a*uM}function Pz(a){return a/360}function hM(a){return 360*a}var zc=Math.PI/2;function fM(a,n){var r=n[0],s=n[1],l=n[2],u=n[3],h=r*r,f=s*s,d=l*l,v=u*u,p=h+f+d+v,g=r*u-s*l;return g>.499995*p?(a[0]=zc,a[1]=2*Math.atan2(s,r),a[2]=0):g<-.499995*p?(a[0]=-zc,a[1]=2*Math.atan2(s,r),a[2]=0):(a[0]=Math.asin(2*(r*l-u*s)),a[1]=Math.atan2(2*(r*u+s*l),1-2*(d+v)),a[2]=Math.atan2(2*(r*s+l*u),1-2*(f+d))),a}function dM(a,n){var r,s,l=Os(j(),n),u=(0,W.Z)(l,3),h=u[0],f=u[1],d=u[2],v=Math.asin(-n[2]/h);return v<zc?v>-zc?(r=Math.atan2(n[6]/f,n[10]/d),s=Math.atan2(n[1]/h,n[0]/h)):(s=0,r=-Math.atan2(n[4]/f,n[5]/f)):(s=0,r=Math.atan2(n[4]/f,n[5]/f)),a[0]=r,a[1]=v,a[2]=s,a}function Ff(a,n){return n.length===16?dM(a,n):fM(a,n)}function vM(a,n,r,s,l){var u=Math.cos(a),h=Math.sin(a);return Fw(s*u,l*h,0,-s*h,l*u,0,n,r,1)}function pM(a,n,r,s,l,u,h){var f=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,d=2*u,v=r-n,p=s-l,g=d/v,y=d/p,m=(r+n)/v,b=(s+l)/p,x,E,w=h-u,S=h*u;return f?(x=-h/w,E=-S/w):(x=-(h+u)/w,E=-2*S/w),a[0]=g,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=y,a[6]=0,a[7]=0,a[8]=m,a[9]=b,a[10]=x,a[11]=-1,a[12]=0,a[13]=0,a[14]=E,a[15]=0,a}function xg(a){var n=a[0],r=a[1],s=a[3],l=a[4],u=Math.sqrt(n*n+r*r),h=Math.sqrt(s*s+l*l),f=n*l-r*s;if(f<0&&(n<l?u=-u:h=-h),u){var d=1/u;n*=d,r*=d}if(h){var v=1/h;s*=v,l*=v}var p=Math.atan2(r,n),g=tr(p);return[a[6],a[7],u,h,g]}var hi=Ce(),Wr=Ce(),ko=li(),It=[j(),j(),j()],Eg=j();function gM(a,n,r,s,l,u){if(!yM(hi,a)||(Ts(Wr,hi),Wr[3]=0,Wr[7]=0,Wr[11]=0,Wr[15]=1,Math.abs(Sp(Wr))<1e-8))return!1;var h=hi[3],f=hi[7],d=hi[11],v=hi[12],p=hi[13],g=hi[14],y=hi[15];if(h!==0||f!==0||d!==0){ko[0]=h,ko[1]=f,ko[2]=d,ko[3]=y;var m=ci(Wr,Wr);if(!m)return!1;wp(Wr,Wr),Ri(l,ko,Wr)}else l[0]=l[1]=l[2]=0,l[3]=1;if(n[0]=v,n[1]=p,n[2]=g,mM(It,hi),r[0]=ft(It[0]),Cr(It[0],It[0]),s[0]=Qn(It[0],It[1]),zf(It[1],It[1],It[0],1,-s[0]),r[1]=ft(It[1]),Cr(It[1],It[1]),s[0]/=r[1],s[1]=Qn(It[0],It[2]),zf(It[2],It[2],It[0],1,-s[1]),s[2]=Qn(It[1],It[2]),zf(It[2],It[2],It[1],1,-s[2]),r[2]=ft(It[2]),Cr(It[2],It[2]),s[1]/=r[2],s[2]/=r[2],Ms(Eg,It[1],It[2]),Qn(It[0],Eg)<0)for(var b=0;b<3;b++)r[b]*=-1,It[b][0]*=-1,It[b][1]*=-1,It[b][2]*=-1;return u[0]=.5*Math.sqrt(Math.max(1+It[0][0]-It[1][1]-It[2][2],0)),u[1]=.5*Math.sqrt(Math.max(1-It[0][0]+It[1][1]-It[2][2],0)),u[2]=.5*Math.sqrt(Math.max(1-It[0][0]-It[1][1]+It[2][2],0)),u[3]=.5*Math.sqrt(Math.max(1+It[0][0]+It[1][1]+It[2][2],0)),It[2][1]>It[1][2]&&(u[0]=-u[0]),It[0][2]>It[2][0]&&(u[1]=-u[1]),It[1][0]>It[0][1]&&(u[2]=-u[2]),!0}function yM(a,n){var r=n[15];if(r===0)return!1;for(var s=1/r,l=0;l<16;l++)a[l]=n[l]*s;return!0}function mM(a,n){a[0][0]=n[0],a[0][1]=n[1],a[0][2]=n[2],a[1][0]=n[4],a[1][1]=n[5],a[1][2]=n[6],a[2][0]=n[8],a[2][1]=n[9],a[2][2]=n[10]}function zf(a,n,r,s,l){a[0]=n[0]*s+r[0]*l,a[1]=n[1]*s+r[1]*l,a[2]=n[2]*s+r[2]*l}var Se=function(a){return a[a.ORBITING=0]="ORBITING",a[a.EXPLORING=1]="EXPLORING",a[a.TRACKING=2]="TRACKING",a}({}),Zf=function(a){return a[a.DEFAULT=0]="DEFAULT",a[a.ROTATIONAL=1]="ROTATIONAL",a[a.TRANSLATIONAL=2]="TRANSLATIONAL",a[a.CINEMATIC=3]="CINEMATIC",a}({}),Or=function(a){return a[a.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",a[a.PERSPECTIVE=1]="PERSPECTIVE",a}({}),wg={UPDATED:"updated"},Sg=2e-4,Mg=function(){function a(){(0,I.Z)(this,a),this.clipSpaceNearZ=Fc.NEGATIVE_ONE,this.eventEmitter=new q,this.matrix=Ce(),this.right=vt(1,0,0),this.up=vt(0,1,0),this.forward=vt(0,0,1),this.position=vt(0,0,1),this.focalPoint=vt(0,0,0),this.distanceVector=vt(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=Ce(),this.projectionMatrixInverse=Ce(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=Se.EXPLORING,this.trackingMode=Zf.DEFAULT,this.projectionMode=Or.PERSPECTIVE,this.frustum=new sM,this.orthoMatrix=Ce()}return(0,D.Z)(a,[{key:"isOrtho",value:function(){return this.projectionMode===Or.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(r){this.enableUpdate=r}},{key:"setType",value:function(r,s){return this.type=r,this.type===Se.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Se.TRACKING&&s!==void 0&&this.setTrackingMode(s),this}},{key:"setProjectionMode",value:function(r){return this.projectionMode=r,this}},{key:"setTrackingMode",value:function(r){if(this.type!==Se.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=r,this}},{key:"setWorldRotation",value:function(r){return this.rotateWorld=r,this._getAngles(),this}},{key:"getViewTransform",value:function(){return ci(Ce(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(r,s){var l=ta(Ce(),[r,s,0]);this.jitteredProjectionMatrix=An(Ce(),l,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(r){return this.matrix=r,this._update(),this}},{key:"setProjectionMatrix",value:function(r){this.projectionMatrix=r}},{key:"setFov",value:function(r){return this.setPerspective(this.near,this.far,r,this.aspect),this}},{key:"setAspect",value:function(r){return this.setPerspective(this.near,this.far,this.fov,r),this}},{key:"setNear",value:function(r){return this.projectionMode===Or.PERSPECTIVE?this.setPerspective(r,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,r,this.far),this}},{key:"setFar",value:function(r){return this.projectionMode===Or.PERSPECTIVE?this.setPerspective(this.near,r,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,r),this}},{key:"setViewOffset",value:function(r,s,l,u,h,f){return this.aspect=r/s,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=s,this.view.offsetX=l,this.view.offsetY=u,this.view.width=h,this.view.height=f,this.projectionMode===Or.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Or.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(r){return this.zoom=r,this.projectionMode===Or.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Or.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(r,s){var l=this.canvas.viewport2Canvas({x:s[0],y:s[1]}),u=l.x,h=l.y,f=this.roll;this.rotate(0,0,-f),this.setPosition(u,h),this.setFocalPoint(u,h),this.setZoom(r),this.rotate(0,0,f);var d=this.canvas.viewport2Canvas({x:s[0],y:s[1]}),v=d.x,p=d.y,g=vt(v-u,p-h,0),y=Qn(g,this.right)/ft(this.right),m=Qn(g,this.up)/ft(this.up),b=this.getPosition(),x=(0,W.Z)(b,2),E=x[0],w=x[1],S=this.getFocalPoint(),M=(0,W.Z)(S,2),C=M[0],T=M[1];return this.setPosition(E-y,w-m),this.setFocalPoint(C-y,T-m),this}},{key:"setPerspective",value:function(r,s,l,u){var h;this.projectionMode=Or.PERSPECTIVE,this.fov=l,this.near=r,this.far=s,this.aspect=u;var f=this.near*Math.tan(we(.5*this.fov))/this.zoom,d=2*f,v=this.aspect*d,p=-.5*v;if((h=this.view)!==null&&h!==void 0&&h.enabled){var g=this.view.fullWidth,y=this.view.fullHeight;p+=this.view.offsetX*v/g,f-=this.view.offsetY*d/y,v*=this.view.width/g,d*=this.view.height/y}return pM(this.projectionMatrix,p,p+v,f-d,f,r,this.far,this.clipSpaceNearZ===Fc.ZERO),ci(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(r,s,l,u,h,f){var d;this.projectionMode=Or.ORTHOGRAPHIC,this.rright=s,this.left=r,this.top=l,this.bottom=u,this.near=h,this.far=f;var v=(this.rright-this.left)/(2*this.zoom),p=(this.top-this.bottom)/(2*this.zoom),g=(this.rright+this.left)/2,y=(this.top+this.bottom)/2,m=g-v,b=g+v,x=y+p,E=y-p;if((d=this.view)!==null&&d!==void 0&&d.enabled){var w=(this.rright-this.left)/this.view.fullWidth/this.zoom,S=(this.top-this.bottom)/this.view.fullHeight/this.zoom;m+=w*this.view.offsetX,b=m+w*this.view.width,x-=S*this.view.offsetY,E=x-S*this.view.height}return this.clipSpaceNearZ===Fc.NEGATIVE_ONE?Rp(this.projectionMatrix,m,b,x,E,h,f):Lp(this.projectionMatrix,m,b,x,E,h,f),ci(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.position[1],l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.position[2],u=Gn(r,s,l);return this._setPosition(u),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.focalPoint[1],l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.focalPoint[2],u=vt(0,1,0);if(this.focalPoint=Gn(r,s,l),this.trackingMode===Zf.CINEMATIC){var h=Ht(j(),this.focalPoint,this.position);r=h[0],s=h[1],l=h[2];var f=ft(h),d=tr(Math.asin(s/f)),v=90+tr(Math.atan2(l,r)),p=Ce();Cp(p,p,we(v)),Tp(p,p,we(d)),u=dn(j(),[0,1,0],p)}return ci(this.matrix,Dp(Ce(),this.position,this.focalPoint,u)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(r){if(this.distance===r||r<0)return this;this.distance=r,this.distance<Sg&&(this.distance=Sg),this.dollyingStep=this.distance/100;var s=j();r=this.distance;var l=this.forward,u=this.focalPoint;return s[0]=r*l[0]+u[0],s[1]=r*l[1]+u[1],s[2]=r*l[2]+u[2],this._setPosition(s),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(r){return this.maxDistance=r,this}},{key:"setMinDistance",value:function(r){return this.minDistance=r,this}},{key:"setAzimuth",value:function(r){return this.azimuth=Rs(r),this.computeMatrix(),this._getAxes(),this.type===Se.ORBITING||this.type===Se.EXPLORING?this._getPosition():this.type===Se.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(r){return this.elevation=Rs(r),this.computeMatrix(),this._getAxes(),this.type===Se.ORBITING||this.type===Se.EXPLORING?this._getPosition():this.type===Se.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(r){return this.roll=Rs(r),this.computeMatrix(),this._getAxes(),this.type===Se.ORBITING||this.type===Se.EXPLORING?this._getPosition():this.type===Se.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var r=ea(an(),[0,0,1],we(this.roll));Ji(this.matrix);var s=ea(an(),[1,0,0],we((this.rotateWorld&&this.type!==Se.TRACKING||this.type===Se.TRACKING?1:-1)*this.elevation)),l=ea(an(),[0,1,0],we((this.rotateWorld&&this.type!==Se.TRACKING||this.type===Se.TRACKING?1:-1)*this.azimuth)),u=na(an(),l,s);u=na(an(),u,r);var h=Mf(Ce(),u);this.type===Se.ORBITING||this.type===Se.EXPLORING?(Cs(this.matrix,this.matrix,this.focalPoint),An(this.matrix,this.matrix,h),Cs(this.matrix,this.matrix,[0,0,this.distance])):this.type===Se.TRACKING&&(Cs(this.matrix,this.matrix,this.position),An(this.matrix,this.matrix,h))}},{key:"_setPosition",value:function(r,s,l){this.position=Gn(r,s,l);var u=this.matrix;u[12]=this.position[0],u[13]=this.position[1],u[14]=this.position[2],u[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){Et(this.right,Gn(Ri(li(),[1,0,0,0],this.matrix))),Et(this.up,Gn(Ri(li(),[0,1,0,0],this.matrix))),Et(this.forward,Gn(Ri(li(),[0,0,1,0],this.matrix))),Cr(this.right,this.right),Cr(this.up,this.up),Cr(this.forward,this.forward)}},{key:"_getAngles",value:function(){var r=this.distanceVector[0],s=this.distanceVector[1],l=this.distanceVector[2],u=ft(this.distanceVector);if(u===0){this.elevation=0,this.azimuth=0;return}this.type===Se.TRACKING?(this.elevation=tr(Math.asin(s/u)),this.azimuth=tr(Math.atan2(-r,-l))):this.rotateWorld?(this.elevation=tr(Math.asin(s/u)),this.azimuth=tr(Math.atan2(-r,-l))):(this.elevation=-tr(Math.asin(s/u)),this.azimuth=-tr(Math.atan2(-r,-l)))}},{key:"_getPosition",value:function(){Et(this.position,Gn(Ri(li(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){Mc(this.distanceVector,[0,0,-this.distance],Bw(Fp(),this.matrix)),Jt(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=Ht(j(),this.focalPoint,this.position),this.distance=ft(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===Or.ORTHOGRAPHIC){var r=this.position,s=ea(an(),[0,0,1],-this.roll*Math.PI/180);So(this.orthoMatrix,s,vt((this.rright-this.left)/2-r[0],(this.top-this.bottom)/2-r[1],0),vt(this.zoom,this.zoom,1),r)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var r=this.getViewTransform(),s=An(Ce(),this.getPerspective(),r);this.getFrustum().extractFromVPMatrix(s),this.eventEmitter.emit(wg.UPDATED)}}},{key:"rotate",value:function(r,s,l){throw new Error(Ee)}},{key:"pan",value:function(r,s){throw new Error(Ee)}},{key:"dolly",value:function(r){throw new Error(Ee)}},{key:"createLandmark",value:function(r,s){throw new Error(Ee)}},{key:"gotoLandmark",value:function(r,s){throw new Error(Ee)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(Ee)}}])}(),bM=function(a){return a[a.Standard=0]="Standard",a}({}),Zc=function(a){return a[a.ADDED=0]="ADDED",a[a.REMOVED=1]="REMOVED",a[a.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",a}({}),xM=j(),_o=Ce(),EM=an();function Tg(a){if(a.localDirtyFlag){var n=a.localSkew[0]!==0||a.localSkew[1]!==0;if(n){So(a.localTransform,a.localRotation,a.localPosition,vt(1,1,1),a.origin),(a.localSkew[0]!==0||a.localSkew[1]!==0)&&(Ji(_o),_o[4]=Math.tan(a.localSkew[0]),_o[1]=Math.tan(a.localSkew[1]),An(a.localTransform,a.localTransform,_o));var r=So(_o,zp(EM,0,0,0,1),Dt(xM,1,1,1),a.localScale,a.origin);An(a.localTransform,a.localTransform,r)}else{var s=a.localTransform,l=a.localPosition,u=a.localRotation,h=a.localScale,f=a.origin,d=l[0]!==0||l[1]!==0||l[2]!==0,v=u[3]!==1||u[0]!==0||u[1]!==0||u[2]!==0,p=h[0]!==1||h[1]!==1||h[2]!==1,g=f[0]!==0||f[1]!==0||f[2]!==0;!v&&!p&&!g?d?ta(s,l):Ji(s):So(s,u,l,h,f)}a.localDirtyFlag=!1}}function wM(a,n){a.dirtyFlag&&(n?An(a.worldTransform,n.worldTransform,a.localTransform):Ts(a.worldTransform,a.localTransform),a.dirtyFlag=!1)}var Cg={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new As(0,0,0,0)},mt=function(a){return a.COORDINATE="<coordinate>",a.COLOR="<color>",a.PAINT="<paint>",a.NUMBER="<number>",a.ANGLE="<angle>",a.OPACITY_VALUE="<opacity-value>",a.SHADOW_BLUR="<shadow-blur>",a.LENGTH="<length>",a.PERCENTAGE="<percentage>",a.LENGTH_PERCENTAGE="<length> | <percentage>",a.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",a.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",a.LIST_OF_POINTS="<list-of-points>",a.PATH="<path>",a.FILTER="<filter>",a.Z_INDEX="<z-index>",a.OFFSET_DISTANCE="<offset-distance>",a.DEFINED_PATH="<defined-path>",a.MARKER="<marker>",a.TRANSFORM="<transform>",a.TRANSFORM_ORIGIN="<transform-origin>",a.TEXT="<text>",a.TEXT_TRANSFORM="<text-transform>",a}({});function Gf(a,n,r){a.prototype=n.prototype=r,r.constructor=a}function Og(a,n){var r=Object.create(a.prototype);for(var s in n)r[s]=n[s];return r}function Po(){}var Ao=.7,Gc=1/Ao,Ls="\\s*([+-]?\\d+)\\s*",No="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",fi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",SM=/^#([0-9a-f]{3,8})$/,MM=new RegExp(`^rgb\\(${Ls},${Ls},${Ls}\\)$`),TM=new RegExp(`^rgb\\(${fi},${fi},${fi}\\)$`),CM=new RegExp(`^rgba\\(${Ls},${Ls},${Ls},${No}\\)$`),OM=new RegExp(`^rgba\\(${fi},${fi},${fi},${No}\\)$`),kM=new RegExp(`^hsl\\(${No},${fi},${fi}\\)$`),_M=new RegExp(`^hsla\\(${No},${fi},${fi},${No}\\)$`),kg={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Gf(Po,Wc,{copy(a){return Object.assign(new this.constructor,this,a)},displayable(){return this.rgb().displayable()},hex:_g,formatHex:_g,formatHex8:PM,formatHsl:AM,formatRgb:Pg,toString:Pg});function _g(){return this.rgb().formatHex()}function PM(){return this.rgb().formatHex8()}function AM(){return Dg(this).formatHsl()}function Pg(){return this.rgb().formatRgb()}function Wc(a){var n,r;return a=(a+"").trim().toLowerCase(),(n=SM.exec(a))?(r=n[1].length,n=parseInt(n[1],16),r===6?Ag(n):r===3?new er(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):r===8?jc(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):r===4?jc(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=MM.exec(a))?new er(n[1],n[2],n[3],1):(n=TM.exec(a))?new er(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=CM.exec(a))?jc(n[1],n[2],n[3],n[4]):(n=OM.exec(a))?jc(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=kM.exec(a))?Lg(n[1],n[2]/100,n[3]/100,1):(n=_M.exec(a))?Lg(n[1],n[2]/100,n[3]/100,n[4]):kg.hasOwnProperty(a)?Ag(kg[a]):a==="transparent"?new er(NaN,NaN,NaN,0):null}function Ag(a){return new er(a>>16&255,a>>8&255,a&255,1)}function jc(a,n,r,s){return s<=0&&(a=n=r=NaN),new er(a,n,r,s)}function NM(a){return a instanceof Po||(a=Wc(a)),a?(a=a.rgb(),new er(a.r,a.g,a.b,a.opacity)):new er}function RM(a,n,r,s){return arguments.length===1?NM(a):new er(a,n,r,s==null?1:s)}function er(a,n,r,s){this.r=+a,this.g=+n,this.b=+r,this.opacity=+s}Gf(er,RM,Og(Po,{brighter(a){return a=a==null?Gc:Math.pow(Gc,a),new er(this.r*a,this.g*a,this.b*a,this.opacity)},darker(a){return a=a==null?Ao:Math.pow(Ao,a),new er(this.r*a,this.g*a,this.b*a,this.opacity)},rgb(){return this},clamp(){return new er(Ia(this.r),Ia(this.g),Ia(this.b),Vc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ng,formatHex:Ng,formatHex8:LM,formatRgb:Rg,toString:Rg}));function Ng(){return`#${Ba(this.r)}${Ba(this.g)}${Ba(this.b)}`}function LM(){return`#${Ba(this.r)}${Ba(this.g)}${Ba(this.b)}${Ba((isNaN(this.opacity)?1:this.opacity)*255)}`}function Rg(){const a=Vc(this.opacity);return`${a===1?"rgb(":"rgba("}${Ia(this.r)}, ${Ia(this.g)}, ${Ia(this.b)}${a===1?")":`, ${a})`}`}function Vc(a){return isNaN(a)?1:Math.max(0,Math.min(1,a))}function Ia(a){return Math.max(0,Math.min(255,Math.round(a)||0))}function Ba(a){return a=Ia(a),(a<16?"0":"")+a.toString(16)}function Lg(a,n,r,s){return s<=0?a=n=r=NaN:r<=0||r>=1?a=n=NaN:n<=0&&(a=NaN),new jr(a,n,r,s)}function Dg(a){if(a instanceof jr)return new jr(a.h,a.s,a.l,a.opacity);if(a instanceof Po||(a=Wc(a)),!a)return new jr;if(a instanceof jr)return a;a=a.rgb();var n=a.r/255,r=a.g/255,s=a.b/255,l=Math.min(n,r,s),u=Math.max(n,r,s),h=NaN,f=u-l,d=(u+l)/2;return f?(n===u?h=(r-s)/f+(r<s)*6:r===u?h=(s-n)/f+2:h=(n-r)/f+4,f/=d<.5?u+l:2-u-l,h*=60):f=d>0&&d<1?0:h,new jr(h,f,d,a.opacity)}function DM(a,n,r,s){return arguments.length===1?Dg(a):new jr(a,n,r,s==null?1:s)}function jr(a,n,r,s){this.h=+a,this.s=+n,this.l=+r,this.opacity=+s}Gf(jr,DM,Og(Po,{brighter(a){return a=a==null?Gc:Math.pow(Gc,a),new jr(this.h,this.s,this.l*a,this.opacity)},darker(a){return a=a==null?Ao:Math.pow(Ao,a),new jr(this.h,this.s,this.l*a,this.opacity)},rgb(){var a=this.h%360+(this.h<0)*360,n=isNaN(a)||isNaN(this.s)?0:this.s,r=this.l,s=r+(r<.5?r:1-r)*n,l=2*r-s;return new er(Wf(a>=240?a-240:a+120,l,s),Wf(a,l,s),Wf(a<120?a+240:a-120,l,s),this.opacity)},clamp(){return new jr(Ig(this.h),Hc(this.s),Hc(this.l),Vc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const a=Vc(this.opacity);return`${a===1?"hsl(":"hsla("}${Ig(this.h)}, ${Hc(this.s)*100}%, ${Hc(this.l)*100}%${a===1?")":`, ${a})`}`}}));function Ig(a){return a=(a||0)%360,a<0?a+360:a}function Hc(a){return Math.max(0,Math.min(1,a||0))}function Wf(a,n,r){return(a<60?n+(r-n)*a/60:a<180?r:a<240?n+(r-n)*(240-a)/60:n)*255}function Ke(a,n){if(typeof a!="function"||n!=null&&typeof n!="function")throw new TypeError("Expected a function");var r=function(){for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];var f=n?n.apply(this,u):u[0],d=r.cache;if(d.has(f))return d.get(f);var v=a.apply(this,u);return r.cache=d.set(f,v)||d,v};return r.cache=new(Ke.Cache||Map),Ke.cacheList.push(r.cache),r}Ke.Cache=Map,Ke.cacheList=[],Ke.clearCache=function(){Ke.cacheList.forEach(function(a){return a.clear()})};var bt=function(a){return a[a.kUnknown=0]="kUnknown",a[a.kNumber=1]="kNumber",a[a.kPercentage=2]="kPercentage",a[a.kEms=3]="kEms",a[a.kPixels=4]="kPixels",a[a.kRems=5]="kRems",a[a.kDegrees=6]="kDegrees",a[a.kRadians=7]="kRadians",a[a.kGradians=8]="kGradians",a[a.kTurns=9]="kTurns",a[a.kMilliseconds=10]="kMilliseconds",a[a.kSeconds=11]="kSeconds",a[a.kInteger=12]="kInteger",a}({}),Vr=function(a){return a[a.kUNumber=0]="kUNumber",a[a.kUPercent=1]="kUPercent",a[a.kULength=2]="kULength",a[a.kUAngle=3]="kUAngle",a[a.kUTime=4]="kUTime",a[a.kUOther=5]="kUOther",a}({}),IM=function(a){return a[a.kYes=0]="kYes",a[a.kNo=1]="kNo",a}({}),BM=function(a){return a[a.kYes=0]="kYes",a[a.kNo=1]="kNo",a}({}),FM=[{name:"em",unit_type:bt.kEms},{name:"px",unit_type:bt.kPixels},{name:"deg",unit_type:bt.kDegrees},{name:"rad",unit_type:bt.kRadians},{name:"grad",unit_type:bt.kGradians},{name:"ms",unit_type:bt.kMilliseconds},{name:"s",unit_type:bt.kSeconds},{name:"rem",unit_type:bt.kRems},{name:"turn",unit_type:bt.kTurns}],Ds=function(a){return a[a.kUnknownType=0]="kUnknownType",a[a.kUnparsedType=1]="kUnparsedType",a[a.kKeywordType=2]="kKeywordType",a[a.kUnitType=3]="kUnitType",a[a.kSumType=4]="kSumType",a[a.kProductType=5]="kProductType",a[a.kNegateType=6]="kNegateType",a[a.kInvertType=7]="kInvertType",a[a.kMinType=8]="kMinType",a[a.kMaxType=9]="kMaxType",a[a.kClampType=10]="kClampType",a[a.kTransformType=11]="kTransformType",a[a.kPositionType=12]="kPositionType",a[a.kURLImageType=13]="kURLImageType",a[a.kColorType=14]="kColorType",a[a.kUnsupportedColorType=15]="kUnsupportedColorType",a}({}),zM=function(n){return FM.find(function(r){return r.name===n}).unit_type},ZM=function(n){return n?n==="number"?bt.kNumber:n==="percent"||n==="%"?bt.kPercentage:zM(n):bt.kUnknown},GM=function(n){switch(n){case bt.kNumber:case bt.kInteger:return Vr.kUNumber;case bt.kPercentage:return Vr.kUPercent;case bt.kPixels:return Vr.kULength;case bt.kMilliseconds:case bt.kSeconds:return Vr.kUTime;case bt.kDegrees:case bt.kRadians:case bt.kGradians:case bt.kTurns:return Vr.kUAngle;default:return Vr.kUOther}},WM=function(n){switch(n){case Vr.kUNumber:return bt.kNumber;case Vr.kULength:return bt.kPixels;case Vr.kUPercent:return bt.kPercentage;case Vr.kUTime:return bt.kSeconds;case Vr.kUAngle:return bt.kDegrees;default:return bt.kUnknown}},Bg=function(n){var r=1;switch(n){case bt.kPixels:case bt.kDegrees:case bt.kSeconds:break;case bt.kMilliseconds:r=.001;break;case bt.kRadians:r=180/Math.PI;break;case bt.kGradians:r=.9;break;case bt.kTurns:r=360;break}return r},jf=function(n){switch(n){case bt.kNumber:case bt.kInteger:return"";case bt.kPercentage:return"%";case bt.kEms:return"em";case bt.kRems:return"rem";case bt.kPixels:return"px";case bt.kDegrees:return"deg";case bt.kRadians:return"rad";case bt.kGradians:return"grad";case bt.kMilliseconds:return"ms";case bt.kSeconds:return"s";case bt.kTurns:return"turn"}return""},$c=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"toString",value:function(){return this.buildCSSText(IM.kNo,BM.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=Ds.kUnitType&&this.getType()<=Ds.kClampType}}],[{key:"isAngle",value:function(r){return r===bt.kDegrees||r===bt.kRadians||r===bt.kGradians||r===bt.kTurns}},{key:"isLength",value:function(r){return r>=bt.kEms&&r<bt.kDegrees}},{key:"isRelativeUnit",value:function(r){return r===bt.kPercentage||r===bt.kEms||r===bt.kRems}},{key:"isTime",value:function(r){return r===bt.kSeconds||r===bt.kMilliseconds}}])}(),jM=function(a){function n(r){var s;return(0,I.Z)(this,n),s=(0,G.Z)(this,n),s.colorSpace=r,s}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"getType",value:function(){return Ds.kColorType}},{key:"to",value:function(s){return this}}])}($c),sa=function(a){return a[a.Constant=0]="Constant",a[a.LinearGradient=1]="LinearGradient",a[a.RadialGradient=2]="RadialGradient",a}({}),Uc=function(a){function n(r,s){var l;return(0,I.Z)(this,n),l=(0,G.Z)(this,n),l.type=r,l.value=s,l}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"clone",value:function(){return new n(this.type,this.value)}},{key:"buildCSSText",value:function(s,l,u){return u}},{key:"getType",value:function(){return Ds.kColorType}}])}($c),kr=function(a){function n(r){var s;return(0,I.Z)(this,n),s=(0,G.Z)(this,n),s.value=r,s}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"clone",value:function(){return new n(this.value)}},{key:"getType",value:function(){return Ds.kKeywordType}},{key:"buildCSSText",value:function(s,l,u){return u+this.value}}])}($c),VM=function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s="";return Number.isFinite(n)?s="NaN":n>0?s="infinity":s="-infinity",s+=r},Vf=function(n){return WM(GM(n))},Me=function(a){function n(r){var s,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bt.kNumber;(0,I.Z)(this,n),s=(0,G.Z)(this,n);var u;return typeof l=="string"?u=ZM(l):u=l,s.unit=u,s.value=r,s}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"clone",value:function(){return new n(this.value,this.unit)}},{key:"equals",value:function(s){var l=s;return this.value===l.value&&this.unit===l.unit}},{key:"getType",value:function(){return Ds.kUnitType}},{key:"convertTo",value:function(s){if(this.unit===s)return new n(this.value,this.unit);var l=Vf(this.unit);if(l!==Vf(s)||l===bt.kUnknown)return null;var u=Bg(this.unit)/Bg(s);return new n(this.value*u,s)}},{key:"buildCSSText",value:function(s,l,u){var h;switch(this.unit){case bt.kUnknown:break;case bt.kInteger:h=Number(this.value).toFixed(0);break;case bt.kNumber:case bt.kPercentage:case bt.kEms:case bt.kRems:case bt.kPixels:case bt.kDegrees:case bt.kRadians:case bt.kGradians:case bt.kMilliseconds:case bt.kSeconds:case bt.kTurns:{var f=-999999,d=999999,v=this.value,p=jf(this.unit);if(v<f||v>d){var g=jf(this.unit);!Number.isFinite(v)||Number.isNaN(v)?h=VM(v,g):h=v+(g||"")}else h="".concat(v).concat(p)}}return u+=h,u}}])}($c),Hr=new Me(0,"px");new Me(1,"px");var Fa=new Me(0,"deg"),Hf=function(a){function n(r,s,l){var u,h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return(0,I.Z)(this,n),u=(0,G.Z)(this,n,["rgb"]),u.r=r,u.g=s,u.b=l,u.alpha=h,u.isNone=f,u}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"clone",value:function(){return new n(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(s,l,u){return"".concat(u,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(jM),Fg=new kr("unset"),HM=new kr("initial"),$M=new kr("inherit"),$f={"":Fg,unset:Fg,initial:HM,inherit:$M},UM=function(n){return $f[n]||($f[n]=new kr(n)),$f[n]},zg=new Hf(0,0,0,0,!0),Zg=new Hf(0,0,0,0),YM=Ke(function(a,n,r,s){return new Hf(a,n,r,s)},function(a,n,r,s){return"rgba(".concat(a,",").concat(n,",").concat(r,",").concat(s,")")}),Re=function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bt.kNumber;return new Me(n,r)};new Me(50,"%");function XM(a){var n=a.type,r=a.value;return n==="hex"?"#".concat(r):n==="literal"?r:n==="rgb"?"rgb(".concat(r.join(","),")"):"rgba(".concat(r.join(","),")")}var qM=function(){var a={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},n="";function r(K){throw new Error("".concat(n,": ").concat(K))}function s(){var K=l();return n.length>0&&r("Invalid input not EOF"),K}function l(){return M(u)}function u(){return h("linear-gradient",a.linearGradient,d)||h("repeating-linear-gradient",a.repeatingLinearGradient,d)||h("radial-gradient",a.radialGradient,g)||h("repeating-radial-gradient",a.repeatingRadialGradient,g)||h("conic-gradient",a.conicGradient,g)}function h(K,rt,U){return f(rt,function(at){var ht=U();return ht&&(X(a.comma)||r("Missing comma before color stops")),{type:K,orientation:ht,colorStops:M(C)}})}function f(K,rt){var U=X(K);if(U){X(a.startCall)||r("Missing (");var at=rt(U);return X(a.endCall)||r("Missing )"),at}}function d(){return v()||p()}function v(){return Z("directional",a.sideOrCorner,1)}function p(){return Z("angular",a.angleValue,1)}function g(){var K,rt=y(),U;return rt&&(K=[],K.push(rt),U=n,X(a.comma)&&(rt=y(),rt?K.push(rt):n=U)),K}function y(){var K=m()||b();if(K)K.at=E();else{var rt=x();if(rt){K=rt;var U=E();U&&(K.at=U)}else{var at=w();at&&(K={type:"default-radial",at})}}return K}function m(){var K=Z("shape",/^(circle)/i,0);return K&&(K.style=z()||x()),K}function b(){var K=Z("shape",/^(ellipse)/i,0);return K&&(K.style=L()||x()),K}function x(){return Z("extent-keyword",a.extentKeywords,1)}function E(){if(Z("position",/^at/,0)){var K=w();return K||r("Missing positioning value"),K}}function w(){var K=S();if(K.x||K.y)return{type:"position",value:K}}function S(){return{x:L(),y:L()}}function M(K){var rt=K(),U=[];if(rt)for(U.push(rt);X(a.comma);)rt=K(),rt?U.push(rt):r("One extra comma");return U}function C(){var K=T();return K||r("Expected color definition"),K.length=L(),K}function T(){return k()||A()||P()||O()}function O(){return Z("literal",a.literalColor,0)}function k(){return Z("hex",a.hexColor,1)}function P(){return f(a.rgbColor,function(){return{type:"rgb",value:M(N)}})}function A(){return f(a.rgbaColor,function(){return{type:"rgba",value:M(N)}})}function N(){return X(a.number)[1]}function L(){return Z("%",a.percentageValue,1)||R()||z()}function R(){return Z("position-keyword",a.positionKeywords,1)}function z(){return Z("px",a.pixelValue,1)||Z("em",a.emValue,1)}function Z(K,rt,U){var at=X(rt);if(at)return{type:K,value:at[U]}}function X(K){var rt=/^[\n\r\t\s]+/.exec(n);rt&&nt(rt[0].length);var U=K.exec(n);return U&&nt(U[0].length),U}function nt(K){n=n.substring(K)}return function(K){return n=K,s()}}();function KM(a,n,r,s){var l=we(s.value),u=0,h=0,f=u+n/2,d=h+r/2,v=Math.abs(n*Math.cos(l))+Math.abs(r*Math.sin(l)),p=a[0]+f-Math.cos(l)*v/2,g=a[1]+d-Math.sin(l)*v/2,y=a[0]+f+Math.cos(l)*v/2,m=a[1]+d+Math.sin(l)*v/2;return{x1:p,y1:g,x2:y,y2:m}}function QM(a,n,r,s,l,u){var h=s.value,f=l.value;s.unit===bt.kPercentage&&(h=s.value/100*n),l.unit===bt.kPercentage&&(f=l.value/100*r);var d=Math.max(Jn([0,0],[h,f]),Jn([0,r],[h,f]),Jn([n,r],[h,f]),Jn([n,0],[h,f]));return u&&(u instanceof Me?d=u.value:u instanceof kr&&(u.value==="closest-side"?d=Math.min(h,n-h,f,r-f):u.value==="farthest-side"?d=Math.max(h,n-h,f,r-f):u.value==="closest-corner"&&(d=Math.min(Jn([0,0],[h,f]),Jn([0,r],[h,f]),Jn([n,r],[h,f]),Jn([n,0],[h,f]))))),{x:h+a[0],y:f+a[1],r:d}}var JM=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,tT=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,eT=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,Gg=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function nT(a){var n,r=a.length;if(a[r-1].length=(n=a[r-1].length)!==null&&n!==void 0?n:{type:"%",value:"100"},r>1){var s;a[0].length=(s=a[0].length)!==null&&s!==void 0?s:{type:"%",value:"0"}}for(var l=0,u=Number(a[0].length.value),h=1;h<r;h++){var f,d=(f=a[h].length)===null||f===void 0?void 0:f.value;if(!(0,At.Z)(d)&&!(0,At.Z)(u)){for(var v=1;v<h-l;v++)a[l+v].length={type:"%",value:"".concat(u+(Number(d)-u)*v/(h-l))};l=h,u=Number(d)}}}var rT={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},iT=Ke(function(a){var n;return a.type==="angular"?n=Number(a.value):n=rT[a.value]||0,Re(n,"deg")}),aT=Ke(function(a){var n=50,r=50,s="%",l="%";if((a==null?void 0:a.type)==="position"){var u=a.value,h=u.x,f=u.y;(h==null?void 0:h.type)==="position-keyword"&&(h.value==="left"?n=0:h.value==="center"?n=50:h.value==="right"?n=100:h.value==="top"?r=0:h.value==="bottom"&&(r=100)),(f==null?void 0:f.type)==="position-keyword"&&(f.value==="left"?n=0:f.value==="center"?r=50:f.value==="right"?n=100:f.value==="top"?r=0:f.value==="bottom"&&(r=100)),((h==null?void 0:h.type)==="px"||(h==null?void 0:h.type)==="%"||(h==null?void 0:h.type)==="em")&&(s=h==null?void 0:h.type,n=Number(h.value)),((f==null?void 0:f.type)==="px"||(f==null?void 0:f.type)==="%"||(f==null?void 0:f.type)==="em")&&(l=f==null?void 0:f.type,r=Number(f.value))}return{cx:Re(n,s),cy:Re(r,l)}}),sT=Ke(function(a){if(a.indexOf("linear")>-1||a.indexOf("radial")>-1){var n=qM(a);return n.map(function(f){var d=f.type,v=f.orientation,p=f.colorStops;nT(p);var g=p.map(function(M){return{offset:Re(Number(M.length.value),"%"),color:XM(M)}});if(d==="linear-gradient")return new Uc(sa.LinearGradient,{angle:v?iT(v):Fa,steps:g});if(d==="radial-gradient"&&(v||(v=[{type:"shape",value:"circle"}]),v[0].type==="shape"&&v[0].value==="circle")){var y=aT(v[0].at),m=y.cx,b=y.cy,x;if(v[0].style){var E=v[0].style,w=E.type,S=E.value;w==="extent-keyword"?x=UM(S):x=Re(S,w)}return new Uc(sa.RadialGradient,{cx:m,cy:b,size:x,steps:g})}})}var r=a[0];if(a[1]==="("||a[2]==="("){if(r==="l"){var s=JM.exec(a);if(s){var l,u=((l=s[2].match(Gg))===null||l===void 0?void 0:l.map(function(f){return f.split(":")}))||[];return[new Uc(sa.LinearGradient,{angle:Re(parseFloat(s[1]),"deg"),steps:u.map(function(f){var d=(0,W.Z)(f,2),v=d[0],p=d[1];return{offset:Re(Number(v)*100,"%"),color:p}})})]}}else if(r==="r"){var h=oT(a);if(h)if((0,ve.Z)(h))a=h;else return[new Uc(sa.RadialGradient,h)]}else if(r==="p")return lT(a)}});function oT(a){var n=tT.exec(a);if(n){var r,s=((r=n[4].match(Gg))===null||r===void 0?void 0:r.map(function(l){return l.split(":")}))||[];return{cx:Re(50,"%"),cy:Re(50,"%"),steps:s.map(function(l){var u=(0,W.Z)(l,2),h=u[0],f=u[1];return{offset:Re(Number(h)*100,"%"),color:f}})}}return null}function lT(a){var n=eT.exec(a);if(n){var r=n[1],s=n[2];switch(r){case"a":r="repeat";break;case"x":r="repeat-x";break;case"y":r="repeat-y";break;case"n":r="no-repeat";break;default:r="no-repeat"}return{image:s,repetition:r}}return null}function Az(a){return!!a.type&&!!a.value}function za(a){return a&&!!a.image}function Yc(a){return a&&!(0,At.Z)(a.r)&&!(0,At.Z)(a.g)&&!(0,At.Z)(a.b)}var Ro=Ke(function(a){if(za(a))return(0,$.Z)({repetition:"repeat"},a);if((0,At.Z)(a)&&(a=""),a==="transparent")return Zg;if(a==="currentColor")a="black";else if(a==="none")return zg;var n=sT(a);if(n)return n;var r=Wc(a),s=[0,0,0,0];return r!==null&&(s[0]=r.r||0,s[1]=r.g||0,s[2]=r.b||0,s[3]=r.opacity),YM.apply(void 0,s)});function cT(a,n){if(!(!Yc(a)||!Yc(n)))return[[Number(a.r),Number(a.g),Number(a.b),Number(a.alpha)],[Number(n.r),Number(n.g),Number(n.b),Number(n.alpha)],function(r){var s=r.slice();if(s[3])for(var l=0;l<3;l++)s[l]=Math.round(Ze(s[l],0,255));return s[3]=Ze(s[3],0,1),"rgba(".concat(s.join(","),")")}]}function Lo(a,n){if((0,At.Z)(n))return Re(0,"px");if(n="".concat(n).trim().toLowerCase(),isFinite(Number(n))){if("px".search(a)>=0)return Re(Number(n),"px");if("deg".search(a)>=0)return Re(Number(n),"deg")}var r=[];n=n.replace(a,function(l){return r.push(l),"U".concat(l)});var s="U(".concat(a.source,")");return r.map(function(l){return Re(Number(n.replace(new RegExp("U".concat(l),"g"),"").replace(new RegExp(s,"g"),"*0")),l)})[0]}var Wg=function(n){return Lo(new RegExp("px","g"),n)},uT=Ke(Wg),hT=function(n){return Lo(new RegExp("%","g"),n)};Ke(hT);var jg=function(n){return(0,se.Z)(n)||isFinite(Number(n))?Re(Number(n)||0,"px"):Lo(new RegExp("px|%|em|rem","g"),n)},Uf=Ke(jg),Vg=function(n){return Lo(new RegExp("deg|rad|grad|turn","g"),n)},fT=Ke(Vg);function dT(a,n,r,s){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,u="",h=a.value||0,f=n.value||0,d=Vf(a.unit),v=a.convertTo(d),p=n.convertTo(d);return v&&p?(h=v.value,f=p.value,u=jf(a.unit)):(Me.isLength(a.unit)||Me.isLength(n.unit))&&(h=fr(a,l,r),f=fr(n,l,r),u="px"),[h,f,function(g){return s&&(g=Math.max(g,0)),g+u}]}function nr(a){var n=0;return a.unit===bt.kDegrees?n=a.value:a.unit===bt.kRadians?n=tr(Number(a.value)):a.unit===bt.kTurns?n=hM(Number(a.value)):a.value&&(n=a.value),n}function Hg(a,n){var r;return Array.isArray(a)?r=a.map(function(s){return Number(s)}):(0,ve.Z)(a)?r=a.split(" ").map(function(s){return Number(s)}):(0,se.Z)(a)&&(r=[a]),n===2?r.length===1?[r[0],r[0]]:[r[0],r[1]]:n===4?r.length===1?[r[0],r[0],r[0],r[0]]:r.length===2?[r[0],r[1],r[0],r[1]]:r.length===3?[r[0],r[1],r[2],r[1]]:[r[0],r[1],r[2],r[3]]:n==="even"&&r.length%2===1?[].concat((0,B.Z)(r),(0,B.Z)(r)):r}function fr(a,n,r){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(a.unit===bt.kPixels)return Number(a.value);if(a.unit===bt.kPercentage&&r){var l=r.nodeName===J.GROUP?r.getLocalBounds():r.getGeometryBounds();return(s?l.min[n]:0)+a.value/100*l.halfExtents[n]*2}return 0}var vT=function(n){return Lo(/deg|rad|grad|turn|px|%/g,n)},pT=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function gT(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(a=a.toLowerCase().trim(),a==="none")return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],s,l=0;s=n.exec(a);){if(s.index!==l)return[];if(l=s.index+s[0].length,pT.indexOf(s[1])>-1&&r.push({name:s[1],params:s[2].split(" ").map(function(u){return vT(u)||Ro(u)})}),n.lastIndex===a.length)return r}return[]}function $g(a){return a.toString()}var Ug=function(n){return typeof n=="number"?Re(n):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(n)?Re(Number(n)):Re(0)},Yf=Ke(Ug);Ke(function(a){return(0,ve.Z)(a)?a.split(" ").map(Yf):a.map(Yf)});function Xf(a,n){return[a,n,$g]}function qf(a,n){return function(r,s){return[r,s,function(l){return $g(Ze(l,a,n))}]}}function Yg(a,n){if(a.length===n.length)return[a,n,function(r){return r}]}function Kf(a){return a.parsedStyle.d.totalLength===0&&(a.parsedStyle.d.totalLength=dS(a.parsedStyle.d.absolutePath)),a.parsedStyle.d.totalLength}function yT(a){return a.parsedStyle.points.totalLength===0&&(a.parsedStyle.points.totalLength=XS(a.parsedStyle.points.points)),a.parsedStyle.points.totalLength}function mT(a){for(var n=0;n<a.length;n++){var r=a[n-1],s=a[n],l=s[0];if(l==="M"&&r){var u=r[0],h=[s[1],s[2]],f=void 0;u==="L"||u==="M"?f=[r[1],r[2]]:(u==="C"||u==="A"||u==="Q")&&(f=[r[r.length-2],r[r.length-1]]),f&&Xc(h,f)&&(a.splice(n,1),n--)}}}function bT(a){for(var n=!1,r=a.length,s=0;s<r;s++){var l=a[s],u=l[0];if(u==="C"||u==="A"||u==="Q"){n=!0;break}}return n}function xT(a){for(var n=[],r=[],s=[],l=0;l<a.length;l++){var u=a[l],h=u[0];h==="M"?(s.length&&(r.push(s),s=[]),s.push([u[1],u[2]])):h==="Z"?s.length&&(n.push(s),s=[]):s.push([u[1],u[2]])}return s.length>0&&r.push(s),{polygons:n,polylines:r}}function Xc(a,n){return a[0]===n[0]&&a[1]===n[1]}function ET(a,n){for(var r=[],s=[],l=[],u=0;u<a.length;u++){var h=a[u],f=h.currentPoint,d=h.params,v=h.prePoint,p=void 0;switch(h.command){case"Q":p=KS(v[0],v[1],d[1],d[2],d[3],d[4]);break;case"C":p=$S(v[0],v[1],d[1],d[2],d[3],d[4],d[5],d[6]);break;case"A":var g=h.arcParams;p=GS(g.cx,g.cy,g.rx,g.ry,g.xRotation,g.startAngle,g.endAngle);break;default:r.push(f[0]),s.push(f[1]);break}p&&(h.box=p,r.push(p.x,p.x+p.width),s.push(p.y,p.y+p.height)),n&&(h.command==="L"||h.command==="M")&&h.prePoint&&h.nextPoint&&l.push(h)}r=r.filter(function(C){return!Number.isNaN(C)&&C!==1/0&&C!==-1/0}),s=s.filter(function(C){return!Number.isNaN(C)&&C!==1/0&&C!==-1/0});var y=Rc(r),m=Rc(s),b=Lc(r),x=Lc(s);if(l.length===0)return{x:y,y:m,width:b-y,height:x-m};for(var E=0;E<l.length;E++){var w=l[E],S=w.currentPoint,M=void 0;S[0]===y?(M=qc(w,n),y-=M.xExtra):S[0]===b&&(M=qc(w,n),b+=M.xExtra),S[1]===m?(M=qc(w,n),m-=M.yExtra):S[1]===x&&(M=qc(w,n),x+=M.yExtra)}return{x:y,y:m,width:b-y,height:x-m}}function qc(a,n){var r=a.prePoint,s=a.currentPoint,l=a.nextPoint,u=Math.pow(s[0]-r[0],2)+Math.pow(s[1]-r[1],2),h=Math.pow(s[0]-l[0],2)+Math.pow(s[1]-l[1],2),f=Math.pow(r[0]-l[0],2)+Math.pow(r[1]-l[1],2),d=Math.acos((u+h-f)/(2*Math.sqrt(u)*Math.sqrt(h)));if(!d||Math.sin(d)===0||To(d,0))return{xExtra:0,yExtra:0};var v=Math.abs(Math.atan2(l[1]-s[1],l[0]-s[0])),p=Math.abs(Math.atan2(l[0]-s[0],l[1]-s[1]));v=v>Math.PI/2?Math.PI-v:v,p=p>Math.PI/2?Math.PI-p:p;var g={xExtra:Math.cos(d/2-v)*(n/2*(1/Math.sin(d/2)))-n/2||0,yExtra:Math.cos(p-d/2)*(n/2*(1/Math.sin(d/2)))-n/2||0};return g}function Xg(a,n){return[n[0]+(n[0]-a[0]),n[1]+(n[1]-a[1])]}var qg=function(n,r){var s=n.x*r.x+n.y*r.y,l=Math.sqrt((Math.pow(n.x,2)+Math.pow(n.y,2))*(Math.pow(r.x,2)+Math.pow(r.y,2))),u=n.x*r.y-n.y*r.x<0?-1:1,h=u*Math.acos(s/l);return h},Kg=function(n,r,s,l,u,h,f,d){r=Math.abs(r),s=Math.abs(s),l=Xp(l,360);var v=we(l);if(n.x===f.x&&n.y===f.y)return{x:n.x,y:n.y,ellipticalArcAngle:0};if(r===0||s===0)return{x:0,y:0,ellipticalArcAngle:0};var p=(n.x-f.x)/2,g=(n.y-f.y)/2,y={x:Math.cos(v)*p+Math.sin(v)*g,y:-Math.sin(v)*p+Math.cos(v)*g},m=Math.pow(y.x,2)/Math.pow(r,2)+Math.pow(y.y,2)/Math.pow(s,2);m>1&&(r*=Math.sqrt(m),s*=Math.sqrt(m));var b=Math.pow(r,2)*Math.pow(s,2)-Math.pow(r,2)*Math.pow(y.y,2)-Math.pow(s,2)*Math.pow(y.x,2),x=Math.pow(r,2)*Math.pow(y.y,2)+Math.pow(s,2)*Math.pow(y.x,2),E=b/x;E=E<0?0:E;var w=(u!==h?1:-1)*Math.sqrt(E),S={x:w*(r*y.y/s),y:w*(-(s*y.x)/r)},M={x:Math.cos(v)*S.x-Math.sin(v)*S.y+(n.x+f.x)/2,y:Math.sin(v)*S.x+Math.cos(v)*S.y+(n.y+f.y)/2},C={x:(y.x-S.x)/r,y:(y.y-S.y)/s},T=qg({x:1,y:0},C),O={x:(-y.x-S.x)/r,y:(-y.y-S.y)/s},k=qg(C,O);!h&&k>0?k-=2*Math.PI:h&&k<0&&(k+=2*Math.PI),k%=2*Math.PI;var P=T+k*d,A=r*Math.cos(P),N=s*Math.sin(P),L={x:Math.cos(v)*A-Math.sin(v)*N+M.x,y:Math.sin(v)*A+Math.cos(v)*N+M.y,ellipticalArcStartAngle:T,ellipticalArcEndAngle:T+k,ellipticalArcAngle:P,ellipticalArcCenter:M,resultantRx:r,resultantRy:s};return L};function wT(a){for(var n=[],r=null,s=null,l=null,u=0,h=a.length,f=0;f<h;f++){var d=a[f];s=a[f+1];var v=d[0],p={command:v,prePoint:r,params:d,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(v){case"M":l=[d[1],d[2]],u=f;break;case"A":var g=ST(r,d);p.arcParams=g;break}if(v==="Z")r=l,s=a[u+1];else{var y=d.length;r=[d[y-2],d[y-1]]}s&&s[0]==="Z"&&(s=a[u],n[u]&&(n[u].prePoint=r)),p.currentPoint=r,n[u]&&Xc(r,n[u].currentPoint)&&(n[u].prePoint=p.prePoint);var m=s?[s[s.length-2],s[s.length-1]]:null;p.nextPoint=m;var b=p.prePoint;if(["L","H","V"].includes(v))p.startTangent=[b[0]-r[0],b[1]-r[1]],p.endTangent=[r[0]-b[0],r[1]-b[1]];else if(v==="Q"){var x=[d[1],d[2]];p.startTangent=[b[0]-x[0],b[1]-x[1]],p.endTangent=[r[0]-x[0],r[1]-x[1]]}else if(v==="T"){var E=n[f-1],w=Xg(E.currentPoint,b);E.command==="Q"?(p.command="Q",p.startTangent=[b[0]-w[0],b[1]-w[1]],p.endTangent=[r[0]-w[0],r[1]-w[1]]):(p.command="TL",p.startTangent=[b[0]-r[0],b[1]-r[1]],p.endTangent=[r[0]-b[0],r[1]-b[1]])}else if(v==="C"){var S=[d[1],d[2]],M=[d[3],d[4]];p.startTangent=[b[0]-S[0],b[1]-S[1]],p.endTangent=[r[0]-M[0],r[1]-M[1]],p.startTangent[0]===0&&p.startTangent[1]===0&&(p.startTangent=[S[0]-M[0],S[1]-M[1]]),p.endTangent[0]===0&&p.endTangent[1]===0&&(p.endTangent=[M[0]-S[0],M[1]-S[1]])}else if(v==="S"){var C=n[f-1],T=Xg(C.currentPoint,b),O=[d[1],d[2]];C.command==="C"?(p.command="C",p.startTangent=[b[0]-T[0],b[1]-T[1]],p.endTangent=[r[0]-O[0],r[1]-O[1]]):(p.command="SQ",p.startTangent=[b[0]-O[0],b[1]-O[1]],p.endTangent=[r[0]-O[0],r[1]-O[1]])}else if(v==="A"){var k=Qg(p,0),P=k.x,A=k.y,N=Qg(p,1,!1),L=N.x,R=N.y;p.startTangent=[P,A],p.endTangent=[L,R]}n.push(p)}return n}function Qg(a,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=a.arcParams,l=s.rx,u=l===void 0?0:l,h=s.ry,f=h===void 0?0:h,d=s.xRotation,v=s.arcFlag,p=s.sweepFlag,g=Kg({x:a.prePoint[0],y:a.prePoint[1]},u,f,d,!!v,!!p,{x:a.currentPoint[0],y:a.currentPoint[1]},n),y=Kg({x:a.prePoint[0],y:a.prePoint[1]},u,f,d,!!v,!!p,{x:a.currentPoint[0],y:a.currentPoint[1]},r?n+.005:n-.005),m=y.x-g.x,b=y.y-g.y,x=Math.sqrt(m*m+b*b);return{x:-m/x,y:-b/x}}function Kc(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Qf(a,n){return Kc(a)*Kc(n)?(a[0]*n[0]+a[1]*n[1])/(Kc(a)*Kc(n)):1}function Jg(a,n){return(a[0]*n[1]<a[1]*n[0]?-1:1)*Math.acos(Qf(a,n))}function ST(a,n){var r=n[1],s=n[2],l=Xp(we(n[3]),Math.PI*2),u=n[4],h=n[5],f=a[0],d=a[1],v=n[6],p=n[7],g=Math.cos(l)*(f-v)/2+Math.sin(l)*(d-p)/2,y=-1*Math.sin(l)*(f-v)/2+Math.cos(l)*(d-p)/2,m=g*g/(r*r)+y*y/(s*s);m>1&&(r*=Math.sqrt(m),s*=Math.sqrt(m));var b=r*r*(y*y)+s*s*(g*g),x=b?Math.sqrt((r*r*(s*s)-b)/b):1;u===h&&(x*=-1),isNaN(x)&&(x=0);var E=s?x*r*y/s:0,w=r?x*-s*g/r:0,S=(f+v)/2+Math.cos(l)*E-Math.sin(l)*w,M=(d+p)/2+Math.sin(l)*E+Math.cos(l)*w,C=[(g-E)/r,(y-w)/s],T=[(-1*g-E)/r,(-1*y-w)/s],O=Jg([1,0],C),k=Jg(C,T);return Qf(C,T)<=-1&&(k=Math.PI),Qf(C,T)>=1&&(k=0),h===0&&k>0&&(k-=2*Math.PI),h===1&&k<0&&(k+=2*Math.PI),{cx:S,cy:M,rx:Xc(a,[v,p])?0:r,ry:Xc(a,[v,p])?0:s,startAngle:O,endAngle:O+k,xRotation:l,arcFlag:u,sweepFlag:h}}function MT(a,n,r){return a.reduce(function(s,l){var u="";if(l[0]==="M"||l[0]==="L"){var h=vec3.fromValues(l[1],l[2],0);r&&vec3.transformMat4(h,h,r),u="".concat(l[0]).concat(h[0],",").concat(h[1])}else if(l[0]==="Z")u=l[0];else if(l[0]==="C"){var f=vec3.fromValues(l[1],l[2],0),d=vec3.fromValues(l[3],l[4],0),v=vec3.fromValues(l[5],l[6],0);r&&(vec3.transformMat4(f,f,r),vec3.transformMat4(d,d,r),vec3.transformMat4(v,v,r)),u="".concat(l[0]).concat(f[0],",").concat(f[1],",").concat(d[0],",").concat(d[1],",").concat(v[0],",").concat(v[1])}else if(l[0]==="A"){var p=vec3.fromValues(l[6],l[7],0);r&&vec3.transformMat4(p,p,r),u="".concat(l[0]).concat(l[1],",").concat(l[2],",").concat(l[3],",").concat(l[4],",").concat(l[5],",").concat(p[0],",").concat(p[1])}else if(l[0]==="Q"){var g=vec3.fromValues(l[1],l[2],0),y=vec3.fromValues(l[3],l[4],0);r&&(vec3.transformMat4(g,g,r),vec3.transformMat4(y,y,r)),u="".concat(l[0]).concat(l[1],",").concat(l[2],",").concat(l[3],",").concat(l[4],"}")}return s+=u},"")}function TT(a,n,r,s){return[["M",a,n],["L",r,s]]}function ty(a,n,r,s){var l=(-1+Math.sqrt(2))/3*4,u=a*l,h=n*l,f=r-a,d=r+a,v=s-n,p=s+n;return[["M",f,s],["C",f,s-h,r-u,v,r,v],["C",r+u,v,d,s-h,d,s],["C",d,s+h,r+u,p,r,p],["C",r-u,p,f,s+h,f,s],["Z"]]}function CT(a,n){var r=a.map(function(s,l){return[l===0?"M":"L",s[0],s[1]]});return n&&r.push(["Z"]),r}function OT(a,n,r,s,l){if(l){var u=_slicedToArray(l,4),h=u[0],f=u[1],d=u[2],v=u[3],p=a>0?1:-1,g=n>0?1:-1,y=p+g!==0?1:0;return[["M",p*h+r,s],["L",a-p*f+r,s],f?["A",f,f,0,0,y,a+r,g*f+s]:null,["L",a+r,n-g*d+s],d?["A",d,d,0,0,y,a+r-p*d,n+s]:null,["L",r+p*v,n+s],v?["A",v,v,0,0,y,r,n+s-g*v]:null,["L",r,g*h+s],h?["A",h,h,0,0,y,p*h+r,s]:null,["Z"]].filter(function(m){return m})}return[["M",r,s],["L",r+a,s],["L",r+a,s+n],["L",r,s+n],["Z"]]}function Nz(a){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a.getLocalTransform(),r=[];switch(a.nodeName){case J.LINE:var s=a.parsedStyle,l=s.x1,u=l===void 0?0:l,h=s.y1,f=h===void 0?0:h,d=s.x2,v=d===void 0?0:d,p=s.y2,g=p===void 0?0:p;r=TT(u,f,v,g);break;case J.CIRCLE:{var y=a.parsedStyle,m=y.r,b=m===void 0?0:m,x=y.cx,E=x===void 0?0:x,w=y.cy,S=w===void 0?0:w;r=ty(b,b,E,S);break}case J.ELLIPSE:{var M=a.parsedStyle,C=M.rx,T=C===void 0?0:C,O=M.ry,k=O===void 0?0:O,P=M.cx,A=P===void 0?0:P,N=M.cy,L=N===void 0?0:N;r=ty(T,k,A,L);break}case J.POLYLINE:case J.POLYGON:var R=a.parsedStyle.points;r=CT(R.points,a.nodeName===J.POLYGON);break;case J.RECT:var z=a.parsedStyle,Z=z.width,X=Z===void 0?0:Z,nt=z.height,K=nt===void 0?0:nt,rt=z.x,U=rt===void 0?0:rt,at=z.y,ht=at===void 0?0:at,pt=z.radius,Ct=pt&&pt.some(function(Nt){return Nt!==0});r=OT(X,K,U,ht,Ct&&pt.map(function(Nt){return clamp(Nt,0,Math.min(Math.abs(X)/2,Math.abs(K)/2))}));break;case J.PATH:var Zt=a.parsedStyle.d.absolutePath;r=_toConsumableArray(Zt);break}if(r.length)return MT(r,a,n)}function Rz(a){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,u=a.map(function(h,f){var d=h[0],v=a[f+1],p=f===0&&(n!==0||r!==0),g=(f===a.length-1||v&&(v[0]==="M"||v[0]==="Z"))&&s!==0&&l!==0,y=p?[n,r]:[0,0],m=_slicedToArray(y,2),b=m[0],x=m[1],E=g?[s,l]:[0,0],w=_slicedToArray(E,2),S=w[0],M=w[1];switch(d){case"M":return"M ".concat(h[1]+b,",").concat(h[2]+x);case"L":return"L ".concat(h[1]+S,",").concat(h[2]+M);case"Q":return"Q ".concat(h[1]," ").concat(h[2],",").concat(h[3]+S," ").concat(h[4]+M);case"C":return"C ".concat(h[1]," ").concat(h[2],",").concat(h[3]," ").concat(h[4],",").concat(h[5]+S," ").concat(h[6]+M);case"A":return"A ".concat(h[1]," ").concat(h[2]," ").concat(h[3]," ").concat(h[4]," ").concat(h[5]," ").concat(h[6]," ").concat(h[7]).concat(g?" L ".concat(h[6]+s,",").concat(h[7]+l):"");case"Z":return"Z";default:return null}}).filter(function(h){return h!==null}).join(" ");return~u.indexOf("NaN")?"":u}var ey=function(n){if(n===""||Array.isArray(n)&&n.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var r;try{r=Nc(n)}catch(m){r=Nc(""),console.error("[g]: Invalid SVG Path definition: ".concat(n))}mT(r);var s=bT(r),l=xT(r),u=l.polygons,h=l.polylines,f=wT(r),d=ET(f,0),v=d.x,p=d.y,g=d.width,y=d.height;return{absolutePath:r,hasArc:s,segments:f,polygons:u,polylines:h,totalLength:0,rect:{x:Number.isFinite(v)?v:0,y:Number.isFinite(p)?p:0,width:Number.isFinite(g)?g:0,height:Number.isFinite(y)?y:0}}},kT=Ke(ey);function ny(a){return(0,ve.Z)(a)?kT(a):ey(a)}function _T(a,n,r){var s=a.curve,l=n.curve;(!s||s.length===0)&&(s=Af(a.absolutePath,!1),a.curve=s),(!l||l.length===0)&&(l=Af(n.absolutePath,!1),n.curve=l);var u=[s,l];s.length!==l.length&&(u=Qp(s,l));var h=Jp(u[0])!==Jp(u[1])?MS(u[0]):TS(u[0]);return[h,OS(u[1],h),function(f){return f}]}function PT(a,n){var r;return(0,ve.Z)(a)?r=a.split(" ").map(function(s){var l=s.split(","),u=(0,W.Z)(l,2),h=u[0],f=u[1];return[Number(h),Number(f)]}):r=a,{points:r,totalLength:0,segments:[]}}function AT(a,n){return[a.points,n.points,function(r){return r}]}var Ge=null,Is=/\s*(\w+)\(([^)]*)\)/g;function rr(a){return function(n){var r=0;return a.map(function(s){return s===Ge?n[r++]:s})}}function Za(a){return a}var Do={matrix:["NNNNNN",[Ge,Ge,0,0,Ge,Ge,0,0,0,0,1,0,Ge,Ge,0,1],Za],matrix3d:["NNNNNNNNNNNNNNNN",Za],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",rr([Ge,Ge,new Me(1)]),Za],scaleX:["N",rr([Ge,new Me(1),new Me(1)]),rr([Ge,new Me(1)])],scaleY:["N",rr([new Me(1),Ge,new Me(1)]),rr([new Me(1),Ge])],scaleZ:["N",rr([new Me(1),new Me(1),Ge])],scale3d:["NNN",Za],skew:["Aa",null,Za],skewX:["A",null,rr([Ge,Fa])],skewY:["A",null,rr([Fa,Ge])],translate:["Tt",rr([Ge,Ge,Hr]),Za],translateX:["T",rr([Ge,Hr,Hr]),rr([Ge,Hr])],translateY:["T",rr([Hr,Ge,Hr]),rr([Hr,Ge])],translateZ:["L",rr([Hr,Hr,Ge])],translate3d:["TTL",Za]};function ry(a){for(var n=[],r=a.length,s=0;s<r;s++){var l=a[s],u=l[0],h=l.slice(1);u==="translate"||u==="skew"?h.length===1&&h.push(0):u==="scale"&&h.length===1&&h.push(h[0]);var f=Do[u];if(!f)return[];var d=h.map(function(v){return Re(v)});n.push({t:u,d})}return n}function iy(a){if(Array.isArray(a))return ry(a);if(a=(a||"none").trim(),a==="none")return[];var n=[],r,s=0;for(Is.lastIndex=0;r=Is.exec(a);){if(r.index!==s)return[];s=r.index+r[0].length;var l=r[1],u=Do[l];if(!u)return[];var h=r[2].split(","),f=u[0];if(f.length<h.length)return[];for(var d=[],v=0;v<f.length;v++){var p=h[v],g=f[v],y=void 0;if(p?y={A:function(b){return b.trim()==="0"?Fa:fT(b)},N:Yf,T:Uf,L:uT}[g.toUpperCase()](p):y={a:Fa,n:d[0],t:Hr}[g],y===void 0)return[];d.push(y)}if(n.push({t:l,d}),Is.lastIndex===a.length)return n}return[]}function NT(a){if(Array.isArray(a))return ry(a);if(a=(a||"none").trim(),a==="none")return[];var n=[],r,s=0;for(Is.lastIndex=0;r=Is.exec(a);){if(r.index!==s)return[];s=r.index+r[0].length;var l=r[1],u=Do[l];if(!u)return[];var h=r[2].split(","),f=u[0];if(f.length<h.length)return[];for(var d=[],v=0;v<f.length;v++){var p=h[v],g=f[v],y=void 0;if(p?y={A:function(b){return b.trim()==="0"?Fa:Vg(b)},N:Ug,T:jg,L:Wg}[g.toUpperCase()](p):y={a:Fa,n:d[0],t:Hr}[g],y===void 0)return[];d.push(y)}if(n.push({t:l,d}),Is.lastIndex===a.length)return n}return[]}function RT(a){var n,r,s,l;switch(a.t){case"rotateX":return l=we(nr(a.d[0])),[1,0,0,0,0,Math.cos(l),Math.sin(l),0,0,-Math.sin(l),Math.cos(l),0,0,0,0,1];case"rotateY":return l=we(nr(a.d[0])),[Math.cos(l),0,-Math.sin(l),0,0,1,0,0,Math.sin(l),0,Math.cos(l),0,0,0,0,1];case"rotate":case"rotateZ":return l=we(nr(a.d[0])),[Math.cos(l),Math.sin(l),0,0,-Math.sin(l),Math.cos(l),0,0,0,0,1,0,0,0,0,1];case"rotate3d":n=a.d[0].value,r=a.d[1].value,s=a.d[2].value,l=we(nr(a.d[3]));var u=n*n+r*r+s*s;if(u===0)n=1,r=0,s=0;else if(u!==1){var h=Math.sqrt(u);n/=h,r/=h,s/=h}var f=Math.sin(l/2),d=f*Math.cos(l/2),v=f*f;return[1-2*(r*r+s*s)*v,2*(n*r*v+s*d),2*(n*s*v-r*d),0,2*(n*r*v-s*d),1-2*(n*n+s*s)*v,2*(r*s*v+n*d),0,2*(n*s*v+r*d),2*(r*s*v-n*d),1-2*(n*n+r*r)*v,0,0,0,0,1];case"scale":return[a.d[0].value,0,0,0,0,a.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[a.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,a.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,a.d[0].value,0,0,0,0,1];case"scale3d":return[a.d[0].value,0,0,0,0,a.d[1].value,0,0,0,0,a.d[2].value,0,0,0,0,1];case"skew":var p=we(nr(a.d[0])),g=we(nr(a.d[1]));return[1,Math.tan(g),0,0,Math.tan(p),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return l=we(nr(a.d[0])),[1,0,0,0,Math.tan(l),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return l=we(nr(a.d[0])),[1,Math.tan(l),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return n=fr(a.d[0],0,null)||0,r=fr(a.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,n,r,0,1];case"translateX":return n=fr(a.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,n,0,0,1];case"translateY":return r=fr(a.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,r,0,1];case"translateZ":return s=fr(a.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,s,1];case"translate3d":return n=fr(a.d[0],0,null)||0,r=fr(a.d[1],0,null)||0,s=fr(a.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,n,r,s,1];case"perspective":var y=fr(a.d[0],0,null)||0,m=y?-1/y:0;return[1,0,0,0,0,1,0,0,0,0,1,m,0,0,0,1];case"matrix":return[a.d[0].value,a.d[1].value,0,0,a.d[2].value,a.d[3].value,0,0,0,0,1,0,a.d[4].value,a.d[5].value,0,1];case"matrix3d":return a.d.map(function(b){return b.value})}}function LT(a,n){return[a[0]*n[0]+a[4]*n[1]+a[8]*n[2]+a[12]*n[3],a[1]*n[0]+a[5]*n[1]+a[9]*n[2]+a[13]*n[3],a[2]*n[0]+a[6]*n[1]+a[10]*n[2]+a[14]*n[3],a[3]*n[0]+a[7]*n[1]+a[11]*n[2]+a[15]*n[3],a[0]*n[4]+a[4]*n[5]+a[8]*n[6]+a[12]*n[7],a[1]*n[4]+a[5]*n[5]+a[9]*n[6]+a[13]*n[7],a[2]*n[4]+a[6]*n[5]+a[10]*n[6]+a[14]*n[7],a[3]*n[4]+a[7]*n[5]+a[11]*n[6]+a[15]*n[7],a[0]*n[8]+a[4]*n[9]+a[8]*n[10]+a[12]*n[11],a[1]*n[8]+a[5]*n[9]+a[9]*n[10]+a[13]*n[11],a[2]*n[8]+a[6]*n[9]+a[10]*n[10]+a[14]*n[11],a[3]*n[8]+a[7]*n[9]+a[11]*n[10]+a[15]*n[11],a[0]*n[12]+a[4]*n[13]+a[8]*n[14]+a[12]*n[15],a[1]*n[12]+a[5]*n[13]+a[9]*n[14]+a[13]*n[15],a[2]*n[12]+a[6]*n[13]+a[10]*n[14]+a[14]*n[15],a[3]*n[12]+a[7]*n[13]+a[11]*n[14]+a[15]*n[15]]}function DT(a){return a.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:a.map(RT).reduce(LT)}function ay(a){var n=[0,0,0],r=[1,1,1],s=[0,0,0],l=[0,0,0,1],u=[0,0,0,1];return gM(DT(a),n,r,s,l,u),[[n,r,s,u,l]]}var IT=function(){function a(s,l){for(var u=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],h=0;h<4;h++)for(var f=0;f<4;f++)for(var d=0;d<4;d++)u[h][f]+=l[h][d]*s[d][f];return u}function n(s){return s[0][2]===0&&s[0][3]===0&&s[1][2]===0&&s[1][3]===0&&s[2][0]===0&&s[2][1]===0&&s[2][2]===1&&s[2][3]===0&&s[3][2]===0&&s[3][3]===1}function r(s,l,u,h,f){for(var d=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],v=0;v<4;v++)d[v][3]=f[v];for(var p=0;p<3;p++)for(var g=0;g<3;g++)d[3][p]+=s[g]*d[g][p];var y=h[0],m=h[1],b=h[2],x=h[3],E=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];E[0][0]=1-2*(m*m+b*b),E[0][1]=2*(y*m-b*x),E[0][2]=2*(y*b+m*x),E[1][0]=2*(y*m+b*x),E[1][1]=1-2*(y*y+b*b),E[1][2]=2*(m*b-y*x),E[2][0]=2*(y*b-m*x),E[2][1]=2*(m*b+y*x),E[2][2]=1-2*(y*y+m*m),d=a(d,E);var w=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];u[2]&&(w[2][1]=u[2],d=a(d,w)),u[1]&&(w[2][1]=0,w[2][0]=u[0],d=a(d,w)),u[0]&&(w[2][0]=0,w[1][0]=u[0],d=a(d,w));for(var S=0;S<3;S++)for(var M=0;M<3;M++)d[S][M]*=l[S];return n(d)?[d[0][0],d[0][1],d[1][0],d[1][1],d[3][0],d[3][1]]:d[0].concat(d[1],d[2],d[3])}return r}();function BT(a){return a.toFixed(6).replace(".000000","")}function Jf(a,n){var r,s;return a.decompositionPair!==n&&(a.decompositionPair=n,r=ay(a)),n.decompositionPair!==a&&(n.decompositionPair=a,s=ay(n)),r[0]===null||s[0]===null?[[!1],[!0],function(l){return l?n[0].d:a[0].d}]:(r[0].push(0),s[0].push(1),[r,s,function(l){var u=zT(r[0][3],s[0][3],l[5]),h=IT(l[0],l[1],l[2],u,l[4]),f=h.map(BT).join(",");return f}])}function FT(a,n){for(var r=0,s=0;s<a.length;s++)r+=a[s]*n[s];return r}function zT(a,n,r){var s=FT(a,n);s=Ze(s,-1,1);var l=[];if(s===1)l=a;else for(var u=Math.acos(s),h=Math.sin(r*u)*1/Math.sqrt(1-s*s),f=0;f<4;f++)l.push(a[f]*(Math.cos(r*u)-s*h)+n[f]*h);return l}function td(a){return a.replace(/[XY]/,"")}function ed(a){return a.replace(/(X|Y|Z|3d)?$/,"3d")}var ZT=function(n,r){return n==="perspective"&&r==="perspective"||(n==="matrix"||n==="matrix3d")&&(r==="matrix"||r==="matrix3d")};function GT(a,n,r){var s=!1;if(!a.length||!n.length){a.length||(s=!0,a=n,n=[]);for(var l=function(){var L=a[u],R=L.t,z=L.d,Z=R.substring(0,5)==="scale"?1:0;n.push({t:R,d:z.map(function(X){return typeof X=="number"?Re(Z):Re(Z,X.unit)})})},u=0;u<a.length;u++)l()}var h=[],f=[],d=[];if(a.length!==n.length){var v=Jf(a,n);h=[v[0]],f=[v[1]],d=[["matrix",[v[2]]]]}else for(var p=0;p<a.length;p++){var g=a[p].t,y=n[p].t,m=a[p].d,b=n[p].d,x=Do[g],E=Do[y],w=void 0;if(ZT(g,y)){var S=Jf([a[p]],[n[p]]);h.push(S[0]),f.push(S[1]),d.push(["matrix",[S[2]]]);continue}else if(g===y)w=g;else if(x[2]&&E[2]&&td(g)===td(y))w=td(g),m=x[2](m),b=E[2](b);else if(x[1]&&E[1]&&ed(g)===ed(y))w=ed(g),m=x[1](m),b=E[1](b);else{var M=Jf(a,n);h=[M[0]],f=[M[1]],d=[["matrix",[M[2]]]];break}for(var C=[],T=[],O=[],k=0;k<m.length;k++){var P=dT(m[k],b[k],r,!1,k);C[k]=P[0],T[k]=P[1],O.push(P[2])}h.push(C),f.push(T),d.push([w,O])}if(s){var A=h;h=f,f=A}return[h,f,function(N){return N.map(function(L,R){var z=L.map(function(Z,X){return d[R][1][X](Z)}).join(",");return d[R][0]==="matrix"&&z.split(",").length===16&&(d[R][0]="matrix3d"),d[R][0]==="matrix3d"&&z.split(",").length===6&&(d[R][0]="matrix"),"".concat(d[R][0],"(").concat(z,")")}).join(" ")}]}var WT=Ke(function(a){if((0,ve.Z)(a)){if(a==="text-anchor")return[Re(0,"px"),Re(0,"px")];var n=a.split(" ");return n.length===1&&(n[0]==="top"||n[0]==="bottom"?(n[1]=n[0],n[0]="center"):n[1]="center"),n.length!==2?null:[Uf(sy(n[0])),Uf(sy(n[1]))]}return[Re(a[0]||0,"px"),Re(a[1]||0,"px")]});function sy(a){return a==="center"?"50%":a==="left"||a==="top"?"0%":a==="right"||a==="bottom"?"100%":a}var nd=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:mt.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:mt.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:mt.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:mt.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:mt.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:mt.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:mt.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:mt.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:mt.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:mt.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:mt.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:mt.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:mt.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:mt.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:mt.FILTER},{n:"clipPath",syntax:mt.DEFINED_PATH},{n:"textPath",syntax:mt.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:mt.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:mt.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:mt.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:mt.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:mt.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:mt.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:mt.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:mt.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:mt.COORDINATE},{n:"y1",int:!0,l:!0,syntax:mt.COORDINATE},{n:"z1",int:!0,l:!0,syntax:mt.COORDINATE},{n:"x2",int:!0,l:!0,syntax:mt.COORDINATE},{n:"y2",int:!0,l:!0,syntax:mt.COORDINATE},{n:"z2",int:!0,l:!0,syntax:mt.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:mt.PATH,p:50},{n:"points",int:!0,l:!0,syntax:mt.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:mt.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:mt.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:mt.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:mt.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:mt.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:mt.NUMBER,d:function(n){return n===J.PATH||n===J.POLYGON||n===J.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:mt.MARKER},{n:"markerEnd",syntax:mt.MARKER},{n:"markerMid",syntax:mt.MARKER},{n:"markerStartOffset",syntax:mt.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:mt.LENGTH,l:!0,int:!0,d:"0"}],jT=new Set(nd.filter(function(a){return!!a.l}).map(function(a){return a.n})),oy={},VT=function(){function a(n){var r=this;(0,I.Z)(this,a),this.runtime=n,nd.forEach(function(s){r.registerMetadata(s)})}return(0,D.Z)(a,[{key:"registerMetadata",value:function(r){[r.n].concat((0,B.Z)(r.a||[])).forEach(function(s){oy[s]=r})}},{key:"getPropertySyntax",value:function(r){return this.runtime.CSSPropertySyntaxFactory[r]}},{key:"processProperties",value:function(r,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(r.attributes,s);var u=r.parsedStyle.clipPath,h=r.parsedStyle.offsetPath;HT(r,s);var f=!!l.forceUpdateGeometry;if(!f){for(var d in s)if(jT.has(d)){f=!0;break}}var v=ly(r);v.has("fill")&&s.fill&&(r.parsedStyle.fill=Ro(s.fill)),v.has("stroke")&&s.stroke&&(r.parsedStyle.stroke=Ro(s.stroke)),v.has("shadowColor")&&s.shadowColor&&(r.parsedStyle.shadowColor=Ro(s.shadowColor)),v.has("filter")&&s.filter&&(r.parsedStyle.filter=gT(s.filter)),v.has("radius")&&!(0,At.Z)(s.radius)&&(r.parsedStyle.radius=Hg(s.radius,4)),v.has("lineDash")&&!(0,At.Z)(s.lineDash)&&(r.parsedStyle.lineDash=Hg(s.lineDash,"even")),v.has("points")&&s.points&&(r.parsedStyle.points=PT(s.points)),v.has("d")&&s.d===""&&(r.parsedStyle.d=(0,$.Z)({},Cg)),v.has("d")&&s.d&&(r.parsedStyle.d=ny(s.d)),v.has("textTransform")&&s.textTransform&&this.runtime.CSSPropertySyntaxFactory[mt.TEXT_TRANSFORM].calculator(null,null,{value:s.textTransform},r,null),v.has("clipPath")&&!Ft(s.clipPath)&&this.runtime.CSSPropertySyntaxFactory[mt.DEFINED_PATH].calculator("clipPath",u,s.clipPath,r,this.runtime),v.has("offsetPath")&&s.offsetPath&&this.runtime.CSSPropertySyntaxFactory[mt.DEFINED_PATH].calculator("offsetPath",h,s.offsetPath,r,this.runtime),v.has("transform")&&s.transform&&(r.parsedStyle.transform=iy(s.transform)),v.has("transformOrigin")&&s.transformOrigin&&(r.parsedStyle.transformOrigin=WT(s.transformOrigin)),v.has("markerStart")&&s.markerStart&&(r.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[mt.MARKER].calculator(null,s.markerStart,s.markerStart,null,null)),v.has("markerEnd")&&s.markerEnd&&(r.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[mt.MARKER].calculator(null,s.markerEnd,s.markerEnd,null,null)),v.has("markerMid")&&s.markerMid&&(r.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[mt.MARKER].calculator("",s.markerMid,s.markerMid,null,null)),v.has("zIndex")&&!(0,At.Z)(s.zIndex)&&this.runtime.CSSPropertySyntaxFactory[mt.Z_INDEX].postProcessor(r),v.has("offsetDistance")&&!(0,At.Z)(s.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[mt.OFFSET_DISTANCE].postProcessor(r),v.has("transform")&&s.transform&&this.runtime.CSSPropertySyntaxFactory[mt.TRANSFORM].postProcessor(r),v.has("transformOrigin")&&s.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[mt.TRANSFORM_ORIGIN].postProcessor(r),f&&(r.geometry.dirty=!0,r.dirty(!0,!0),l.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(r))}},{key:"updateGeometry",value:function(r){var s=r.nodeName,l=this.runtime.geometryUpdaterFactory[s];if(l){var u=r.geometry;u.contentBounds||(u.contentBounds=new ke),u.renderBounds||(u.renderBounds=new ke);var h=r.parsedStyle,f=l.update(h,r),d=f.cx,v=d===void 0?0:d,p=f.cy,g=p===void 0?0:p,y=f.cz,m=y===void 0?0:y,b=f.hwidth,x=b===void 0?0:b,E=f.hheight,w=E===void 0?0:E,S=f.hdepth,M=S===void 0?0:S,C=[Math.abs(x),Math.abs(w),M],T=h.stroke,O=h.lineWidth,k=O===void 0?1:O,P=h.increasedLineWidthForHitTesting,A=P===void 0?0:P,N=h.shadowType,L=N===void 0?"outer":N,R=h.shadowColor,z=h.filter,Z=z===void 0?[]:z,X=h.transformOrigin,nt=[v,g,m];u.contentBounds.update(nt,C);var K=s===J.POLYLINE||s===J.POLYGON||s===J.PATH?Math.SQRT2:.5,rt=T&&!T.isNone;if(rt){var U=((k||0)+(A||0))*K;C[0]+=U,C[1]+=U}if(u.renderBounds.update(nt,C),R&&L&&L!=="inner"){var at=u.renderBounds,ht=at.min,pt=at.max,Ct=h.shadowBlur,Zt=h.shadowOffsetX,Nt=h.shadowOffsetY,Pt=Ct||0,ie=Zt||0,Kt=Nt||0,re=ht[0]-Pt+ie,te=pt[0]+Pt+ie,ze=ht[1]-Pt+Kt,Yt=pt[1]+Pt+Kt;ht[0]=Math.min(ht[0],re),pt[0]=Math.max(pt[0],te),ht[1]=Math.min(ht[1],ze),pt[1]=Math.max(pt[1],Yt),u.renderBounds.setMinMax(ht,pt)}Z.forEach(function(En){var Yi=En.name,_n=En.params;if(Yi==="blur"){var ur=_n[0].value;u.renderBounds.update(u.renderBounds.center,Jt(u.renderBounds.halfExtents,u.renderBounds.halfExtents,[ur,ur,0]))}else if(Yi==="drop-shadow"){var Xt=_n[0].value,he=_n[1].value,Qt=_n[2].value,oe=u.renderBounds,be=oe.min,kt=oe.max,le=be[0]-Qt+Xt,fe=kt[0]+Qt+Xt,fn=be[1]-Qt+he,de=kt[1]+Qt+he;be[0]=Math.min(be[0],le),kt[0]=Math.max(kt[0],fe),be[1]=Math.min(be[1],fn),kt[1]=Math.max(kt[1],de),u.renderBounds.setMinMax(be,kt)}}),r.geometry.dirty=!1;var wr=x<0,zn=w<0,Pa=(wr?-1:1)*(X?fr(X[0],0,r,!0):0),kn=(zn?-1:1)*(X?fr(X[1],1,r,!0):0);(Pa||kn)&&r.setOrigin(Pa,kn)}}},{key:"updateSizeAttenuation",value:function(r,s){r.style.isSizeAttenuation?(r.style.rawLineWidth||(r.style.rawLineWidth=r.style.lineWidth),r.style.lineWidth=(r.style.rawLineWidth||1)/s,r.nodeName===J.CIRCLE&&(r.style.rawR||(r.style.rawR=r.style.r),r.style.r=(r.style.rawR||1)/s)):(r.style.rawLineWidth&&(r.style.lineWidth=r.style.rawLineWidth,delete r.style.rawLineWidth),r.nodeName===J.CIRCLE&&r.style.rawR&&(r.style.r=r.style.rawR,delete r.style.rawR))}}])}();function HT(a,n){var r=ly(a);for(var s in n)r.has(s)&&(a.parsedStyle[s]=n[s])}function ly(a){return a.constructor.PARSED_STYLE_LIST}var $T=function(){function a(){(0,I.Z)(this,a),this.mixer=Xf}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l,u){return nr(l)}}])}(),UT=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l,u,h){return l instanceof kr&&(l=null),h.sceneGraphService.updateDisplayObjectDependency(r,s,l,u),r==="clipPath"&&u.forEach(function(f){f.childNodes.length===0&&h.sceneGraphService.dirtyToRoot(f)}),l}}])}(),YT=function(){function a(){(0,I.Z)(this,a),this.parser=Ro,this.mixer=cT}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l,u){return l instanceof kr?l.value==="none"?zg:Zg:l}}])}(),XT=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l){return l instanceof kr?[]:l}}])}();function cy(a){var n=a.parsedStyle,r=n.fontSize;return(0,At.Z)(r)?null:r}var rd=function(){function a(){(0,I.Z)(this,a),this.mixer=Xf}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l,u,h){if((0,se.Z)(l))return l;if(Me.isRelativeUnit(l.unit)){if(l.unit===bt.kPercentage)return 0;if(l.unit===bt.kEms){if(u.parentNode){var f=cy(u.parentNode);if(f)return f*=l.value,f}return 0}if(l.unit===bt.kRems){var d;if(u!=null&&(d=u.ownerDocument)!==null&&d!==void 0&&d.documentElement){var v=cy(u.ownerDocument.documentElement);if(v)return v*=l.value,v}return 0}}else return l.value}}])}(),qT=function(){function a(){(0,I.Z)(this,a),this.mixer=Yg}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l){return l.map(function(u){return u.value})}}])}(),KT=function(){function a(){(0,I.Z)(this,a),this.mixer=Yg}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l){return l.map(function(u){return u.value})}}])}(),QT=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l,u){var h;l instanceof kr&&(l=null);var f=(h=l)===null||h===void 0?void 0:h.cloneNode(!0);return f&&(f.style.isMarker=!0),f}}])}(),JT=function(){function a(){(0,I.Z)(this,a),this.mixer=Xf}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l){return l.value}}])}(),tC=function(){function a(){(0,I.Z)(this,a),this.mixer=qf(0,1)}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l){return l.value}},{key:"postProcessor",value:function(r){var s=r.parsedStyle,l=s.offsetPath,u=s.offsetDistance;if(l){var h=l.nodeName;if(h===J.LINE||h===J.PATH||h===J.POLYLINE){var f=l.getPoint(u);f&&r.setLocalPosition(f.x,f.y)}}}}])}(),eC=function(){function a(){(0,I.Z)(this,a),this.mixer=qf(0,1)}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l){return l.value}}])}(),nC=function(){function a(){(0,I.Z)(this,a),this.parser=ny,this.mixer=_T}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l){return l instanceof kr&&l.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new As(0,0,0,0)}:l}}])}(),rC=(0,D.Z)(function a(){(0,I.Z)(this,a),this.mixer=AT}),iC=function(a){function n(){var r;(0,I.Z)(this,n);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=(0,G.Z)(this,n,[].concat(l)),r.mixer=qf(0,1/0),r}return(0,F.Z)(n,a),(0,D.Z)(n)}(rd),aC=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l,u){return l instanceof kr?l.value==="unset"?"":l.value:"".concat(l)}},{key:"postProcessor",value:function(r){r.nodeValue="".concat(r.parsedStyle.text)||""}}])}(),sC=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l,u){var h=u.getAttribute("text");if(h){var f=h;l.value==="capitalize"?f=h.charAt(0).toUpperCase()+h.slice(1):l.value==="lowercase"?f=h.toLowerCase():l.value==="uppercase"&&(f=h.toUpperCase()),u.parsedStyle.text=f}return l.value}}])}(),Lz=function(n){return Object.fromEntries(Object.entries(n).filter(function(r){var s=_slicedToArray(r,2),l=s[1];return l!==void 0}))},id=new WeakMap;function oC(a,n,r){if(a){var s=typeof a=="string"?document.getElementById(a):a;id.has(s)&&id.get(s).destroy(r),id.set(s,n)}}var ad=typeof window!="undefined"&&typeof window.document!="undefined";function lC(a){return!!a.getAttribute}function cC(a,n){for(var r=0,s=a.length;r<s;){var l=r+s>>>1;uy(a[l],n)<0?r=l+1:s=l}return r}function uy(a,n){var r=Number(a.parsedStyle.zIndex||0),s=Number(n.parsedStyle.zIndex||0);if(r===s){var l=a.parentNode;if(l){var u=l.childNodes||[];return u.indexOf(a)-u.indexOf(n)}}return r-s}function hy(a){var n=a;do{var r,s=(r=n.parsedStyle)===null||r===void 0?void 0:r.clipPath;if(s)return n;n=n.parentElement}while(n!==null);return null}var fy="px";function uC(a,n,r){ad&&a.style&&(a.style.width=n+fy,a.style.height=r+fy)}function dy(a,n){if(ad)return document.defaultView.getComputedStyle(a,null).getPropertyValue(n)}function hC(a){var n=dy(a,"width");return n==="auto"?a.offsetWidth:parseFloat(n)}function fC(a){var n=dy(a,"height");return n==="auto"?a.offsetHeight:parseFloat(n)}var dC=1,vC={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},sd=typeof performance=="object"&&performance.now?performance:Date;function Qc(a){return a.nodeName===J.FRAGMENT?!0:a.getRootNode().nodeName===J.FRAGMENT}function Ga(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"auto",n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,s=!1,l=!1,u=!!n&&!n.isNone,h=!!r&&!r.isNone;return a==="visiblepainted"||a==="painted"||a==="auto"?(s=u,l=h):a==="visiblefill"||a==="fill"?s=!0:a==="visiblestroke"||a==="stroke"?l=!0:(a==="visible"||a==="all")&&(s=!0,l=!0),[s,l]}var pC=1,gC=function(){return pC++},di=typeof self=="object"&&self.self===self?self:typeof Y.g=="object"&&Y.g.global===Y.g?Y.g:{},yC=Date.now(),mC=function(){return di.performance&&typeof di.performance.now=="function"?di.performance.now():Date.now()-yC},Io={},vy=Date.now(),bC=function(n){if(typeof n!="function")throw new TypeError("".concat(n," is not a function"));var r=Date.now(),s=r-vy,l=s>16?0:16-s,u=gC();return Io[u]=n,Object.keys(Io).length>1||setTimeout(function(){vy=r;var h=Io;Io={},Object.keys(h).forEach(function(f){return h[f](mC())})},l),u},xC=function(n){delete Io[n]},EC=["","webkit","moz","ms","o"],py=function(n){return typeof n!="string"?bC:n===""?di.requestAnimationFrame:di["".concat(n,"RequestAnimationFrame")]},wC=function(n){return typeof n!="string"?xC:n===""?di.cancelAnimationFrame:di["".concat(n,"CancelAnimationFrame")]||di["".concat(n,"CancelRequestAnimationFrame")]},SC=function(n,r){for(var s=0;n[s]!==void 0;){if(r(n[s]))return n[s];s+=1}},gy=SC(EC,function(a){return!!py(a)}),od=py(gy),yy=wC(gy);di.requestAnimationFrame=od,di.cancelAnimationFrame=yy;var MC=function(){function a(){(0,I.Z)(this,a),this.callbacks=[]}return(0,D.Z)(a,[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(r,s){this.callbacks.push(s)}},{key:"promise",value:function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return Promise.all(this.callbacks.map(function(u){return u.apply(void 0,s)}))}}])}(),TC=function(){function a(){(0,I.Z)(this,a),this.callbacks=[]}return(0,D.Z)(a,[{key:"tapPromise",value:function(r,s){this.callbacks.push(s)}},{key:"promise",value:function(){var n=(0,ia.Z)((0,Rn.Z)().mark(function s(){var l,u,h,f,d=arguments;return(0,Rn.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!this.callbacks.length){v.next=6;break}return v.next=1,(l=this.callbacks)[0].apply(l,d);case 1:u=v.sent,h=0;case 2:if(!(h<this.callbacks.length-1)){v.next=5;break}return f=this.callbacks[h],v.next=3,f(u);case 3:u=v.sent;case 4:h++,v.next=2;break;case 5:return v.abrupt("return",u);case 6:return v.abrupt("return",null);case 7:case"end":return v.stop()}},s,this)}));function r(){return n.apply(this,arguments)}return r}()}])}(),Wn=function(){function a(){(0,I.Z)(this,a),this.callbacks=[]}return(0,D.Z)(a,[{key:"tap",value:function(r,s){this.callbacks.push(s)}},{key:"call",value:function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];var u=arguments;this.callbacks.forEach(function(h){h.apply(void 0,u)})}}])}(),ld=function(){function a(){(0,I.Z)(this,a),this.callbacks=[]}return(0,D.Z)(a,[{key:"tap",value:function(r,s){this.callbacks.push(s)}},{key:"call",value:function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];if(this.callbacks.length){for(var u=arguments,h=this.callbacks[0].apply(void 0,u),f=0;f<this.callbacks.length-1;f++){var d=this.callbacks[f];h=d(h)}return h}return null}}])}(),CC=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],OC=/([\"\'])[^\'\"]+\1/;function my(a){var n=a.fontSize,r=n===void 0?16:n,s=a.fontFamily,l=s===void 0?"sans-serif":s,u=a.fontStyle,h=u===void 0?"normal":u,f=a.fontVariant,d=f===void 0?"normal":f,v=a.fontWeight,p=v===void 0?"normal":v;return{fontSize:r,fontFamily:l,fontStyle:h,fontVariant:d,fontWeight:p}}var by=Ke(function(n){for(var r=my(n),s=r.fontSize,l=r.fontFamily,u=r.fontStyle,h=r.fontVariant,f=r.fontWeight,d=(0,se.Z)(s)&&"".concat(s,"px")||"16px",v=l.split(","),p=v.length-1;p>=0;p--){var g=v[p].trim();!OC.test(g)&&CC.indexOf(g)<0&&(g='"'.concat(g,'"')),v[p]=g}return"".concat(u," ").concat(h," ").concat(f," ").concat(d," ").concat(v.join(","))},function(a){var n=my(a),r=n.fontSize,s=n.fontFamily,l=n.fontStyle,u=n.fontVariant,h=n.fontWeight;return"".concat(l,"_").concat(u,"_").concat(h,"_").concat(r,"_").concat(s)}),kC=1e-6,Bo=function(n){return Math.max(n,kC)};function cd(a,n,r){return Ji(a),a[4]=Math.tan(n),a[1]=Math.tan(r),a}var Qe=Ce(),_C=Ce(),PC={scale:function(n){Na(Qe,[n[0].value,n[1].value,1].map(function(r){return Bo(r)}))},scaleX:function(n){Na(Qe,[n[0].value,1,1].map(function(r){return Bo(r)}))},scaleY:function(n){Na(Qe,[1,n[0].value,1].map(function(r){return Bo(r)}))},scaleZ:function(n){Na(Qe,[1,1,n[0].value].map(function(r){return Bo(r)}))},scale3d:function(n){Na(Qe,[n[0].value,n[1].value,n[2].value].map(function(r){return Bo(r)}))},translate:function(n){ta(Qe,[n[0].value,n[1].value,0])},translateX:function(n){ta(Qe,[n[0].value,0,0])},translateY:function(n){ta(Qe,[0,n[0].value,0])},translateZ:function(n){ta(Qe,[0,0,n[0].value])},translate3d:function(n){ta(Qe,[n[0].value,n[1].value,n[2].value])},rotate:function(n){Sf(Qe,we(nr(n[0])))},rotateX:function(n){kp(Qe,we(nr(n[0])))},rotateY:function(n){_p(Qe,we(nr(n[0])))},rotateZ:function(n){Sf(Qe,we(nr(n[0])))},rotate3d:function(n){Op(Qe,we(nr(n[3])),[n[0].value,n[1].value,n[2].value])},skew:function(n){cd(Qe,we(n[0].value),we(n[1].value))},skewX:function(n){cd(Qe,we(n[0].value),0)},skewY:function(n){cd(Qe,0,we(n[0].value))},matrix:function(n){wf(Qe,n[0].value,n[1].value,0,0,n[2].value,n[3].value,0,0,0,0,1,0,n[4].value,n[5].value,0,1)},matrix3d:function(n){wf.apply(Q,[Qe].concat((0,B.Z)(n.map(function(r){return r.value}))))}},AC=vt(1,1,1),NC=j(),xy={translate:function(n,r){st.sceneGraphService.setLocalScale(n,AC,!1),st.sceneGraphService.setLocalEulerAngles(n,NC,void 0,void 0,!1),st.sceneGraphService.setLocalPosition(n,[r[0].value,r[1].value,0],!1),st.sceneGraphService.dirtyLocalTransform(n,n.transformable)}};function Ey(a,n){if(a.length){if(a.length===1&&xy[a[0].t]){xy[a[0].t](n,a[0].d);return}for(var r=Ji(_C),s=0;s<a.length;s++){var l=a[s],u=l.t,h=l.d,f=PC[u];f&&(f(h),Bp(r,r,Qe))}n.setLocalTransform(r)}else n.resetLocalTransform();return n.getLocalTransform()}var RC=function(){function a(){(0,I.Z)(this,a),this.parser=NT,this.mixer=GT}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l,u){return l instanceof kr?[]:l}},{key:"postProcessor",value:function(r){Ey(r.parsedStyle.transform,r)}}])}(),LC=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"postProcessor",value:function(r){var s=r.parsedStyle.transformOrigin;s[0].unit===bt.kPixels&&s[1].unit===bt.kPixels?r.setOrigin(s[0].value,s[1].value):r.getGeometryBounds()}}])}(),DC=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"calculator",value:function(r,s,l,u){return l.value}},{key:"postProcessor",value:function(r){if(r.parentNode){var s=r.parentNode,l=s.renderable,u=s.sortable;l&&s.dirty(),u&&(u.dirty=!0,u.dirtyReason=Zc.Z_INDEX_CHANGED)}}}])}(),IC=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"update",value:function(r,s){var l=r.cx,u=l===void 0?0:l,h=r.cy,f=h===void 0?0:h,d=r.r,v=d===void 0?0:d;return{cx:u,cy:f,hwidth:v,hheight:v}}}])}(),BC=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"update",value:function(r,s){var l=r.cx,u=l===void 0?0:l,h=r.cy,f=h===void 0?0:h,d=r.rx,v=d===void 0?0:d,p=r.ry,g=p===void 0?0:p;return{cx:u,cy:f,hwidth:v,hheight:g}}}])}(),FC=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"update",value:function(r){var s=r.x1,l=r.y1,u=r.x2,h=r.y2,f=Math.min(s,u),d=Math.max(s,u),v=Math.min(l,h),p=Math.max(l,h),g=d-f,y=p-v,m=g/2,b=y/2;return{cx:f+m,cy:v+b,hwidth:m,hheight:b}}}])}(),zC=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"update",value:function(r){var s=r.d,l=s.rect,u=l.x,h=l.y,f=l.width,d=l.height,v=f/2,p=d/2;return{cx:u+v,cy:h+p,hwidth:v,hheight:p}}}])}(),ZC=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"update",value:function(r){if(r.points&&(0,Gr.Z)(r.points.points)){var s=r.points.points,l=Math.min.apply(Math,(0,B.Z)(s.map(function(y){return y[0]}))),u=Math.max.apply(Math,(0,B.Z)(s.map(function(y){return y[0]}))),h=Math.min.apply(Math,(0,B.Z)(s.map(function(y){return y[1]}))),f=Math.max.apply(Math,(0,B.Z)(s.map(function(y){return y[1]}))),d=u-l,v=f-h,p=d/2,g=v/2;return{cx:l+p,cy:h+g,hwidth:p,hheight:g}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),GC=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"update",value:function(r,s){var l=r.x,u=l===void 0?0:l,h=r.y,f=h===void 0?0:h,d=r.src,v=r.width,p=v===void 0?0:v,g=r.height,y=g===void 0?0:g,m=p,b=y;return d&&!(0,ve.Z)(d)&&(m||(m=d.width,r.width=m),b||(b=d.height,r.height=b)),{cx:u+m/2,cy:f+b/2,hwidth:m/2,hheight:b/2}}}])}(),WC=function(){function a(n){(0,I.Z)(this,a),this.globalRuntime=n}return(0,D.Z)(a,[{key:"isReadyToMeasure",value:function(r,s){var l=r.text;return l}},{key:"update",value:function(r,s){var l,u=r.text,h=r.textAlign,f=h===void 0?"start":h,d=r.lineWidth,v=d===void 0?1:d,p=r.textBaseline,g=p===void 0?"alphabetic":p,y=r.dx,m=y===void 0?0:y,b=r.dy,x=b===void 0?0:b,E=r.x,w=E===void 0?0:E,S=r.y,M=S===void 0?0:S;if(!this.isReadyToMeasure(r,s))return r.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var C=(s==null||(l=s.ownerDocument)===null||l===void 0||(l=l.defaultView)===null||l===void 0?void 0:l.getConfig())||{},T=C.offscreenCanvas,O=this.globalRuntime.textService.measureText(u,r,T);r.metrics=O;var k=O.width,P=O.height,A=k/2,N=P/2,L=w+A;f==="center"||f==="middle"?L+=v/2-A:(f==="right"||f==="end")&&(L+=v-A*2);var R=M-N;return g==="middle"?R+=N:g==="top"||g==="hanging"?R+=N*2:g==="alphabetic"||(g==="bottom"||g==="ideographic")&&(R+=0),m&&(L+=m),x&&(R+=x),{cx:L,cy:R,hwidth:A,hheight:N}}}])}(),jC=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"update",value:function(r,s){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),VC=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"update",value:function(r,s){var l=r.x,u=l===void 0?0:l,h=r.y,f=h===void 0?0:h,d=r.width,v=d===void 0?0:d,p=r.height,g=p===void 0?0:p;return{cx:u+v/2,cy:f+g/2,hwidth:v/2,hheight:g/2}}}])}();function Dz(a){return!!a.type}var Jc=function(){function a(n){(0,I.Z)(this,a),this.eventPhase=a.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new wn,this.page=new wn,this.canvas=new wn,this.viewport=new wn,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=n}return(0,D.Z)(a,[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(Ee)}}])}(),wy=function(a){function n(){var r;(0,I.Z)(this,n);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=(0,G.Z)(this,n,[].concat(l)),r.client=new wn,r.movement=new wn,r.offset=new wn,r.global=new wn,r.screen=new wn,r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(s){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(s)}},{key:"initMouseEvent",value:function(){throw new Error(Ee)}}])}(Jc),tu=function(a){function n(){var r;(0,I.Z)(this,n);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=(0,G.Z)(this,n,[].concat(l)),r.width=0,r.height=0,r.isPrimary=!1,r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"getCoalescedEvents",value:function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(wy),ud=function(a){function n(){return(0,I.Z)(this,n),(0,G.Z)(this,n,arguments)}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(wy),sn=function(a){function n(r,s){var l;return(0,I.Z)(this,n),l=(0,G.Z)(this,n,[null]),l.type=r,l.detail=s,Object.assign(l,s),l}return(0,F.Z)(n,a),(0,D.Z)(n)}(Jc),Sy=function(){function a(){(0,I.Z)(this,a),this.emitter=new q}return(0,D.Z)(a,[{key:"on",value:function(r,s,l){return this.addEventListener(r,s,l),this}},{key:"addEventListener",value:function(r,s,l){var u=!1,h=!1;if(Co(l))u=l;else if(l){var f=l.capture;u=f===void 0?!1:f;var d=l.once;h=d===void 0?!1:d}u&&(r+="capture"),s=(0,_t.Z)(s)?s:s.handleEvent;var v=(0,_t.Z)(s)?void 0:s;return h?this.emitter.once(r,s,v):this.emitter.on(r,s,v),this}},{key:"off",value:function(r,s,l){return r?this.removeEventListener(r,s,l):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var r;(r=this.emitter)===null||r===void 0||r.removeAllListeners()}},{key:"removeEventListener",value:function(r,s,l){var u;if(!this.emitter)return this;var h=Co(l)?l:l==null?void 0:l.capture;h&&(r+="capture"),s=(0,_t.Z)(s)?s:(u=s)===null||u===void 0?void 0:u.handleEvent;var f=(0,_t.Z)(s)?void 0:s;return this.emitter.off(r,s,f),this}},{key:"emit",value:function(r,s){this.dispatchEvent(new sn(r,s))}},{key:"dispatchEventToSelf",value:function(r){r.target||(r.target=this),r.currentTarget=this,this.emitter.emit(r.type,r)}},{key:"dispatchEvent",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2?arguments[2]:void 0;if(l)return this.dispatchEventToSelf(r),!0;var u;if(this.document)u=this;else if(this.defaultView)u=this.defaultView;else{var h;u=(h=this.ownerDocument)===null||h===void 0?void 0:h.defaultView}if(u){if(r.manager=u.getEventService(),!r.manager)return!1;r.defaultPrevented=!1,r.path?r.path.length=0:r.page=[],s||(r.target=this),r.manager.dispatchEvent(r,r.type,s)}else this.dispatchEventToSelf(r);return!r.defaultPrevented}}])}(),Be=function(a){function n(){var r;(0,I.Z)(this,n);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=(0,G.Z)(this,n,[].concat(l)),r.shadow=!1,r.ownerDocument=null,r.isConnected=!1,r.baseURI="",r.childNodes=[],r.nodeType=0,r.nodeName="",r.nodeValue=null,r.parentNode=null,r.destroyed=!1,r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"textContent",get:function(){var s="";this.nodeName===J.TEXT&&(s+=this.style.text);var l=(0,La.Z)(this.childNodes),u;try{for(l.s();!(u=l.n()).done;){var h=u.value;h.nodeName===J.TEXT?s+=h.nodeValue:s+=h.textContent}}catch(f){l.e(f)}finally{l.f()}return s},set:function(s){var l=this;this.childNodes.slice().forEach(function(u){l.removeChild(u)}),this.nodeName===J.TEXT&&(this.style.text="".concat(s))}},{key:"getRootNode",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(s):s.composed&&this.host?this.host.getRootNode(s):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(s){throw new Error(Ee)}},{key:"lookupNamespaceURI",value:function(s){throw new Error(Ee)}},{key:"lookupPrefix",value:function(s){throw new Error(Ee)}},{key:"normalize",value:function(){throw new Error(Ee)}},{key:"isEqualNode",value:function(s){return this===s}},{key:"isSameNode",value:function(s){return this.isEqualNode(s)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(s){if(s===this)return 0;for(var l=s,u=this,h=[l],f=[u];(d=l.parentNode)!==null&&d!==void 0?d:u.parentNode;){var d;l=l.parentNode?(h.push(l.parentNode),l.parentNode):l,u=u.parentNode?(f.push(u.parentNode),u.parentNode):u}if(l!==u)return n.DOCUMENT_POSITION_DISCONNECTED|n.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|n.DOCUMENT_POSITION_PRECEDING;var v=h.length>f.length?h:f,p=v===h?f:h;if(v[v.length-p.length]===p[0])return v===h?n.DOCUMENT_POSITION_CONTAINED_BY|n.DOCUMENT_POSITION_FOLLOWING:n.DOCUMENT_POSITION_CONTAINS|n.DOCUMENT_POSITION_PRECEDING;for(var g=v.length-p.length,y=p.length-1;y>=0;y--){var m=p[y],b=v[g+y];if(b!==m){var x=m.parentNode.childNodes;return x.indexOf(m)<x.indexOf(b)?p===h?n.DOCUMENT_POSITION_PRECEDING:n.DOCUMENT_POSITION_FOLLOWING:v===h?n.DOCUMENT_POSITION_PRECEDING:n.DOCUMENT_POSITION_FOLLOWING}}return n.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(s){return this.contains(s)}},{key:"contains",value:function(s){for(var l=s;l&&this!==l;)l=l.parentNode;return!!l}},{key:"getAncestor",value:function(s){for(var l=this;s>0&&l;)l=l.parentNode,s--;return l}},{key:"forEach",value:function(s){for(var l=[this];l.length>0;){var u=l.pop(),h=s(u);if(h===!1)break;for(var f=u.childNodes.length-1;f>=0;f--)l.push(u.childNodes[f])}}}],[{key:"isNode",value:function(s){return!!s.childNodes}}])}(Sy);Be.DOCUMENT_POSITION_DISCONNECTED=1,Be.DOCUMENT_POSITION_PRECEDING=2,Be.DOCUMENT_POSITION_FOLLOWING=4,Be.DOCUMENT_POSITION_CONTAINS=8,Be.DOCUMENT_POSITION_CONTAINED_BY=16,Be.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var HC=2048,$C=function(){function a(n,r){var s=this;(0,I.Z)(this,a),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=Ce(),this.tmpVec3=j(),this.onPointerDown=function(l){var u=s.createPointerEvent(l);if(s.dispatchEvent(u,"pointerdown"),u.pointerType==="touch")s.dispatchEvent(u,"touchstart");else if(u.pointerType==="mouse"||u.pointerType==="pen"){var h=u.button===2;s.dispatchEvent(u,h?"rightdown":"mousedown")}var f=s.trackingData(l.pointerId);f.pressTargetsByButton[l.button]=u.composedPath(),s.freeEvent(u)},this.onPointerUp=function(l){var u=sd.now(),h=s.createPointerEvent(l,void 0,void 0,s.context.config.alwaysTriggerPointerEventOnCanvas?s.rootTarget:void 0);if(s.dispatchEvent(h,"pointerup"),h.pointerType==="touch")s.dispatchEvent(h,"touchend");else if(h.pointerType==="mouse"||h.pointerType==="pen"){var f=h.button===2;s.dispatchEvent(h,f?"rightup":"mouseup")}var d=s.trackingData(l.pointerId),v=s.findMountedTarget(d.pressTargetsByButton[l.button]),p=v;if(v&&!h.composedPath().includes(v)){for(var g=v;g&&!h.composedPath().includes(g);){if(h.currentTarget=g,s.notifyTarget(h,"pointerupoutside"),h.pointerType==="touch")s.notifyTarget(h,"touchendoutside");else if(h.pointerType==="mouse"||h.pointerType==="pen"){var y=h.button===2;s.notifyTarget(h,y?"rightupoutside":"mouseupoutside")}Be.isNode(g)&&(g=g.parentNode)}delete d.pressTargetsByButton[l.button],p=g}if(p){var m,b=s.clonePointerEvent(h,"click");b.target=p,b.path=[],d.clicksByButton[l.button]||(d.clicksByButton[l.button]={clickCount:0,target:b.target,timeStamp:u});var x=s.context.renderingContext.root.ownerDocument.defaultView,E=d.clicksByButton[l.button];E.target===b.target&&u-E.timeStamp<x.getConfig().dblClickSpeed?++E.clickCount:E.clickCount=1,E.target=b.target,E.timeStamp=u,b.detail=E.clickCount,(m=h.detail)!==null&&m!==void 0&&m.preventClick||(!s.context.config.useNativeClickEvent&&(b.pointerType==="mouse"||b.pointerType==="touch")&&s.dispatchEvent(b,"click"),s.dispatchEvent(b,"pointertap")),s.freeEvent(b)}s.freeEvent(h)},this.onPointerMove=function(l){var u=s.createPointerEvent(l,void 0,void 0,s.context.config.alwaysTriggerPointerEventOnCanvas?s.rootTarget:void 0),h=u.pointerType==="mouse"||u.pointerType==="pen",f=s.trackingData(l.pointerId),d=s.findMountedTarget(f.overTargets);if(f.overTargets&&d!==u.target){var v=l.type==="mousemove"?"mouseout":"pointerout",p=s.createPointerEvent(l,v,d||void 0);if(s.dispatchEvent(p,"pointerout"),h&&s.dispatchEvent(p,"mouseout"),!u.composedPath().includes(d)){var g=s.createPointerEvent(l,"pointerleave",d||void 0);for(g.eventPhase=g.AT_TARGET;g.target&&!u.composedPath().includes(g.target);)g.currentTarget=g.target,s.notifyTarget(g),h&&s.notifyTarget(g,"mouseleave"),Be.isNode(g.target)&&(g.target=g.target.parentNode);s.freeEvent(g)}s.freeEvent(p)}if(d!==u.target){var y=l.type==="mousemove"?"mouseover":"pointerover",m=s.clonePointerEvent(u,y);s.dispatchEvent(m,"pointerover"),h&&s.dispatchEvent(m,"mouseover");for(var b=d&&Be.isNode(d)&&d.parentNode;b&&b!==(Be.isNode(s.rootTarget)&&s.rootTarget.parentNode)&&b!==u.target;)b=b.parentNode;var x=!b||b===(Be.isNode(s.rootTarget)&&s.rootTarget.parentNode);if(x){var E=s.clonePointerEvent(u,"pointerenter");for(E.eventPhase=E.AT_TARGET;E.target&&E.target!==d&&E.target!==(Be.isNode(s.rootTarget)&&s.rootTarget.parentNode);)E.currentTarget=E.target,s.notifyTarget(E),h&&s.notifyTarget(E,"mouseenter"),Be.isNode(E.target)&&(E.target=E.target.parentNode);s.freeEvent(E)}s.freeEvent(m)}s.dispatchEvent(u,"pointermove"),u.pointerType==="touch"&&s.dispatchEvent(u,"touchmove"),h&&(s.dispatchEvent(u,"mousemove"),s.cursor=s.getCursor(u.target)),f.overTargets=u.composedPath(),s.freeEvent(u)},this.onPointerOut=function(l){var u=s.trackingData(l.pointerId);if(u.overTargets){var h=l.pointerType==="mouse"||l.pointerType==="pen",f=s.findMountedTarget(u.overTargets),d=s.createPointerEvent(l,"pointerout",f||void 0);s.dispatchEvent(d),h&&s.dispatchEvent(d,"mouseout");var v=s.createPointerEvent(l,"pointerleave",f||void 0);for(v.eventPhase=v.AT_TARGET;v.target&&v.target!==(Be.isNode(s.rootTarget)&&s.rootTarget.parentNode);)v.currentTarget=v.target,s.notifyTarget(v),h&&s.notifyTarget(v,"mouseleave"),Be.isNode(v.target)&&(v.target=v.target.parentNode);u.overTargets=null,s.freeEvent(d),s.freeEvent(v)}s.cursor=null},this.onPointerOver=function(l){var u=s.trackingData(l.pointerId),h=s.createPointerEvent(l),f=h.pointerType==="mouse"||h.pointerType==="pen";s.dispatchEvent(h,"pointerover"),f&&s.dispatchEvent(h,"mouseover"),h.pointerType==="mouse"&&(s.cursor=s.getCursor(h.target));var d=s.clonePointerEvent(h,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==(Be.isNode(s.rootTarget)&&s.rootTarget.parentNode);)d.currentTarget=d.target,s.notifyTarget(d),f&&s.notifyTarget(d,"mouseenter"),Be.isNode(d.target)&&(d.target=d.target.parentNode);u.overTargets=h.composedPath(),s.freeEvent(h),s.freeEvent(d)},this.onPointerUpOutside=function(l){var u=s.trackingData(l.pointerId),h=s.findMountedTarget(u.pressTargetsByButton[l.button]),f=s.createPointerEvent(l);if(h){for(var d=h;d;)f.currentTarget=d,s.notifyTarget(f,"pointerupoutside"),f.pointerType==="touch"||(f.pointerType==="mouse"||f.pointerType==="pen")&&s.notifyTarget(f,f.button===2?"rightupoutside":"mouseupoutside"),Be.isNode(d)&&(d=d.parentNode);delete u.pressTargetsByButton[l.button]}s.freeEvent(f)},this.onWheel=function(l){var u=s.createWheelEvent(l);s.dispatchEvent(u),s.freeEvent(u)},this.onClick=function(l){if(s.context.config.useNativeClickEvent){var u=s.createPointerEvent(l);s.dispatchEvent(u),s.freeEvent(u)}},this.onPointerCancel=function(l){var u=s.createPointerEvent(l,void 0,void 0,s.context.config.alwaysTriggerPointerEventOnCanvas?s.rootTarget:void 0);s.dispatchEvent(u),s.freeEvent(u)},this.globalRuntime=n,this.context=r}return(0,D.Z)(a,[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var r=this.context.contextService.getBoundingClientRect(),s=1,l=1,u=this.context.contextService.getDomElement();if(u&&r){var h=u.offsetWidth,f=u.offsetHeight;h&&f&&(s=r.width/h,l=r.height/f)}return{scaleX:s,scaleY:l,bbox:r}}},{key:"client2Viewport",value:function(r){var s=this.getScale(),l=s.scaleX,u=s.scaleY,h=s.bbox;return new wn((r.x-((h==null?void 0:h.left)||0))/l,(r.y-((h==null?void 0:h.top)||0))/u)}},{key:"viewport2Client",value:function(r){var s=this.getScale(),l=s.scaleX,u=s.scaleY,h=s.bbox;return new wn((r.x+((h==null?void 0:h.left)||0))*l,(r.y+((h==null?void 0:h.top)||0))*u)}},{key:"viewport2Canvas",value:function(r){var s=r.x,l=r.y,u=this.rootTarget.defaultView,h=u.getCamera(),f=this.context.config,d=f.width,v=f.height,p=h.getPerspectiveInverse(),g=h.getWorldTransform(),y=An(this.tmpMatrix,g,p),m=Dt(this.tmpVec3,s/d*2-1,(1-l/v)*2-1,0);return dn(m,m,y),new wn(m[0],m[1])}},{key:"canvas2Viewport",value:function(r){var s=this.rootTarget.defaultView,l=s.getCamera(),u=l.getPerspective(),h=l.getViewTransform(),f=An(this.tmpMatrix,u,h),d=Dt(this.tmpVec3,r.x,r.y,0);dn(this.tmpVec3,this.tmpVec3,f);var v=this.context.config,p=v.width,g=v.height;return new wn((d[0]+1)/2*p,(1-(d[1]+1)/2)*g)}},{key:"setPickHandler",value:function(r){this.pickHandler=r}},{key:"addEventMapping",value:function(r,s){this.mappingTable[r]||(this.mappingTable[r]=[]),this.mappingTable[r].push({fn:s,priority:0}),this.mappingTable[r].sort(function(l,u){return l.priority-u.priority})}},{key:"mapEvent",value:function(r){if(this.rootTarget){var s=this.mappingTable[r.type];if(s)for(var l=0,u=s.length;l<u;l++)s[l].fn(r);else console.warn("[EventService]: Event mapping not defined for ".concat(r.type))}}},{key:"dispatchEvent",value:function(r,s,l){if(!l)r.propagationStopped=!1,r.propagationImmediatelyStopped=!1,this.propagate(r,s);else{r.eventPhase=r.AT_TARGET;var u=this.rootTarget.defaultView||null;r.currentTarget=u,this.notifyListeners(r,s)}}},{key:"propagate",value:function(r,s){if(r.target){var l=r.composedPath();r.eventPhase=r.CAPTURING_PHASE;for(var u=l.length-1;u>=1;u--)if(r.currentTarget=l[u],this.notifyTarget(r,s),r.propagationStopped||r.propagationImmediatelyStopped)return;if(r.eventPhase=r.AT_TARGET,r.currentTarget=r.target,this.notifyTarget(r,s),!(r.propagationStopped||r.propagationImmediatelyStopped)){var h=l.indexOf(r.currentTarget);r.eventPhase=r.BUBBLING_PHASE;for(var f=h+1;f<l.length;f++)if(r.currentTarget=l[f],this.notifyTarget(r,s),r.propagationStopped||r.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(r){var s=[r],l=this.rootTarget.defaultView||null;if(l&&l===r)return s.unshift(l.document),s;for(var u=0;u<HC&&r!==this.rootTarget;u++)Be.isNode(r)&&r.parentNode&&(s.push(r.parentNode),r=r.parentNode);return l&&s.push(l),s}},{key:"hitTest",value:function(r){var s=r.viewportX,l=r.viewportY,u=this.context.config,h=u.width,f=u.height,d=u.disableHitTesting;return s<0||l<0||s>h||l>f?null:!d&&this.pickHandler(r)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(r,s){var l,u=s==null?void 0:s.target;if((l=u)!==null&&l!==void 0&&l.shadowRoot&&(u=s.composedPath()[0]),u){if(u===r)return!0;if(r&&r.contains)return r.contains(u)}return s!=null&&s.composedPath?s.composedPath().indexOf(r)>-1:!1}},{key:"getExistedHTML",value:function(r){if(r.nativeEvent.composedPath)for(var s=0,l=r.nativeEvent.composedPath();s<l.length;s++){var u=l[s],h=this.nativeHTMLMap.get(u);if(h)return h}return null}},{key:"pickTarget",value:function(r){return this.hitTest({clientX:r.clientX,clientY:r.clientY,viewportX:r.viewportX,viewportY:r.viewportY,x:r.canvasX,y:r.canvasY})}},{key:"createPointerEvent",value:function(r,s,l,u){var h=this.allocateEvent(tu);this.copyPointerData(r,h),this.copyMouseData(r,h),this.copyData(r,h),h.nativeEvent=r.nativeEvent,h.originalEvent=r;var f=this.getExistedHTML(h),d=this.context.contextService.getDomElement();return h.target=l!=null?l:f||this.isNativeEventFromCanvas(d,h.nativeEvent)&&this.pickTarget(h)||u,typeof s=="string"&&(h.type=s),h}},{key:"createWheelEvent",value:function(r){var s=this.allocateEvent(ud);this.copyWheelData(r,s),this.copyMouseData(r,s),this.copyData(r,s),s.nativeEvent=r.nativeEvent,s.originalEvent=r;var l=this.getExistedHTML(s),u=this.context.contextService.getDomElement();return s.target=l||this.isNativeEventFromCanvas(u,s.nativeEvent)&&this.pickTarget(s),s}},{key:"trackingData",value:function(r){return this.mappingState.trackingData[r]||(this.mappingState.trackingData[r]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[r]}},{key:"cloneWheelEvent",value:function(r){var s=this.allocateEvent(ud);return s.nativeEvent=r.nativeEvent,s.originalEvent=r.originalEvent,this.copyWheelData(r,s),this.copyMouseData(r,s),this.copyData(r,s),s.target=r.target,s.path=r.composedPath().slice(),s.type=r.type,s}},{key:"clonePointerEvent",value:function(r,s){var l=this.allocateEvent(tu);return l.nativeEvent=r.nativeEvent,l.originalEvent=r.originalEvent,this.copyPointerData(r,l),this.copyMouseData(r,l),this.copyData(r,l),l.target=r.target,l.path=r.composedPath().slice(),l.type=s!=null?s:l.type,l}},{key:"copyPointerData",value:function(r,s){s.pointerId=r.pointerId,s.width=r.width,s.height=r.height,s.isPrimary=r.isPrimary,s.pointerType=r.pointerType,s.pressure=r.pressure,s.tangentialPressure=r.tangentialPressure,s.tiltX=r.tiltX,s.tiltY=r.tiltY,s.twist=r.twist}},{key:"copyMouseData",value:function(r,s){s.altKey=r.altKey,s.button=r.button,s.buttons=r.buttons,s.ctrlKey=r.ctrlKey,s.metaKey=r.metaKey,s.shiftKey=r.shiftKey,s.client.copyFrom(r.client),s.movement.copyFrom(r.movement),s.canvas.copyFrom(r.canvas),s.screen.copyFrom(r.screen),s.global.copyFrom(r.global),s.offset.copyFrom(r.offset)}},{key:"copyWheelData",value:function(r,s){s.deltaMode=r.deltaMode,s.deltaX=r.deltaX,s.deltaY=r.deltaY,s.deltaZ=r.deltaZ}},{key:"copyData",value:function(r,s){s.isTrusted=r.isTrusted,s.timeStamp=sd.now(),s.type=r.type,s.detail=r.detail,s.view=r.view,s.page.copyFrom(r.page),s.viewport.copyFrom(r.viewport)}},{key:"allocateEvent",value:function(r){this.eventPool.has(r)||this.eventPool.set(r,[]);var s=this.eventPool.get(r).pop()||new r(this);return s.eventPhase=s.NONE,s.currentTarget=null,s.path=[],s.target=null,s}},{key:"freeEvent",value:function(r){if(r.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var s=r.constructor;this.eventPool.has(s)||this.eventPool.set(s,[]),this.eventPool.get(s).push(r)}},{key:"notifyTarget",value:function(r,s){s=s!=null?s:r.type;var l=r.eventPhase===r.CAPTURING_PHASE||r.eventPhase===r.AT_TARGET?"".concat(s,"capture"):s;this.notifyListeners(r,l),r.eventPhase===r.AT_TARGET&&this.notifyListeners(r,s)}},{key:"notifyListeners",value:function(r,s){var l=r.currentTarget.emitter,u=l._events[s];if(u)if("fn"in u)u.once&&l.removeListener(s,u.fn,void 0,!0),u.fn.call(r.currentTarget||u.context,r);else for(var h=0;h<u.length&&!r.propagationImmediatelyStopped;h++)u[h].once&&l.removeListener(s,u[h].fn,void 0,!0),u[h].fn.call(r.currentTarget||u[h].context,r)}},{key:"findMountedTarget",value:function(r){if(!r)return null;for(var s=r[r.length-1],l=r.length-2;l>=0;l--){var u=r[l];if(u===this.rootTarget||Be.isNode(u)&&u.parentNode===s)s=r[l];else break}return s}},{key:"getCursor",value:function(r){for(var s=r;s;){var l=lC(s)&&s.getAttribute("cursor");if(l)return l;s=Be.isNode(s)&&s.parentNode}}}])}(),hd=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"getOrCreateCanvas",value:function(r,s){if(this.canvas)return this.canvas;if(r||st.offscreenCanvas)this.canvas=r||st.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,$.Z)({willReadFrequently:!0},s));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,$.Z)({willReadFrequently:!0},s)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(l){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,$.Z)({willReadFrequently:!0},s))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(r,s){return this.context?this.context:(this.getOrCreateCanvas(r,s),this.context)}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch(r){}try{return document.createElement("canvas")}catch(r){}return null}}])}(),Bs=function(a){return a[a.CAMERA_CHANGED=0]="CAMERA_CHANGED",a[a.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",a[a.NONE=2]="NONE",a}({}),UC=function(){function a(n,r){(0,I.Z)(this,a),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Wn,initAsync:new MC,dirtycheck:new ld,cull:new ld,beginFrame:new Wn,beforeRender:new Wn,render:new Wn,afterRender:new Wn,endFrame:new Wn,destroy:new Wn,pick:new TC,pickSync:new ld,pointerDown:new Wn,pointerUp:new Wn,pointerMove:new Wn,pointerOut:new Wn,pointerOver:new Wn,pointerWheel:new Wn,pointerCancel:new Wn,click:new Wn},this.globalRuntime=n,this.context=r}return(0,D.Z)(a,[{key:"init",value:function(r){var s=this,l=(0,$.Z)((0,$.Z)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(u){u.apply(l,s.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,r()):this.hooks.initAsync.promise().then(function(){s.inited=!0,r()}).catch(function(u){})}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){var r=this.context.config.renderer,s=r.getConfig(),l=s.enableDirtyRectangleRendering;return!l||this.context.renderingContext.renderReasons.has(Bs.CAMERA_CHANGED)}},{key:"render",value:function(r,s,l){var u=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var h=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(h.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),h.renderReasons.size&&this.inited){h.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var f=h.renderReasons.size===1&&h.renderReasons.has(Bs.CAMERA_CHANGED),d=!r.disableRenderHooks||!f;d&&this.renderDisplayObject(h.root,r,h),this.hooks.beginFrame.call(s),d&&h.renderListCurrentFrame.forEach(function(v){u.hooks.beforeRender.call(v),u.hooks.render.call(v),u.hooks.afterRender.call(v)}),this.hooks.endFrame.call(s),h.renderListCurrentFrame=[],h.renderReasons.clear(),l()}}},{key:"renderDisplayObject",value:function(r,s,l){var u=this,h=s.renderer.getConfig(),f=h.enableDirtyCheck,d=h.enableCulling;function v(x){var E=x.renderable,w=x.sortable,S=f?E.dirty||l.dirtyRectangleRenderingDisabled?x:null:x,M=null;S&&(M=d?u.hooks.cull.call(S,u.context.camera):S,M&&(u.stats.rendered+=1,l.renderListCurrentFrame.push(M))),x.dirty(!1),w.renderOrder=u.zIndexCounter,u.zIndexCounter+=1,u.stats.total+=1,w.dirty&&(u.sort(x,w),w.dirty=!1,w.dirtyChildren=[],w.dirtyReason=void 0)}for(var p=[r];p.length>0;){var g,y=p.pop();v(y);for(var m=((g=y.sortable)===null||g===void 0||(g=g.sorted)===null||g===void 0?void 0:g.length)>0?y.sortable.sorted:y.childNodes,b=m.length-1;b>=0;b--)p.push(m[b])}}},{key:"sort",value:function(r,s){var l,u;(s==null||(l=s.sorted)===null||l===void 0?void 0:l.length)>0&&s.dirtyReason!==Zc.Z_INDEX_CHANGED?s.dirtyChildren.forEach(function(h){var f=s.sorted.indexOf(h);f>-1&&s.sorted.splice(f,1);var d=r.childNodes.indexOf(h);if(d>-1)if(s.sorted.length===0)s.sorted.push(h);else{var v=cC(s.sorted,h);s.sorted.splice(v,0,h)}}):s.sorted=r.childNodes.slice().sort(uy),((u=s.sorted)===null||u===void 0?void 0:u.length)>0&&r.childNodes.filter(function(h){return h.parsedStyle.zIndex}).length===0&&(s.sorted=[])}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(Bs.DISPLAY_OBJECT_CHANGED)}}])}(),YC=/\[\s*(.*)=(.*)\s*\]/,XC=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"selectOne",value:function(r,s){var l=this;if(r.startsWith("."))return s.find(function(d){return((d==null?void 0:d.classList)||[]).indexOf(l.getIdOrClassname(r))>-1});if(r.startsWith("#"))return s.find(function(d){return d.id===l.getIdOrClassname(r)});if(r.startsWith("[")){var u=this.getAttribute(r),h=u.name,f=u.value;return h?s.find(function(d){return s!==d&&(h==="name"?d.name===f:l.attributeToString(d,h)===f)}):null}return s.find(function(d){return s!==d&&d.nodeName===r})}},{key:"selectAll",value:function(r,s){var l=this;if(r.startsWith("."))return s.findAll(function(d){return s!==d&&((d==null?void 0:d.classList)||[]).indexOf(l.getIdOrClassname(r))>-1});if(r.startsWith("#"))return s.findAll(function(d){return s!==d&&d.id===l.getIdOrClassname(r)});if(r.startsWith("[")){var u=this.getAttribute(r),h=u.name,f=u.value;return h?s.findAll(function(d){return s!==d&&(h==="name"?d.name===f:l.attributeToString(d,h)===f)}):[]}return s.findAll(function(d){return s!==d&&d.nodeName===r})}},{key:"is",value:function(r,s){if(r.startsWith("."))return s.className===this.getIdOrClassname(r);if(r.startsWith("#"))return s.id===this.getIdOrClassname(r);if(r.startsWith("[")){var l=this.getAttribute(r),u=l.name,h=l.value;return u==="name"?s.name===h:this.attributeToString(s,u)===h}return s.nodeName===r}},{key:"getIdOrClassname",value:function(r){return r.substring(1)}},{key:"getAttribute",value:function(r){var s=r.match(YC),l="",u="";return s&&s.length>2&&(l=s[1].replace(/"/g,""),u=s[2].replace(/"/g,"")),{name:l,value:u}}},{key:"attributeToString",value:function(r,s){if(!r.getAttribute)return"";var l=r.getAttribute(s);return(0,At.Z)(l)?"":l.toString?l.toString():""}}])}(),$t=function(a){return a.ATTR_MODIFIED="DOMAttrModified",a.INSERTED="DOMNodeInserted",a.MOUNTED="DOMNodeInsertedIntoDocument",a.REMOVED="removed",a.UNMOUNTED="DOMNodeRemovedFromDocument",a.REPARENT="reparent",a.DESTROY="destroy",a.BOUNDS_CHANGED="bounds-changed",a.CULLED="culled",a}({}),vi=function(a){function n(r,s,l,u,h,f,d,v){var p;return(0,I.Z)(this,n),p=(0,G.Z)(this,n,[null]),p.relatedNode=s,p.prevValue=l,p.newValue=u,p.attrName=h,p.attrChange=f,p.prevParsedValue=d,p.newParsedValue=v,p.type=r,p}return(0,F.Z)(n,a),(0,D.Z)(n)}(Jc);vi.ADDITION=2,vi.MODIFICATION=1,vi.REMOVAL=3;var qC=new vi($t.REPARENT,null,"","","",0,"",""),KC=kf(),eu=j(),QC=vt(1,1,1),JC=Ce(),tO=kf(),Wa=j(),eO=Ce(),ja=an(),nO=j(),rO=an(),iO=j(),Fo=j(),Va=j(),nu=Ce(),My=an(),Ty=an(),ru=an(),iu={affectChildren:!0},aO=function(){function a(n){(0,I.Z)(this,a),this.pendingEvents=new Map,this.boundsChangedEvent=new sn($t.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=n}return(0,D.Z)(a,[{key:"matches",value:function(r,s){return this.runtime.sceneGraphSelector.is(r,s)}},{key:"querySelector",value:function(r,s){return this.runtime.sceneGraphSelector.selectOne(r,s)}},{key:"querySelectorAll",value:function(r,s){return this.runtime.sceneGraphSelector.selectAll(r,s)}},{key:"attach",value:function(r,s,l){var u,h=!1;r.parentNode&&(h=r.parentNode!==s,this.detach(r));var f=r.nodeName===J.FRAGMENT,d=Qc(s);r.parentNode=s;var v=f?r.childNodes:[r];(0,se.Z)(l)?v.forEach(function(x){s.childNodes.splice(l,0,x),x.parentNode=s}):v.forEach(function(x){s.childNodes.push(x),x.parentNode=s});var p=s,g=p.sortable;if((g!=null&&(u=g.sorted)!==null&&u!==void 0&&u.length||g.dirty||r.parsedStyle.zIndex)&&(g.dirtyChildren.indexOf(r)===-1&&g.dirtyChildren.push(r),g.dirty=!0,g.dirtyReason=Zc.ADDED),!d){if(f)this.dirtifyFragment(r);else{var y=r.transformable;y&&this.dirtyWorldTransform(r,y)}if(h){var m,b=((m=s.ownerDocument)===null||m===void 0||(m=m.defaultView)===null||m===void 0||(m=m.getConfig())===null||m===void 0||(m=m.future)===null||m===void 0?void 0:m.experimentalCancelEventPropagation)===!0;r.dispatchEvent(qC,b,b)}}}},{key:"detach",value:function(r){var s,l;if(r.parentNode){var u=r.transformable,h=r.parentNode,f=h.sortable;(f!=null&&(s=f.sorted)!==null&&s!==void 0&&s.length||(l=r.style)!==null&&l!==void 0&&l.zIndex)&&(f.dirtyChildren.indexOf(r)===-1&&f.dirtyChildren.push(r),f.dirty=!0,f.dirtyReason=Zc.REMOVED);var d=r.parentNode.childNodes.indexOf(r);d>-1&&r.parentNode.childNodes.splice(d,1),u&&this.dirtyWorldTransform(r,u),r.parentNode=null}}},{key:"getLocalPosition",value:function(r){return r.transformable.localPosition}},{key:"getLocalRotation",value:function(r){return r.transformable.localRotation}},{key:"getLocalScale",value:function(r){return r.transformable.localScale}},{key:"getLocalSkew",value:function(r){return r.transformable.localSkew}},{key:"getLocalTransform",value:function(r){var s=r.transformable;return Tg(s),s.localTransform}},{key:"setLocalPosition",value:function(r,s){var l,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=r.transformable;Fo[0]=s[0],Fo[1]=s[1],Fo[2]=(l=s[2])!==null&&l!==void 0?l:0,!Eo(h.localPosition,Fo)&&(Et(h.localPosition,Fo),u&&this.dirtyLocalTransform(r,h))}},{key:"translateLocal",value:function(r,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof s=="number"&&(s=vt(s,l,u));var h=r.transformable;Eo(s,eu)||(Tc(s,s,h.localRotation),Jt(h.localPosition,h.localPosition,s),this.dirtyLocalTransform(r,h))}},{key:"setLocalRotation",value:function(r,s,l,u,h){var f=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;typeof s=="number"&&(s=zp(ja,s,l,u,h));var d=r.transformable;_c(d.localRotation,s),f&&this.dirtyLocalTransform(r,d)}},{key:"rotateLocal",value:function(r,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof s=="number"&&(s=vt(s,l,u));var h=r.transformable;kc(Ty,s[0],s[1],s[2]),Zp(h.localRotation,h.localRotation,Ty),this.dirtyLocalTransform(r,h)}},{key:"setLocalScale",value:function(r,s){var l,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=r.transformable;Dt(Wa,s[0],s[1],(l=s[2])!==null&&l!==void 0?l:h.localScale[2]),!Eo(Wa,h.localScale)&&(Et(h.localScale,Wa),u&&this.dirtyLocalTransform(r,h))}},{key:"scaleLocal",value:function(r,s){var l,u=r.transformable;xe(u.localScale,u.localScale,Dt(Wa,s[0],s[1],(l=s[2])!==null&&l!==void 0?l:1)),this.dirtyLocalTransform(r,u)}},{key:"setLocalSkew",value:function(r,s,l){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;typeof s=="number"&&(s=$w(tO,s,l));var h=r.transformable;Hw(h.localSkew,s),u&&this.dirtyLocalTransform(r,h)}},{key:"setLocalEulerAngles",value:function(r,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;typeof s=="number"&&(s=vt(s,l,u));var f=r.transformable;kc(f.localRotation,s[0],s[1],s[2]),h&&this.dirtyLocalTransform(r,f)}},{key:"setLocalTransform",value:function(r,s){var l=Cc(nO,s),u=Oc(rO,s),h=Os(iO,s);this.setLocalScale(r,h,!1),this.setLocalPosition(r,l,!1),this.setLocalRotation(r,u,void 0,void 0,void 0,!1),this.dirtyLocalTransform(r,r.transformable)}},{key:"resetLocalTransform",value:function(r){this.setLocalScale(r,QC,!1),this.setLocalPosition(r,eu,!1),this.setLocalEulerAngles(r,eu,void 0,void 0,!1),this.setLocalSkew(r,KC,void 0,!1),this.dirtyLocalTransform(r,r.transformable)}},{key:"getPosition",value:function(r){var s=r.transformable;return Cc(s.position,this.getWorldTransform(r,s))}},{key:"getRotation",value:function(r){var s=r.transformable;return Oc(s.rotation,this.getWorldTransform(r,s))}},{key:"getScale",value:function(r){var s=r.transformable;return Os(s.scaling,this.getWorldTransform(r,s))}},{key:"getOrigin",value:function(r){return r.getGeometryBounds(),r.transformable.origin}},{key:"getWorldTransform",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r.transformable;return!s.localDirtyFlag&&!s.dirtyFlag||(r.parentNode&&r.parentNode.transformable&&this.getWorldTransform(r.parentNode),this.internalUpdateTransform(r)),s.worldTransform}},{key:"setPosition",value:function(r,s){var l,u=r.transformable;if(Va[0]=s[0],Va[1]=s[1],Va[2]=(l=s[2])!==null&&l!==void 0?l:0,!Eo(this.getPosition(r),Va)){if(Et(u.position,Va),r.parentNode===null||!r.parentNode.transformable)Et(u.localPosition,Va);else{var h=r.parentNode.transformable;Ts(nu,h.worldTransform),ci(nu,nu),dn(u.localPosition,Va,nu)}this.dirtyLocalTransform(r,u)}}},{key:"translate",value:function(r,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof s=="number"&&(s=Dt(Wa,s,l,u)),!Eo(s,eu)&&(Jt(Wa,this.getPosition(r),s),this.setPosition(r,Wa))}},{key:"setRotation",value:function(r,s,l,u,h){var f=r.transformable;if(typeof s=="number"&&(s=Ww(s,l,u,h)),r.parentNode===null||!r.parentNode.transformable)this.setLocalRotation(r,s);else{var d=this.getRotation(r.parentNode);_c(ja,d),Of(ja,ja),na(f.localRotation,ja,s),Pc(f.localRotation,f.localRotation),this.dirtyLocalTransform(r,f)}}},{key:"rotate",value:function(r,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof s=="number"&&(s=vt(s,l,u));var h=r.transformable;if(r.parentNode===null||!r.parentNode.transformable)this.rotateLocal(r,s);else{var f=ja;kc(f,s[0],s[1],s[2]);var d=this.getRotation(r),v=this.getRotation(r.parentNode);_c(ru,v),Of(ru,ru),na(f,ru,f),na(h.localRotation,f,d),Pc(h.localRotation,h.localRotation),this.dirtyLocalTransform(r,h)}}},{key:"setOrigin",value:function(r,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof s=="number"&&(s=[s,l,u]);var h=r.transformable;if(!(s[0]===h.origin[0]&&s[1]===h.origin[1]&&s[2]===h.origin[2])){var f=h.origin;f[0]=s[0],f[1]=s[1],f[2]=s[2]||0,this.dirtyLocalTransform(r,h)}}},{key:"setEulerAngles",value:function(r,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof s=="number"&&(s=vt(s,l,u));var h=r.transformable;if(r.parentNode===null||!r.parentNode.transformable)this.setLocalEulerAngles(r,s);else{kc(h.localRotation,s[0],s[1],s[2]);var f=this.getRotation(r.parentNode);_c(My,Of(ja,f)),Zp(h.localRotation,h.localRotation,My),this.dirtyLocalTransform(r,h)}}},{key:"getTransformedGeometryBounds",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2?arguments[2]:void 0,u=this.getGeometryBounds(r,s);if(!ke.isEmpty(u)){var h=l||new ke;return h.setFromTransformedAABB(u,this.getWorldTransform(r)),h}return null}},{key:"getGeometryBounds",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=r,u=l.geometry;u.dirty&&st.styleValueRegistry.updateGeometry(r);var h=s?u.renderBounds:u.contentBounds||null;return h||new ke}},{key:"getBounds",value:function(r){var s=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=r,h=u.renderable;if(!h.boundsDirty&&!l&&h.bounds)return h.bounds;if(!h.renderBoundsDirty&&l&&h.renderBounds)return h.renderBounds;var f=l?h.renderBounds:h.bounds,d=this.getTransformedGeometryBounds(r,l,f),v=r.childNodes;if(v.forEach(function(y){var m=s.getBounds(y,l);m&&(d?d.add(m):(d=f||new ke,d.update(m.center,m.halfExtents)))}),d||(d=new ke),l){var p=hy(r);if(p){var g=p.parsedStyle.clipPath.getBounds(l);d?g&&(d=g.intersection(d)):d.update(g.center,g.halfExtents)}}return l?(h.renderBounds=d,h.renderBoundsDirty=!1):(h.bounds=d,h.boundsDirty=!1),d}},{key:"getLocalBounds",value:function(r){if(r.parentNode){var s=JC;r.parentNode.transformable&&(s=ci(eO,this.getWorldTransform(r.parentNode)));var l=this.getBounds(r);if(!ke.isEmpty(l)){var u=new ke;return u.setFromTransformedAABB(l,s),u}}return this.getBounds(r)}},{key:"getBoundingClientRect",value:function(r){var s,l,u=this.getGeometryBounds(r);ke.isEmpty(u)||(l=new ke,l.setFromTransformedAABB(u,this.getWorldTransform(r)));var h=(s=r.ownerDocument)===null||s===void 0||(s=s.defaultView)===null||s===void 0?void 0:s.getContextService().getBoundingClientRect();if(l){var f=l.getMin(),d=(0,W.Z)(f,2),v=d[0],p=d[1],g=l.getMax(),y=(0,W.Z)(g,2),m=y[0],b=y[1];return new As(v+((h==null?void 0:h.left)||0),p+((h==null?void 0:h.top)||0),m-v,b-p)}return new As((h==null?void 0:h.left)||0,(h==null?void 0:h.top)||0,0,0)}},{key:"internalUpdateTransform",value:function(r){var s,l=(s=r.parentNode)===null||s===void 0?void 0:s.transformable;Tg(r.transformable),wM(r.transformable,l)}},{key:"internalUpdateElement",value:function(r,s){var l,u,h,f,d=((l=r.ownerDocument)===null||l===void 0||(l=l.defaultView)===null||l===void 0||(l=l.getConfig())===null||l===void 0||(l=l.future)===null||l===void 0?void 0:l.experimentalAttributeUpdateOptimization)===!0,v=s[s.length-1],p=(v==null?void 0:v.transformDirty)||((u=r.transformable)===null||u===void 0?void 0:u.localDirtyFlag);if(r.transformable){var g;(g=r.transformable).dirtyFlag||(g.dirtyFlag=p)}if(this.internalUpdateTransform(r),p){var y;(y=r.dirty)===null||y===void 0||y.call(r,!0,!0)}var m=((h=r.renderable)===null||h===void 0?void 0:h.boundsDirty)||((f=r.renderable)===null||f===void 0?void 0:f.renderBoundsDirty);if((p||m)&&(v==null?void 0:v.shapeUpdated)===!1&&d)for(var b=s.length-1;b>=0;){var x,E,w=s[b];if(w.shapeUpdated)break;(x=(E=w.node).dirty)===null||x===void 0||x.call(E,!0,!0),w.shapeUpdated=!0,b-=1}return p}},{key:"syncHierarchy",value:function(r){for(var s,l,u=[r],h=r.parentNode?[{node:r.parentNode,transformDirty:((s=r.parentNode.transformable)===null||s===void 0?void 0:s.localDirtyFlag)||((l=r.parentNode.transformable)===null||l===void 0?void 0:l.dirtyFlag),shapeUpdated:!1}]:[];u.length>0;){for(var f=u.pop(),d=h[h.length-1];h.length>0&&f.parentNode!==d.node;)d=h.pop();var v=this.internalUpdateElement(f,h);if(f.childNodes.length>0){for(var p=f.childNodes.length-1;p>=0;p--)u.push(f.childNodes[p]);h.push({node:f,transformDirty:v,shapeUpdated:!1})}}}},{key:"dirtyLocalTransform",value:function(r,s){Qc(r)||s.localDirtyFlag||(s.localDirtyFlag=!0,s.dirtyFlag||this.dirtyWorldTransform(r,s))}},{key:"dirtyWorldTransform",value:function(r,s){this.dirtifyWorldInternal(r,s),this.dirtyToRoot(r,!0)}},{key:"dirtifyWorldInternal",value:function(r,s){var l,u=this,h=((l=r.ownerDocument)===null||l===void 0||(l=l.defaultView)===null||l===void 0||(l=l.getConfig())===null||l===void 0||(l=l.future)===null||l===void 0?void 0:l.experimentalAttributeUpdateOptimization)===!0;s.dirtyFlag||(s.dirtyFlag=!0,r.dirty(!0,!0),h||r.childNodes.forEach(function(f){var d=f.transformable;u.dirtifyWorldInternal(f,d)}))}},{key:"dirtyToRoot",value:function(r){for(var s,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=r,h=((s=r.ownerDocument)===null||s===void 0||(s=s.defaultView)===null||s===void 0||(s=s.getConfig())===null||s===void 0||(s=s.future)===null||s===void 0?void 0:s.experimentalAttributeUpdateOptimization)===!0;u;){var f,d;if((f=(d=u).dirty)===null||f===void 0||f.call(d,!0,!0),h)break;u=u.parentNode}l&&r.forEach(function(v){var p;(p=v.dirty)===null||p===void 0||p.call(v,!0,!0)}),this.informDependentDisplayObjects(r),this.pendingEvents.set(r,l)}},{key:"dirtifyFragment",value:function(r){var s,l,u=r.transformable;u&&(u.dirtyFlag=!0,u.localDirtyFlag=!0),(s=(l=r).dirty)===null||s===void 0||s.call(l,!0,!0);for(var h=r.childNodes.length,f=0;f<h;f++)this.dirtifyFragment(r.childNodes[f]);r.nodeName===J.FRAGMENT&&this.pendingEvents.set(r,!1)}},{key:"triggerPendingEvents",value:function(){var r=this,s=new Set,l,u,h=function(d,v){if(!(!d.isConnected||s.has(d)||d.nodeName===J.FRAGMENT)){if(r.boundsChangedEvent.detail=v,r.boundsChangedEvent.target=d,d.isMutationObserved)d.dispatchEvent(r.boundsChangedEvent);else{if(l===void 0){var p;l=((p=d.ownerDocument.defaultView)===null||p===void 0||(p=p.getConfig())===null||p===void 0||(p=p.future)===null||p===void 0?void 0:p.experimentalCancelEventPropagation)===!0}d.ownerDocument.defaultView.dispatchEvent(r.boundsChangedEvent,!0,l)}s.add(d)}};this.pendingEvents.forEach(function(f,d){if(d.nodeName!==J.FRAGMENT){if(u===void 0){var v;u=((v=d.ownerDocument)===null||v===void 0||(v=v.defaultView)===null||v===void 0||(v=v.getConfig())===null||v===void 0||(v=v.future)===null||v===void 0?void 0:v.experimentalAttributeUpdateOptimization)===!0}iu.affectChildren=f,u?h(d,iu):f?d.forEach(function(p){h(p,iu)}):h(d,iu)}}),s.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"updateDisplayObjectDependency",value:function(r,s,l,u){if(s&&s!==l){var h=this.displayObjectDependencyMap.get(s);if(h&&h[r]){var f=h[r].indexOf(u);h[r].splice(f,1)}}if(l){var d=this.displayObjectDependencyMap.get(l);d||(this.displayObjectDependencyMap.set(l,{}),d=this.displayObjectDependencyMap.get(l)),d[r]||(d[r]=[]),d[r].push(u)}}},{key:"informDependentDisplayObjects",value:function(r){var s,l=this,u=this.displayObjectDependencyMap.get(r);if(u){var h=(s=r.ownerDocument)===null||s===void 0||(s=s.defaultView)===null||s===void 0||(s=s.getConfig())===null||s===void 0||(s=s.future)===null||s===void 0?void 0:s.experimentalCancelEventPropagation;Object.keys(u).forEach(function(f){u[f].forEach(function(d){l.dirtyToRoot(d,!0),d.dispatchEvent(new vi($t.ATTR_MODIFIED,d,l,l,f,vi.MODIFICATION,l,l),h,h),d.isCustomElement&&d.isConnected&&d.attributeChangedCallback&&d.attributeChangedCallback(f,l,l)})})}}}])}(),Cy=function(){function a(n){if((0,I.Z)(this,a),n<=0)throw new Error("LRU capacity must be a positive number.");this.capacity=n,this.cache=new Map}return(0,D.Z)(a,[{key:"get",value:function(r){if(this.cache.has(r)){var s=this.cache.get(r);return this.cache.delete(r),this.cache.set(r,s),s}}},{key:"put",value:function(r,s){if(this.cache.has(r)&&this.cache.delete(r),this.cache.set(r,s),this.cache.size>this.capacity){var l=this.cache.keys().next().value;this.cache.delete(l)}}},{key:"len",value:function(){return this.cache.size}},{key:"clear",value:function(){this.cache.clear()}}])}(),Ha={MetricsString:"|\xC9q\xC5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Oy=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,sO=/[!%),.:;?\]}'""]/,oO=/[$('"]/,lO=/[!),.:;?\]}'""]/,cO=/[([{'"]/,uO=/[)\]'"?!:;,.]/,hO=/[(['"...]/,fO=/[!%),.:;?\]}'"]/,dO=/[$([{'"#]/,vO=new RegExp("".concat(sO.source,"|").concat(lO.source,"|").concat(uO.source,"|").concat(fO.source)),pO=new RegExp("".concat(oO.source,"|").concat(cO.source,"|").concat(hO.source,"|").concat(dO.source)),gO=function(){function a(n){var r=this;(0,I.Z)(this,a),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(s,l){return r.isBreakingSpace(l)?!1:!!(s&&(pO.exec(l)||vO.exec(s)))},this.trimByKinsokuShorui=function(s){var l=(0,B.Z)(s),u=l[l.length-2];if(!u)return s;var h=u[u.length-1];return l[l.length-2]=u.slice(0,-1),l[l.length-1]=h+l[l.length-1],l},this.runtime=n,this.charWidthCache=new Cy(100)}return(0,D.Z)(a,[{key:"measureFont",value:function(r,s){if(this.fontMetricsCache[r])return this.fontMetricsCache[r];var l={ascent:0,descent:0,fontSize:0},u=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(s),h=this.runtime.offscreenCanvasCreator.getOrCreateContext(s,{willReadFrequently:!0});h.font=r;var f=Ha.MetricsString+Ha.BaselineSymbol,d=Math.ceil(h.measureText(f).width),v=Math.ceil(h.measureText(Ha.BaselineSymbol).width),p=Ha.HeightMultiplier*v;v=v*Ha.BaselineMultiplier|0,u.width=d,u.height=p,h.fillStyle="#f00",h.fillRect(0,0,d,p),h.font=r,h.textBaseline="alphabetic",h.fillStyle="#000",h.fillText(f,0,v);var g=h.getImageData(0,0,d||1,p||1).data,y=g.length,m=d*4,b=0,x=0,E=!1;for(b=0;b<v;++b){for(var w=0;w<m;w+=4)if(g[x+w]!==255){E=!0;break}if(!E)x+=m;else break}for(l.ascent=v-b,x=y-m,E=!1,b=p;b>v;--b){for(var S=0;S<m;S+=4)if(g[x+S]!==255){E=!0;break}if(!E)x-=m;else break}return l.descent=b-v,l.fontSize=l.ascent+l.descent,this.fontMetricsCache[r]=l,l}},{key:"measureText",value:function(r,s,l){var u=s.fontSize,h=u===void 0?16:u,f=s.wordWrap,d=f===void 0?!1:f,v=s.lineHeight,p=s.lineWidth,g=p===void 0?1:p,y=s.textBaseline,m=y===void 0?"alphabetic":y,b=s.textAlign,x=b===void 0?"start":b,E=s.letterSpacing,w=E===void 0?0:E,S=s.textPath;s.textPathSide,s.textPathStartOffset;var M=s.leading,C=M===void 0?0:M,T=by(s),O=this.measureFont(T,l);O.fontSize===0&&(O.fontSize=h,O.ascent=h);var k=this.runtime.offscreenCanvasCreator.getOrCreateContext(l);k.font=T,s.isOverflowing=!1;var P=d?this.wordWrap(r,s,l):r,A=P.split(/(?:\r\n|\r|\n)/),N=new Array(A.length),L=0;if(S){S.getTotalLength();for(var R=0;R<A.length;R++)k.measureText(A[R]).width+(A[R].length-1)*w}else{for(var z=0;z<A.length;z++){var Z=k.measureText(A[z]).width+(A[z].length-1)*w;N[z]=Z,L=Math.max(L,Z)}var X=L+g,nt=v||O.fontSize+g,K=Math.max(nt,O.fontSize+g)+(A.length-1)*(nt+C);nt+=C;var rt=0;return m==="middle"?rt=-K/2:m==="bottom"||m==="alphabetic"||m==="ideographic"?rt=-K:(m==="top"||m==="hanging")&&(rt=0),{font:T,width:X,height:K,lines:A,lineWidths:N,lineHeight:nt,maxLineWidth:L,fontProperties:O,lineMetrics:N.map(function(U,at){var ht=0;return x==="center"||x==="middle"?ht-=U/2:(x==="right"||x==="end")&&(ht-=U),new As(ht-g/2,rt+at*nt,U+g,nt)})}}}},{key:"wordWrap",value:function(r,s,l){var u=this,h=Array.from(r);if(h.length===0)return"";var f=this,d=s.wordWrapWidth,v=d===void 0?0:d,p=s.letterSpacing,g=p===void 0?0:p,y=s.maxLines,m=y===void 0?1/0:y,b=s.textOverflow,x=this.runtime.offscreenCanvasCreator.getOrCreateContext(l),E=v+g,w="";b==="ellipsis"?w="...":b&&b!=="clip"&&(w=b);var S=[""],M=0,C=0,T=-1,O=by(s),k=this.charWidthCache.get(O);k||(k=new Cy(500),this.charWidthCache.put(O,k));var P=function(U){return u.getFromCache(U,g,k,x)},A=P(w);function N(rt,U,at,ht){for(;P(rt)<ht&&U<h.length-1&&!f.isNewline(h[U+1]);)U+=1,rt+=h[U];for(;P(rt)>ht&&U>=at;)U-=1,rt=rt.slice(0,-1);return{lineTxt:rt,txtLastCharIndex:U}}function L(rt,U){if(!(A<=0||A>E)){if(!S[rt]){S[rt]=w;return}var at=N(S[rt],U,T+1,E-A);S[rt]=at.lineTxt+w}}for(var R=0;R<h.length;R++){var z=h[R],Z=h[R-1],X=h[R+1],nt=P(z);if(this.isNewline(z)){if(M+1>=m){R<h.length-1&&L(M,R-1),s.isOverflowing=!0;break}T=R-1,M+=1,C=0,S[M]="";continue}if(nt>E){L(M,R-1),s.isOverflowing=!0;break}if(C>0&&C+nt>E){var K=N(S[M],R-1,T+1,E);if(K.txtLastCharIndex!==R-1){if(S[M]=K.lineTxt,K.txtLastCharIndex===h.length-1)break;R=K.txtLastCharIndex+1,z=h[R],Z=h[R-1],X=h[R+1],nt=P(z)}if(M+1>=m){L(M,R-1),s.isOverflowing=!0;break}if(T=R-1,M+=1,C=0,S[M]="",this.isBreakingSpace(z))continue;this.canBreakInLastChar(z)||(S=this.trimToBreakable(S),C=this.sumTextWidthByCache(S[M]||"",P)),this.shouldBreakByKinsokuShorui(z,X)&&(S=this.trimByKinsokuShorui(S),C+=P(Z||""))}C+=nt,S[M]+=z}return S.join(`
`)}},{key:"isBreakingSpace",value:function(r){return typeof r!="string"?!1:Ha.BreakingSpaces.indexOf(r.charCodeAt(0))>=0}},{key:"isNewline",value:function(r){return typeof r!="string"?!1:Ha.Newlines.indexOf(r.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(r){var s=(0,B.Z)(r),l=s[s.length-2],u=this.findBreakableIndex(l);if(u===-1||!l)return s;var h=l.slice(u,u+1),f=this.isBreakingSpace(h),d=u+1,v=u+(f?0:1);return s[s.length-1]+=l.slice(d,l.length),s[s.length-2]=l.slice(0,v),s}},{key:"canBreakInLastChar",value:function(r){return!(r&&Oy.test(r))}},{key:"sumTextWidthByCache",value:function(r,s){return r.split("").reduce(function(l,u){return l+s(u)},0)}},{key:"findBreakableIndex",value:function(r){for(var s=r.length-1;s>=0;s--)if(!Oy.test(r[s]))return s;return-1}},{key:"getFromCache",value:function(r,s,l,u){var h=l.get(r);if(typeof h!="number"){var f=r.length*s,d=u.measureText(r);h=d.width+f,l.put(r,h)}return h}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear()}}])}(),st={},yO=function(a){var n=new GC,r=new ZC;return a={},(0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)(a,J.FRAGMENT,null),J.CIRCLE,new IC),J.ELLIPSE,new BC),J.RECT,n),J.IMAGE,n),J.GROUP,new jC),J.LINE,new FC),J.TEXT,new WC(st)),J.POLYLINE,r),J.POLYGON,r),(0,St.Z)((0,St.Z)((0,St.Z)(a,J.PATH,new zC),J.HTML,new VC),J.MESH,null)}(),mO=function(a){var n=new YT,r=new rd;return a={},(0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)(a,mt.PERCENTAGE,null),mt.NUMBER,new JT),mt.ANGLE,new $T),mt.DEFINED_PATH,new UT),mt.PAINT,n),mt.COLOR,n),mt.FILTER,new XT),mt.LENGTH,r),mt.LENGTH_PERCENTAGE,r),mt.LENGTH_PERCENTAGE_12,new qT),(0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)(a,mt.LENGTH_PERCENTAGE_14,new KT),mt.COORDINATE,new rd),mt.OFFSET_DISTANCE,new tC),mt.OPACITY_VALUE,new eC),mt.PATH,new nC),mt.LIST_OF_POINTS,new rC),mt.SHADOW_BLUR,new iC),mt.TEXT,new aC),mt.TEXT_TRANSFORM,new sC),mt.TRANSFORM,new RC),(0,St.Z)((0,St.Z)((0,St.Z)(a,mt.TRANSFORM_ORIGIN,new LC),mt.Z_INDEX,new DC),mt.MARKER,new QT)}(),bO=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof Y.g!="undefined"?Y.g:{}};st.CameraContribution=Mg,st.AnimationTimeline=null,st.EasingFunction=null,st.offscreenCanvasCreator=new hd,st.sceneGraphSelector=new XC,st.sceneGraphService=new aO(st),st.textService=new gO(st),st.geometryUpdaterFactory=yO,st.CSSPropertySyntaxFactory=mO,st.styleValueRegistry=new VT(st),st.layoutRegistry=null,st.globalThis=bO(),st.enableStyleSyntax=!0,st.enableSizeAttenuation=!1;var ky=0;function Iz(){ky=0}var fd=new vi($t.INSERTED,null,"","","",0,"",""),dd=new vi($t.REMOVED,null,"","","",0,"",""),_y=new sn($t.DESTROY),xO=function(a){function n(){var r;(0,I.Z)(this,n);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=(0,G.Z)(this,n,[].concat(l)),r.entity=ky++,r.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},r.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},r.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},r.cullable={strategy:bM.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},r.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},r.rBushNode={aabb:void 0},r.namespaceURI="g",r.scrollLeft=0,r.scrollTop=0,r.clientTop=0,r.clientLeft=0,r.style={},r.computedStyle={},r.parsedStyle={},r.attributes={},r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"dirty",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.renderable.dirty=s,l&&(this.renderable.boundsDirty=s,this.renderable.renderBoundsDirty=s)}},{key:"className",get:function(){return this.getAttribute("class")||""},set:function(s){this.setAttribute("class",s)}},{key:"classList",get:function(){return this.className.split(" ").filter(function(s){return s!==""})}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var s=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[s+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var s=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[s-1]||null}return null}},{key:"cloneNode",value:function(s){throw new Error(Ee)}},{key:"appendChild",value:function(s,l){var u;if(s.destroyed)throw new Error(oM);return st.sceneGraphService.attach(s,this,l),(u=this.ownerDocument)!==null&&u!==void 0&&u.defaultView&&(!Qc(this)&&s.nodeName===J.FRAGMENT?this.ownerDocument.defaultView.mountFragment(s):this.ownerDocument.defaultView.mountChildren(s)),this.isMutationObserved&&(fd.relatedNode=this,s.dispatchEvent(fd)),s}},{key:"insertBefore",value:function(s,l){if(!l)this.appendChild(s);else{s.parentElement&&s.parentElement.removeChild(s);var u=this.childNodes.indexOf(l);u===-1?this.appendChild(s):this.appendChild(s,u)}return s}},{key:"replaceChild",value:function(s,l){var u=this.childNodes.indexOf(l);return this.removeChild(l),this.appendChild(s,u),l}},{key:"removeChild",value:function(s){var l,u,h=((l=this.ownerDocument)===null||l===void 0||(l=l.defaultView)===null||l===void 0||(l=l.getConfig().future)===null||l===void 0?void 0:l.experimentalCancelEventPropagation)===!0;return dd.relatedNode=this,s.dispatchEvent(dd,h,h),(u=s.ownerDocument)!==null&&u!==void 0&&u.defaultView&&s.ownerDocument.defaultView.unmountChildren(s),st.sceneGraphService.detach(s),s}},{key:"removeChildren",value:function(){for(var s=this.childNodes.length-1;s>=0;s--){var l=this.childNodes[s];this.removeChild(l)}}},{key:"destroyChildren",value:function(){for(var s=this.childNodes.length-1;s>=0;s--){var l=this.childNodes[s];l.childNodes.length>0&&l.destroyChildren(),l.destroy()}}},{key:"matches",value:function(s){return st.sceneGraphService.matches(s,this)}},{key:"getElementById",value:function(s){return st.sceneGraphService.querySelector("#".concat(s),this)}},{key:"getElementsByName",value:function(s){return st.sceneGraphService.querySelectorAll('[name="'.concat(s,'"]'),this)}},{key:"getElementsByClassName",value:function(s){return st.sceneGraphService.querySelectorAll(".".concat(s),this)}},{key:"getElementsByTagName",value:function(s){return st.sceneGraphService.querySelectorAll(s,this)}},{key:"querySelector",value:function(s){return st.sceneGraphService.querySelector(s,this)}},{key:"querySelectorAll",value:function(s){return st.sceneGraphService.querySelectorAll(s,this)}},{key:"closest",value:function(s){var l=this;do{if(st.sceneGraphService.matches(s,l))return l;l=l.parentElement}while(l!==null);return null}},{key:"find",value:function(s){var l=this,u=null;return this.forEach(function(h){return h!==l&&s(h)?(u=h,!1):!0}),u}},{key:"findAll",value:function(s){var l=this,u=[];return this.forEach(function(h){h!==l&&s(h)&&u.push(h)}),u}},{key:"after",value:function(){var s=this;if(this.parentNode){for(var l=this.parentNode.childNodes.indexOf(this),u=arguments.length,h=new Array(u),f=0;f<u;f++)h[f]=arguments[f];h.forEach(function(d,v){var p;return(p=s.parentNode)===null||p===void 0?void 0:p.appendChild(d,l+v+1)})}}},{key:"before",value:function(){if(this.parentNode){for(var s,l=this.parentNode.childNodes.indexOf(this),u=arguments.length,h=new Array(u),f=0;f<u;f++)h[f]=arguments[f];var d=h[0],v=h.slice(1);this.parentNode.appendChild(d,l),(s=d).after.apply(s,(0,B.Z)(v))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var s=this,l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];u.forEach(function(f){return s.appendChild(f)})}},{key:"prepend",value:function(){for(var s=this,l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];u.forEach(function(f,d){return s.appendChild(f,d)})}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){var s,l=((s=this.ownerDocument)===null||s===void 0||(s=s.defaultView)===null||s===void 0||(s=s.getConfig().future)===null||s===void 0?void 0:s.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(_y,l,l),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return st.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return st.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return st.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return st.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return st.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(s){if(typeof s!="symbol"){var l=this.attributes[s];return l}}},{key:"hasAttribute",value:function(s){return this.getAttributeNames().includes(s)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(s){this.setAttribute(s,null),delete this.attributes[s]}},{key:"setAttribute",value:function(s,l,u,h){this.attributes[s]=l}},{key:"getAttributeNS",value:function(s,l){throw new Error(Ee)}},{key:"getAttributeNode",value:function(s){throw new Error(Ee)}},{key:"getAttributeNodeNS",value:function(s,l){throw new Error(Ee)}},{key:"hasAttributeNS",value:function(s,l){throw new Error(Ee)}},{key:"removeAttributeNS",value:function(s,l){throw new Error(Ee)}},{key:"removeAttributeNode",value:function(s){throw new Error(Ee)}},{key:"setAttributeNS",value:function(s,l,u){throw new Error(Ee)}},{key:"setAttributeNode",value:function(s){throw new Error(Ee)}},{key:"setAttributeNodeNS",value:function(s){throw new Error(Ee)}},{key:"toggleAttribute",value:function(s,l){throw new Error(Ee)}}])}(Be);function ae(a){return!!(a!=null&&a.nodeName)}var EO=st.globalThis.Proxy?st.globalThis.Proxy:function(){},pi=new vi($t.ATTR_MODIFIED,null,null,null,null,vi.MODIFICATION,null,null),zo=j(),wO=an(),Pe=function(a){function n(r){var s;return(0,I.Z)(this,n),s=(0,G.Z)(this,n),s.isCustomElement=!1,s.isMutationObserved=!1,s.activeAnimations=[],s.config=r,s.id=r.id||"",s.name=r.name||"",(r.className||r.class)&&(s.className=r.className||r.class),s.nodeName=r.type||J.GROUP,r.initialParsedStyle&&Object.assign(s.parsedStyle,r.initialParsedStyle),s.initAttributes(r.style),st.enableStyleSyntax&&(s.style=new EO({setProperty:function(u,h){s.setAttribute(u,h)},getPropertyValue:function(u){return s.getAttribute(u)},removeProperty:function(u){s.removeAttribute(u)},item:function(){return""}},{get:function(u,h){return u[h]!==void 0?u[h]:s.getAttribute(h)},set:function(u,h,f){return s.setAttribute(h,f),!0}})),s}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"destroy",value:function(){eg(n,"destroy",this,3)([]),this.getAnimations().forEach(function(s){s.cancel()})}},{key:"cloneNode",value:function(s,l){var u=(0,$.Z)({},this.attributes);for(var h in u){var f=u[h];ae(f)&&h!=="clipPath"&&h!=="offsetPath"&&h!=="textPath"&&(u[h]=f.cloneNode(s)),l&&(u[h]=l(h,f))}var d=new this.constructor((0,$.Z)((0,$.Z)({},this.config),{},{style:u}));return d.setLocalTransform(this.getLocalTransform()),s&&this.children.forEach(function(v){if(!v.style.isMarker){var p=v.cloneNode(s);d.appendChild(p)}}),d}},{key:"initAttributes",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l={forceUpdateGeometry:!0};st.styleValueRegistry.processProperties(this,s,l),this.dirty()}},{key:"setAttribute",value:function(s,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;Ft(l)||(u||l!==this.attributes[s])&&(this.internalSetAttribute(s,l,{memoize:h}),eg(n,"setAttribute",this,3)([s,l]))}},{key:"internalSetAttribute",value:function(s,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=this.attributes[s],f=this.parsedStyle[s];st.styleValueRegistry.processProperties(this,(0,St.Z)({},s,l),u),this.dirty();var d=this.parsedStyle[s];if(this.isConnected)if(pi.relatedNode=this,pi.prevValue=h,pi.newValue=l,pi.attrName=s,pi.prevParsedValue=f,pi.newParsedValue=d,this.isMutationObserved)this.dispatchEvent(pi);else{var v,p=((v=this.ownerDocument.defaultView.getConfig().future)===null||v===void 0?void 0:v.experimentalCancelEventPropagation)===!0;pi.target=this,this.ownerDocument.defaultView.dispatchEvent(pi,!0,p)}if(this.isCustomElement&&this.isConnected||!this.isCustomElement){var g,y;(g=(y=this).attributeChangedCallback)===null||g===void 0||g.call(y,s,h,l,f,d)}}},{key:"getBBox",value:function(){var s=this.getBounds(),l=s.getMin(),u=(0,W.Z)(l,2),h=u[0],f=u[1],d=s.getMax(),v=(0,W.Z)(d,2),p=v[0],g=v[1];return new As(h,f,p-h,g-f)}},{key:"setOrigin",value:function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return st.sceneGraphService.setOrigin(this,Gn(s,l,u,!1)),this}},{key:"getOrigin",value:function(){return st.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return st.sceneGraphService.setPosition(this,Gn(s,l,u,!1)),this}},{key:"setLocalPosition",value:function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return st.sceneGraphService.setLocalPosition(this,Gn(s,l,u,!1)),this}},{key:"translate",value:function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return st.sceneGraphService.translate(this,Gn(s,l,u,!1)),this}},{key:"translateLocal",value:function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return st.sceneGraphService.translateLocal(this,Gn(s,l,u,!1)),this}},{key:"getPosition",value:function(){return st.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return st.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(s,l,u){return this.scaleLocal(s,l,u)}},{key:"scaleLocal",value:function(s,l,u){return typeof s=="number"&&(l=l||s,u=u||s,s=Gn(s,l,u,!1)),st.sceneGraphService.scaleLocal(this,s),this}},{key:"setLocalScale",value:function(s,l,u){return typeof s=="number"&&(l=l||s,u=u||s,s=Gn(s,l,u,!1)),st.sceneGraphService.setLocalScale(this,s),this}},{key:"getLocalScale",value:function(){return st.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return st.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){var s=Ff(zo,st.sceneGraphService.getWorldTransform(this)),l=(0,W.Z)(s,3),u=l[2];return tr(u)}},{key:"getLocalEulerAngles",value:function(){var s=Ff(zo,st.sceneGraphService.getLocalRotation(this)),l=(0,W.Z)(s,3),u=l[2];return tr(u)}},{key:"setEulerAngles",value:function(s){return st.sceneGraphService.setEulerAngles(this,0,0,s),this}},{key:"setLocalEulerAngles",value:function(s){return st.sceneGraphService.setLocalEulerAngles(this,0,0,s),this}},{key:"rotateLocal",value:function(s,l,u){return(0,At.Z)(l)&&(0,At.Z)(u)?st.sceneGraphService.rotateLocal(this,0,0,s):st.sceneGraphService.rotateLocal(this,s,l,u),this}},{key:"rotate",value:function(s,l,u){return(0,At.Z)(l)&&(0,At.Z)(u)?st.sceneGraphService.rotate(this,0,0,s):st.sceneGraphService.rotate(this,s,l,u),this}},{key:"setRotation",value:function(s,l,u,h){return st.sceneGraphService.setRotation(this,s,l,u,h),this}},{key:"setLocalRotation",value:function(s,l,u,h){return st.sceneGraphService.setLocalRotation(this,s,l,u,h),this}},{key:"setLocalSkew",value:function(s,l){return st.sceneGraphService.setLocalSkew(this,s,l),this}},{key:"getRotation",value:function(){return st.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return st.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return st.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return st.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return st.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(s){return st.sceneGraphService.setLocalTransform(this,s),this}},{key:"resetLocalTransform",value:function(){st.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(s,l){var u,h=(u=this.ownerDocument)===null||u===void 0?void 0:u.timeline;return h?h.play(this,s,l):null}},{key:"isVisible",value:function(){var s;return((s=this.parsedStyle)===null||s===void 0?void 0:s.visibility)!=="hidden"}},{key:"interactive",get:function(){return this.isInteractive()},set:function(s){this.style.pointerEvents=s?"auto":"none"}},{key:"isInteractive",value:function(){var s;return((s=this.parsedStyle)===null||s===void 0?void 0:s.pointerEvents)!=="none"}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,B.Z)(this.parentNode.children.map(function(s){return Number(s.style.zIndex)})))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,B.Z)(this.parentNode.children.map(function(s){return Number(s.style.zIndex)})))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var s=this,l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];var f=u[0],d=u[1];return f?(0,Zn.Z)(f)?(Object.keys(f).forEach(function(v){s.setAttribute(v,f[v])}),this):u.length===2?(this.setAttribute(f,d),this):this.attributes[f]:this.attributes}},{key:"getMatrix",value:function(s){var l=s||this.getWorldTransform(),u=Cc(zo,l),h=(0,W.Z)(u,2),f=h[0],d=h[1],v=Os(zo,l),p=(0,W.Z)(v,2),g=p[0],y=p[1],m=Oc(wO,l),b=Ff(zo,m),x=(0,W.Z)(b,3),E=x[0],w=x[2];return vM(E||w,f,d,g,y)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(s){var l=xg(s),u=(0,W.Z)(l,5),h=u[0],f=u[1],d=u[2],v=u[3],p=u[4];this.setEulerAngles(p).setPosition(h,f).setLocalScale(d,v)}},{key:"setLocalMatrix",value:function(s){var l=xg(s),u=(0,W.Z)(l,5),h=u[0],f=u[1],d=u[2],v=u[3],p=u[4];this.setLocalEulerAngles(p).setLocalPosition(h,f).setLocalScale(d,v)}},{key:"show",value:function(){this.forEach(function(s){s.style.visibility="visible"})}},{key:"hide",value:function(){this.forEach(function(s){s.style.visibility="hidden"})}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(s){return this.children[s]||null}},{key:"add",value:function(s,l){return this.appendChild(s,l)}},{key:"set",value:function(s,l){this.config[s]=l}},{key:"get",value:function(s){return this.config[s]}},{key:"moveTo",value:function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(s,l,u),this}},{key:"move",value:function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(s,l,u),this}},{key:"setZIndex",value:function(s){return this.style.zIndex=s,this}}])}(xO);Pe.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var gi=function(a){function n(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,I.Z)(this,n),(0,G.Z)(this,n,[(0,$.Z)({type:J.CIRCLE},r)])}return(0,F.Z)(n,a),(0,D.Z)(n)}(Pe);gi.PARSED_STYLE_LIST=new Set([].concat((0,B.Z)(Pe.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var SO=["style"],vd=function(a){function n(){var r,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=s.style,u=(0,Da.Z)(s,SO);return(0,I.Z)(this,n),r=(0,G.Z)(this,n,[(0,$.Z)({style:l},u)]),r.isCustomElement=!0,r}return(0,F.Z)(n,a),(0,D.Z)(n)}(Pe);vd.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var Zo=function(a){function n(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,I.Z)(this,n),(0,G.Z)(this,n,[(0,$.Z)({type:J.ELLIPSE},r)])}return(0,F.Z)(n,a),(0,D.Z)(n)}(Pe);Zo.PARSED_STYLE_LIST=new Set([].concat((0,B.Z)(Pe.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"]));var MO=function(a){function n(){return(0,I.Z)(this,n),(0,G.Z)(this,n,[{type:J.FRAGMENT}])}return(0,F.Z)(n,a),(0,D.Z)(n)}(Pe);MO.PARSED_STYLE_LIST=new Set(["class","className"]);var vn=function(a){function n(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,I.Z)(this,n),(0,G.Z)(this,n,[(0,$.Z)({type:J.GROUP},r)])}return(0,F.Z)(n,a),(0,D.Z)(n)}(Pe);vn.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var TO=["style"],$a=function(a){function n(){var r,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=s.style,u=(0,Da.Z)(s,TO);return(0,I.Z)(this,n),r=(0,G.Z)(this,n,[(0,$.Z)({type:J.HTML,style:l},u)]),r.cullable.enable=!1,r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var s=ci(Ce(),this.parentNode.getWorldTransform()),l=this.getBounds();if(!ke.isEmpty(l)){var u=new ke;return u.setFromTransformedAABB(l,s),u}}return this.getBounds()}}])}(Pe);$a.PARSED_STYLE_LIST=new Set([].concat((0,B.Z)(Pe.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var Go=function(a){function n(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,I.Z)(this,n),(0,G.Z)(this,n,[(0,$.Z)({type:J.IMAGE},r)])}return(0,F.Z)(n,a),(0,D.Z)(n)}(Pe);Go.PARSED_STYLE_LIST=new Set([].concat((0,B.Z)(Pe.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var CO=["style"],Ua=function(a){function n(){var r,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=s.style,u=(0,Da.Z)(s,CO);(0,I.Z)(this,n),r=(0,G.Z)(this,n,[(0,$.Z)({type:J.LINE,style:(0,$.Z)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},l)},u)]),r.markerStartAngle=0,r.markerEndAngle=0;var h=r.parsedStyle,f=h.markerStart,d=h.markerEnd;return f&&ae(f)&&(r.markerStartAngle=f.getLocalEulerAngles(),r.appendChild(f)),d&&ae(d)&&(r.markerEndAngle=d.getLocalEulerAngles(),r.appendChild(d)),r.transformMarker(!0),r.transformMarker(!1),r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"attributeChangedCallback",value:function(s,l,u,h,f){s==="x1"||s==="y1"||s==="x2"||s==="y2"||s==="markerStartOffset"||s==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):s==="markerStart"?(h&&ae(h)&&(this.markerStartAngle=0,h.remove()),f&&ae(f)&&(this.markerStartAngle=f.getLocalEulerAngles(),this.appendChild(f),this.transformMarker(!0))):s==="markerEnd"&&(h&&ae(h)&&(this.markerEndAngle=0,h.remove()),f&&ae(f)&&(this.markerEndAngle=f.getLocalEulerAngles(),this.appendChild(f),this.transformMarker(!1)))}},{key:"transformMarker",value:function(s){var l=this.parsedStyle,u=l.markerStart,h=l.markerEnd,f=l.markerStartOffset,d=l.markerEndOffset,v=l.x1,p=l.x2,g=l.y1,y=l.y2,m=s?u:h;if(!(!m||!ae(m))){var b=0,x,E,w,S,M,C;s?(w=v,S=g,x=p-v,E=y-g,M=f||0,C=this.markerStartAngle):(w=p,S=y,x=v-p,E=g-y,M=d||0,C=this.markerEndAngle),b=Math.atan2(E,x),m.setLocalEulerAngles(b*180/Math.PI+C),m.setLocalPosition(w+Math.cos(b)*M,S+Math.sin(b)*M)}}},{key:"getPoint",value:function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=this.parsedStyle,h=u.x1,f=u.y1,d=u.x2,v=u.y2,p=ui(h,f,d,v,s),g=p.x,y=p.y,m=dn(j(),vt(g,y,0),l?this.getWorldTransform():this.getLocalTransform());return new wn(m[0],m[1])}},{key:"getPointAtLength",value:function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(s/this.getTotalLength(),l)}},{key:"getTotalLength",value:function(){var s=this.parsedStyle,l=s.x1,u=s.y1,h=s.x2,f=s.y2;return og(l,u,h,f)}}])}(Pe);Ua.PARSED_STYLE_LIST=new Set([].concat((0,B.Z)(Pe.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var OO=["style"],dr=function(a){function n(){var r,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=s.style,u=(0,Da.Z)(s,OO);(0,I.Z)(this,n),r=(0,G.Z)(this,n,[(0,$.Z)({type:J.PATH,style:l,initialParsedStyle:{miterLimit:4,d:(0,$.Z)({},Cg)}},u)]),r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var h=r.parsedStyle,f=h.markerStart,d=h.markerEnd,v=h.markerMid;return f&&ae(f)&&(r.markerStartAngle=f.getLocalEulerAngles(),r.appendChild(f)),v&&ae(v)&&r.placeMarkerMid(v),d&&ae(d)&&(r.markerEndAngle=d.getLocalEulerAngles(),r.appendChild(d)),r.transformMarker(!0),r.transformMarker(!1),r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"attributeChangedCallback",value:function(s,l,u,h,f){s==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):s==="markerStartOffset"||s==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):s==="markerStart"?(h&&ae(h)&&(this.markerStartAngle=0,h.remove()),f&&ae(f)&&(this.markerStartAngle=f.getLocalEulerAngles(),this.appendChild(f),this.transformMarker(!0))):s==="markerEnd"?(h&&ae(h)&&(this.markerEndAngle=0,h.remove()),f&&ae(f)&&(this.markerEndAngle=f.getLocalEulerAngles(),this.appendChild(f),this.transformMarker(!1))):s==="markerMid"&&this.placeMarkerMid(f)}},{key:"transformMarker",value:function(s){var l=this.parsedStyle,u=l.markerStart,h=l.markerEnd,f=l.markerStartOffset,d=l.markerEndOffset,v=s?u:h;if(!(!v||!ae(v))){var p=0,g,y,m,b,x,E;if(s){var w=this.getStartTangent(),S=(0,W.Z)(w,2),M=S[0],C=S[1];m=C[0],b=C[1],g=M[0]-C[0],y=M[1]-C[1],x=f||0,E=this.markerStartAngle}else{var T=this.getEndTangent(),O=(0,W.Z)(T,2),k=O[0],P=O[1];m=P[0],b=P[1],g=k[0]-P[0],y=k[1]-P[1],x=d||0,E=this.markerEndAngle}p=Math.atan2(y,g),v.setLocalEulerAngles(p*180/Math.PI+E),v.setLocalPosition(m+Math.cos(p)*x,b+Math.sin(p)*x)}}},{key:"placeMarkerMid",value:function(s){var l=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(p){p.remove()}),s&&ae(s))for(var u=1;u<l.length-1;u++){var h=(0,W.Z)(l[u].currentPoint,2),f=h[0],d=h[1],v=u===1?s:s.cloneNode(!0);this.markerMidList.push(v),this.appendChild(v),v.setLocalPosition(f,d)}}},{key:"getTotalLength",value:function(){return Kf(this)}},{key:"getPointAtLength",value:function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=this.parsedStyle.d.absolutePath,h=AS(u,s),f=h.x,d=h.y,v=dn(j(),vt(f,d,0),l?this.getWorldTransform():this.getLocalTransform());return new wn(v[0],v[1])}},{key:"getPoint",value:function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPointAtLength(s*Kf(this),l)}},{key:"getStartTangent",value:function(){var s=this.parsedStyle.d.segments,l=[];if(s.length>1){var u=s[0].currentPoint,h=s[1].currentPoint,f=s[1].startTangent;l=[],f?(l.push([u[0]-f[0],u[1]-f[1]]),l.push([u[0],u[1]])):(l.push([h[0],h[1]]),l.push([u[0],u[1]]))}return l}},{key:"getEndTangent",value:function(){var s=this.parsedStyle.d.segments,l=s.length,u=[];if(l>1){var h=s[l-2].currentPoint,f=s[l-1].currentPoint,d=s[l-1].endTangent;u=[],d?(u.push([f[0]-d[0],f[1]-d[1]]),u.push([f[0],f[1]])):(u.push([h[0],h[1]]),u.push([f[0],f[1]]))}return u}}])}(Pe);dr.PARSED_STYLE_LIST=new Set([].concat((0,B.Z)(Pe.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var kO=["style"],Ya=function(a){function n(){var r,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=s.style,u=(0,Da.Z)(s,kO);(0,I.Z)(this,n),r=(0,G.Z)(this,n,[(0,$.Z)({type:J.POLYGON,style:l,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},u)]),r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var h=r.parsedStyle,f=h.markerStart,d=h.markerEnd,v=h.markerMid;return f&&ae(f)&&(r.markerStartAngle=f.getLocalEulerAngles(),r.appendChild(f)),v&&ae(v)&&r.placeMarkerMid(v),d&&ae(d)&&(r.markerEndAngle=d.getLocalEulerAngles(),r.appendChild(d)),r.transformMarker(!0),r.transformMarker(!1),r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"attributeChangedCallback",value:function(s,l,u,h,f){s==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):s==="markerStartOffset"||s==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):s==="markerStart"?(h&&ae(h)&&(this.markerStartAngle=0,h.remove()),f&&ae(f)&&(this.markerStartAngle=f.getLocalEulerAngles(),this.appendChild(f),this.transformMarker(!0))):s==="markerEnd"?(h&&ae(h)&&(this.markerEndAngle=0,h.remove()),f&&ae(f)&&(this.markerEndAngle=f.getLocalEulerAngles(),this.appendChild(f),this.transformMarker(!1))):s==="markerMid"&&this.placeMarkerMid(f)}},{key:"transformMarker",value:function(s){var l=this.parsedStyle,u=l.markerStart,h=l.markerEnd,f=l.markerStartOffset,d=l.markerEndOffset,v=l.points,p=v||{},g=p.points,y=s?u:h;if(!(!y||!ae(y)||!g)){var m=0,b,x,E,w,S,M;if(E=g[0][0],w=g[0][1],s)b=g[1][0]-g[0][0],x=g[1][1]-g[0][1],S=f||0,M=this.markerStartAngle;else{var C=g.length;this.parsedStyle.isClosed?(b=g[C-1][0]-g[0][0],x=g[C-1][1]-g[0][1]):(E=g[C-1][0],w=g[C-1][1],b=g[C-2][0]-g[C-1][0],x=g[C-2][1]-g[C-1][1]),S=d||0,M=this.markerEndAngle}m=Math.atan2(x,b),y.setLocalEulerAngles(m*180/Math.PI+M),y.setLocalPosition(E+Math.cos(m)*S,w+Math.sin(m)*S)}}},{key:"placeMarkerMid",value:function(s){var l=this.parsedStyle.points,u=l||{},h=u.points;if(this.markerMidList.forEach(function(g){g.remove()}),this.markerMidList=[],s&&ae(s)&&h)for(var f=1;f<(this.parsedStyle.isClosed?h.length:h.length-1);f++){var d=h[f][0],v=h[f][1],p=f===1?s:s.cloneNode(!0);this.markerMidList.push(p),this.appendChild(p),p.setLocalPosition(d,v)}}}])}(Pe);Ya.PARSED_STYLE_LIST=new Set([].concat((0,B.Z)(Pe.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var _O=["style"],au=function(a){function n(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=r.style,l=(0,Da.Z)(r,_O);return(0,I.Z)(this,n),(0,G.Z)(this,n,[(0,$.Z)({type:J.POLYLINE,style:s,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},l)])}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"getTotalLength",value:function(){return yT(this)}},{key:"getPointAtLength",value:function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(s/this.getTotalLength(),l)}},{key:"getPoint",value:function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var h=[],f=0,d,v,p=this.getTotalLength();u.forEach(function(w,S){u[S+1]&&(d=[0,0],d[0]=f/p,v=og(w[0],w[1],u[S+1][0],u[S+1][1]),f+=v,d[1]=f/p,h.push(d))}),this.parsedStyle.points.segments=h}var g=0,y=0;this.parsedStyle.points.segments.forEach(function(w,S){s>=w[0]&&s<=w[1]&&(g=(s-w[0])/(w[1]-w[0]),y=S)});var m=ui(u[y][0],u[y][1],u[y+1][0],u[y+1][1],g),b=m.x,x=m.y,E=dn(j(),vt(b,x,0),l?this.getWorldTransform():this.getLocalTransform());return new wn(E[0],E[1])}},{key:"getStartTangent",value:function(){var s=this.parsedStyle.points.points,l=[];return l.push([s[1][0],s[1][1]]),l.push([s[0][0],s[0][1]]),l}},{key:"getEndTangent",value:function(){var s=this.parsedStyle.points.points,l=s.length-1,u=[];return u.push([s[l-1][0],s[l-1][1]]),u.push([s[l][0],s[l][1]]),u}}])}(Ya);au.PARSED_STYLE_LIST=new Set([].concat((0,B.Z)(Ya.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var Sn=function(a){function n(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,I.Z)(this,n),(0,G.Z)(this,n,[(0,$.Z)({type:J.RECT},r)])}return(0,F.Z)(n,a),(0,D.Z)(n)}(Pe);Sn.PARSED_STYLE_LIST=new Set([].concat((0,B.Z)(Pe.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var PO=["style"],Xa=function(a){function n(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=r.style,l=(0,Da.Z)(r,PO);return(0,I.Z)(this,n),(0,G.Z)(this,n,[(0,$.Z)({type:J.TEXT,style:(0,$.Z)({fill:"black"},s)},l)])}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"getComputedTextLength",value:function(){var s;return this.getGeometryBounds(),((s=this.parsedStyle.metrics)===null||s===void 0?void 0:s.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var s;return this.getGeometryBounds(),((s=this.parsedStyle.metrics)===null||s===void 0?void 0:s.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(Pe);Xa.PARSED_STYLE_LIST=new Set([].concat((0,B.Z)(Pe.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var AO=function(){function a(){(0,I.Z)(this,a),this.registry={},this.define(J.CIRCLE,gi),this.define(J.ELLIPSE,Zo),this.define(J.RECT,Sn),this.define(J.IMAGE,Go),this.define(J.LINE,Ua),this.define(J.GROUP,vn),this.define(J.PATH,dr),this.define(J.POLYGON,Ya),this.define(J.POLYLINE,au),this.define(J.TEXT,Xa),this.define(J.HTML,$a)}return(0,D.Z)(a,[{key:"define",value:function(r,s){this.registry[r]=s}},{key:"get",value:function(r){return this.registry[r]}}])}(),Bz={number:function(n){return new Me(n)},percent:function(n){return new Me(n,"%")},px:function(n){return new Me(n,"px")},em:function(n){return new Me(n,"em")},rem:function(n){return new Me(n,"rem")},deg:function(n){return new Me(n,"deg")},grad:function(n){return new Me(n,"grad")},rad:function(n){return new Me(n,"rad")},turn:function(n){return new Me(n,"turn")},s:function(n){return new Me(n,"s")},ms:function(n){return new Me(n,"ms")},registerProperty:function(n){var r=n.name,s=n.inherits,l=n.interpolable,u=n.initialValue,h=n.syntax;st.styleValueRegistry.registerMetadata({n:r,inh:s,int:l,d:u,syntax:h})},registerLayout:function(n,r){st.layoutRegistry.registerLayout(n,r)}},Py=function(a){function n(){var r;(0,I.Z)(this,n),r=(0,G.Z)(this,n),r.defaultView=null,r.ownerDocument=null,r.nodeName="document";try{r.timeline=new st.AnimationTimeline(r)}catch(l){}var s={};return nd.forEach(function(l){var u=l.n,h=l.inh,f=l.d;h&&f&&(s[u]=(0,_t.Z)(f)?f(J.GROUP):f)}),r.documentElement=new vn({id:"g-root",style:s}),r.documentElement.ownerDocument=r,r.documentElement.parentNode=r,r.childNodes=[r.documentElement],r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(s,l){if(s==="svg")return this.documentElement;var u=this.defaultView.customElements.get(s);u||(console.warn("Unsupported tagName: ",s),u=s==="tspan"?Xa:vn);var h=new u(l);return h.ownerDocument=this,h}},{key:"createElementNS",value:function(s,l,u){return this.createElement(l,u)}},{key:"cloneNode",value:function(s){throw new Error(Ee)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(s){}}},{key:"elementsFromBBox",value:function(s,l,u,h){var f=this.defaultView.context.rBushRoot,d=f.search({minX:s,minY:l,maxX:u,maxY:h}),v=[];return d.forEach(function(p){var g=p.displayObject,y=g.parsedStyle.pointerEvents,m=y===void 0?"auto":y,b=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(m);(!b||b&&g.isVisible())&&!g.isCulled()&&g.isInteractive()&&v.push(g)}),v.sort(function(p,g){return g.sortable.renderOrder-p.sortable.renderOrder}),v}},{key:"elementFromPointSync",value:function(s,l){var u=this.defaultView.canvas2Viewport({x:s,y:l}),h=u.x,f=u.y,d=this.defaultView.getConfig(),v=d.width,p=d.height;if(h<0||f<0||h>v||f>p)return null;var g=this.defaultView.viewport2Client({x:h,y:f}),y=g.x,m=g.y,b=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:s,y:l,viewportX:h,viewportY:f,clientX:y,clientY:m},picked:[]}),x=b.picked;return x&&x[0]||this.documentElement}},{key:"elementFromPoint",value:function(){var r=(0,ia.Z)((0,Rn.Z)().mark(function l(u,h){var f,d,v,p,g,y,m,b,x,E,w;return(0,Rn.Z)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(f=this.defaultView.canvas2Viewport({x:u,y:h}),d=f.x,v=f.y,p=this.defaultView.getConfig(),g=p.width,y=p.height,!(d<0||v<0||d>g||v>y)){S.next=1;break}return S.abrupt("return",null);case 1:return m=this.defaultView.viewport2Client({x:d,y:v}),b=m.x,x=m.y,S.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:u,y:h,viewportX:d,viewportY:v,clientX:b,clientY:x},picked:[]});case 2:return E=S.sent,w=E.picked,S.abrupt("return",w&&w[0]||this.documentElement);case 3:case"end":return S.stop()}},l,this)}));function s(l,u){return r.apply(this,arguments)}return s}()},{key:"elementsFromPointSync",value:function(s,l){var u=this.defaultView.canvas2Viewport({x:s,y:l}),h=u.x,f=u.y,d=this.defaultView.getConfig(),v=d.width,p=d.height;if(h<0||f<0||h>v||f>p)return[];var g=this.defaultView.viewport2Client({x:h,y:f}),y=g.x,m=g.y,b=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:s,y:l,viewportX:h,viewportY:f,clientX:y,clientY:m},picked:[]}),x=b.picked;return x[x.length-1]!==this.documentElement&&x.push(this.documentElement),x}},{key:"elementsFromPoint",value:function(){var r=(0,ia.Z)((0,Rn.Z)().mark(function l(u,h){var f,d,v,p,g,y,m,b,x,E,w;return(0,Rn.Z)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(f=this.defaultView.canvas2Viewport({x:u,y:h}),d=f.x,v=f.y,p=this.defaultView.getConfig(),g=p.width,y=p.height,!(d<0||v<0||d>g||v>y)){S.next=1;break}return S.abrupt("return",[]);case 1:return m=this.defaultView.viewport2Client({x:d,y:v}),b=m.x,x=m.y,S.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:u,y:h,viewportX:d,viewportY:v,clientX:b,clientY:x},picked:[]});case 2:return E=S.sent,w=E.picked,w[w.length-1]!==this.documentElement&&w.push(this.documentElement),S.abrupt("return",w);case 3:case"end":return S.stop()}},l,this)}));function s(l,u){return r.apply(this,arguments)}return s}()},{key:"appendChild",value:function(s,l){throw new Error(Ns)}},{key:"insertBefore",value:function(s,l){throw new Error(Ns)}},{key:"removeChild",value:function(s,l){throw new Error(Ns)}},{key:"replaceChild",value:function(s,l,u){throw new Error(Ns)}},{key:"append",value:function(){throw new Error(Ns)}},{key:"prepend",value:function(){throw new Error(Ns)}},{key:"getElementById",value:function(s){return this.documentElement.getElementById(s)}},{key:"getElementsByName",value:function(s){return this.documentElement.getElementsByName(s)}},{key:"getElementsByTagName",value:function(s){return this.documentElement.getElementsByTagName(s)}},{key:"getElementsByClassName",value:function(s){return this.documentElement.getElementsByClassName(s)}},{key:"querySelector",value:function(s){return this.documentElement.querySelector(s)}},{key:"querySelectorAll",value:function(s){return this.documentElement.querySelectorAll(s)}},{key:"find",value:function(s){return this.documentElement.find(s)}},{key:"findAll",value:function(s){return this.documentElement.findAll(s)}}])}(Be),Ay=function(){function a(n){(0,I.Z)(this,a),this.strategies=n}return(0,D.Z)(a,[{key:"apply",value:function(r){var s=r.config,l=r.camera,u=r.renderingService,h=r.renderingContext,f=this.strategies;u.hooks.cull.tap(a.tag,function(d){if(d){var v,p=d.cullable;if(f.length===0?p.visible=h.unculledEntities.indexOf(d.entity)>-1:p.visible=f.every(function(y){return y.isVisible(l,d)}),!d.isCulled()&&d.isVisible())return d;var g=((v=s.future)===null||v===void 0?void 0:v.experimentalCancelEventPropagation)===!0;return d.dispatchEvent(new sn($t.CULLED),g,g),null}return d}),u.hooks.afterRender.tap(a.tag,function(d){d.cullable.visibilityPlaneMask=-1})}}])}();Ay.tag="Culling";var Ny=function(){function a(){var n=this;(0,I.Z)(this,a),this.autoPreventDefault=!1,this.rootPointerEvent=new tu(null),this.rootWheelEvent=new ud(null),this.onPointerMove=function(r){var s,l=(s=n.context.renderingContext.root)===null||s===void 0||(s=s.ownerDocument)===null||s===void 0?void 0:s.defaultView;if(!(l.supportsTouchEvents&&r.pointerType==="touch")){var u=n.normalizeToPointerEvent(r,l),h=(0,La.Z)(u),f;try{for(h.s();!(f=h.n()).done;){var d=f.value,v=n.bootstrapEvent(n.rootPointerEvent,d,l,r);n.context.eventService.mapEvent(v)}}catch(p){h.e(p)}finally{h.f()}n.setCursor(n.context.eventService.cursor)}},this.onClick=function(r){var s,l=(s=n.context.renderingContext.root)===null||s===void 0||(s=s.ownerDocument)===null||s===void 0?void 0:s.defaultView,u=n.normalizeToPointerEvent(r,l),h=(0,La.Z)(u),f;try{for(h.s();!(f=h.n()).done;){var d=f.value,v=n.bootstrapEvent(n.rootPointerEvent,d,l,r);n.context.eventService.mapEvent(v)}}catch(p){h.e(p)}finally{h.f()}n.setCursor(n.context.eventService.cursor)}}return(0,D.Z)(a,[{key:"apply",value:function(r){var s=this;this.context=r;var l=r.renderingService,u=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(h){var f=s.context.renderingService.hooks.pickSync.call({position:h,picked:[],topmost:!0}),d=f.picked;return d[0]||null}),l.hooks.pointerWheel.tap(a.tag,function(h){var f=s.normalizeWheelEvent(h);s.context.eventService.mapEvent(f)}),l.hooks.pointerDown.tap(a.tag,function(h){if(!(u.supportsTouchEvents&&h.pointerType==="touch")){var f=s.normalizeToPointerEvent(h,u);if(s.autoPreventDefault&&f[0].isNormalized){var d=h.cancelable||!("cancelable"in h);d&&h.preventDefault()}var v=(0,La.Z)(f),p;try{for(v.s();!(p=v.n()).done;){var g=p.value,y=s.bootstrapEvent(s.rootPointerEvent,g,u,h);s.context.eventService.mapEvent(y)}}catch(m){v.e(m)}finally{v.f()}s.setCursor(s.context.eventService.cursor)}}),l.hooks.pointerUp.tap(a.tag,function(h){if(!(u.supportsTouchEvents&&h.pointerType==="touch")){var f=s.context.contextService.getDomElement(),d=s.context.eventService.isNativeEventFromCanvas(f,h),v=d?"":"outside",p=s.normalizeToPointerEvent(h,u),g=(0,La.Z)(p),y;try{for(g.s();!(y=g.n()).done;){var m=y.value,b=s.bootstrapEvent(s.rootPointerEvent,m,u,h);b.type+=v,s.context.eventService.mapEvent(b)}}catch(x){g.e(x)}finally{g.f()}s.setCursor(s.context.eventService.cursor)}}),l.hooks.pointerMove.tap(a.tag,this.onPointerMove),l.hooks.pointerOver.tap(a.tag,this.onPointerMove),l.hooks.pointerOut.tap(a.tag,this.onPointerMove),l.hooks.click.tap(a.tag,this.onClick),l.hooks.pointerCancel.tap(a.tag,function(h){var f=s.normalizeToPointerEvent(h,u),d=(0,La.Z)(f),v;try{for(d.s();!(v=d.n()).done;){var p=v.value,g=s.bootstrapEvent(s.rootPointerEvent,p,u,h);s.context.eventService.mapEvent(g)}}catch(y){d.e(y)}finally{d.f()}s.setCursor(s.context.eventService.cursor)})}},{key:"bootstrapEvent",value:function(r,s,l,u){r.view=l,r.originalEvent=null,r.nativeEvent=u,r.pointerId=s.pointerId,r.width=s.width,r.height=s.height,r.isPrimary=s.isPrimary,r.pointerType=s.pointerType,r.pressure=s.pressure,r.tangentialPressure=s.tangentialPressure,r.tiltX=s.tiltX,r.tiltY=s.tiltY,r.twist=s.twist,this.transferMouseData(r,s);var h=this.context.eventService.client2Viewport({x:s.clientX,y:s.clientY}),f=h.x,d=h.y;r.viewport.x=f,r.viewport.y=d;var v=this.context.eventService.viewport2Canvas(r.viewport),p=v.x,g=v.y;return r.canvas.x=p,r.canvas.y=g,r.global.copyFrom(r.canvas),r.offset.copyFrom(r.canvas),r.isTrusted=u.isTrusted,r.type==="pointerleave"&&(r.type="pointerout"),r.type.startsWith("mouse")&&(r.type=r.type.replace("mouse","pointer")),r.type.startsWith("touch")&&(r.type=vC[r.type]||r.type),r}},{key:"normalizeWheelEvent",value:function(r){var s=this.rootWheelEvent;this.transferMouseData(s,r),s.deltaMode=r.deltaMode,s.deltaX=r.deltaX,s.deltaY=r.deltaY,s.deltaZ=r.deltaZ;var l=this.context.eventService.client2Viewport({x:r.clientX,y:r.clientY}),u=l.x,h=l.y;s.viewport.x=u,s.viewport.y=h;var f=this.context.eventService.viewport2Canvas(s.viewport),d=f.x,v=f.y;return s.canvas.x=d,s.canvas.y=v,s.global.copyFrom(s.canvas),s.offset.copyFrom(s.canvas),s.nativeEvent=r,s.type=r.type,s}},{key:"transferMouseData",value:function(r,s){r.isTrusted=s.isTrusted,r.srcElement=s.srcElement,r.timeStamp=sd.now(),r.type=s.type,r.altKey=s.altKey,r.metaKey=s.metaKey,r.shiftKey=s.shiftKey,r.ctrlKey=s.ctrlKey,r.button=s.button,r.buttons=s.buttons,r.client.x=s.clientX,r.client.y=s.clientY,r.movement.x=s.movementX,r.movement.y=s.movementY,r.page.x=s.pageX,r.page.y=s.pageY,r.screen.x=s.screenX,r.screen.y=s.screenY,r.relatedTarget=null}},{key:"setCursor",value:function(r){this.context.contextService.applyCursorStyle(r||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(r,s){var l=[];if(s.isTouchEvent(r))for(var u=0;u<r.changedTouches.length;u++){var h=r.changedTouches[u];Ft(h.button)&&(h.button=0),Ft(h.buttons)&&(h.buttons=1),Ft(h.isPrimary)&&(h.isPrimary=r.touches.length===1&&r.type==="touchstart"),Ft(h.width)&&(h.width=h.radiusX||1),Ft(h.height)&&(h.height=h.radiusY||1),Ft(h.tiltX)&&(h.tiltX=0),Ft(h.tiltY)&&(h.tiltY=0),Ft(h.pointerType)&&(h.pointerType="touch"),Ft(h.pointerId)&&(h.pointerId=h.identifier||0),Ft(h.pressure)&&(h.pressure=h.force||.5),Ft(h.twist)&&(h.twist=0),Ft(h.tangentialPressure)&&(h.tangentialPressure=0),h.isNormalized=!0,h.type=r.type,l.push(h)}else if(s.isMouseEvent(r)){var f=r;Ft(f.isPrimary)&&(f.isPrimary=!0),Ft(f.width)&&(f.width=1),Ft(f.height)&&(f.height=1),Ft(f.tiltX)&&(f.tiltX=0),Ft(f.tiltY)&&(f.tiltY=0),Ft(f.pointerType)&&(f.pointerType="mouse"),Ft(f.pointerId)&&(f.pointerId=dC),Ft(f.pressure)&&(f.pressure=.5),Ft(f.twist)&&(f.twist=0),Ft(f.tangentialPressure)&&(f.tangentialPressure=0),f.isNormalized=!0,l.push(f)}else l.push(r);return l}}])}();Ny.tag="Event";var NO=[J.CIRCLE,J.ELLIPSE,J.IMAGE,J.RECT,J.LINE,J.POLYLINE,J.POLYGON,J.TEXT,J.PATH,J.HTML],RO=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"isVisible",value:function(r,s){var l,u=s.cullable;if(!u.enable)return!0;var h=s.getRenderBounds();if(ke.isEmpty(h))return!1;var f=r.getFrustum(),d=(l=s.parentNode)===null||l===void 0||(l=l.cullable)===null||l===void 0?void 0:l.visibilityPlaneMask;return u.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(s,h,d||Ps.INDETERMINATE,f.planes),u.visible=u.visibilityPlaneMask!==Ps.OUTSIDE,u.visible}},{key:"computeVisibilityWithPlaneMask",value:function(r,s,l,u){if(l===Ps.OUTSIDE||l===Ps.INSIDE)return l;for(var h=Ps.INSIDE,f=NO.indexOf(r.nodeName)>-1,d=0,v=u.length;d<v;++d){var p=1<<d;if(l&p&&!(f&&(d===4||d===5))){var g=u[d],y=g.normal,m=g.distance;if(Qn(y,s.getPositiveFarPoint(u[d]))+m<0)return Ps.OUTSIDE;Qn(y,s.getNegativeFarPoint(u[d]))+m<0&&(h|=p)}}return h}}])}(),Ry=function(){function a(){(0,I.Z)(this,a),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return(0,D.Z)(a,[{key:"apply",value:function(r){var s=this,l,u,h=r.config,f=r.renderingService,d=r.renderingContext,v=r.rBushRoot,p=d.root.ownerDocument.defaultView;this.rBush=v;var g=function(S){f.dirtify()},y=function(S){s.syncTasks.set(S.target,S.detail.affectChildren),f.dirtify()},m=function(S){var M=S.target;st.enableSizeAttenuation&&st.styleValueRegistry.updateSizeAttenuation(M,p.getCamera().getZoom())},b=function(S){var M=S.target,C=M.rBushNode;C!=null&&C.aabb&&s.rBush.remove(C.aabb),s.syncTasks.delete(M),st.sceneGraphService.dirtyToRoot(M),f.dirtify()};f.hooks.init.tap(a.tag,function(){p.addEventListener($t.MOUNTED,m),p.addEventListener($t.UNMOUNTED,b),p.addEventListener($t.ATTR_MODIFIED,g),p.addEventListener($t.BOUNDS_CHANGED,y)}),f.hooks.destroy.tap(a.tag,function(){p.removeEventListener($t.MOUNTED,m),p.removeEventListener($t.UNMOUNTED,b),p.removeEventListener($t.ATTR_MODIFIED,g),p.removeEventListener($t.BOUNDS_CHANGED,y),s.syncTasks.clear()});var x=(l=st.globalThis.requestIdleCallback)!==null&&l!==void 0?l:od.bind(st.globalThis),E=((u=h.future)===null||u===void 0?void 0:u.experimentalRICSyncRTree)===!0;f.hooks.endFrame.tap(a.tag,function(){s.isFirstTimeRendering?(s.isFirstTimeRendering=!1,s.syncing=!0,x(function(){s.syncRTree(!0),s.isFirstTimeRenderingFinished=!0})):E&&st.globalThis.requestIdleCallback&&st.globalThis.cancelIdleCallback?(st.globalThis.cancelIdleCallback(s.ricSyncRTreeId),s.ricSyncRTreeId=st.globalThis.requestIdleCallback(function(){return s.syncRTree()})):s.syncRTree()})}},{key:"syncNode",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(r.isConnected){var l=r.rBushNode;l.aabb&&this.rBush.remove(l.aabb);var u=r.getRenderBounds();if(u){var h=r.renderable;s&&(h.dirtyRenderBounds||(h.dirtyRenderBounds=new ke),h.dirtyRenderBounds.update(u.center,u.halfExtents));var f=u.getMin(),d=(0,W.Z)(f,2),v=d[0],p=d[1],g=u.getMax(),y=(0,W.Z)(g,2),m=y[0],b=y[1];l.aabb||(l.aabb={}),l.aabb.displayObject=r,l.aabb.minX=v,l.aabb.minY=p,l.aabb.maxX=m,l.aabb.maxY=b}if(l.aabb&&!isNaN(l.aabb.maxX)&&!isNaN(l.aabb.maxX)&&!isNaN(l.aabb.minX)&&!isNaN(l.aabb.minY))return l.aabb}}},{key:"syncRTree",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!s&&(this.syncing||this.syncTasks.size===0))){this.syncing=!0;var l=[],u=new Set,h=function(d){if(!u.has(d)&&d.renderable){var v=r.syncNode(d,s);v&&(l.push(v),u.add(d))}};this.syncTasks.forEach(function(f,d){f&&d.forEach(h);for(var v=d;v;)h(v),v=v.parentElement}),this.rBush.load(l),l.length=0,this.syncing=!1}}}])}();Ry.tag="Prepare";function Fz(a){return!!a.document}var vr=function(a){return a.READY="ready",a.BEFORE_RENDER="beforerender",a.RERENDER="rerender",a.AFTER_RENDER="afterrender",a.BEFORE_DESTROY="beforedestroy",a.AFTER_DESTROY="afterdestroy",a.RESIZE="resize",a.DIRTY_RECTANGLE="dirtyrectangle",a.RENDERER_CHANGED="rendererchanged",a}({}),Ly=500,LO=.1,DO=1e3,su=new sn($t.MOUNTED),ou=new sn($t.UNMOUNTED),pd=new sn(vr.BEFORE_RENDER),Dy=new sn(vr.RERENDER),gd=new sn(vr.AFTER_RENDER),yd=function(a){function n(r){var s;(0,I.Z)(this,n),s=(0,G.Z)(this,n),s.Element=Pe,s.inited=!1,s.context={};var l=r.container,u=r.canvas,h=r.renderer,f=r.width,d=r.height,v=r.background,p=r.cursor,g=r.supportsMutipleCanvasesInOneContainer,y=r.cleanUpOnDestroy,m=y===void 0?!0:y,b=r.offscreenCanvas,x=r.devicePixelRatio,E=r.requestAnimationFrame,w=r.cancelAnimationFrame,S=r.createImage,M=r.supportsTouchEvents,C=r.supportsPointerEvents,T=r.isTouchEvent,O=r.isMouseEvent,k=r.dblClickSpeed,P=f,A=d,N=x||ad&&window.devicePixelRatio||1;return N=N>=1?Math.ceil(N):1,u&&(P=f||hC(u)||u.width/N,A=d||fC(u)||u.height/N),s.customElements=new AO,s.devicePixelRatio=N,s.requestAnimationFrame=E!=null?E:od.bind(st.globalThis),s.cancelAnimationFrame=w!=null?w:yy.bind(st.globalThis),s.createImage=S!=null?S:function(){return new window.Image},s.supportsTouchEvents=M!=null?M:"ontouchstart"in st.globalThis,s.supportsPointerEvents=C!=null?C:!!st.globalThis.PointerEvent,s.isTouchEvent=T!=null?T:function(L){return s.supportsTouchEvents&&L instanceof st.globalThis.TouchEvent},s.isMouseEvent=O!=null?O:function(L){return!st.globalThis.MouseEvent||L instanceof st.globalThis.MouseEvent&&(!s.supportsPointerEvents||!(L instanceof st.globalThis.PointerEvent))},b&&(st.offscreenCanvas=b),s.document=new Py,s.document.defaultView=s,g||oC(l,s,m),s.initRenderingContext((0,$.Z)((0,$.Z)({},r),{},{width:P,height:A,background:v!=null?v:"transparent",cursor:p!=null?p:"default",cleanUpOnDestroy:m,devicePixelRatio:N,requestAnimationFrame:s.requestAnimationFrame,cancelAnimationFrame:s.cancelAnimationFrame,createImage:s.createImage,supportsTouchEvents:s.supportsTouchEvents,supportsPointerEvents:s.supportsPointerEvents,isTouchEvent:s.isTouchEvent,isMouseEvent:s.isMouseEvent,dblClickSpeed:k!=null?k:200})),s.initDefaultCamera(P,A,h.clipSpaceNearZ),s.initRenderer(h,!0),s}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"initRenderingContext",value:function(s){this.context.config=s,this.context.renderingContext={root:this.document.documentElement,unculledEntities:[],renderListCurrentFrame:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(s,l,u){var h=this,f=new st.CameraContribution;f.clipSpaceNearZ=u,f.setType(Se.EXPLORING,Zf.DEFAULT).setPosition(s/2,l/2,Ly).setFocalPoint(s/2,l/2,0).setOrthographic(s/-2,s/2,l/2,l/-2,LO,DO),f.canvas=this,f.eventEmitter.on(wg.UPDATED,function(){h.context.renderingContext.renderReasons.add(Bs.CAMERA_CHANGED),st.enableSizeAttenuation&&h.getConfig().renderer.getConfig().enableSizeAttenuation&&h.updateSizeAttenuation()}),this.context.camera=f}},{key:"updateSizeAttenuation",value:function(){var s=this.getCamera().getZoom();this.document.documentElement.forEach(function(l){st.styleValueRegistry.updateSizeAttenuation(l,s)})}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var s=this;return this.readyPromise||(this.readyPromise=new Promise(function(l){s.resolveReadyPromise=function(){l(s)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var s,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,u=arguments.length>1?arguments[1]:void 0;Ke.clearCache();var h=((s=this.getConfig().future)===null||s===void 0?void 0:s.experimentalCancelEventPropagation)===!0;u||this.dispatchEvent(new sn(vr.BEFORE_DESTROY),h,h),this.frameId&&this.cancelAnimationFrame(this.frameId);var f=this.getRoot();l&&(this.unmountChildren(f),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),this.context.rBushRoot&&this.context.rBushRoot.clear(),u||this.dispatchEvent(new sn(vr.AFTER_DESTROY),h,h);var d=function(p){p.currentTarget=null,p.manager=null,p.target=null,p.relatedNode=null};d(su),d(ou),d(pd),d(Dy),d(gd),d(pi),d(fd),d(dd),d(_y),st.textService.clearCache()}},{key:"changeSize",value:function(s,l){this.resize(s,l)}},{key:"resize",value:function(s,l){var u,h=this.context.config;h.width=s,h.height=l,this.getContextService().resize(s,l);var f=this.context.camera,d=f.getProjectionMode();f.setPosition(s/2,l/2,Ly).setFocalPoint(s/2,l/2,0),d===Or.ORTHOGRAPHIC?f.setOrthographic(s/-2,s/2,l/2,l/-2,f.getNear(),f.getFar()):f.setAspect(s/l);var v=((u=h.future)===null||u===void 0?void 0:u.experimentalCancelEventPropagation)===!0;this.dispatchEvent(new sn(vr.RESIZE,{width:s,height:l}),v,v)}},{key:"appendChild",value:function(s,l){return this.document.documentElement.appendChild(s,l)}},{key:"insertBefore",value:function(s,l){return this.document.documentElement.insertBefore(s,l)}},{key:"removeChild",value:function(s){return this.document.documentElement.removeChild(s)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(s){var l,u=this;s&&(pd.detail=s,gd.detail=s);var h=((l=this.getConfig().future)===null||l===void 0?void 0:l.experimentalCancelEventPropagation)===!0;this.dispatchEvent(pd,h,h);var f=this.getRenderingService();f.render(this.getConfig(),s,function(){u.dispatchEvent(Dy,h,h)}),this.dispatchEvent(gd,h,h)}},{key:"run",value:function(){var s=this,l=function(h,f){s.render(f),s.frameId=s.requestAnimationFrame(l)};l()}},{key:"initRenderer",value:function(s){var l=this,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!s)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new eM,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new Ny,new Ry,new Ay([new RO])),this.loadRendererContainerModule(s),this.context.contextService=new this.context.ContextService((0,$.Z)((0,$.Z)({},st),this.context)),this.context.renderingService=new UC(st,this.context),this.context.eventService=new $C(st,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(s,u,!0)):this.context.contextService.initAsync().then(function(){l.initRenderingService(s,u)}).catch(function(h){console.error(h)})}},{key:"initRenderingService",value:function(s){var l=this,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.context.renderingService.init(function(){var f;l.inited=!0;var d=((f=l.getConfig().future)===null||f===void 0?void 0:f.experimentalCancelEventPropagation)===!0;u?h?l.requestAnimationFrame(function(){l.dispatchEvent(new sn(vr.READY),d,d)}):l.dispatchEvent(new sn(vr.READY),d,d):l.dispatchEvent(new sn(vr.RENDERER_CHANGED),d,d),l.readyPromise&&l.resolveReadyPromise(),u||l.getRoot().forEach(function(v){var p,g;(p=(g=v).dirty)===null||p===void 0||p.call(g,!0,!0)}),l.mountChildren(l.getRoot()),s.getConfig().enableAutoRendering&&l.run()})}},{key:"loadRendererContainerModule",value:function(s){var l=this,u=s.getPlugins();u.forEach(function(h){h.context=l.context,h.init(st)})}},{key:"setRenderer",value:function(s){var l=this.getConfig();if(l.renderer!==s){var u=l.renderer;l.renderer=s,this.destroy(!1,!0),(0,B.Z)((u==null?void 0:u.getPlugins())||[]).reverse().forEach(function(h){h.destroy(st)}),this.initRenderer(s)}}},{key:"setCursor",value:function(s){var l=this.getConfig();l.cursor=s,this.getContextService().applyCursorStyle(s)}},{key:"unmountChildren",value:function(s){var l=this;if(s.childNodes.forEach(function(f){l.unmountChildren(f)}),this.inited){if(s.isMutationObserved)s.dispatchEvent(ou);else{var u,h=((u=this.getConfig().future)===null||u===void 0?void 0:u.experimentalCancelEventPropagation)===!0;ou.target=s,this.dispatchEvent(ou,!0,h)}s!==this.document.documentElement&&(s.ownerDocument=null),s.isConnected=!1}s.isCustomElement&&s.disconnectedCallback&&s.disconnectedCallback()}},{key:"mountChildren",value:function(s){var l=this,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qc(s);if(this.inited){if(!s.isConnected&&(s.ownerDocument=this.document,s.isConnected=!0,!u))if(s.isMutationObserved)s.dispatchEvent(su);else{var h,f=((h=this.getConfig().future)===null||h===void 0?void 0:h.experimentalCancelEventPropagation)===!0;su.target=s,this.dispatchEvent(su,!0,f)}}else console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",s.nodeName);s.childNodes.forEach(function(d){l.mountChildren(d,u)}),s.isCustomElement&&s.connectedCallback&&s.connectedCallback()}},{key:"mountFragment",value:function(s){this.mountChildren(s,!1)}},{key:"client2Viewport",value:function(s){return this.getEventService().client2Viewport(s)}},{key:"viewport2Client",value:function(s){return this.getEventService().viewport2Client(s)}},{key:"viewport2Canvas",value:function(s){return this.getEventService().viewport2Canvas(s)}},{key:"canvas2Viewport",value:function(s){return this.getEventService().canvas2Viewport(s)}},{key:"getPointByClient",value:function(s,l){return this.client2Viewport({x:s,y:l})}},{key:"getClientByPoint",value:function(s,l){return this.viewport2Client({x:s,y:l})}}])}(Sy);var IO=function(a){function n(){var r;(0,I.Z)(this,n);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=(0,G.Z)(this,n,[].concat(l)),r.landmarks=[],r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"rotate",value:function(s,l,u){if(this.relElevation=Rs(l),this.relAzimuth=Rs(s),this.relRoll=Rs(u),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===Se.EXPLORING){var h=ea(an(),[1,0,0],we((this.rotateWorld?1:-1)*this.relElevation)),f=ea(an(),[0,1,0],we((this.rotateWorld?1:-1)*this.relAzimuth)),d=ea(an(),[0,0,1],we(this.relRoll)),v=na(an(),f,h);v=na(an(),v,d);var p=Mf(Ce(),v);Cs(this.matrix,this.matrix,[0,0,-this.distance]),An(this.matrix,this.matrix,p),Cs(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===Se.ORBITING||this.type===Se.EXPLORING?this._getPosition():this.type===Se.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(s,l){var u=Gn(s,l,0),h=et(this.position);return Jt(h,h,Zr(j(),this.right,u[0])),Jt(h,h,Zr(j(),this.up,u[1])),this._setPosition(h),this.triggerUpdate(),this}},{key:"dolly",value:function(s){var l=this.forward,u=et(this.position),h=s*this.dollyingStep,f=this.distance+s*this.dollyingStep;return h=Math.max(Math.min(f,this.maxDistance),this.minDistance)-this.distance,u[0]+=h*l[0],u[1]+=h*l[1],u[2]+=h*l[2],this._setPosition(u),this.type===Se.ORBITING||this.type===Se.EXPLORING?this._getDistance():this.type===Se.TRACKING&&Jt(this.focalPoint,u,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(s){var l,u,h,f,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},v=d.position,p=v===void 0?this.position:v,g=d.focalPoint,y=g===void 0?this.focalPoint:g,m=d.roll,b=d.zoom,x=new st.CameraContribution;x.setType(this.type,void 0),x.setPosition(p[0],(l=p[1])!==null&&l!==void 0?l:this.position[1],(u=p[2])!==null&&u!==void 0?u:this.position[2]),x.setFocalPoint(y[0],(h=y[1])!==null&&h!==void 0?h:this.focalPoint[1],(f=y[2])!==null&&f!==void 0?f:this.focalPoint[2]),x.setRoll(m!=null?m:this.roll),x.setZoom(b!=null?b:this.zoom);var E={name:s,matrix:xp(x.getWorldTransform()),right:et(x.right),up:et(x.up),forward:et(x.forward),position:et(x.getPosition()),focalPoint:et(x.getFocalPoint()),distanceVector:et(x.getDistanceVector()),distance:x.getDistance(),dollyingStep:x.getDollyingStep(),azimuth:x.getAzimuth(),elevation:x.getElevation(),roll:x.getRoll(),relAzimuth:x.relAzimuth,relElevation:x.relElevation,relRoll:x.relRoll,zoom:x.getZoom()};return this.landmarks.push(E),E}},{key:"gotoLandmark",value:function(s){var l=this,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=(0,ve.Z)(s)?this.landmarks.find(function(L){return L.name===s}):s;if(h){var f=(0,se.Z)(u)?{duration:u}:u,d=f.easing,v=d===void 0?"linear":d,p=f.duration,g=p===void 0?100:p,y=f.easingFunction,m=y===void 0?void 0:y,b=f.onfinish,x=b===void 0?void 0:b,E=f.onframe,w=E===void 0?void 0:E,S=.01;this.cancelLandmarkAnimation();var M=h.position,C=h.focalPoint,T=h.zoom,O=h.roll,k=m||st.EasingFunction(v),P,A=function(){l.setFocalPoint(C),l.setPosition(M),l.setRoll(O),l.setZoom(T),l.computeMatrix(),l.triggerUpdate(),x==null||x()};if(g===0)return A();var N=function(R){P===void 0&&(P=R);var z=R-P;if(z>=g){A();return}var Z=k(z/g),X=j(),nt=j(),K=1,rt=0;yo(X,l.focalPoint,C,Z),yo(nt,l.position,M,Z),rt=l.roll*(1-Z)+O*Z,K=l.zoom*(1-Z)+T*Z,l.setFocalPoint(X),l.setPosition(nt),l.setRoll(rt),l.setZoom(K);var U=mp(X,C)+mp(nt,M);if(U<=S&&T===void 0&&O===void 0)return A();l.computeMatrix(),l.triggerUpdate(),z<g&&(w==null||w(Z),l.landmarkAnimationID=l.canvas.requestAnimationFrame(N))};this.canvas.requestAnimationFrame(N)}}}])}(Mg);st.CameraContribution=IO;var Iy=null,zz=0,By=new WeakMap,Zz=null,Gz=null,lu,Li;function Wz(a,n){return lu=new Iy(a,n)}function jz(a){return Li||(Li=Iy.copy(lu),Li.oldValue=a,Li)}function Vz(){lu=Li=void 0}function BO(a){return a===Li||a===lu}function Hz(a,n){return a===n?a:Li&&BO(a)?Li:null}function FO(a){a.nodes.forEach(function(n){var r=By.get(n);r&&r.forEach(function(s){s.observer===a&&s.removeTransientObservers()})})}function $z(a,n){for(var r=a;r;r=r.parentNode){var s=By.get(r);if(s)for(var l=0;l<s.length;l++){var u=s[l],h=u.options;if(!(r!==a&&!h.subtree)){var f=n(h);f&&u.enqueue(f)}}}}var md=!1,bd=null;function Uz(a){bd.push(a),md||(md=!0,typeof runtime.globalThis!="undefined"?runtime.globalThis.setTimeout(xd):xd())}function xd(){md=!1;var a=bd;bd=[],a.sort(function(r,s){return r.uid-s.uid});var n=!1;a.forEach(function(r){var s=r.takeRecords();FO(r),s.length&&(r.callback(s,r),n=!0)}),n&&xd()}var Ed=function(a){function n(r,s,l,u){var h;return(0,I.Z)(this,n),h=(0,G.Z)(this,n,[r]),h.currentTime=l,h.timelineTime=u,h.target=s,h.type="finish",h.bubbles=!1,h.currentTarget=s,h.defaultPrevented=!1,h.eventPhase=h.AT_TARGET,h.timeStamp=Date.now(),h.currentTime=l,h.timelineTime=u,h}return(0,F.Z)(n,a),(0,D.Z)(n)}(Jc),zO=0,ZO=function(){function a(n,r){var s;(0,I.Z)(this,a),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=n,n.animation=this,this.timeline=r,this.id="".concat(zO++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((s=this.effect)===null||s===void 0?void 0:s.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return(0,D.Z)(a,[{key:"pending",get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var r=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(s,l){r.resolveReadyPromise=function(){s(r)},r.rejectReadyPromise=function(){l(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var r=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(s,l){r.resolveFinishedPromise=function(){s(r)},r.rejectFinishedPromise=function(){l(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(r){if(r=Number(r),!isNaN(r)){if(this.timeline.restart(),!this._paused&&this._startTime!==null){var s;this._startTime=Number((s=this.timeline)===null||s===void 0?void 0:s.currentTime)-r/this.playbackRate}this.currentTimePending=!1,this._currentTime!==r&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(r,!0),this.timeline.applyDirtiedAnimation(this))}}},{key:"startTime",get:function(){return this._startTime},set:function(r){if(r!==null){if(this.updatePromises(),r=Number(r),isNaN(r)||this._paused||this._idle)return;this._startTime=r,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(r){if(r!==this._playbackRate){this.updatePromises();var s=this.currentTime;this._playbackRate=r,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),s!==null&&(this.currentTime=s),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||this.playState==="running"||!this._finishedFlag}},{key:"updatePromises",value:function(){var r;if((r=this.effect.target)!==null&&r!==void 0&&r.destroyed)return this.readyPromise=void 0,this.finishedPromise=void 0,!1;var s=this.oldPlayState,l=this.pending?"pending":this.playState;return this.readyPromise&&l!==s&&(l==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):s==="pending"?this.resolveReadyPromise():l==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&l!==s&&(l==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):l==="finished"?this.resolveFinishedPromise():s==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=l,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){var r=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var s=new Ed(null,this,this.currentTime,null);setTimeout(function(){r.oncancel(s)})}}},{key:"reverse",value:function(){this.updatePromises();var r=this.currentTime;this.playbackRate*=-1,this.play(),r!==null&&(this.currentTime=r),this.updatePromises()}},{key:"updatePlaybackRate",value:function(r){this.playbackRate=r}},{key:"targetAnimations",value:function(){var r,s=(r=this.effect)===null||r===void 0?void 0:r.target;return s.getAnimations()}},{key:"markTarget",value:function(){var r=this.targetAnimations();r.indexOf(this)===-1&&r.push(this)}},{key:"unmarkTarget",value:function(){var r=this.targetAnimations(),s=r.indexOf(this);s!==-1&&r.splice(s,1)}},{key:"tick",value:function(r,s){!this._idle&&!this._paused&&(this._startTime===null?s&&(this.startTime=r-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((r-this._startTime)*this.playbackRate)),s&&(this.currentTimePending=!1,this.fireEvents(r))}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")}},{key:"persist",value:function(){throw new Error(Ee)}},{key:"addEventListener",value:function(r,s,l){throw new Error(Ee)}},{key:"removeEventListener",value:function(r,s,l){throw new Error(Ee)}},{key:"dispatchEvent",value:function(r){throw new Error(Ee)}},{key:"commitStyles",value:function(){throw new Error(Ee)}},{key:"ensureAlive",value:function(){if(this.playbackRate<0&&this.currentTime===0){var r;this._inEffect=!!((r=this.effect)!==null&&r!==void 0&&r.update(-1))}else{var s;this._inEffect=!!((s=this.effect)!==null&&s!==void 0&&s.update(this.currentTime))}!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(r,s){r!==this._currentTime&&(this._currentTime=r,this._isFinished&&!s&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(r){var s=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var l=new Ed(null,this,this.currentTime,r);setTimeout(function(){s.onfinish&&s.onfinish(l)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var u=new Ed(null,this,this.currentTime,r);this.onframe(u)}this._finishedFlag=!1}}}])}(),GO=4,WO=.001,jO=1e-7,VO=10,Wo=11,cu=1/(Wo-1),HO=typeof Float32Array=="function",Fy=function(n,r){return 1-3*r+3*n},zy=function(n,r){return 3*r-6*n},Zy=function(n){return 3*n},uu=function(n,r,s){return((Fy(r,s)*n+zy(r,s))*n+Zy(r))*n},Gy=function(n,r,s){return 3*Fy(r,s)*n*n+2*zy(r,s)*n+Zy(r)},$O=function(n,r,s,l,u){var h,f,d=0;do f=r+(s-r)/2,h=uu(f,l,u)-n,h>0?s=f:r=f;while(Math.abs(h)>jO&&++d<VO);return f},UO=function(n,r,s,l){for(var u=0;u<GO;++u){var h=Gy(r,s,l);if(h===0)return r;var f=uu(r,s,l)-n;r-=f/h}return r},wd=function(n,r,s,l){if(!(n>=0&&n<=1&&s>=0&&s<=1))throw new Error("bezier x values must be in [0, 1] range");if(n===r&&s===l)return function(d){return d};for(var u=HO?new Float32Array(Wo):new Array(Wo),h=0;h<Wo;++h)u[h]=uu(h*cu,n,s);var f=function(v){for(var p=0,g=1,y=Wo-1;g!==y&&u[g]<=v;++g)p+=cu;--g;var m=(v-u[g])/(u[g+1]-u[g]),b=p+m*cu,x=Gy(b,n,s);return x>=WO?UO(v,b,n,s):x===0?b:$O(v,p,p+cu,n,s)};return function(d){return d===0||d===1?d:uu(f(d),r,l)}},YO=function(n){return n=n.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())}),n.charAt(0)==="-"?n.substring(1):n},hu=function(n){return Math.pow(n,2)},fu=function(n){return Math.pow(n,3)},du=function(n){return Math.pow(n,4)},vu=function(n){return Math.pow(n,5)},pu=function(n){return Math.pow(n,6)},gu=function(n){return 1-Math.cos(n*Math.PI/2)},yu=function(n){return 1-Math.sqrt(1-n*n)},mu=function(n){return n*n*(3*n-2)},bu=function(n){for(var r,s=4;n<((r=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((r*3-2)/22-n,2)},xu=function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=(0,W.Z)(r,2),l=s[0],u=l===void 0?1:l,h=s[1],f=h===void 0?.5:h,d=Ze(Number(u),1,10),v=Ze(Number(f),.1,2);return n===0||n===1?n:-d*Math.pow(2,10*(n-1))*Math.sin((n-1-v/(Math.PI*2)*Math.asin(1/d))*(Math.PI*2)/v)},jo=function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0,l=(0,W.Z)(r,4),u=l[0],h=u===void 0?1:u,f=l[1],d=f===void 0?100:f,v=l[2],p=v===void 0?10:v,g=l[3],y=g===void 0?0:g;h=Ze(h,.1,1e3),d=Ze(d,.1,1e3),p=Ze(p,.1,1e3),y=Ze(y,.1,1e3);var m=Math.sqrt(d/h),b=p/(2*Math.sqrt(d*h)),x=b<1?m*Math.sqrt(1-b*b):0,E=1,w=b<1?(b*m+-y)/x:-y+m,S=s?s*n/1e3:n;return b<1?S=Math.exp(-S*b*m)*(E*Math.cos(x*S)+w*Math.sin(x*S)):S=(E+w*S)*Math.exp(-S*m),n===0||n===1?n:1-S},Sd=function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=r,l=(0,W.Z)(s,2),u=l[0],h=u===void 0?10:u,f=l[1],d=f==="start"?Math.ceil:Math.floor;return d(Ze(n,0,1)*h)/h},Wy=function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=(0,W.Z)(r,4),l=s[0],u=s[1],h=s[2],f=s[3];return wd(l,u,h,f)(n)},Eu=wd(.42,0,1,1),_r=function(n){return function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>2?arguments[2]:void 0;return 1-n(1-r,s,l)}},Pr=function(n){return function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>2?arguments[2]:void 0;return r<.5?n(r*2,s,l)/2:1-n(r*-2+2,s,l)/2}},Ar=function(n){return function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>2?arguments[2]:void 0;return r<.5?(1-n(1-r*2,s,l))/2:(n(r*2-1,s,l)+1)/2}},jy={steps:Sd,"step-start":function(n){return Sd(n,[1,"start"])},"step-end":function(n){return Sd(n,[1,"end"])},linear:function(n){return n},"cubic-bezier":Wy,ease:function(n){return Wy(n,[.25,.1,.25,1])},in:Eu,out:_r(Eu),"in-out":Pr(Eu),"out-in":Ar(Eu),"in-quad":hu,"out-quad":_r(hu),"in-out-quad":Pr(hu),"out-in-quad":Ar(hu),"in-cubic":fu,"out-cubic":_r(fu),"in-out-cubic":Pr(fu),"out-in-cubic":Ar(fu),"in-quart":du,"out-quart":_r(du),"in-out-quart":Pr(du),"out-in-quart":Ar(du),"in-quint":vu,"out-quint":_r(vu),"in-out-quint":Pr(vu),"out-in-quint":Ar(vu),"in-expo":pu,"out-expo":_r(pu),"in-out-expo":Pr(pu),"out-in-expo":Ar(pu),"in-sine":gu,"out-sine":_r(gu),"in-out-sine":Pr(gu),"out-in-sine":Ar(gu),"in-circ":yu,"out-circ":_r(yu),"in-out-circ":Pr(yu),"out-in-circ":Ar(yu),"in-back":mu,"out-back":_r(mu),"in-out-back":Pr(mu),"out-in-back":Ar(mu),"in-bounce":bu,"out-bounce":_r(bu),"in-out-bounce":Pr(bu),"out-in-bounce":Ar(bu),"in-elastic":xu,"out-elastic":_r(xu),"in-out-elastic":Pr(xu),"out-in-elastic":Ar(xu),spring:jo,"spring-in":jo,"spring-out":_r(jo),"spring-in-out":Pr(jo),"spring-out-in":Ar(jo)},XO=function(n){return YO(n).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},qO=function(n){return jy[XO(n)]||jy.linear},KO=function(n){return n},QO=1,JO=.5,Vy=0;function Hy(a,n){return function(r){if(r>=1)return 1;var s=1/a;return r+=n*s,r-r%s}}var wu="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",tk=new RegExp("cubic-bezier\\(".concat(wu,",").concat(wu,",").concat(wu,",").concat(wu,"\\)")),ek=/steps\(\s*(\d+)\s*\)/,nk=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function Md(a){var n=tk.exec(a);if(n)return wd.apply(void 0,(0,B.Z)(n.slice(1).map(Number)));var r=ek.exec(a);if(r)return Hy(Number(r[1]),Vy);var s=nk.exec(a);return s?Hy(Number(s[1]),{start:QO,middle:JO,end:Vy}[s[2]]):qO(a)}function rk(a){return Math.abs(ik(a)/(a.playbackRate||1))}function ik(a){var n;return a.duration===0||a.iterations===0?0:(a.duration==="auto"?0:Number(a.duration))*((n=a.iterations)!==null&&n!==void 0?n:1)}var $y=0,Td=1,Su=2,Uy=3;function ak(a,n,r){if(n===null)return $y;var s=r.endTime;return n<Math.min(r.delay,s)?Td:n>=Math.min(r.delay+a+r.endDelay,s)?Su:Uy}function sk(a,n,r,s,l){switch(s){case Td:return n==="backwards"||n==="both"?0:null;case Uy:return r-l;case Su:return n==="forwards"||n==="both"?a:null;case $y:return null}}function ok(a,n,r,s,l){var u=l;return a===0?n!==Td&&(u+=r):u+=s/a,u}function lk(a,n,r,s,l,u){var h=a===1/0?n%1:a%1;return h===0&&r===Su&&s!==0&&(l!==0||u===0)&&(h=1),h}function ck(a,n,r,s){return a===Su&&n===1/0?1/0:r===1?Math.floor(s)-1:Math.floor(s)}function uk(a,n,r){var s=a;if(a!=="normal"&&a!=="reverse"){var l=n;a==="alternate-reverse"&&(l+=1),s="normal",l!==1/0&&l%2!==0&&(s="reverse")}return s==="normal"?r:1-r}function hk(a,n,r){var s=ak(a,n,r),l=sk(a,r.fill,n,s,r.delay);if(l===null)return null;var u=r.duration==="auto"?0:r.duration,h=ok(u,s,r.iterations,l,r.iterationStart),f=lk(h,r.iterationStart,s,r.iterations,l,u),d=ck(s,r.iterations,f,h),v=uk(r.direction,d,f);return r.currentIteration=d,r.progress=v,r.easingFunction(v)}function fk(a,n,r){var s=dk(a,n),l=vk(s,r);return function(u,h){if(h!==null)l.filter(function(d){return h>=d.applyFrom&&h<d.applyTo}).forEach(function(d){var v=h-d.startOffset,p=d.endOffset-d.startOffset,g=p===0?0:v/p;u.setAttribute(d.property,d.interpolation(g),!1,!1)});else for(var f in s)Yy(f)&&u.setAttribute(f,null)}}function Yy(a){return a!=="offset"&&a!=="easing"&&a!=="composite"&&a!=="computedOffset"}function dk(a,n){for(var r={},s=0;s<a.length;s++)for(var l in a[s])if(Yy(l)){var u={offset:a[s].offset,computedOffset:a[s].computedOffset,easing:a[s].easing,easingFunction:Md(a[s].easing)||n.easingFunction,value:a[s][l]};r[l]=r[l]||[],r[l].push(u)}return r}function vk(a,n){var r=[];for(var s in a)for(var l=a[s],u=0;u<l.length-1;u++){var h=u,f=u+1,d=l[h].computedOffset,v=l[f].computedOffset,p=d,g=v;u===0&&(p=-1/0,v===0&&(f=h)),u===l.length-2&&(g=1/0,d===1&&(h=f)),r.push({applyFrom:p,applyTo:g,startOffset:l[h].computedOffset,endOffset:l[f].computedOffset,easingFunction:l[h].easingFunction,property:s,interpolation:pk(s,l[h].value,l[f].value,n)})}return r.sort(function(y,m){return y.startOffset-m.startOffset}),r}var Xy=function(n,r,s){return function(l){var u=qy(n,r,l);return(0,se.Z)(u)?u:s(u)}};function pk(a,n,r,s){var l=oy[a];if(l&&l.syntax&&l.int){var u=st.styleValueRegistry.getPropertySyntax(l.syntax);if(u){var h=u.parser,f=h?h(n,s):n,d=h?h(r,s):r,v=u.mixer(f,d,s);if(v){var p=Xy.apply(void 0,(0,B.Z)(v));return function(g){return g===0?n:g===1?r:p(g)}}}}return Xy(!1,!0,function(g){return g?r:n})}function qy(a,n,r){if(typeof a=="number"&&typeof n=="number")return a*(1-r)+n*r;if(typeof a=="boolean"&&typeof n=="boolean"||typeof a=="string"&&typeof n=="string")return r<.5?a:n;if(Array.isArray(a)&&Array.isArray(n)){for(var s=a.length,l=n.length,u=Math.max(s,l),h=[],f=0;f<u;f++)h.push(qy(a[f<s?f:s-1],n[f<l?f:l-1],r));return h}throw new Error("Mismatched interpolation arguments ".concat(a,":").concat(n))}var gk=function(){function a(){(0,I.Z)(this,a),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=KO,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return(0,D.Z)(a,[{key:"easing",get:function(){return this._easing},set:function(r){this.easingFunction=Md(r),this._easing=r}}])}();function yk(a){var n=[];for(var r in a)if(!(r in["easing","offset","composite"])){var s=a[r];Array.isArray(s)||(s=[s]);for(var l=s.length,u=0;u<l;u++){if(!n[u]){var h={};"offset"in a&&(h.offset=Number(a.offset)),"easing"in a&&(h.easing=a.easing),"composite"in a&&(h.composite=a.composite),n[u]=h}s[u]!==void 0&&s[u]!==null&&(n[u][r]=s[u])}}return n.sort(function(f,d){return(f.computedOffset||0)-(d.computedOffset||0)}),n}function Ky(a,n){if(a===null)return[];Array.isArray(a)||(a=yk(a));for(var r=a.map(function(d){var v={};n!=null&&n.composite&&(v.composite="auto");for(var p in d){var g=d[p];if(p==="offset"){if(g!==null){if(g=Number(g),!isFinite(g))throw new Error("Keyframe offsets must be numbers.");if(g<0||g>1)throw new Error("Keyframe offsets must be between 0 and 1.");v.computedOffset=g}}else if(p==="composite"&&["replace","add","accumulate","auto"].indexOf(g)===-1)throw new Error("".concat(g," compositing is not supported"));v[p]=g}return v.offset===void 0&&(v.offset=null),v.easing===void 0&&(v.easing=(n==null?void 0:n.easing)||"linear"),v.composite===void 0&&(v.composite="auto"),v}),s=!0,l=-1/0,u=0;u<r.length;u++){var h=r[u].offset;if((0,At.Z)(h))s=!1;else{if(h<l)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");l=h}}r=r.filter(function(d){return Number(d.offset)>=0&&Number(d.offset)<=1});function f(){var d,v=r,p=v.length;if(r[p-1].computedOffset=Number((d=r[p-1].offset)!==null&&d!==void 0?d:1),p>1){var g;r[0].computedOffset=Number((g=r[0].offset)!==null&&g!==void 0?g:0)}for(var y=0,m=Number(r[0].computedOffset),b=1;b<p;b++){var x=r[b].computedOffset;if(!(0,At.Z)(x)&&!(0,At.Z)(m)){for(var E=1;E<b-y;E++)r[y+E].computedOffset=m+(Number(x)-m)*E/(b-y);y=b,m=Number(x)}}}return s||f(),r}var mk="backwards|forwards|both|none".split("|"),bk="reverse|alternate|alternate-reverse".split("|");function xk(a,n){var r=new gk;return n&&(r.fill="both",r.duration="auto"),typeof a=="number"&&!isNaN(a)?r.duration=a:a!==void 0&&Object.keys(a).forEach(function(s){if(a[s]!==void 0&&a[s]!==null&&a[s]!=="auto"){if((typeof r[s]=="number"||s==="duration")&&(typeof a[s]!="number"||isNaN(a[s]))||s==="fill"&&mk.indexOf(a[s])===-1||s==="direction"&&bk.indexOf(a[s])===-1)return;r[s]=a[s]}}),r}function Ek(a,n){return a=wk(a!=null?a:{duration:"auto"}),xk(a,n)}function wk(a){return typeof a=="number"&&(isNaN(a)?a={duration:"auto"}:a={duration:a}),a}var Sk=function(){function a(n,r,s){var l=this;(0,I.Z)(this,a),this.composite="replace",this.iterationComposite="replace",this.target=n,this.timing=Ek(s,!1),this.timing.effect=this,this.timing.activeDuration=rk(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Ky(r,this.timing),this.interpolations=fk(this.normalizedKeyframes,this.timing,this.target);var u=st.globalThis.Proxy;this.computedTiming=u?new u(this.timing,{get:function(f,d){return d==="duration"?f.duration==="auto"?0:f.duration:d==="fill"?f.fill==="auto"?"none":f.fill:d==="localTime"?l.animation&&l.animation.currentTime||null:d==="currentIteration"?!l.animation||l.animation.playState!=="running"?null:f.currentIteration||0:d==="progress"?!l.animation||l.animation.playState!=="running"?null:f.progress||0:f[d]},set:function(){return!0}}):this.timing}return(0,D.Z)(a,[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(r){return r===null?!1:(this.timeFraction=hk(this.timing.activeDuration,r,this.timing),this.timeFraction!==null)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(r){this.normalizedKeyframes=Ky(r)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(r){var s=this;Object.keys(r||{}).forEach(function(l){s.timing[l]=r[l]})}}])}();function Qy(a,n){return Number(a.id)-Number(n.id)}var Mk=function(){function a(n){var r=this;(0,I.Z)(this,a),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(s){r.currentTime=s,r.discardAnimations(),r.animations.length===0?r.timelineTicking=!1:r.requestAnimationFrame(r.webAnimationsNextTick)},this.processRafCallbacks=function(s){var l=r.rafCallbacks;r.rafCallbacks=[],s<Number(r.currentTime)&&(s=Number(r.currentTime)),r.animations.sort(Qy),r.animations=r.tick(s,!0,r.animations)[0],l.forEach(function(u){u[1](s)}),r.applyPendingEffects()},this.document=n}return(0,D.Z)(a,[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(r,s,l){var u=new Sk(r,s,l),h=new ZO(u,this);return this.animations.push(h),this.restartWebAnimationsNextTick(),h.updatePromises(),h.play(),h.updatePromises(),h}},{key:"applyDirtiedAnimation",value:function(r){var s=this;if(!this.inTick){r.markTarget();var l=r.targetAnimations();l.sort(Qy);var u=this.tick(Number(this.currentTime),!1,l.slice())[1];u.forEach(function(h){var f=s.animations.indexOf(h);f!==-1&&s.animations.splice(f,1)}),this.applyPendingEffects()}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach(function(r){r==null||r.applyInterpolations()}),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(r){return r.updatePromises()})}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(r){return r.playState!=="finished"&&r.playState!=="idle"})}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(r){var s=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([s,r]),s}},{key:"requestAnimationFrame",value:function(r){var s=this;return this.rAF(function(l){s.updateAnimationsPromises(),r(l),s.updateAnimationsPromises()})}},{key:"tick",value:function(r,s,l){var u=this,h,f;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=r,this.ticking=!1;var d=[],v=[],p=[],g=[];return l.forEach(function(y){y.tick(r,s),y._inEffect?(v.push(y.effect),y.markTarget()):(d.push(y.effect),y.unmarkTarget()),y._needsTick&&(u.ticking=!0);var m=y._inEffect||y._needsTick;y._inTimeline=m,m?p.push(y):g.push(y)}),(h=this.pendingEffects).push.apply(h,d),(f=this.pendingEffects).push.apply(f,v),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[p,g]}}])}();st.EasingFunction=Md,st.AnimationTimeline=Mk;var Jy=function(a){return(0,At.Z)(a)?"":a.toString()},Tk=function(a){var n=Jy(a);return n.charAt(0).toUpperCase()+n.substring(1)},Mu=Tk,tm=Y(6241),Ck=function(a){return a!==null&&typeof a!="function"&&isFinite(a.length)},Vo=Ck,Cd=function(a,n){if(a===n)return!0;if(!a||!n||(0,ve.Z)(a)||(0,ve.Z)(n))return!1;if(Vo(a)||Vo(n)){if(a.length!==n.length)return!1;for(var r=!0,s=0;s<a.length&&(r=Cd(a[s],n[s]),!!r);s++);return r}if((0,tm.Z)(a)||(0,tm.Z)(n)){var l=Object.keys(a),u=Object.keys(n);if(l.length!==u.length)return!1;for(var r=!0,s=0;s<l.length&&(r=Cd(a[l[s]],n[l[s]]),!!r);s++);return r}return!1},Je=Cd;const Ok={duration:500},kk={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"},Yz={CHANGE:"change"};var Le;(function(a){a.NodeAdded="NodeAdded",a.NodeUpdated="NodeUpdated",a.NodeRemoved="NodeRemoved",a.EdgeAdded="EdgeAdded",a.EdgeUpdated="EdgeUpdated",a.EdgeRemoved="EdgeRemoved",a.ComboAdded="ComboAdded",a.ComboUpdated="ComboUpdated",a.ComboRemoved="ComboRemoved"})(Le||(Le={}));var ir;(function(a){a.DRAW="draw",a.COLLAPSE="collapse",a.EXPAND="expand",a.TRANSFORM="transform"})(ir||(ir={}));var yi;(function(a){a.CLICK="canvas:click",a.DBLCLICK="canvas:dblclick",a.POINTER_OVER="canvas:pointerover",a.POINTER_LEAVE="canvas:pointerleave",a.POINTER_ENTER="canvas:pointerenter",a.POINTER_MOVE="canvas:pointermove",a.POINTER_OUT="canvas:pointerout",a.POINTER_DOWN="canvas:pointerdown",a.POINTER_UP="canvas:pointerup",a.CONTEXT_MENU="canvas:contextmenu",a.DRAG_START="canvas:dragstart",a.DRAG="canvas:drag",a.DRAG_END="canvas:dragend",a.DRAG_ENTER="canvas:dragenter",a.DRAG_OVER="canvas:dragover",a.DRAG_LEAVE="canvas:dragleave",a.DROP="canvas:drop",a.WHEEL="canvas:wheel"})(yi||(yi={}));var oa;(function(a){a.CLICK="combo:click",a.DBLCLICK="combo:dblclick",a.POINTER_OVER="combo:pointerover",a.POINTER_LEAVE="combo:pointerleave",a.POINTER_ENTER="combo:pointerenter",a.POINTER_MOVE="combo:pointermove",a.POINTER_OUT="combo:pointerout",a.POINTER_DOWN="combo:pointerdown",a.POINTER_UP="combo:pointerup",a.CONTEXT_MENU="combo:contextmenu",a.DRAG_START="combo:dragstart",a.DRAG="combo:drag",a.DRAG_END="combo:dragend",a.DRAG_ENTER="combo:dragenter",a.DRAG_OVER="combo:dragover",a.DRAG_LEAVE="combo:dragleave",a.DROP="combo:drop"})(oa||(oa={}));var tt;(function(a){a.CLICK="click",a.DBLCLICK="dblclick",a.POINTER_OVER="pointerover",a.POINTER_LEAVE="pointerleave",a.POINTER_ENTER="pointerenter",a.POINTER_MOVE="pointermove",a.POINTER_OUT="pointerout",a.POINTER_DOWN="pointerdown",a.POINTER_UP="pointerup",a.CONTEXT_MENU="contextmenu",a.DRAG_START="dragstart",a.DRAG="drag",a.DRAG_END="dragend",a.DRAG_ENTER="dragenter",a.DRAG_OVER="dragover",a.DRAG_LEAVE="dragleave",a.DROP="drop",a.KEY_DOWN="keydown",a.KEY_UP="keyup",a.WHEEL="wheel",a.PINCH="pinch"})(tt||(tt={}));var qa;(function(a){a.KEY_DOWN="keydown",a.KEY_UP="keyup"})(qa||(qa={}));var Ho;(function(a){a.CLICK="edge:click",a.DBLCLICK="edge:dblclick",a.POINTER_OVER="edge:pointerover",a.POINTER_LEAVE="edge:pointerleave",a.POINTER_ENTER="edge:pointerenter",a.POINTER_MOVE="edge:pointermove",a.POINTER_OUT="edge:pointerout",a.POINTER_DOWN="edge:pointerdown",a.POINTER_UP="edge:pointerup",a.CONTEXT_MENU="edge:contextmenu",a.DRAG_ENTER="edge:dragenter",a.DRAG_OVER="edge:dragover",a.DRAG_LEAVE="edge:dragleave",a.DROP="edge:drop"})(Ho||(Ho={}));var lt;(function(a){a.BEFORE_CANVAS_INIT="beforecanvasinit",a.AFTER_CANVAS_INIT="aftercanvasinit",a.BEFORE_SIZE_CHANGE="beforesizechange",a.AFTER_SIZE_CHANGE="aftersizechange",a.BEFORE_ELEMENT_CREATE="beforeelementcreate",a.AFTER_ELEMENT_CREATE="afterelementcreate",a.BEFORE_ELEMENT_UPDATE="beforeelementupdate",a.AFTER_ELEMENT_UPDATE="afterelementupdate",a.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",a.AFTER_ELEMENT_DESTROY="afterelementdestroy",a.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",a.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",a.BEFORE_DRAW="beforedraw",a.AFTER_DRAW="afterdraw",a.BEFORE_RENDER="beforerender",a.AFTER_RENDER="afterrender",a.BEFORE_ANIMATE="beforeanimate",a.AFTER_ANIMATE="afteranimate",a.BEFORE_LAYOUT="beforelayout",a.AFTER_LAYOUT="afterlayout",a.BEFORE_STAGE_LAYOUT="beforestagelayout",a.AFTER_STAGE_LAYOUT="afterstagelayout",a.BEFORE_TRANSFORM="beforetransform",a.AFTER_TRANSFORM="aftertransform",a.BATCH_START="batchstart",a.BATCH_END="batchend",a.BEFORE_DESTROY="beforedestroy",a.AFTER_DESTROY="afterdestroy",a.BEFORE_RENDERER_CHANGE="beforerendererchange",a.AFTER_RENDERER_CHANGE="afterrendererchange"})(lt||(lt={}));var Di;(function(a){a.UNDO="undo",a.REDO="redo",a.CANCEL="cancel",a.ADD="add",a.CLEAR="clear",a.CHANGE="change"})(Di||(Di={}));var pr;(function(a){a.CLICK="node:click",a.DBLCLICK="node:dblclick",a.POINTER_OVER="node:pointerover",a.POINTER_LEAVE="node:pointerleave",a.POINTER_ENTER="node:pointerenter",a.POINTER_MOVE="node:pointermove",a.POINTER_OUT="node:pointerout",a.POINTER_DOWN="node:pointerdown",a.POINTER_UP="node:pointerup",a.CONTEXT_MENU="node:contextmenu",a.DRAG_START="node:dragstart",a.DRAG="node:drag",a.DRAG_END="node:dragend",a.DRAG_ENTER="node:dragenter",a.DRAG_OVER="node:dragover",a.DRAG_LEAVE="node:dragleave",a.DROP="node:drop"})(pr||(pr={}));const Oe="combo",gr="tree";var Fs;(function(a){a.NODE="node",a.EDGE="edge",a.COMBO="combo",a.THEME="theme",a.PALETTE="palette",a.LAYOUT="layout",a.BEHAVIOR="behavior",a.PLUGIN="plugin",a.ANIMATION="animation",a.TRANSFORM="transform",a.SHAPE="shape"})(Fs||(Fs={}));const Tu={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function mi(a,n){var r;const s=(r=Tu[a])===null||r===void 0?void 0:r[n];if(s)return s}function _k(a){return Tu[a]}const em="5.0.50",Pk="G6";function Ii(a){return`[${Pk} v${em}] ${a}`}const ar={mute:!1,debug:a=>{!ar.mute&&console.debug(Ii(a))},info:a=>{!ar.mute&&console.info(Ii(a))},warn:a=>{!ar.mute&&console.warn(Ii(a))},error:a=>{!ar.mute&&console.error(Ii(a))}};function nm(a){const{theme:n}=a;if(!n)return{};const r=mi(Fs.THEME,n);return r||(ar.warn(`The theme of ${n} is not registered.`),{})}function Od(a,n){if(Array.isArray(a)&&a.length===0)return null;const r=Array.isArray(a)?a[0]:a,s=Array.isArray(a)?a.slice(1):n||[];return new Proxy(r,{get(l,u){return typeof l[u]=="function"&&!["onframe","onfinish"].includes(u)?(...h)=>{l[u](...h),s.forEach(f=>{var d;return(d=f[u])===null||d===void 0?void 0:d.call(f,...h)})}:u==="finished"?Promise.all([r.finished,...s.map(h=>h.finished)]):Reflect.get(l,u)},set(l,u,h){return["onframe","onfinish"].includes(u)||s.forEach(f=>{f[u]=h}),Reflect.set(l,u,h)}})}function kd(a){const n=a.reduce((s,l)=>(Object.entries(l).forEach(([u,h])=>{s[u]===void 0?s[u]=[h]:s[u].push(h)}),s),{});Object.entries(n).forEach(([s,l])=>{(l.length!==a.length||l.some(u=>(0,At.Z)(u))||l.every(u=>!["sourceNode","targetNode","childrenNode"].includes(s)&&Je(u,l[0])))&&delete n[s]});const r=Object.entries(n).reduce((s,[l,u])=>(u.forEach((h,f)=>{s[f]?s[f][l]=h:s[f]={[l]:h}}),s),[]);return a.length!==0&&r.length===0&&r.push({_:0},{_:0}),r}function $o(a){switch(a){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function rm(a,n){const{animation:r}=a;if(r===!1||n===!1)return!1;const s=Object.assign({},Ok);return(0,Zn.Z)(r)&&Object.assign(s,r),(0,Zn.Z)(n)&&Object.assign(s,n),s}function Ak(a){if(typeof a=="string"){const n=mi(Fs.ANIMATION,a);return n||(ar.warn(`The animation of ${a} is not registered.`),[])}return a}function Nk(a,n,r,s){var l,u;const{animation:h}=a;if(h===!1||s===!1)return[];const f=(l=a==null?void 0:a[n])===null||l===void 0?void 0:l.animation;if(f===!1)return[];const d=f==null?void 0:f[r];if(d===!1)return[];const v=(u=nm(a)[n])===null||u===void 0?void 0:u.animation,p=(y=[])=>Ak(y).map(m=>Object.assign(Object.assign(Object.assign(Object.assign({},kk),(0,Zn.Z)(h)&&h),m),(0,Zn.Z)(s)&&s));if(d)return p(d);if(!v)return[];const g=v[r];return g===!1?[]:p(g)}function im(a,n,r,s=[]){if(!s&&a===0&&n===0&&r===0)return null;if(Array.isArray(s)){let u=-1;const h=[];for(let f=0;f<s.length;f++){const d=s[f];if(d[0]==="translate"){if(d[1]===a&&d[2]===n)return null;u=f,h.push(["translate",a,n])}else if(d[0]==="translate3d"){if(d[1]===a&&d[2]===n&&d[3]===r)return null;u=f,h.push(["translate3d",a,n,r!=null?r:0])}else h.push(d)}return u===-1&&h.splice(0,0,(0,se.Z)(r)?["translate3d",a,n,r!=null?r:0]:["translate",a,n]),h.length===0?null:h}const l=s?s.replace(/translate(3d)?\([^)]*\)/g,""):"";return r===0?`translate(${a}, ${n})${l}`:`translate3d(${a}, ${n}, ${r})${l}`}var Rk=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};const Lk=(a,n,r)=>{if(!r.length)return null;const[s,l]=n,u=v=>{var p;if(v){const g=a.getShape(v);if(!g)return null;const y=`get${Mu(v)}Style`,m=((p=a==null?void 0:a[y])===null||p===void 0?void 0:p.bind(a))||(E=>E),b=(m==null?void 0:m(s))||{},x=(m==null?void 0:m(l))||{};return{shape:g,fromStyle:b,toStyle:x}}else return{shape:a,fromStyle:s,toStyle:l}};let h;const f=r.map(v=>{var{fields:p,shape:g,states:y}=v,m=Rk(v,["fields","shape","states"]);const b=u(g);if(!b)return null;const{shape:x,fromStyle:E,toStyle:w}=b,S=[{},{}];if(p.forEach(C=>{var T,O;Object.assign(S[0],{[C]:(T=E[C])!==null&&T!==void 0?T:$o(C)}),Object.assign(S[1],{[C]:(O=w[C])!==null&&O!==void 0?O:$o(C)})}),S.some(C=>Object.keys(C).some(T=>["x","y","z"].includes(T)))){const{x:C=0,y:T=0,z:O,transform:k=""}=x.attributes||{};S.forEach(P=>{var A,N,L;P.transform=im((A=P.x)!==null&&A!==void 0?A:C,(N=P.y)!==null&&N!==void 0?N:T,(L=P.z)!==null&&L!==void 0?L:O,k)})}const M=x.animate(kd(S),m);return g===void 0&&(h=M),M}).filter(Boolean),d=h||(f==null?void 0:f[0]);return d?Od(d,f.filter(v=>v!==v)):null},Dk=[{fields:["opacity"]}],Ik=[{fields:["x","y"]}],am=[{fields:["x","y"]}],Bk=am,sm=[{fields:["sourceNode","targetNode"]}],Fk=sm,om=[{fields:["childrenNode","x","y"]}],zk=om,Xz=[{fields:["childrenNode","x","y"]}];var Zk=Object.prototype.hasOwnProperty;function Gk(a,n){if(!n||!(0,Gr.Z)(a))return{};for(var r={},s=(0,_t.Z)(n)?n:function(f){return f[n]},l,u=0;u<a.length;u++){var h=a[u];l=s(h),Zk.call(r,l)?r[l].push(h):r[l]=[h]}return r}var Cu=Gk,lm=function(a,n,r){var s,l,u,h,f=0;r||(r={});var d=function(){f=r.leading===!1?0:Date.now(),s=null,h=a.apply(l,u),s||(l=u=null)},v=function(){var p=Date.now();!f&&r.leading===!1&&(f=p);var g=n-(p-f);return l=this,u=arguments,g<=0||g>n?(s&&(clearTimeout(s),s=null),f=p,h=a.apply(l,u),s||(l=u=null)):!s&&r.trailing!==!1&&(s=setTimeout(d,g)),h};return v.cancel=function(){clearTimeout(s),f=0,s=l=u=null},v},Ou=Y(83207);function Wk(a){return"source"in a&&"target"in a}function jk(a){return a.length===2}function qz(a){return a.length===3}function zs(a){return a instanceof Float32Array?!0:Array.isArray(a)&&(a.length===2||a.length===3)?a.every(n=>typeof n=="number"):!1}function bi(a,n,r){return a>=n&&a<=r}function yr(a=0){if(Array.isArray(a)){const[n=0,r=n,s=n,l=r]=a;return[n,r,s,l]}return[a,a,a,a]}function Vk(a=0){const n=yr(a);return n[0]+n[2]}function Kz(a=0){const n=yr(a);return n[1]+n[3]}function xi(a){return a.max[0]-a.min[0]}function Ei(a){return a.max[1]-a.min[1]}function la(a){return[xi(a),Ei(a)]}function ca(a,n){const r=zs(a)?_d(a):a.getShape("key").getBounds();return n?ua(r,n):r}function _d(a){const[n,r,s=0]=a,l=new ke;return l.setMinMax([n,r,s],[n,r,s]),l}function ua(a,n){const[r,s,l,u]=yr(n),[h,f,d]=a.min,[v,p,g]=a.max,y=new ke;return y.setMinMax([h-u,f-r,d],[v+s,p+l,g]),y}function Uo(a){if(a.length===0)return new ke;if(a.length===1)return a[0];const n=new ke;n.setMinMax(a[0].min,a[0].max);for(let r=1;r<a.length;r++){const s=a[r];n.setMinMax([Math.min(n.min[0],s.min[0]),Math.min(n.min[1],s.min[1]),Math.min(n.min[2],s.min[2])],[Math.max(n.max[0],s.max[0]),Math.max(n.max[1],s.max[1]),Math.max(n.max[2],s.max[2])])}return n}function Hk(a,n){const[r,s]=a.min,[l,u]=a.max,[h,f]=n.min,[d,v]=n.max;return r>=h&&l<=d&&s>=f&&u<=v}function $r(a,n){return bi(a[0],n.min[0],n.max[0])&&bi(a[1],n.min[1],n.max[1])}function cm(a,n,r=!1){const{min:[s,l],max:[u,h]}=n,f=(a[1]===l||a[1]===h)&&(r||bi(a[0],s,u)),d=(a[0]===s||a[0]===u)&&(r||bi(a[1],l,h));return f||d}function $k(a,n){return!$r(a,n)}function ku(a,n){const{center:r}=n;return a[0]===r[0]&&a[1]===r[1]}function Yo(a,n){const[r,s]=a,[l,u]=n.min,[h,f]=n.max,d=r-l,v=h-r,p=s-u,g=f-s,y=Math.min(d,v,p,g);return y===d?"left":y===v?"right":y===p?"top":y===g?"bottom":"left"}function Ka(a,n){const r=(0,Ou.Z)(a);if($r(a,n))switch(Yo(a,n)){case"left":r[0]=n.min[0];break;case"right":r[0]=n.max[0];break;case"top":r[1]=n.min[1];break;case"bottom":r[1]=n.max[1];break}else{const[s,l]=a,[u,h]=n.min,[f,d]=n.max;r[0]=bi(s,u,f)?s:s<u?u:f,r[1]=bi(l,h,d)?l:l<h?h:d}return r}function Uk(a,n){const{center:r}=a,[s,l]=la(a),u=n==="up"||n==="down"?r[0]:n==="right"?r[0]-s/6:r[0]+s/6,h=n==="left"||n==="right"?r[1]:n==="down"?r[1]-l/6:r[1]+l/6;return[u,h]}function Yk(a,n){let[r,s]=la(a);return[r,s]=n==="up"||n==="down"?[r,s]:[s,r],(Math.pow(s,2)-Math.pow(Math.sqrt(Math.pow(r/2,2)+Math.pow(s,2))-r/2,2))/(2*s)}function Xk(a){const{min:[n,r],max:[s,l]}=a,u=[n,l],h=[s,l],f=[s,r],d=[n,r];return[[u,h],[h,f],[f,d],[d,u]]}var qk=function(n,r){var s=n.nodes,l=n.edges,u=[],h={};if(!s)throw new Error("invalid nodes data!");return s&&s.forEach(function(f,d){h[f.id]=d;var v=[];u.push(v)}),l&&l.forEach(function(f){var d=f.source,v=f.target,p=h[d],g=h[v];!p&&p!==0||!g&&g!==0||(u[p][g]=1,r||(u[g][p]=1))}),u},_u=qk,Kk=function(n,r){return n===r},um=function(){function a(n,r){r===void 0&&(r=null),this.value=n,this.next=r}return a.prototype.toString=function(n){return n?n(this.value):"".concat(this.value)},a}(),Qk=function(){function a(n){n===void 0&&(n=Kk),this.head=null,this.tail=null,this.compare=n}return a.prototype.prepend=function(n){var r=new um(n,this.head);return this.head=r,this.tail||(this.tail=r),this},a.prototype.append=function(n){var r=new um(n);return this.head?(this.tail.next=r,this.tail=r,this):(this.head=r,this.tail=r,this)},a.prototype.delete=function(n){if(!this.head)return null;for(var r=null;this.head&&this.compare(this.head.value,n);)r=this.head,this.head=this.head.next;var s=this.head;if(s!==null)for(;s.next;)this.compare(s.next.value,n)?(r=s.next,s.next=s.next.next):s=s.next;return this.compare(this.tail.value,n)&&(this.tail=s),r},a.prototype.find=function(n){var r=n.value,s=r===void 0?void 0:r,l=n.callback,u=l===void 0?void 0:l;if(!this.head)return null;for(var h=this.head;h;){if(u&&u(h.value)||s!==void 0&&this.compare(h.value,s))return h;h=h.next}return null},a.prototype.deleteTail=function(){var n=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,n;for(var r=this.head;r.next;)r.next.next?r=r.next:r.next=null;return this.tail=r,n},a.prototype.deleteHead=function(){if(!this.head)return null;var n=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),n},a.prototype.fromArray=function(n){var r=this;return n.forEach(function(s){return r.append(s)}),this},a.prototype.toArray=function(){for(var n=[],r=this.head;r;)n.push(r),r=r.next;return n},a.prototype.reverse=function(){for(var n=this.head,r=null,s=null;n;)s=n.next,n.next=r,r=n,n=s;this.tail=this.head,this.head=r},a.prototype.toString=function(n){return n===void 0&&(n=void 0),this.toArray().map(function(r){return r.toString(n)}).toString()},a}(),hm=Qk,Jk=function(){function a(){this.linkedList=new hm}return a.prototype.isEmpty=function(){return!this.linkedList.head},a.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},a.prototype.enqueue=function(n){this.linkedList.append(n)},a.prototype.dequeue=function(){var n=this.linkedList.deleteHead();return n?n.value:null},a.prototype.toString=function(n){return this.linkedList.toString(n)},a}(),t_=Jk,Nr=function(n,r,s){r===void 0&&(r=[]);var l=r.filter(function(d){return d.source===n||d.target===n});if(s==="target"){var u=function(v){return v.source===n};return l.filter(u).map(function(d){return d.target})}if(s==="source"){var h=function(v){return v.target===n};return l.filter(h).map(function(d){return d.source})}var f=function(v){return v.source===n?v.target:v.source};return l.map(f)},e_=function(n,r){return r.filter(function(s){return s.source===n})},Pu=function(n,r){return r.filter(function(s){return s.source===n||s.target===n})},fm=function(n){n===void 0&&(n=0);var r="".concat(Math.random()).split(".")[1].substr(0,5),s="".concat(Math.random()).split(".")[1].substr(0,5);return"".concat(n,"-").concat(r).concat(s)};function n_(a){a===void 0&&(a={});var n=a,r=function(){},s=function(){var l={};return function(u){var h=u.next,f=h;return l[f]?!1:(l[f]=!0,!0)}}();return n.allowTraversal=a.allowTraversal||s,n.enter=a.enter||r,n.leave=a.leave||r,n}var r_=function(n,r,s,l){l===void 0&&(l=!0);var u=n_(s),h=new t_,f=n.edges,d=f===void 0?[]:f;h.enqueue(r);for(var v="",p=function(){var y=h.dequeue();u.enter({current:y,previous:v}),Nr(y,d,l?"target":void 0).forEach(function(m){u.allowTraversal({previous:v,current:y,next:m})&&h.enqueue(m)}),u.leave({current:y,previous:v}),v=y};!h.isEmpty();)p()},i_=r_,a_=function(n){for(var r=n.nodes,s=r===void 0?[]:r,l=n.edges,u=l===void 0?[]:l,h=[],f={},d=[],v=function m(b){d.push(b),f[b.id]=!0;for(var x=Nr(b.id,u),E=function(M){var C=x[M];if(!f[C]){var T=s.filter(function(O){return O.id===C});T.length>0&&m(T[0])}},w=0;w<x.length;++w)E(w)},p=0;p<s.length;p++){var g=s[p];if(!f[g.id]){v(g);for(var y=[];d.length>0;)y.push(d.pop());h.push(y)}}return h},dm=function(n){for(var r=n.nodes,s=r===void 0?[]:r,l=n.edges,u=l===void 0?[]:l,h=[],f={},d={},v={},p=[],g=0,y=function E(w){d[w.id]=g,v[w.id]=g,g+=1,h.push(w),f[w.id]=!0;for(var S=Nr(w.id,u,"target").filter(function(k){return s.map(function(P){return P.id}).indexOf(k)>-1}),M=function(P){var A=S[P];if(!d[A]&&d[A]!==0){var N=s.filter(function(L){return L.id===A});N.length>0&&E(N[0]),v[w.id]=Math.min(v[w.id],v[A])}else f[A]&&(v[w.id]=Math.min(v[w.id],d[A]))},C=0;C<S.length;C++)M(C);if(v[w.id]===d[w.id]){for(var T=[];h.length>0;){var O=h.pop();if(f[O.id]=!1,T.push(O),O===w)break}T.length>0&&p.push(T)}},m=0,b=s;m<b.length;m++){var x=b[m];!d[x.id]&&d[x.id]!==0&&y(x)}return p};function vm(a,n){return n?dm(a):a_(a)}var Xo=function(n){var r={},s=n.nodes,l=s===void 0?[]:s,u=n.edges,h=u===void 0?[]:u;return l.forEach(function(f){r[f.id]={degree:0,inDegree:0,outDegree:0}}),h.forEach(function(f){r[f.source].degree++,r[f.source].outDegree++,r[f.target].degree++,r[f.target].inDegree++}),r},Pd=Xo,s_=function(n,r){var s=Xo(n);return s[r]?Xo(n)[r].inDegree:0},o_=function(n,r){var s=Xo(n);return s[r]?Xo(n)[r].outDegree:0};function l_(a){a===void 0&&(a={});var n=a,r=function(){},s=function(){var l={};return function(u){var h=u.next;return l[h]?!1:(l[h]=!0,!0)}}();return n.allowTraversal=a.allowTraversal||s,n.enter=a.enter||r,n.leave=a.leave||r,n}function pm(a,n,r,s,l){l===void 0&&(l=!0),s.enter({current:n,previous:r});var u=a.edges,h=u===void 0?[]:u;Nr(n,h,l?"target":void 0).forEach(function(f){s.allowTraversal({previous:r,current:n,next:f})&&pm(a,f,n,s,l)}),s.leave({current:n,previous:r})}function gm(a,n,r,s){s===void 0&&(s=!0),pm(a,n,"",l_(r),s)}var c_=function(n){var r=null,s=n.nodes,l=s===void 0?[]:s,u={},h={},f={},d={};l.forEach(function(g){h[g.id]=g});for(var v={enter:function(y){var m=y.current,b=y.previous;if(f[m]){r={};for(var x=m,E=b;E!==m;)r[x]=E,x=E,E=u[E];r[x]=E}else f[m]=m,delete h[m],u[m]=b},leave:function(y){var m=y.current;d[m]=m,delete f[m]},allowTraversal:function(y){var m=y.next;return r?!1:!d[m]}};Object.keys(h).length;){var p=Object.keys(h)[0];gm(n,p,v)}return r},ym=function(n,r,s){var l,u;s===void 0&&(s=!0);for(var h=[],f=vm(n,!1),d=0,v=f;d<v.length;d++){var p=v[d];if(p.length)for(var g=p[0],y=g.id,m=[g],b=(l={},l[y]=g,l),x=(u={},u[y]=new Set,u);m.length>0;)for(var E=m.pop(),w=E.id,S=Nr(w,n.edges),M=function(O){var k,P=S[O],A=n.nodes.find(function(X){return X.id===P});if(P===w)h.push((k={},k[P]=E,k));else if(!(P in x))b[P]=E,m.push(A),x[P]=new Set([E]);else if(!x[w].has(A)){for(var N=!0,L=[A,E],R=b[w];x[P].size&&!x[P].has(R)&&(L.push(R),R!==b[R.id]);)R=b[R.id];if(L.push(R),r&&s?(N=!1,L.findIndex(function(X){return r.indexOf(X.id)>-1})>-1&&(N=!0)):r&&!s&&L.findIndex(function(X){return r.indexOf(X.id)>-1})>-1&&(N=!1),N){for(var z={},Z=1;Z<L.length;Z+=1)z[L[Z-1].id]=L[Z];L.length&&(z[L[L.length-1].id]=L[0]),h.push(z)}x[P].add(E)}},C=0;C<S.length;C+=1)M(C)}return h},mm=function(n,r,s){s===void 0&&(s=!0);for(var l=[],u=new Set,h=[],f=[],d={},v={},p=function(R){for(var z=[R];z.length>0;){var Z=z.pop();u.has(Z)&&(u.delete(Z),h[Z.id].forEach(function(X){z.push(X)}),h[Z.id].clear())}},g=function L(R,z,Z){var X=!1;if(r&&s===!1&&r.indexOf(R.id)>-1)return X;l.push(R),u.add(R);for(var nt=Z[R.id],K=0;K<nt.length;K+=1){var rt=d[nt[K]];if(rt===z){for(var U={},at=1;at<l.length;at+=1)U[l[at-1].id]=l[at];l.length&&(U[l[l.length-1].id]=l[0]),f.push(U),X=!0}else u.has(rt)||L(rt,z,Z)&&(X=!0)}if(X)p(R);else for(var K=0;K<nt.length;K+=1){var rt=d[nt[K]];h[rt.id].has(R)||h[rt.id].add(R)}return l.pop(),X},y=n.nodes,m=y===void 0?[]:y,b=0;b<m.length;b+=1){var x=m[b],E=x.id;v[E]=b,d[b]=x}if(r&&s)for(var w=function(R){var z=r[R];v[m[R].id]=v[z],v[z]=0,d[0]=m.find(function(Z){return Z.id===z}),d[v[m[R].id]]=m[R]},b=0;b<r.length;b++)w(b);for(var S=function(R){for(var z,Z,X=1/0,nt=0;nt<R.length;nt+=1)for(var K=R[nt],rt=0;rt<K.length;rt++){var U=v[K[rt].id];U<X&&(X=U,Z=nt)}for(var at=R[Z],ht=[],nt=0;nt<at.length;nt+=1){var pt=at[nt];ht[pt.id]=[];for(var Ct=0,Zt=Nr(pt.id,n.edges,"target").filter(function(ie){return at.map(function(Kt){return Kt.id}).indexOf(ie)>-1});Ct<Zt.length;Ct++){var Nt=Zt[Ct];Nt===pt.id&&!(s===!1&&r.indexOf(pt.id)>-1)?f.push((z={},z[pt.id]=pt,z)):ht[pt.id].push(v[Nt])}}return{component:at,adjList:ht,minIdx:X}},M=0;M<m.length;){var C=m.filter(function(L){return v[L.id]>=M}),T=dm({nodes:C,edges:n.edges}).filter(function(L){return L.length>1});if(T.length===0)break;var O=S(T),k=O.minIdx,P=O.adjList,A=O.component;if(A.length>1){A.forEach(function(L){h[L.id]=new Set});var N=d[k];if(r&&s&&r.indexOf(N.id)===-1)return f;g(N,N,P),M=k+1}else break}return f},u_=function(n,r,s,l){return l===void 0&&(l=!0),r?mm(n,s,l):ym(n,s,l)},bm=c_,h_={}.toString,f_=function(a,n){return h_.call(a)==="[object "+n+"]"},Au=f_,Ad=function(a){return Au(a,"Function")},Nd=function(a){return Array.isArray?Array.isArray(a):Au(a,"Array")},d_=function(a){var n=typeof a;return a!==null&&n==="object"||n==="function"};function v_(a,n){if(a){var r;if(Nd(a))for(var s=0,l=a.length;s<l&&(r=n(a[s],s),r!==!1);s++);else if(d_(a)){for(var u in a)if(a.hasOwnProperty(u)&&(r=n(a[u],u),r===!1))break}}}var xm=v_,Qz=Object.keys?function(a){return Object.keys(a)}:function(a){var n=[];return xm(a,function(r,s){Ad(a)&&s==="prototype"||n.push(s)}),n},Jz=null;function tZ(a,n){var r=keys(n),s=r.length;if(isNil(a))return!s;for(var l=0;l<s;l+=1){var u=r[l];if(n[u]!==a[u]||!(u in a))return!1}return!0}var eZ=null,nZ=function(a){if(!isObjectLike(a)||!isType(a,"Object"))return!1;if(Object.getPrototypeOf(a)===null)return!0;for(var n=a;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(a)===n},rZ=null;function iZ(a,n){if(!isArray(a))return null;var r;if(isFunction(n)&&(r=n),isPlainObject(n)&&(r=function(l){return isMatch(l,n)}),r){for(var s=0;s<a.length;s+=1)if(r(a[s]))return a[s]}return null}var aZ=null,sZ=function(a,n){for(var r=null,s=0;s<a.length;s++){var l=a[s],u=l[n];if(!isNil(u)){isArray(u)?r=u[0]:r=u;break}}return r},oZ=null,lZ=function(a){if(!isArray(a))return[];for(var n=[],r=0;r<a.length;r++)n=n.concat(a[r]);return n},cZ=null,p_=function(a,n){if(n===void 0&&(n=[]),!isArray(a))n.push(a);else for(var r=0;r<a.length;r+=1)p_(a[r],n);return n},uZ=null,hZ=function(a){if(isArray(a))return a.reduce(function(n,r){return Math.max(n,r)},a[0])},fZ=function(a){if(isArray(a))return a.reduce(function(n,r){return Math.min(n,r)},a[0])},dZ=function(a){var n=a.filter(function(h){return!isNaN(h)});if(!n.length)return{min:0,max:0};if(isArray(a[0])){for(var r=[],s=0;s<a.length;s++)r=r.concat(a[s]);n=r}var l=getMax(n),u=getMin(n);return{min:u,max:l}},vZ=null,Em=Array.prototype,g_=Em.splice,y_=Em.indexOf,pZ=function(a){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];for(var s=0;s<n.length;s++)for(var l=n[s],u=-1;(u=y_.call(a,l))>-1;)g_.call(a,u,1);return a},gZ=null,m_=Array.prototype.splice,yZ=function(n,r){if(!isArrayLike(n))return[];for(var s=n?r.length:0,l=s-1;s--;){var u=void 0,h=r[s];(s===l||h!==u)&&(u=h,m_.call(n,h,1))}return n},mZ=null,bZ=function(a,n,r){if(!isArray(a)&&!isPlainObject(a))return a;var s=r;return each(a,function(l,u){s=n(s,l,u)}),s},xZ=null,EZ=function(a,n){var r=[];if(!isArrayLike(a))return r;for(var s=-1,l=[],u=a.length;++s<u;){var h=a[s];n(h,s,a)&&(r.push(h),l.push(s))}return pullAt(a,l),r},wZ=null,Rd=function(a){return Au(a,"String")};function SZ(a,n){var r;if(isFunction(n))r=function(l,u){return n(l)-n(u)};else{var s=[];isString(n)?s.push(n):isArray(n)&&(s=n),r=function(l,u){for(var h=0;h<s.length;h+=1){var f=s[h];if(l[f]>u[f])return 1;if(l[f]<u[f])return-1}return 0}}return a.sort(r),a}var MZ=null;function Ld(a,n){n===void 0&&(n=new Map);var r=[];if(Array.isArray(a))for(var s=0,l=a.length;s<l;s++){var u=a[s];n.has(u)||(r.push(u),n.set(u,!0))}return r}var TZ=function(a,n){for(var r=[],s={},l=0;l<a.length;l++){var u=a[l],h=u[n];if(!isNil(h)){isArray(h)||(h=[h]);for(var f=0;f<h.length;f++){var d=h[f];s[d]||(r.push(d),s[d]=!0)}}}return r};function CZ(a,n){return isArray(a)||isString(a)?a[0]===n:!1}var OZ=null;function kZ(a,n){return isArray(a)||isString(a)?a[a.length-1]===n:!1}var _Z=null,b_=Object.prototype.hasOwnProperty;function PZ(a,n){if(!n||!isArray(a))return{};for(var r={},s=isFunction(n)?n:function(f){return f[n]},l,u=0;u<a.length;u++){var h=a[u];l=s(h),b_.call(r,l)?r[l].push(h):r[l]=[h]}return r}var AZ=null;function NZ(a,n){if(!n)return{0:a};if(!isFunction(n)){var r=isArray(n)?n:n.replace(/\s+/g,"").split("*");n=function(s){for(var l="_",u=0,h=r.length;u<h;u++)l+=s[r[u]]&&s[r[u]].toString();return l}}return groupBy(a,n)}var RZ=function(a,n){if(!n)return[a];var r=groupToMap(a,n),s=[];for(var l in r)s.push(r[l]);return s},wm={};function LZ(a){var n=wm[a];if(!n){for(var r=a.toString(16),s=r.length;s<6;s++)r="0"+r;n="#"+r,wm[a]=n}return n}var DZ=null;function IZ(a){var n=0,r=0,s=0,l=0;return isArray(a)?a.length===1?n=r=s=l=a[0]:a.length===2?(n=s=a[0],r=l=a[1]):a.length===3?(n=a[0],r=l=a[1],s=a[2]):(n=a[0],r=a[1],s=a[2],l=a[3]):n=r=s=l=a,{r1:n,r2:r,r3:s,r4:l}}var BZ=null,x_=function(a){return Au(a,"Number")},E_=x_,FZ=function(a){return isNumber(a)&&a%1!==0},zZ=null,ZZ=function(a){return isNumber(a)&&a%2===0},GZ=null,WZ=Number.isInteger?Number.isInteger:function(a){return E_(a)&&a%1===0},jZ=null,VZ=function(a){return isNumber(a)&&a<0},HZ=null,$Z=function(a){return isNumber(a)&&a%2!==0},UZ=null,YZ=function(a){return isNumber(a)&&a>0},XZ=null,qZ=function(a,n){if(isArray(a)){for(var r,s=-1/0,l=0;l<a.length;l++){var u=a[l],h=isFunction(n)?n(u):u[n];h>s&&(r=u,s=h)}return r}},KZ=function(a,n){if(isArray(a)){for(var r,s=1/0,l=0;l<a.length;l++){var u=a[l],h=isFunction(n)?n(u):u[n];h<s&&(r=u,s=h)}return r}},w_=180/Math.PI,QZ=function(a){return w_*a},JZ=null,S_=Math.PI/180,t7=function(a){return S_*a},e7=null,n7=null,M_=Object.values?function(a){return Object.values(a)}:function(a){var n=[];return xm(a,function(r,s){Ad(a)&&s==="prototype"||n.push(r)}),n},T_=M_,r7=function(a,n){return contains(values(a),n)},C_={}.toString,i7=function(a){return C_.call(a).replace(/^\[object /,"").replace(/]$/,"")},a7=null,s7=function(a){return isType(a,"Arguments")},o7=null,l7=function(a){return isType(a,"Boolean")},c7=null,u7=function(a){return isType(a,"Date")},h7=null,f7=function(a){return isType(a,"Error")},d7=null;function v7(a){return isNumber(a)&&isFinite(a)}var O_=Object.prototype,p7=function(a){var n=a&&a.constructor,r=typeof n=="function"&&n.prototype||O_;return a===r},g7=null,y7=function(a){return isType(a,"RegExp")},m7=null,b7=function(){for(var a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];for(var r=a[0],s=1;s<a.length;s++){var l=a[s];isFunction(l)&&(l=l.prototype),mix(r.prototype,l)}},x7=null,Dd=function(a){if(typeof a!="object"||a===null)return a;var n;if(Nd(a)){n=[];for(var r=0,s=a.length;r<s;r++)typeof a[r]=="object"&&a[r]!=null?n[r]=Dd(a[r]):n[r]=a[r]}else{n={};for(var l in a)typeof a[l]=="object"&&a[l]!=null?n[l]=Dd(a[l]):n[l]=a[l]}return n},qo=Dd,k_=function(a,n){if(!Ad(a))throw new TypeError("Expected a function");var r=function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];var u=n?n.apply(this,s):s[0],h=r.cache;if(h.has(u))return h.get(u);var f=a.apply(this,s);return h.set(u,f),f};return r.cache=new Map,r},__=5;function Sm(a,n,r,s){r=r||0,s=s||__;for(var l in n)if(n.hasOwnProperty(l)){var u=n[l];u!==null&&isPlainObject(u)?(isPlainObject(a[l])||(a[l]={}),r<s?Sm(a[l],u,r+1,s):a[l]=n[l]):isArray(u)?(a[l]=[],a[l]=a[l].concat(u)):u!==void 0&&(a[l]=u)}}var E7=function(a){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];for(var s=0;s<n.length;s+=1)Sm(a,n[s]);return a},w7=null,S7=function(a,n,r,s){isFunction(n)||(r=n,n=a,a=function(){});var l=Object.create?function(h,f){return Object.create(h,{constructor:{value:f}})}:function(h,f){function d(){}d.prototype=h;var v=new d;return v.constructor=f,v},u=l(n.prototype,a);return a.prototype=mix(u,a.prototype),a.superclass=l(n.prototype,n),mix(u,r),mix(a,s),a},M7=null,P_=Object.prototype.hasOwnProperty;function T7(a){if(isNil(a))return!0;if(isArrayLike(a))return!a.length;var n=getType(a);if(n==="Map"||n==="Set")return!a.size;if(isPrototype(a))return!Object.keys(a).length;for(var r in a)if(P_.call(a,r))return!1;return!0}var C7=null,A_=function(a){return typeof a=="object"&&a!==null},Mm=A_,N_=function(a){return a!==null&&typeof a!="function"&&isFinite(a.length)},Tm=N_,Id=function(a,n){if(a===n)return!0;if(!a||!n||Rd(a)||Rd(n))return!1;if(Tm(a)||Tm(n)){if(a.length!==n.length)return!1;for(var r=!0,s=0;s<a.length&&(r=Id(a[s],n[s]),!!r);s++);return r}if(Mm(a)||Mm(n)){var l=Object.keys(a),u=Object.keys(n);if(l.length!==u.length)return!1;for(var r=!0,s=0;s<l.length&&(r=Id(a[l[s]],n[l[s]]),!!r);s++);return r}return!1},R_=Id,O7=function(a,n,r){return isFunction(r)?!!r(a,n):isEqual(a,n)},k7=function(a,n,r){for(var s=0,l=isString(n)?n.split("."):n;a&&s<l.length;)a=a[l[s++]];return a===void 0||s<l.length?r:a},_7=function(a,n,r){var s=a,l=isString(n)?n.split("."):n;return l.forEach(function(u,h){h<l.length-1?(isObject(s[u])||(s[u]=isNumber(l[h+1])?[]:{}),s=s[u]):s[u]=r}),a},L_=Object.prototype.hasOwnProperty,P7=function(a,n){if(a===null||!isPlainObject(a))return{};var r={};return each(n,function(s){L_.call(a,s)&&(r[s]=a[s])}),r},A7=function(a,n){return reduce(a,function(r,s,l){return n.includes(l)||(r[l]=s),r},{})},Nu={},N7=function(a){return a=a||"g",Nu[a]?Nu[a]+=1:Nu[a]=1,a+Nu[a]},Ru,R7=k_(function(a,n){n===void 0&&(n={});var r=n.fontSize,s=n.fontFamily,l=n.fontWeight,u=n.fontStyle,h=n.fontVariant;return Ru||(Ru=document.createElement("canvas").getContext("2d")),Ru.font=[u,h,l,r+"px",s].join(" "),Ru.measureText(Rd(a)?a:"").width},function(a,n){return n===void 0&&(n={}),(0,_.pr)([a],T_(n)).join("")}),L7=function(a,n,r,s){s===void 0&&(s="...");var l=16,u=measureTextWidth(s,r),h=isString(a)?a:toString(a),f=n,d=[],v,p;if(measureTextWidth(a,r)<=n)return a;for(;v=h.substr(0,l),p=measureTextWidth(v,r),!(p+u>f&&p>f);)if(d.push(v),f-=p,h=h.substr(l),!h)return d.join("");for(;v=h.substr(0,1),p=measureTextWidth(v,r),!(p+u>f);)if(d.push(v),f-=p,h=h.substr(1),!h)return d.join("");return""+d.join("")+s},D7=function(){function a(){this.map={}}return a.prototype.has=function(n){return this.map[n]!==void 0},a.prototype.get=function(n,r){var s=this.map[n];return s===void 0?r:s},a.prototype.set=function(n,r){this.map[n]=r},a.prototype.clear=function(){this.map={}},a.prototype.delete=function(n){delete this.map[n]},a.prototype.size=function(){return Object.keys(this.map).length},a}(),I7=null,D_=function(n,r,s){for(var l=1/0,u,h=0;h<r.length;h++){var f=r[h].id;!s[f]&&n[f]<=l&&(l=n[f],u=r[h])}return u},I_=function(n,r,s,l){var u=n.nodes,h=u===void 0?[]:u,f=n.edges,d=f===void 0?[]:f,v=[],p={},g={},y={};h.forEach(function(M,C){var T=M.id;v.push(T),g[T]=1/0,T===r&&(g[T]=0)});for(var m=h.length,b=function(C){var T=D_(g,h,p),O=T.id;if(p[O]=!0,g[O]===1/0)return"continue";var k=[];s?k=e_(O,d):k=Pu(O,d),k.forEach(function(P){var A=P.target,N=P.source,L=A===O?N:A,R=l&&P[l]?P[l]:1;g[L]>g[T.id]+R?(g[L]=g[T.id]+R,y[L]=[T.id]):g[L]===g[T.id]+R&&y[L].push(T.id)})},x=0;x<m;x++)b(x);y[r]=[r];var E={};for(var w in g)g[w]!==1/0&&Cm(r,w,y,E);var S={};for(var w in E)S[w]=E[w][0];return{length:g,path:S,allPath:E}},Lu=I_;function Cm(a,n,r,s){if(a===n)return[a];if(s[n])return s[n];for(var l=[],u=0,h=r[n];u<h.length;u++){var f=h[u],d=Cm(a,f,r,s);if(!d)return;for(var v=0,p=d;v<p.length;v++){var g=p[v];Nd(g)?l.push((0,_.ev)((0,_.ev)([],g,!0),[n],!1)):l.push([g,n])}}return s[n]=l,s[n]}var Bd=function(n,r,s,l,u){var h=Lu(n,r,l,u),f=h.length,d=h.path,v=h.allPath;return{length:f[s],path:d[s],allPath:v[s]}},B_=function(n,r,s,l){var u;if(r===s)return[[r]];var h=n.edges,f=h===void 0?[]:h,d=[r],v=(u={},u[r]=!0,u),p=[],g=[],y=l?Nr(r,f,"target"):Nr(r,f);for(p.push(y);d.length>0&&p.length>0;){var m=p[p.length-1];if(m.length){var b=m.shift();b&&(d.push(b),v[b]=!0,y=l?Nr(b,f,"target"):Nr(b,f),p.push(y.filter(function(w){return!v[w]})))}else{var x=d.pop();v[x]=!1,p.pop();continue}if(d[d.length-1]===s){var E=d.map(function(S){return S});g.push(E);var x=d.pop();v[x]=!1,p.pop()}}return g},F_=function(n,r){for(var s=_u(n,r),l=[],u=s.length,h=0;h<u;h+=1){l[h]=[];for(var f=0;f<u;f+=1)h===f?l[h][f]=0:s[h][f]===0||!s[h][f]?l[h][f]=1/0:l[h][f]=s[h][f]}for(var d=0;d<u;d+=1)for(var h=0;h<u;h+=1)for(var f=0;f<u;f+=1)l[h][f]>l[h][d]+l[d][f]&&(l[h][f]=l[h][d]+l[d][f]);return l},Fd=F_,z_=function(n,r,s,l){r===void 0&&(r=!1),s===void 0&&(s="weight"),l===void 0&&(l=1e3);var u=n.nodes,h=u===void 0?[]:u,f=n.edges,d=f===void 0?[]:f,v={},p={};h.forEach(function(C,T){var O=fm();C.clusterId=O,v[O]={id:O,nodes:[C]},p[C.id]={node:C,idx:T}});var g=_u(n,r),y=[],m={};g.forEach(function(C,T){var O=0,k=h[T].id;m[k]={},C.forEach(function(P,A){if(P){O+=P;var N=h[A].id;m[k][N]=P}}),y.push(O)});for(var b=0,x=function(){var T=!1;if(h.forEach(function(O){var k={};Object.keys(m[O.id]).forEach(function(X){var nt=m[O.id][X],K=p[X].node,rt=K.clusterId;k[rt]||(k[rt]=0),k[rt]+=nt});var P=-1/0,A=[];if(Object.keys(k).forEach(function(X){P<k[X]?(P=k[X],A=[X]):P===k[X]&&A.push(X)}),!(A.length===1&&A[0]===O.clusterId)){var N=A.indexOf(O.clusterId);if(N>=0&&A.splice(N,1),A&&A.length){T=!0;var L=v[O.clusterId],R=L.nodes.indexOf(O);L.nodes.splice(R,1);var z=Math.floor(Math.random()*A.length),Z=v[A[z]];Z.nodes.push(O),O.clusterId=Z.id}}}),!T)return"break";b++};b<l;){var E=x();if(E==="break")break}Object.keys(v).forEach(function(C){var T=v[C];(!T.nodes||!T.nodes.length)&&delete v[C]});var w=[],S={};d.forEach(function(C){var T=C.source,O=C.target,k=C[s]||1,P=p[T].node.clusterId,A=p[O].node.clusterId,N="".concat(P,"---").concat(A);if(S[N])S[N].weight+=k,S[N].count++;else{var L={source:P,target:A,weight:k,count:1};S[N]=L,w.push(L)}});var M=[];return Object.keys(v).forEach(function(C){M.push(v[C])}),{clusters:M,clusterEdges:w}},Z_=z_,G_=function(){function a(n){this.arr=n}return a.prototype.getArr=function(){return this.arr||[]},a.prototype.add=function(n){var r,s=n.arr;if(!(!((r=this.arr)===null||r===void 0)&&r.length))return new a(s);if(!(s!=null&&s.length))return new a(this.arr);if(this.arr.length===s.length){var l=[];for(var u in this.arr)l[u]=this.arr[u]+s[u];return new a(l)}},a.prototype.subtract=function(n){var r,s=n.arr;if(!(!((r=this.arr)===null||r===void 0)&&r.length))return new a(s);if(!(s!=null&&s.length))return new a(this.arr);if(this.arr.length===s.length){var l=[];for(var u in this.arr)l[u]=this.arr[u]-s[u];return new a(l)}},a.prototype.avg=function(n){var r=[];if(n!==0)for(var s in this.arr)r[s]=this.arr[s]/n;return new a(r)},a.prototype.negate=function(){var n=[];for(var r in this.arr)n[r]=-this.arr[r];return new a(n)},a.prototype.squareEuclideanDistance=function(n){var r,s=n.arr;if(!(!((r=this.arr)===null||r===void 0)&&r.length)||!(s!=null&&s.length))return 0;if(this.arr.length===s.length){var l=0;for(var u in this.arr)l+=Math.pow(this.arr[u]-n.arr[u],2);return l}},a.prototype.euclideanDistance=function(n){var r,s=n.arr;if(!(!((r=this.arr)===null||r===void 0)&&r.length)||!(s!=null&&s.length))return 0;if(this.arr.length===s.length){var l=0;for(var u in this.arr)l+=Math.pow(this.arr[u]-n.arr[u],2);return Math.sqrt(l)}else console.error("The two vectors are unequal in length.")},a.prototype.normalize=function(){var n=[],r=qo(this.arr);r.sort(function(h,f){return h-f});var s=r[r.length-1],l=r[0];for(var u in this.arr)n[u]=(this.arr[u]-l)/(s-l);return new a(n)},a.prototype.norm2=function(){var n;if(!(!((n=this.arr)===null||n===void 0)&&n.length))return 0;var r=0;for(var s in this.arr)r+=Math.pow(this.arr[s],2);return Math.sqrt(r)},a.prototype.dot=function(n){var r,s=n.arr;if(!(!((r=this.arr)===null||r===void 0)&&r.length)||!(s!=null&&s.length))return 0;if(this.arr.length===s.length){var l=0;for(var u in this.arr)l+=this.arr[u]*n.arr[u];return l}else console.error("The two vectors are unequal in length.")},a.prototype.equal=function(n){var r,s=n.arr;if(((r=this.arr)===null||r===void 0?void 0:r.length)!==(s==null?void 0:s.length))return!1;for(var l in this.arr)if(this.arr[l]!==s[l])return!1;return!0},a}(),Rr=G_,W_=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/,j_=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/,Om=function(n,r){n===void 0&&(n=[]),r===void 0&&(r=100);var s={};n.forEach(function(u){u.properties&&Object.keys(u.properties).forEach(function(h){if(h==="id"||!"".concat(u.properties[h]).match(W_)&&!"".concat(u.properties[h]).match(j_)&&isNaN(Number(u.properties[h]))){s.hasOwnProperty(h)&&delete s[h];return}s.hasOwnProperty(h)?s[h]+=1:s[h]=1})});var l=Object.keys(s).sort(function(u,h){return s[h]-s[u]});return l.length<r?l:l.slice(0,r)},V_=function(n,r){return r.map(function(s){return n.hasOwnProperty(s)?n[s]:0})},H_=function(n){for(var r=Om(n),s=[],l=0;l<n.length;l++)s[l]=V_(n[l].properties,r);return s},Du=function(n,r){r===void 0&&(r=void 0);var s=[];return n.forEach(function(l){r===void 0&&s.push(l),l[r]!==void 0&&s.push(l[r])}),s},B7={getAllSortProperties:Om,getPropertyWeight:H_,getAllProperties:Du},Ur;(function(a){a.EuclideanDistance="euclideanDistance"})(Ur||(Ur={}));var km=function(n,r,s){var l=[];r!=null&&r.length?l=r:(n.forEach(function(h){l=l.concat(Object.keys(h))}),l=Ld(l));var u={};return l.forEach(function(h){var f=[];n.forEach(function(d){d[h]!==void 0&&d[h]!==""&&f.push(d[h])}),f.length&&!(s!=null&&s.includes(h))&&(u[h]=Ld(f))}),u},Iu=function(n,r,s){var l=km(n,r,s),u=[];if(!Object.keys(l).length)return u;var h=Object.values(l),f=h.every(function(d){return d.every(function(v){return typeof v=="number"})});return n.forEach(function(d,v){var p=[];Object.keys(l).forEach(function(g){var y=d[g],m=l[g],b=m.findIndex(function(w){return y===w}),x=[];if(f)x.push(y);else for(var E=0;E<m.length;E++)E===b?x.push(1):x.push(0);p=p.concat(x)}),u[v]=p}),u},zd=function(n,r,s,l){s===void 0&&(s=Ur.EuclideanDistance);var u=0;switch(s){case Ur.EuclideanDistance:u=new Rr(n).euclideanDistance(new Rr(r));break;default:break}return u},F7={getAllKeyValueMap:km,oneHot:Iu,getDistance:zd},_m=function(n,r,s,l){for(var u=r.length,h=2*l,f=0,d=0;d<u;d++)for(var v=n[d].clusterId,p=0;p<u;p++){var g=n[p].clusterId;if(v===g){var y=r[d][p]||0,m=s[d]||0,b=s[p]||0;f+=y-m*b/h}}return f*=1/h,f},Zd=function(n,r){n===void 0&&(n=[]);for(var s=n.length,l=new Rr([]),u=0;u<s;u++)l=l.add(new Rr(r[u]));var h=l.avg(s);h.normalize();for(var f=0,u=0;u<s;u++){var d=new Rr(r[u]),v=d.squareEuclideanDistance(h);f+=v}var p=[];n.forEach(function(){p.push([])});for(var u=0;u<s;u++){var d=new Rr(r[u]);n[u].clusterInertial=0;for(var g=0;g<s;g++){if(u===g){p[u][g]=0;continue}var y=new Rr(r[g]);p[u][g]=d.squareEuclideanDistance(y),n[u].clusterInertial+=p[u][g]}}for(var m=0,b=2*s*f,u=0;u<s;u++)for(var x=n[u].clusterId,g=0;g<s;g++){var E=n[g].clusterId;if(!(u===g||x!==E)){var w=n[u].clusterInertial*n[g].clusterInertial/Math.pow(b,2)-p[u][g]/b;m+=w}}return Number(m.toFixed(4))},$_=function(n,r,s,l,u,h,f,d,v){r===void 0&&(r=!1),s===void 0&&(s="weight"),l===void 0&&(l=1e-4),u===void 0&&(u=!1),h===void 0&&(h=void 0),f===void 0&&(f=[]),d===void 0&&(d=["id"]),v===void 0&&(v=1);var p=n.nodes,g=p===void 0?[]:p,y=n.edges,m=y===void 0?[]:y,b=[];if(u){g.forEach(function(U,at){U.properties=U.properties||{},U.originIndex=at});var x=[];g.every(function(U){return U.hasOwnProperty("nodeType")})&&(x=Array.from(new Set(g.map(function(U){return U.nodeType}))),g.forEach(function(U){U.properties.nodeType=x.findIndex(function(at){return at===U.nodeType})}));var E=Du(g,h);b=Iu(E,f,d)}var w=1,S={},M={};g.forEach(function(U,at){var ht=String(w++);U.clusterId=ht,S[ht]={id:ht,nodes:[U]},M[U.id]={node:U,idx:at}});var C=_u(n,r),T=[],O={},k=0;C.forEach(function(U,at){var ht=0,pt=g[at].id;O[pt]={},U.forEach(function(Ct,Zt){if(Ct){ht+=Ct;var Nt=g[Zt].id;O[pt][Nt]=Ct,k+=Ct}}),T.push(ht)}),k/=2;for(var P=1/0,A=1/0,N=0,L=[],R={};;){u&&g.every(function(U){return U.hasOwnProperty("properties")})?P=_m(g,C,T,k)+Zd(g,b)*v:P=_m(g,C,T,k),N===0&&(A=P,L=g,R=S);var z=P>0&&P>A&&P-A<l;if(P>A&&(L=g.map(function(U){return{node:U,clusterId:U.clusterId}}),R=qo(S),A=P),z||N>100)break;N++,Object.keys(S).forEach(function(U){var at=0;m.forEach(function(ht){var pt=ht.source,Ct=ht.target,Zt=M[pt].node.clusterId,Nt=M[Ct].node.clusterId;(Zt===U&&Nt!==U||Nt===U&&Zt!==U)&&(at=at+(ht[s]||1))}),S[U].sumTot=at}),g.forEach(function(U,at){var ht=S[U.clusterId],pt=0,Ct,Zt=T[at]/(2*k),Nt=0,Pt=ht.nodes;Pt.forEach(function(kn){var En=M[kn.id].idx;Nt+=C[at][En]||0});var ie=Nt-ht.sumTot*Zt,Kt=Pt.filter(function(kn){return kn.id!==U.id}),re=[];Kt.forEach(function(kn,En){re[En]=b[kn.originIndex]});var te=Zd(Kt,b)*v,ze=O[U.id];if(Object.keys(ze).forEach(function(kn){var En=M[kn].node,Yi=En.clusterId;if(Yi!==U.clusterId){var _n=S[Yi],ur=_n.nodes;if(!(!ur||!ur.length)){var Xt=0;ur.forEach(function(le){var fe=M[le.id].idx;Xt+=C[at][fe]||0});var he=Xt-_n.sumTot*Zt,Qt=ur.concat([U]),oe=[];Qt.forEach(function(le,fe){oe[fe]=b[le.originIndex]});var be=Zd(Qt,b)*v,kt=he-ie;u&&(kt=he+be-(ie+te)),kt>pt&&(pt=kt,Ct=_n)}}}),pt>0){Ct.nodes.push(U);var Yt=U.clusterId;U.clusterId=Ct.id;var wr=ht.nodes.indexOf(U);ht.nodes.splice(wr,1);var zn=0,Pa=0;m.forEach(function(kn){var En=kn.source,Yi=kn.target,_n=M[En].node.clusterId,ur=M[Yi].node.clusterId;(_n===Ct.id&&ur!==Ct.id||ur===Ct.id&&_n!==Ct.id)&&(zn=zn+(kn[s]||1)),(_n===Yt&&ur!==Yt||ur===Yt&&_n!==Yt)&&(Pa=Pa+(kn[s]||1))}),Ct.sumTot=zn,ht.sumTot=Pa}})}var Z={},X=0;Object.keys(R).forEach(function(U){var at=R[U];if(!at.nodes||!at.nodes.length){delete R[U];return}var ht=String(X+1);ht!==U&&(at.id=ht,at.nodes=at.nodes.map(function(pt){return{id:pt.id,clusterId:ht}}),R[ht]=at,Z[U]=ht,delete R[U],X++)}),L.forEach(function(U){var at=U.node,ht=U.clusterId;at&&(at.clusterId=ht,at.clusterId&&Z[at.clusterId]&&(at.clusterId=Z[at.clusterId]))});var nt=[],K={};m.forEach(function(U){var at=U.source,ht=U.target,pt=U[s]||1,Ct=M[at].node.clusterId,Zt=M[ht].node.clusterId;if(!(!Ct||!Zt)){var Nt="".concat(Ct,"---").concat(Zt);if(K[Nt])K[Nt].weight+=pt,K[Nt].count++;else{var Pt={source:Ct,target:Zt,weight:pt,count:1};K[Nt]=Pt,nt.push(Pt)}}});var rt=[];return Object.keys(R).forEach(function(U){rt.push(R[U])}),{clusters:rt,clusterEdges:nt}},Pm=$_,U_=function(n,r,s,l,u,h,f,d){return r===void 0&&(r=!1),s===void 0&&(s="weight"),l===void 0&&(l=1e-4),u===void 0&&(u=void 0),h===void 0&&(h=[]),f===void 0&&(f=["id"]),d===void 0&&(d=1),Pm(n,r,s,l,!0,u,h,f,d)},Y_=U_,X_=function(n,r){var s;r===void 0&&(r=1);for(var l=qo(n),u=l.nodes,h=u===void 0?[]:u,f=l.edges,d=f===void 0?[]:f,v=function(){var y=Pd({nodes:h,edges:d}),m=Object.keys(y);m.sort(function(E,w){var S,M;return((S=y[E])===null||S===void 0?void 0:S.degree)-((M=y[w])===null||M===void 0?void 0:M.degree)});var b=m[0];if(!h.length||((s=y[b])===null||s===void 0?void 0:s.degree)>=r)return"break";var x=h.findIndex(function(E){return E.id===b});h.splice(x,1),d=d.filter(function(E){return!(E.source===b||E.target===b)})};;){var p=v();if(p==="break")break}return{nodes:h,edges:d}},q_=X_,Am=function(n,r,s){var l=[];switch(n){case Ur.EuclideanDistance:l=r[s];break;default:l=[];break}return l},K_=function(n,r,s,l,u,h){r===void 0&&(r=3),s===void 0&&(s=void 0),l===void 0&&(l=[]),u===void 0&&(u=["id"]),h===void 0&&(h=Ur.EuclideanDistance);var f=n.nodes,d=f===void 0?[]:f,v=n.edges,p=v===void 0?[]:v,g={clusters:[{id:"0",nodes:d}],clusterEdges:[]};if(h===Ur.EuclideanDistance&&!d.every(function(ht){return ht.hasOwnProperty(s)}))return g;var y=[],m=[];if(h===Ur.EuclideanDistance&&(y=Du(d,s),m=Iu(y,l,u)),!m.length)return g;for(var b=Ld(m.map(function(ht){return ht.join("")})),x=Math.min(r,d.length,b.length),E=0;E<d.length;E++)d[E].originIndex=E;for(var w=[],S=[],M=[],E=0;E<x;E++)if(E===0){var C=Math.floor(Math.random()*d.length);switch(h){case Ur.EuclideanDistance:w[E]=m[C];break;default:w[E]=[];break}S.push(C),M[E]=[d[C]],d[C].clusterId=String(E)}else{for(var T=-1/0,O=0,k=function(Ct){if(!S.includes(Ct)){for(var Zt=0,Nt=0;Nt<w.length;Nt++){var Pt=0;switch(h){case Ur.EuclideanDistance:Pt=zd(m[d[Ct].originIndex],w[Nt],h);break;default:break}Zt+=Pt}var ie=Zt/w.length;ie>T&&!w.find(function(Kt){return R_(Kt,Am(h,m,d[Ct].originIndex))})&&(T=ie,O=Ct)}},P=0;P<d.length;P++)k(P);w[E]=Am(h,m,O),S.push(O),M[E]=[d[O]],d[O].clusterId=String(E)}for(var A=0;;){for(var E=0;E<d.length;E++){var N=0,L=1/0;if(!(A===0&&S.includes(E))){for(var R=0;R<w.length;R++){var z=0;switch(h){case Ur.EuclideanDistance:z=zd(m[E],w[R],h);break;default:break}z<L&&(L=z,N=R)}if(d[E].clusterId!==void 0)for(var Z=M[Number(d[E].clusterId)].length-1;Z>=0;Z--)M[Number(d[E].clusterId)][Z].id===d[E].id&&M[Number(d[E].clusterId)].splice(Z,1);d[E].clusterId=String(N),M[N].push(d[E])}}for(var X=!1,E=0;E<M.length;E++){for(var nt=M[E],K=new Rr([]),R=0;R<nt.length;R++)K=K.add(new Rr(m[nt[R].originIndex]));var rt=K.avg(nt.length);rt.equal(new Rr(w[E]))||(X=!0,w[E]=rt.getArr())}if(A++,d.every(function(ht){return ht.clusterId!==void 0})&&X||A>=1e3)break}var U=[],at={};return p.forEach(function(ht){var pt,Ct,Zt=ht.source,Nt=ht.target,Pt=(pt=d.find(function(te){return te.id===Zt}))===null||pt===void 0?void 0:pt.clusterId,ie=(Ct=d.find(function(te){return te.id===Nt}))===null||Ct===void 0?void 0:Ct.clusterId,Kt="".concat(Pt,"---").concat(ie);if(at[Kt])at[Kt].count++;else{var re={source:Pt,target:ie,count:1};at[Kt]=re,U.push(re)}}),{clusters:M,clusterEdges:U}},Q_=K_,J_=function(n,r){var s=new Rr(r),l=s.norm2(),u=new Rr(n),h=u.norm2(),f=s.dot(u),d=l*h,v=d?f/d:0;return v},Nm=J_,tP=function(n,r,s,l,u){n===void 0&&(n=[]),s===void 0&&(s=void 0),l===void 0&&(l=[]),u===void 0&&(u=[]);var h=qo(n.filter(function(y){return y.id!==r.id})),f=n.findIndex(function(y){return y.id===r.id}),d=Du(n,s),v=Iu(d,l,u),p=v[f],g=[];return h.forEach(function(y,m){if(y.id!==r.id){var b=v[m],x=Nm(b,p);g.push(x),y.cosineSimilarity=x}}),h.sort(function(y,m){return m.cosineSimilarity-y.cosineSimilarity}),{allCosineSimilarity:g,similarNodes:h}},eP=tP,nP=function(){function a(n){this.count=n.length,this.parent={};for(var r=0,s=n;r<s.length;r++){var l=s[r];this.parent[l]=l}}return a.prototype.find=function(n){for(;this.parent[n]!==n;)n=this.parent[n];return n},a.prototype.union=function(n,r){var s=this.find(n),l=this.find(r);s!==l&&(s<l?(this.parent[r]!==r&&this.union(this.parent[r],n),this.parent[r]=this.parent[n]):(this.parent[n]!==n&&this.union(this.parent[n],r),this.parent[n]=this.parent[r]))},a.prototype.connected=function(n,r){return this.find(n)===this.find(r)},a}(),rP=nP,iP=function(n,r){return n-r},aP=function(){function a(n){n===void 0&&(n=iP),this.compareFn=n,this.list=[]}return a.prototype.getLeft=function(n){return 2*n+1},a.prototype.getRight=function(n){return 2*n+2},a.prototype.getParent=function(n){return n===0?null:Math.floor((n-1)/2)},a.prototype.isEmpty=function(){return this.list.length<=0},a.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},a.prototype.delMin=function(){var n=this.top(),r=this.list.pop();return this.list.length>0&&(this.list[0]=r,this.moveDown(0)),n},a.prototype.insert=function(n){if(n!==null){this.list.push(n);var r=this.list.length-1;return this.moveUp(r),!0}return!1},a.prototype.moveUp=function(n){for(var r=this.getParent(n);n&&n>0&&this.compareFn(this.list[r],this.list[n])>0;){var s=this.list[r];this.list[r]=this.list[n],this.list[n]=s,n=r,r=this.getParent(n)}},a.prototype.moveDown=function(n){var r,s=n,l=this.getLeft(n),u=this.getRight(n),h=this.list.length;l!==null&&l<h&&this.compareFn(this.list[s],this.list[l])>0?s=l:u!==null&&u<h&&this.compareFn(this.list[s],this.list[u])>0&&(s=u),n!==s&&(r=[this.list[s],this.list[n]],this.list[n]=r[0],this.list[s]=r[1],this.moveDown(s))},a}(),sP=aP,oP=function(n,r){var s=[],l=n.nodes,u=l===void 0?[]:l,h=n.edges,f=h===void 0?[]:h;if(u.length===0)return s;var d=u[0],v=new Set;v.add(d);var p=function(E,w){return r?E.weight-w.weight:0},g=new sP(p);for(Pu(d.id,f).forEach(function(x){g.insert(x)});!g.isEmpty();){var y=g.delMin(),m=y.source,b=y.target;v.has(m)&&v.has(b)||(s.push(y),v.has(m)||(v.add(m),Pu(m,f).forEach(function(x){g.insert(x)})),v.has(b)||(v.add(b),Pu(b,f).forEach(function(x){g.insert(x)})))}return s},Rm=function(n,r){var s=[],l=n.nodes,u=l===void 0?[]:l,h=n.edges,f=h===void 0?[]:h;if(u.length===0)return s;var d=f.map(function(m){return m});r&&d.sort(function(m,b){return m.weight-b.weight});for(var v=new rP(u.map(function(m){return m.id}));d.length>0;){var p=d.shift(),g=p.source,y=p.target;v.connected(g,y)||(s.push(p),v.union(g,y))}return s},lP=function(n,r,s){var l={prim:oP,kruskal:Rm};return s?l[s](n,r):Rm(n,r)},cP=lP,uP=function(n,r,s){typeof r!="number"&&(r=1e-6),typeof s!="number"&&(s=.85);for(var l=1,u=0,h=1e3,f=n.nodes,d=f===void 0?[]:f,v=n.edges,p=v===void 0?[]:v,g=d.length,y,m={},b={},x=0;x<g;++x){var E=d[x],w=E.id;m[w]=1/g,b[w]=1/g}for(var S=Pd(n);h>0&&l>r;){u=0;for(var x=0;x<g;++x){var E=d[x],w=E.id;if(y=0,S[E.id].inDegree===0)m[w]=0;else{for(var M=Nr(w,p,"source"),C=0;C<M.length;++C){var T=M[C],O=S[T].outDegree;O>0&&(y+=b[T]/O)}m[w]=s*y,u+=m[w]}}u=(1-u)/g,l=0;for(var x=0;x<g;++x){var E=d[x],w=E.id;y=m[w]+u,l+=Math.abs(y-b[w]),b[w]=y}h-=1}return b},Lm=uP,hP=-1,Bu=-1,Dm="-1",wi="-1",Im=-1,z7="-1",Bm=function(){function a(n,r,s,l){n===void 0&&(n=hP),r===void 0&&(r=Bu),s===void 0&&(s=Bu),l===void 0&&(l=Dm),this.id=n,this.from=r,this.to=s,this.label=l}return a}(),fP=function(){function a(n,r){n===void 0&&(n=Bu),r===void 0&&(r=wi),this.id=n,this.label=r,this.edges=[],this.edgeMap={}}return a.prototype.addEdge=function(n){this.edges.push(n),this.edgeMap[n.id]=n},a}(),Fm=function(){function a(n,r,s){n===void 0&&(n=Bu),r===void 0&&(r=!0),s===void 0&&(s=!1),this.id=n,this.edgeIdAutoIncrease=r,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=s}return a.prototype.getNodeNum=function(){return this.nodes.length},a.prototype.addNode=function(n,r){if(!this.nodeMap[n]){var s=new fP(n,r);this.nodes.push(s),this.nodeMap[n]=s,this.nodeLabelMap[r]||(this.nodeLabelMap[r]=[]),this.nodeLabelMap[r].push(n)}},a.prototype.addEdge=function(n,r,s,l){if((this.edgeIdAutoIncrease||n===void 0)&&(n=this.counter++),!(this.nodeMap[r]&&this.nodeMap[s]&&this.nodeMap[s].edgeMap[n])){var u=new Bm(n,r,s,l);if(this.edges.push(u),this.edgeMap[n]=u,this.nodeMap[r].addEdge(u),this.edgeLabelMap[l]||(this.edgeLabelMap[l]=[]),this.edgeLabelMap[l].push(u),!this.directed){var h=new Bm(n,s,r,l);this.nodeMap[s].addEdge(h),this.edgeLabelMap[l].push(h)}}},a}(),Qa=function(){function a(n,r,s,l,u){this.fromNode=n,this.toNode=r,this.nodeEdgeNodeLabel={nodeLabel1:s||wi,edgeLabel:l||Dm,nodeLabel2:u||wi}}return a.prototype.equalTo=function(n){return this.fromNode===n.formNode&&this.toNode===n.toNode&&this.nodeEdgeNodeLabel===n.nodeEdgeNodeLabel},a.prototype.notEqualTo=function(n){return!this.equalTo(n)},a}(),zm=function(){function a(){this.rmpath=[],this.dfsEdgeList=[]}return a.prototype.equalTo=function(n){var r=this.dfsEdgeList.length,s=n.length;if(r!==s)return!1;for(var l=0;l<r;l++)if(this.dfsEdgeList[l]!==n[l])return!1;return!0},a.prototype.notEqualTo=function(n){return!this.equalTo(n)},a.prototype.pushBack=function(n,r,s,l,u){return this.dfsEdgeList.push(new Qa(n,r,s,l,u)),this.dfsEdgeList},a.prototype.toGraph=function(n,r){n===void 0&&(n=Im),r===void 0&&(r=!1);var s=new Fm(n,!0,r);return this.dfsEdgeList.forEach(function(l){var u=l.fromNode,h=l.toNode,f=l.nodeEdgeNodeLabel,d=f.nodeLabel1,v=f.edgeLabel,p=f.nodeLabel2;d!==wi&&s.addNode(u,d),p!==wi&&s.addNode(h,p),d!==wi&&p!==d&&s.addEdge(void 0,u,h,v)}),s},a.prototype.buildRmpath=function(){this.rmpath=[];for(var n=void 0,r=this.dfsEdgeList.length,s=r-1;s>=0;s--){var l=this.dfsEdgeList[s],u=l.fromNode,h=l.toNode;u<h&&(n===void 0||h===n)&&(this.rmpath.push(s),n=u)}return this.rmpath},a.prototype.getNodeNum=function(){var n={};return this.dfsEdgeList.forEach(function(r){n[r.fromNode]||(n[r.fromNode]=!0),n[r.toNode]||(n[r.toNode]=!0)}),Object.keys(n).length},a}(),Fu=function(){function a(n){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],!!n){for(;n;){var r=n.edge;this.edges.push(r),this.nodesUsed[r.from]=1,this.nodesUsed[r.to]=1,this.edgesUsed[r.id]=1,n=n.preNode}this.edges=this.edges.reverse()}}return a.prototype.hasNode=function(n){return this.nodesUsed[n.id]===1},a.prototype.hasEdge=function(n){return this.edgesUsed[n.id]===1},a}(),dP=function(){function a(n){var r=n.graphs,s=n.minSupport,l=s===void 0?2:s,u=n.minNodeNum,h=u===void 0?1:u,f=n.maxNodeNum,d=f===void 0?4:f,v=n.top,p=v===void 0?10:v,g=n.directed,y=g===void 0?!1:g,m=n.verbose,b=m===void 0?!1:m;this.graphs=r,this.dfsCode=new zm,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=l,this.top=p,this.directed=y,this.counter=0,this.maxNodeNum=d,this.minNodeNum=h,this.verbose=b,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return a.prototype.findForwardRootEdges=function(n,r){var s=this,l=[],u=n.nodeMap;return r.edges.forEach(function(h){(s.directed||r.label<=u[h.to].label)&&l.push(h)}),l},a.prototype.findBackwardEdge=function(n,r,s,l){if(!this.directed&&r===s)return null;for(var u=n.nodeMap,h=u[s.to],f=h.edges,d=f.length,v=0;v<d;v++){var p=f[v];if(!(l.hasEdge(p)||p.to!==r.from)){if(this.directed){if(u[r.from].label<u[s.to].label||u[r.from].label===u[s.to].label&&r.label<=p.label)return p}else if(r.label<p.label||r.label===p.label&&u[r.to].label<=u[s.to].label)return p}}return null},a.prototype.findForwardPureEdges=function(n,r,s,l){for(var u=[],h=r.to,f=n.nodeMap[h].edges,d=f.length,v=0;v<d;v++){var p=f[v],g=n.nodeMap[p.to];s<=g.label&&!l.hasNode(g)&&u.push(p)}return u},a.prototype.findForwardRmpathEdges=function(n,r,s,l){for(var u=[],h=n.nodeMap,f=h[r.to].label,d=h[r.from],v=d.edges,p=v.length,g=0;g<p;g++){var y=v[g],m=h[y.to].label;r.to===y.to||s>m||l.hasNode(h[y.to])||(r.label<y.label||r.label===y.label&&f<=m)&&u.push(y)}return u},a.prototype.getSupport=function(n){var r={};return n.forEach(function(s){r[s.graphId]||(r[s.graphId]=!0)}),Object.keys(r).length},a.prototype.findMinLabel=function(n){var r=void 0;return Object.keys(n).forEach(function(s){var l=n[s],u=l.nodeLabel1,h=l.edgeLabel,f=l.nodeLabel2;if(!r){r={nodeLabel1:u,edgeLabel:h,nodeLabel2:f};return}(u<r.nodeLabel1||u===r.nodeLabel1&&h<r.edgeLabel||u===r.nodeLabel1&&h===r.edgeLabel&&f<r.nodeLabel2)&&(r={nodeLabel1:u,edgeLabel:h,nodeLabel2:f})}),r},a.prototype.isMin=function(){var n=this,r=this.dfsCode;if(this.verbose&&console.log("isMin checking",r),r.dfsEdgeList.length===1)return!0;var s=this.directed,l=r.toGraph(Im,s),u=l.nodeMap,h=new zm,f={};l.nodes.forEach(function(g){var y=n.findForwardRootEdges(l,g);y.forEach(function(m){var b=u[m.to],x="".concat(g.label,"-").concat(m.label,"-").concat(b.label);f[x]||(f[x]={projected:[],nodeLabel1:g.label,edgeLabel:m.label,nodeLabel2:b.label});var E={graphId:l.id,edge:m,preNode:null};f[x].projected.push(E)})});var d=this.findMinLabel(f);if(d){h.dfsEdgeList.push(new Qa(0,1,d.nodeLabel1,d.edgeLabel,d.nodeLabel2));var v=function g(y){for(var m=h.buildRmpath(),b=h.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,x=h.dfsEdgeList[m[0]].toNode,E={},w=!1,S=0,M=s?-1:0,C=function(K){if(w)return"break";y.forEach(function(rt){var U=new Fu(rt),at=n.findBackwardEdge(l,U.edges[m[K]],U.edges[m[0]],U);at&&(E[at.label]||(E[at.label]={projected:[],edgeLabel:at.label}),E[at.label].projected.push({graphId:l.id,edge:E,preNode:rt}),S=h.dfsEdgeList[m[K]].fromNode,w=!0)})},T=m.length-1;T>M;T--){var O=C(T);if(O==="break")break}if(w){var k=n.findMinLabel(E);h.dfsEdgeList.push(new Qa(x,S,wi,k.edgeLabel,wi));var P=h.dfsEdgeList.length-1;return n.dfsCode.dfsEdgeList[P]!==h.dfsEdgeList[P]?!1:g(E[k.edgeLabel].projected)}var A={};w=!1;var N=0;y.forEach(function(nt){var K=new Fu(nt),rt=n.findForwardPureEdges(l,K.edges[m[0]],b,K);rt.length>0&&(w=!0,N=x,rt.forEach(function(U){var at="".concat(U.label,"-").concat(u[U.to].label);A[at]||(A[at]={projected:[],edgeLabel:U.label,nodeLabel2:u[U.to].label}),A[at].projected.push({graphId:l.id,edge:U,preNode:nt})}))});for(var L=m.length,R=function(K){if(w)return"break";var rt=m[K];y.forEach(function(U){var at=new Fu(U),ht=n.findForwardRmpathEdges(l,at.edges[rt],b,at);ht.length>0&&(w=!0,N=h.dfsEdgeList[rt].fromNode,ht.forEach(function(pt){var Ct="".concat(pt.label,"-").concat(u[pt.to].label);A[Ct]||(A[Ct]={projected:[],edgeLabel:pt.label,nodeLabel2:u[pt.to].label}),A[Ct].projected.push({graphId:l.id,edge:pt,preNode:U})}))})},T=0;T<L;T++){var z=R(T);if(z==="break")break}if(!w)return!0;var Z=n.findMinLabel(A);h.dfsEdgeList.push(new Qa(N,x+1,wi,Z.edgeLabel,Z.nodeLabel2));var X=h.dfsEdgeList.length-1;return r.dfsEdgeList[X]!==h.dfsEdgeList[X]?!1:g(A["".concat(Z.edgeLabel,"-").concat(Z.nodeLabel2)].projected)},p="".concat(d.nodeLabel1,"-").concat(d.edgeLabel,"-").concat(d.nodeLabel2);return v(f[p].projected)}},a.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var n=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push(qo(n))}},a.prototype.subGraphMining=function(n){var r=this,s=this.getSupport(n);if(!(s<this.minSupport)&&this.isMin()){this.report();var l=this.dfsCode.getNodeNum(),u=this.dfsCode.buildRmpath(),h=this.dfsCode.dfsEdgeList[u[0]].toNode,f=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,d={},v={};n.forEach(function(p){for(var g=r.graphs[p.graphId],y=g.nodeMap,m=new Fu(p),b=u.length-1;b>=0;b--){var x=r.findBackwardEdge(g,m.edges[u[b]],m.edges[u[0]],m);if(x){var E="".concat(r.dfsCode.dfsEdgeList[u[b]].fromNode,"-").concat(x.label);v[E]||(v[E]={projected:[],toNodeId:r.dfsCode.dfsEdgeList[u[b]].fromNode,edgeLabel:x.label}),v[E].projected.push({graphId:p.graphId,edge:x,preNode:p})}}if(!(l>=r.maxNodeNum)){var w=r.findForwardPureEdges(g,m.edges[u[0]],f,m);w.forEach(function(M){var C="".concat(h,"-").concat(M.label,"-").concat(y[M.to].label);d[C]||(d[C]={projected:[],fromNodeId:h,edgeLabel:M.label,nodeLabel2:y[M.to].label}),d[C].projected.push({graphId:p.graphId,edge:M,preNode:p})});for(var S=function(C){var T=r.findForwardRmpathEdges(g,m.edges[u[C]],f,m);T.forEach(function(O){var k="".concat(r.dfsCode.dfsEdgeList[u[C]].fromNode,"-").concat(O.label,"-").concat(y[O.to].label);d[k]||(d[k]={projected:[],fromNodeId:r.dfsCode.dfsEdgeList[u[C]].fromNode,edgeLabel:O.label,nodeLabel2:y[O.to].label}),d[k].projected.push({graphId:p.graphId,edge:O,preNode:p})})},b=0;b<u.length;b++)S(b)}}),Object.keys(v).forEach(function(p){var g=v[p],y=g.toNodeId,m=g.edgeLabel;r.dfsCode.dfsEdgeList.push(new Qa(h,y,"-1",m,"-1")),r.subGraphMining(v[p].projected),r.dfsCode.dfsEdgeList.pop()}),Object.keys(d).forEach(function(p){var g=d[p],y=g.fromNodeId,m=g.edgeLabel,b=g.nodeLabel2;r.dfsCode.dfsEdgeList.push(new Qa(y,h+1,wi,m,b)),r.subGraphMining(d[p].projected),r.dfsCode.dfsEdgeList.pop()})}},a.prototype.generate1EdgeFrequentSubGraphs=function(){var n=this.graphs,r=this.directed,s=this.minSupport,l=this.frequentSize1Subgraphs,u={},h={},f={},d={};return Object.keys(n).forEach(function(v){var p=n[v],g=p.nodeMap;p.nodes.forEach(function(y,m){var b=y.label,x="".concat(v,"-").concat(b);if(!f[x]){var E=u[b]||0;E++,u[b]=E}f[x]={graphKey:v,label:b},y.edges.forEach(function(w){var S=b,M=g[w.to].label;if(!r&&S>M){var C=M;M=S,S=C}var T=w.label,O="".concat(v,"-").concat(S,"-").concat(T,"-").concat(M),k="".concat(S,"-").concat(T,"-").concat(M);if(!h[k]){var P=h[k]||0;P++,h[k]=P}d[O]={graphId:v,nodeLabel1:S,edgeLabel:T,nodeLabel2:M}})})}),Object.keys(u).forEach(function(v){var p=u[v];if(!(p<s)){var g={nodes:[],edges:[]};g.nodes.push({id:"0",label:v}),l.push(g)}}),l},a.prototype.run=function(){var n=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var r=this.graphs,s=this.directed,l={};Object.keys(r).forEach(function(u){var h=r[u],f=h.nodeMap;h.nodes.forEach(function(d){var v=n.findForwardRootEdges(h,d);v.forEach(function(p){var g=f[p.to],y="".concat(d.label,"-").concat(p.label,"-").concat(g.label);l[y]||(l[y]={projected:[],nodeLabel1:d.label,edgeLabel:p.label,nodeLabel2:g.label});var m={graphId:u,edge:p,preNode:null};l[y].projected.push(m)})})}),Object.keys(l).forEach(function(u){var h=l[u],f=h.projected,d=h.nodeLabel1,v=h.edgeLabel,p=h.nodeLabel2;n.dfsCode.dfsEdgeList.push(new Qa(0,1,d,v,p)),n.subGraphMining(f),n.dfsCode.dfsEdgeList.pop()})}},a}(),vP=function(n,r,s,l){var u={};return Object.keys(n).forEach(function(h,f){var d=n[h],v=new Fm(f,!0,r),p={};d.nodes.forEach(function(g,y){v.addNode(y,g[s]),p[g.id]=y}),d.edges.forEach(function(g,y){var m=p[g.source],b=p[g.target];v.addEdge(-1,m,b,g[l])}),v&&v.getNodeNum()&&(u[v.id]=v)}),u},pP=function(n,r,s){var l=[];return n.forEach(function(u){var h={nodes:[],edges:[]};u.nodes.forEach(function(f){var d;h.nodes.push((d={id:"".concat(f.id)},d[r]=f.label,d))}),u.edges.forEach(function(f){var d;h.edges.push((d={source:"".concat(f.from),target:"".concat(f.to)},d[s]=f.label,d))}),l.push(h)}),l},Zm="cluster",gP=function(n){var r=n.graphs,s=n.directed,l=s===void 0?!1:s,u=n.nodeLabelProp,h=u===void 0?Zm:u,f=n.edgeLabelProp,d=f===void 0?Zm:f,v=vP(r,l,h,d),p=n.minSupport,g=n.maxNodeNum,y=n.minNodeNum,m=n.verbose,b=n.top,x={graphs:v,minSupport:p,maxNodeNum:g,minNodeNum:y,top:b,verbose:m,directed:l},E=new dP(x);E.run();var w=pP(E.frequentSubgraphs,h,d);return w},yP=gP,Gm=function(n,r,s,l){s===void 0&&(s="cluster"),l===void 0&&(l=2);var u=[],h=n.nodes;return r.forEach(function(f,d){u.push(Wm(h,f,d,s,l))}),u},Wm=function(n,r,s,l,u){var h=[s],f=[],d={};return r.forEach(function(v,p){if(v<=u&&s!==p){h.push(p),f.push(n[p]);var g=n[p][l];d[g]?(d[g].count++,d[g].dists.push(v)):d[g]={count:1,dists:[v]}}}),Object.keys(d).forEach(function(v){d[v].dists=d[v].dists.sort(function(p,g){return p-g})}),{nodeIdx:s,nodeId:n[s].id,nodeIdxs:h,neighbors:f,neighborNum:h.length-1,nodeLabelCountMap:d}},mP=function(n,r,s,l,u){var h=Math.ceil(s/r),f={},d=0;return l.forEach(function(v,p){for(var g=0,y=0,m=v.nodeIdxs,b=v.neighborNum-1;g<h;){for(var x=m[1+Math.floor(Math.random()*b)],E=0;(f["".concat(p,"-").concat(x)]||f["".concat(x,"-").concat(p)])&&(x=Math.floor(Math.random()*r),E++,!(E>2*r)););if(E<2*r&&(f["".concat(p,"-").concat(x)]={start:p,end:x,distance:u[p][x]},g++,d++,d>=s))return f;if(y++,y>2*r)break}if(g<h){var w=h-g;h=(h+w)/(r-p-1)}}),f},zu=function(n,r,s,l){var u=s.nodes;return l||(l={}),Object.keys(n).forEach(function(h){var f,d;if(!(l&&l[h])){l[h]={nodes:[],edges:[]};var v=n[h],p=(f=r[v.start])===null||f===void 0?void 0:f.nodeIdxs,g=(d=r[v.end])===null||d===void 0?void 0:d.nodeIdxs;if(!(!p||!g)){var y=new Set(g),m=p.filter(function(S){return y.has(S)});if(!(!m||!m.length)){for(var b={},x=m.length,E=0;E<x;E++){var w=u[m[E]];l[h].nodes.push(w),b[w.id]=!0}s.edges.forEach(function(S){b[S.source]&&b[S.target]&&l[h].edges.push(S)})}}}}),l},Zu=function(n,r,s,l){var u,h,f={};n.nodes.forEach(function(v){f[v.id]=v});var d=0;return!(!((u=r==null?void 0:r.edges)===null||u===void 0)&&u.length)||((h=r==null?void 0:r.nodes)===null||h===void 0?void 0:h.length)<2?0:(n.edges.forEach(function(v){var p=f[v.source][s],g=f[v.target][s],y=r==null?void 0:r.nodes[0][s],m=r==null?void 0:r.nodes[1][s],b=r==null?void 0:r.edges[0][l];v[l]===b&&(p===y&&g===m||p===m&&g===y)&&d++}),d)},bP=function(n,r,s){for(var l=1/0,u=0,h=function(v){var p=n[v],g=Object.keys(p).sort(function(S,M){return p[S]-p[M]}),y=10,m=[];g.forEach(function(S,M){m[M%y]||(m[M%y]={graphs:[],totalCount:0,aveCount:0}),m[M%y].graphs.push(S),m[M%y].totalCount+=p[S]});var b=0,x=[];m.forEach(function(S){var M=S.totalCount/S.graphs.length;S.aveCount=M,x.push(M);var C=0,T=S.length;S.graphs.forEach(function(O,k){var P=p[O];S.graphs.forEach(function(A,N){k!==N&&(C+=Math.abs(P-p[A]))})}),C/=T*(T-1)/2,b+=C}),b/=m.length;var E=0;x.forEach(function(S,M){x.forEach(function(C,T){M!==T&&(E+=Math.abs(S-C))}),E/=x.length*(x.length-1)/2});var w=E-b;l<w&&(l=w,u=v)},f=0;f<r;f++)h(f);return{structure:s[u],structureCountMap:n[u]}},jm=function(n,r){var s={},l={};return n.forEach(function(u,h){s[u.id]={idx:h,node:u,degree:0,inDegree:0,outDegree:0};var f=u[r];l[f]||(l[f]=[]),l[f].push(u)}),{nodeMap:s,nodeLabelMap:l}},Vm=function(n,r,s){var l={},u={};return n.forEach(function(h,f){l["".concat(fm)]={idx:f,edge:h};var d=h[r];u[d]||(u[d]=[]),u[d].push(h);var v=s[h.source];v&&(v.degree++,v.outDegree++);var p=s[h.target];p&&(p.degree++,p.inDegree++)}),{edgeMap:l,edgeLabelMap:u}},Hm=function(n,r,s){var l=r.length,u={};return r.forEach(function(h,f){for(var d=s?0:f+1,v=n[f].id,p=d;p<l;p++)if(f!==p){var g=n[p].id,y=h[p];u["".concat(v,"-").concat(g)]=y,s||(u["".concat(g,"-").concat(v)]=y)}}),u},xP=function(n,r,s,l,u,h,f,d,v,p,g){var y,m="".concat(r.id,"-").concat(s.id);if(p&&p[m])return p[m];var b=g?g[m]:void 0;if(!b){var x=(y={},y[m]={start:l[r.id].idx,end:l[s.id].idx,distance:u},y);g=zu(x,h,n,g),b=g[m]}return Zu(b,f,d,v)},$m=function(n,r,s,l){var u,h,f,d=(u=n[r])===null||u===void 0?void 0:u.degree,v=(h=n[r])===null||h===void 0?void 0:h.inDegree,p=(f=n[r])===null||f===void 0?void 0:f.outDegree;return n[r]===void 0&&(d=1/0,v=1/0,p=1/0,l[r].forEach(function(g){var y=s[g.id].degree;d>y&&(d=y);var m=s[g.id].inDegree;v>m&&(v=m);var b=s[g.id].outDegree;p>b&&(p=b)}),n[r]={degree:d,inDegree:v,outDegree:p}),{minPatternNodeLabelDegree:d,minPatternNodeLabelInDegree:v,minPatternNodeLabelOutDegree:p}},EP=function(n,r,s,l,u,h,f){var d;if(s===void 0&&(s=!1),h===void 0&&(h="cluster"),f===void 0&&(f="cluster"),!(!n||!n.nodes)){var v=n.nodes.length;if(v){var p=Fd(n,s),g=Fd(r,s),y=Hm(n.nodes,p,s),m=Hm(r.nodes,g,s),b=jm(n.nodes,h),x=b.nodeMap,E=b.nodeLabelMap,w=jm(r.nodes,h),S=w.nodeMap,M=w.nodeLabelMap;Vm(n.edges,f,x);var C=Vm(r.edges,f,S).edgeLabelMap,T=[];g==null||g.forEach(function(Xt){T=T.concat(Xt)}),u||(u=Math.max.apply(Math,(0,_.ev)((0,_.ev)([],T,!1),[2],!1))),l||(l=u);var O=Gm(n,p,h,l),k=Gm(r,g,h,l),P=Math.min(100,v*(v-1)/2),A=mP(l,v,P,O,p),N=zu(A,O,n),L=10,R=1,z=1,Z=4,X={graphs:N,nodeLabelProp:h,edgeLabelProp:f,minSupport:R,minNodeNum:z,maxNodeNum:Z,directed:s},nt=yP(X).slice(0,L),K=nt.length,rt=[];nt.forEach(function(Xt,he){rt[he]={},Object.keys(N).forEach(function(Qt){var oe=N[Qt],be=Zu(oe,Xt,h,f);rt[he][Qt]=be})});var U=bP(rt,K,nt),at=U.structure,ht=U.structureCountMap,pt=r.nodes[0],Ct=[],Zt=(d=r.nodes[0])===null||d===void 0?void 0:d[h],Nt=-1/0;r.nodes.forEach(function(Xt){var he=Xt[h],Qt=E[he];(Qt==null?void 0:Qt.length)>Nt&&(Nt=Qt.length,Ct=Qt,Zt=he,pt=Xt)});var Pt={},ie={},Kt={},re={},te={},ze={};Object.keys(M).forEach(function(Xt,he){te[Xt]=[],s&&(ze[Xt]=[]);var Qt=-1/0,oe=M[Xt],be={};oe.forEach(function(de){var ce=m["".concat(pt.id,"-").concat(de.id)];if(ce&&te[Xt].push(ce),Qt<ce&&(Qt=ce),be["".concat(pt.id,"-").concat(de.id)]={start:0,end:S[de.id].idx,distance:ce},s){var qe=m["".concat(de.id,"-").concat(pt.id)];qe&&ze[Xt].push(qe)}}),te[Xt]=te[Xt].sort(function(de,ce){return de-ce}),s&&(ze[Xt]=ze[Xt].sort(function(de,ce){return de-ce})),ie=zu(be,k,r,ie);var kt=[];if(Object.keys(be).forEach(function(de){if(Kt[de]){kt.push(Kt[de]);return}var ce=ie[de];Kt[de]=Zu(ce,at,h,f),kt.push(Kt[de])}),kt=kt.sort(function(de,ce){return ce-de}),re["".concat(pt.id,"-").concat(Xt)]=kt,Xt!==Zt)for(var le=(Ct==null?void 0:Ct.length)||0,fe=function(ce){var qe=Ct[ce],Sr=O[x[qe.id].idx],nn=Sr.nodeLabelCountMap[Xt],ws=M[Xt].length;if(!nn||nn.count<ws)return Ct.splice(ce,1),"continue";for(var po=!1,qn=0;qn<ws;qn++)if(nn.dists[qn]>te[Xt][qn]){po=!0;break}if(po)return Ct.splice(ce,1),"continue";var zr={};Sr.neighbors.forEach(function(Kn){var ai=y["".concat(qe.id,"-").concat(Kn.id)];zr["".concat(qe.id,"-").concat(Kn.id)]={start:x[qe.id].idx,end:x[Kn.id].idx,distance:ai}}),N=zu(zr,O,n,N);var _i=[];Object.keys(zr).forEach(function(Kn){if(ht[Kn]){_i.push(ht[Kn]);return}var ai=N[Kn];ht[Kn]=Zu(ai,at,h,f),_i.push(ht[Kn])}),_i=_i.sort(function(Kn,ai){return ai-Kn});for(var Aa=!1,qn=0;qn<ws;qn++)if(_i[qn]<kt[qn]){Aa=!0;break}if(Aa)return Ct.splice(ce,1),"continue"},fn=le-1;fn>=0;fn--)fe(fn)});var Yt=[];Ct==null||Ct.forEach(function(Xt){for(var he=x[Xt.id].idx,Qt=Wm(n.nodes,p[he],he,h,u),oe=Qt.neighbors,be=oe.length,kt=!1,le=be-1;le>=0;le--){if(oe.length+1<r.nodes.length){kt=!0;return}var fe=oe[le],fn=fe[h];if(!M[fn]||!M[fn].length){oe.splice(le,1);continue}if(!te[fn]||!te[fn].length){oe.splice(le,1);continue}var de="".concat(Xt.id,"-").concat(fe.id),ce=y[de],qe=te[fn].length-1,Sr=te[fn][qe];if(ce>Sr){oe.splice(le,1);continue}if(s){var nn="".concat(fe.id,"-").concat(Xt.id),ws=y[nn];qe=ze[fn].length-1;var po=ze[fn][qe];if(ws>po){oe.splice(le,1);continue}}var qn=ht[de]?ht[de]:xP(n,Xt,fe,x,ce,O,at,h,f,ht,N),zr="".concat(pt.id,"-").concat(fn),_i=re[zr][re[zr].length-1];if(qn<_i){oe.splice(le,1);continue}var Aa=$m(Pt,fn,S,M),Kn=Aa.minPatternNodeLabelDegree,ai=Aa.minPatternNodeLabelInDegree,Xi=Aa.minPatternNodeLabelOutDegree;if(x[fe.id].degree<Kn){oe.splice(le,1);continue}}kt||Yt.push({nodes:[Xt].concat(oe)})});var wr=Lu(r,pt.id,!1).length,zn={};s?(Object.keys(wr).forEach(function(Xt){var he=S[Xt].node[h];zn[he]?zn[he].push(wr[Xt]):zn[he]=[wr[Xt]]}),Object.keys(zn).forEach(function(Xt){zn[Xt].sort(function(he,Qt){return he-Qt})})):zn=te;for(var Pa=Yt.length,kn=function(he){var Qt=Yt[he],oe=Qt.nodes[0],be={},kt={};Qt.nodes.forEach(function(Ne,Mr){kt[Ne.id]={idx:Mr,node:Ne,degree:0,inDegree:0,outDegree:0};var gn=Ne[h];be[gn]?be[gn]++:be[gn]=1});var le=[],fe={};n.edges.forEach(function(Ne){kt[Ne.source]&&kt[Ne.target]&&(le.push(Ne),fe[Ne[f]]?fe[Ne[f]]++:fe[Ne[f]]=1,kt[Ne.source].degree++,kt[Ne.target].degree++,kt[Ne.source].outDegree++,kt[Ne.target].inDegree++)});for(var fn=Object.keys(C).length,de=!1,ce=0;ce<fn;ce++){var qe=Object.keys(C)[ce];if(!fe[qe]||fe[qe]<C[qe].length){de=!0;break}}if(de)return Yt.splice(he,1),"continue";var Sr=le.length;if(Sr<r.edges.length)return Yt.splice(he,1),"break";for(var nn=!1,ws=function(Mr){var gn=le[Mr],Pi=gn[f],Ss=C[Pi];if(!Ss||!Ss.length)return fe[Pi]--,Ss&&fe[Pi]<Ss.length?(nn=!0,"break"):(le.splice(Mr,1),kt[gn.source].degree--,kt[gn.target].degree--,kt[gn.source].outDegree--,kt[gn.target].inDegree--,"continue");var K2=kt[gn.source].node[h],Q2=kt[gn.target].node[h],fp=!1;if(Ss.forEach(function(J2){var tw=S[J2.source].node,ew=S[J2.target].node;tw[h]===K2&&ew[h]===Q2&&(fp=!0),!s&&tw[h]===Q2&&ew[h]===K2&&(fp=!0)}),!fp)return fe[Pi]--,Ss&&fe[Pi]<Ss.length?(nn=!0,"break"):(le.splice(Mr,1),kt[gn.source].degree--,kt[gn.target].degree--,kt[gn.source].outDegree--,kt[gn.target].inDegree--,"continue")},ce=Sr-1;ce>=0;ce--){var po=ws(ce);if(po==="break")break}if(nn)return Yt.splice(he,1),"continue";Qt.edges=le;var qn=Lu(Qt,Qt.nodes[0].id,!1).length;if(Object.keys(qn).reverse().forEach(function(Ne){if(!(Ne===Qt.nodes[0].id||nn)){if(qn[Ne]===1/0){var Mr=kt[Ne].node[h];if(be[Mr]--,be[Mr]<M[Mr].length){nn=!0;return}var gn=Qt.nodes.indexOf(kt[Ne].node);Qt.nodes.splice(gn,1),kt[Ne]=void 0;return}var Pi=x[Ne].node[h];if(!zn[Pi]||!zn[Pi].length||qn[Ne]>zn[Pi][zn[Pi].length-1]){var Mr=kt[Ne].node[h];if(be[Mr]--,be[Mr]<M[Mr].length){nn=!0;return}var gn=Qt.nodes.indexOf(kt[Ne].node);Qt.nodes.splice(gn,1),kt[Ne]=void 0}}}),nn)return Yt.splice(he,1),"continue";for(var zr=!0,_i=0;zr&&!nn;){zr=!1;var Aa=s?kt[oe.id].degree<S[pt.id].degree||kt[oe.id].inDegree<S[pt.id].inDegree||kt[oe.id].outDegree<S[pt.id].outDegree:kt[oe.id].degree<S[pt.id].degree;if(Aa){nn=!0;break}if(be[oe[h]]<M[oe[h]].length){nn=!0;break}for(var Kn=Qt.nodes.length,ai=Kn-1;ai>=0;ai--){var Xi=Qt.nodes[ai],X2=kt[Xi.id].degree,zF=kt[Xi.id].inDegree,ZF=kt[Xi.id].outDegree,GF=Xi[h],hp=$m(Pt,GF,S,M),q2=hp.minPatternNodeLabelDegree,WF=hp.minPatternNodeLabelInDegree,jF=hp.minPatternNodeLabelOutDegree,VF=s?X2<q2||zF<WF||ZF<jF:X2<q2;if(VF){if(be[Xi[h]]--,be[Xi[h]]<M[Xi[h]].length){nn=!0;break}Qt.nodes.splice(ai,1),kt[Xi.id]=void 0,zr=!0}}if(nn||!zr&&_i!==0)break;Sr=le.length;for(var bf=Sr-1;bf>=0;bf--){var qi=le[bf];if(!kt[qi.source]||!kt[qi.target]){le.splice(bf,1);var xf=qi[f];if(fe[xf]--,kt[qi.source]&&(kt[qi.source].degree--,kt[qi.source].outDegree--),kt[qi.target]&&(kt[qi.target].degree--,kt[qi.target].inDegree--),C[xf]&&fe[xf]<C[xf].length){nn=!0;break}zr=!0}}_i++}if(nn||nn||Qt.nodes.length<r.nodes.length||le.length<r.edges.length)return Yt.splice(he,1),"continue"},En=Pa-1;En>=0;En--){var Yi=kn(En);if(Yi==="break")break}for(var _n=Yt.length,ur=function(he){var Qt=Yt[he],oe={};Qt.edges.forEach(function(le){var fe="".concat(le.source,"-").concat(le.target,"-").concat(le.label);oe[fe]?oe[fe]++:oe[fe]=1});for(var be=function(fe){var fn=Yt[fe],de={};fn.edges.forEach(function(qe){var Sr="".concat(qe.source,"-").concat(qe.target,"-").concat(qe.label);de[Sr]?de[Sr]++:de[Sr]=1});var ce=!0;Object.keys(de).length!==Object.keys(oe).length?ce=!1:Object.keys(oe).forEach(function(qe){de[qe]!==oe[qe]&&(ce=!1)}),ce&&Yt.splice(fe,1)},kt=_n-1;kt>he;kt--)be(kt);_n=Yt.length},En=0;En<=_n-1;En++)ur(En);return Yt}}},wP=EP,SP=function(){function a(n){n===void 0&&(n=10),this.linkedList=new hm,this.maxStep=n}return Object.defineProperty(a.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),a.prototype.isEmpty=function(){return!this.linkedList.head},a.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},a.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},a.prototype.push=function(n){this.linkedList.prepend(n),this.length>this.maxStep&&this.linkedList.deleteTail()},a.prototype.pop=function(){var n=this.linkedList.deleteHead();return n?n.value:null},a.prototype.toArray=function(){return this.linkedList.toArray().map(function(n){return n.value})},a.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},a}(),MP=SP,TP=bm,Z7={getAdjMatrix:_u,breadthFirstSearch:i_,connectedComponent:vm,getDegree:Pd,getInDegree:s_,getOutDegree:o_,detectCycle:bm,detectDirectedCycle:TP,detectAllCycles:u_,detectAllDirectedCycle:mm,detectAllUndirectedCycle:ym,depthFirstSearch:gm,dijkstra:Lu,findAllPath:B_,findShortestPath:Bd,floydWarshall:Fd,labelPropagation:Z_,louvain:Pm,iLouvain:Y_,kCore:q_,kMeans:Q_,cosineSimilarity:Nm,nodesCosineSimilarity:eP,minimumSpanningTree:cP,pageRank:Lm,getNeighbors:Nr,Stack:MP,GADDI:wP};function V(a){if(a.id!==void 0)return a.id;if(a.source!==void 0&&a.target!==void 0)return`${a.source}-${a.target}`;throw new Error(Ii("The datum does not have available id."))}function Gu(a){return a.combo}function Um(a,n){const r={nodes:(a.nodes||[]).map(V),edges:(a.edges||[]).map(V),combos:(a.combos||[]).map(V)};return n?Object.values(r).flat():r}const Ym=(a,n,r)=>{var s;switch(r.type){case"degree":{const l=new Map;return(s=a.nodes)===null||s===void 0||s.forEach(u=>{const h=n(V(u),r.direction).length;l.set(V(u),h)}),l}case"betweenness":return CP(a,r.directed,r.weightPropertyName);case"closeness":return OP(a,r.directed,r.weightPropertyName);case"eigenvector":return _P(a,r.directed);case"pagerank":return kP(a,r.epsilon,r.linkProb);default:return Xm(a)}},Xm=a=>{var n;const r=new Map;return(n=a.nodes)===null||n===void 0||n.forEach(s=>{r.set(V(s),0)}),r},CP=(a,n,r)=>{const s=Xm(a),{nodes:l=[]}=a;return l.forEach(u=>{l.forEach(h=>{if(u!==h){const{allPath:f}=Bd(a,V(u),V(h),n,r),d=f.length;f.flat().forEach(v=>{v!==V(u)&&v!==V(h)&&s.set(v,s.get(v)+1/d)})}})}),s},OP=(a,n,r)=>{const s=new Map,{nodes:l=[]}=a;return l.forEach(u=>{const h=l.reduce((f,d)=>{if(u!==d){const{length:v}=Bd(a,V(u),V(d),n,r);f+=v}return f},0);s.set(V(u),1/h)}),s},kP=(a,n,r)=>{var s;const l=new Map,u=Lm(a,n,r);return(s=a.nodes)===null||s===void 0||s.forEach(h=>{l.set(V(h),u[V(h)])}),l},_P=(a,n)=>{const{nodes:r=[]}=a,s=PP(a,n),l=AP(s,r.length),u=new Map;return r.forEach((h,f)=>{u.set(V(h),l[f])}),u},PP=(a,n)=>{const{nodes:r=[],edges:s=[]}=a,l=Array(r.length).fill(null).map(()=>Array(r.length).fill(0));return s.forEach(({source:u,target:h})=>{const f=r.findIndex(v=>V(v)===u),d=r.findIndex(v=>V(v)===h);n?l[f][d]=1:(l[f][d]=1,l[d][f]=1)}),l},AP=(a,n,r=100,s=1e-6)=>{let l=Array(n).fill(1),u=1/0;for(let h=0;h<r&&u>s;h++){const f=Array(n).fill(0);for(let v=0;v<n;v++)for(let p=0;p<n;p++)f[v]+=a[v][p]*l[p];const d=Math.sqrt(f.reduce((v,p)=>v+p*p,0));for(let v=0;v<n;v++)f[v]/=d;u=Math.sqrt(f.reduce((v,p,g)=>v+(p-l[g])*p,0)),l=f}return l};function ha(a,n,r,s=Je){const l=new Map(a.map(y=>[r(y),y])),u=new Map(n.map(y=>[r(y),y])),h=new Set(l.keys()),f=new Set(u.keys()),d=[],v=[],p=[],g=[];return f.forEach(y=>{h.has(y)?s(l.get(y),u.get(y))?g.push(u.get(y)):v.push(u.get(y)):d.push(u.get(y))}),h.forEach(y=>{f.has(y)||p.push(l.get(y))}),{enter:d,exit:p,keep:g,update:v}}function fa(a,n,r){const s=l=>{r&&!r(l)||(l.style.visibility=n)};a.forEach(l=>{s(l)})}function NP(a,n,r){const s={},l=u=>(u in s||(s[u]=0),`${n}-${u}-${s[u]++}`);return r.map(u=>typeof u=="string"?{type:u,key:l(u)}:typeof u=="function"?u.call(a):u.key?u:Object.assign(Object.assign({},u),{key:l(u.type)}))}class Gd{constructor(n){this.extensions=[],this.extensionMap={},this.context=n}setExtensions(n){const r=NP(this.context.graph,this.category,n),{enter:s,update:l,exit:u,keep:h}=ha(this.extensions,r,f=>f.key);this.createExtensions(s),this.updateExtensions([...l,...h]),this.destroyExtensions(u),this.extensions=r}createExtension(n){const{category:r}=this,{key:s,type:l}=n,u=mi(r,l);if(!u)return ar.warn(`The extension ${l} of ${r} is not registered.`);const h=new u(this.context,n);h.initialized=!0,this.extensionMap[s]=h}createExtensions(n){n.forEach(r=>this.createExtension(r))}updateExtension(n){const{key:r}=n,s=this.extensionMap[r];s&&s.update(n)}updateExtensions(n){n.forEach(r=>this.updateExtension(r))}destroyExtension(n){const r=this.extensionMap[n];r&&(r.initialized&&!r.destroyed&&r.destroy(),delete this.extensionMap[n])}destroyExtensions(n){n.forEach(({key:r})=>this.destroyExtension(r))}destroy(){this.destroyExtensions(this.extensions),this.context={},this.extensions=[],this.extensionMap={}}}class Wd{constructor(n,r){this.events=[],this.initialized=!1,this.destroyed=!1,this.context=n,this.options=r}update(n){this.options=Object.assign(this.options,n)}destroy(){this.context={},this.options={},this.destroyed=!0}}class sr extends Wd{}class Ko extends sr{constructor(n,r){super(n,Object.assign({},Ko.defaultOptions,r)),this.isOverlapping=(s,l)=>l.some(u=>s.intersects(u)),this.occupiedBounds=[],this.detectLabelCollision=s=>{const l=this.context.viewport,u={show:[],hide:[]};return this.occupiedBounds=[],s.forEach(h=>{const f=h.getShape("label").getRenderBounds();l.isInViewport(f,!0)&&!this.isOverlapping(f,this.occupiedBounds)?(u.show.push(h),this.occupiedBounds.push(ua(f,this.options.padding))):u.hide.push(h)}),u},this.hideLabelIfExceedViewport=(s,l)=>{const{exit:u}=ha(s,l,h=>h.id);u==null||u.forEach(this.hideLabel)},this.nodeCentralities=new Map,this.sortNodesByCentrality=(s,l)=>{const{model:u}=this.context,h=u.getData(),f=u.getRelatedEdgesData.bind(u);return s.map(v=>(this.nodeCentralities.has(v.id)||(this.nodeCentralities=Ym(h,f,l)),{node:v,centrality:this.nodeCentralities.get(v.id)})).sort((v,p)=>p.centrality-v.centrality).map(v=>v.node)},this.sortLabelElementsInView=s=>{const{sort:l,sortNode:u,sortCombo:h,sortEdge:f}=this.options,{model:d}=this.context;if((0,_t.Z)(l))return s.sort((x,E)=>l(d.getElementDataById(x.id),d.getElementDataById(E.id)));const{node:v=[],edge:p=[],combo:g=[]}=Cu(s,x=>x.type),y=(0,_t.Z)(h)?g.sort((x,E)=>h(...d.getComboData([x.id,E.id]))):g,m=(0,_t.Z)(u)?v.sort((x,E)=>u(...d.getNodeData([x.id,E.id]))):this.sortNodesByCentrality(v,u),b=(0,_t.Z)(f)?p.sort((x,E)=>f(...d.getEdgeData([x.id,E.id]))):p;return[...y,...m,...b]},this.labelElementsInView=[],this.isFirstRender=!0,this.onToggleVisibility=s=>{var l;if(((l=s.data)===null||l===void 0?void 0:l.stage)==="zIndex")return;if(!this.validate(s)){this.hiddenElements.size>0&&(this.hiddenElements.forEach(this.showLabel),this.hiddenElements.clear());return}const u=this.isFirstRender?this.getLabelElements():this.getLabelElementsInView();this.hideLabelIfExceedViewport(this.labelElementsInView,u),this.labelElementsInView=u;const h=this.sortLabelElementsInView(this.labelElementsInView),{show:f,hide:d}=this.detectLabelCollision(h);for(let v=f.length-1;v>=0;v--)this.showLabel(f[v]);d.forEach(this.hideLabel)},this.hiddenElements=new Map,this.hideLabel=s=>{const l=s.getShape("label");l&&fa(l,"hidden"),this.hiddenElements.set(s.id,s)},this.showLabel=s=>{const l=s.getShape("label");l&&fa(l,"visible"),s.toFront(),this.hiddenElements.delete(s.id)},this.onTransform=lm(this.onToggleVisibility,this.options.throttle,{leading:!0}),this.enableToggle=!0,this.toggle=s=>{this.enableToggle&&this.onToggleVisibility(s)},this.onBeforeRender=()=>{this.enableToggle=!1},this.onAfterRender=s=>{this.onToggleVisibility(s),this.enableToggle=!0},this.bindEvents()}update(n){this.unbindEvents(),super.update(n),this.bindEvents(),this.onToggleVisibility({})}getLabelElements(){const{elementMap:n}=this.context.element,r=[];for(const s in n){const l=n[s];l.isVisible()&&l.getShape("label")&&r.push(l)}return r}getLabelElementsInView(){const n=this.context.viewport;return this.getLabelElements().filter(r=>n.isInViewport(r.getShape("key").getRenderBounds()))}bindEvents(){const{graph:n}=this.context;n.on(lt.BEFORE_RENDER,this.onBeforeRender),n.on(lt.AFTER_RENDER,this.onAfterRender),n.on(lt.AFTER_DRAW,this.toggle),n.on(lt.AFTER_LAYOUT,this.toggle),n.on(lt.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:n}=this.context;n.off(lt.BEFORE_RENDER,this.onBeforeRender),n.off(lt.AFTER_RENDER,this.onAfterRender),n.off(lt.AFTER_DRAW,this.toggle),n.off(lt.AFTER_LAYOUT,this.toggle),n.off(lt.AFTER_TRANSFORM,this.onTransform)}validate(n){if(this.destroyed)return!1;const{enable:r}=this.options;return(0,_t.Z)(r)?r(n):!!r}destroy(){this.unbindEvents(),super.destroy()}}Ko.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:"degree"}};var jn=Y(83787);const qm=[0,0,0];function Gt(a,n){return a.map((r,s)=>r+n[s])}function Te(a,n){return a.map((r,s)=>r-n[s])}function Yr(a,n){return typeof n=="number"?a.map(r=>r*n):a.map((r,s)=>r*n[s])}function Xr(a,n){return typeof n=="number"?a.map(r=>r/n):a.map((r,s)=>r/n[s])}function RP(a,n){return a.reduce((r,s,l)=>r+s*n[l],0)}function LP(a,n){const r=Qo(a),s=Qo(n);return[r[1]*s[2]-r[2]*s[1],r[2]*s[0]-r[0]*s[2],r[0]*s[1]-r[1]*s[0]]}function da(a,n){return a.map(r=>r*n)}function Ae(a,n){return Math.sqrt(a.reduce((r,s,l)=>r+Math.pow(s-n[l]||0,2),0))}function Wu(a,n){return a.reduce((r,s,l)=>r+Math.abs(s-n[l]),0)}function Bi(a){const n=a.reduce((r,s)=>r+Math.pow(s,2),0);return a.map(r=>r/Math.sqrt(n))}function jd(a,n,r=!1){const s=a[0]*n[1]-a[1]*n[0];let l=Math.acos(Yr(a,n).reduce((u,h)=>u+h,0)/(Ae(a,qm)*Ae(n,qm)));return r&&s<0&&(l=2*Math.PI-l),l}function G7(a,n){return a.every((r,s)=>r===n[s])}function ju(a,n=!0){return n?[-a[1],a[0]]:[a[1],-a[0]]}function Vd(a,n){return a.map(r=>r%n)}function Ja(a){return[a[0],a[1]]}function Qo(a){return jk(a)?[a[0],a[1],0]:a}function Km(a){const[n,r]=a;return!n&&!r?0:Math.atan2(r,n)}function Qm(a,n){const[r,s]=a;if(n%360===0)return[r,s];const l=n*Math.PI/180,u=Math.cos(l),h=Math.sin(l);return[r*u-s*h,r*h+s*u]}function Jm(a,n){const[r,s]=a,[l,u]=n,h=Te(r,s),f=Te(l,u);return LP(h,f).every(d=>d===0)}function Hd(a,n,r=!1){if(Jm(a,n))return;const[s,l]=a,[u,h]=n,f=((s[0]-u[0])*(u[1]-h[1])-(s[1]-u[1])*(u[0]-h[0]))/((s[0]-l[0])*(u[1]-h[1])-(s[1]-l[1])*(u[0]-h[0])),d=h[0]-u[0]?(s[0]-u[0]+f*(l[0]-s[0]))/(h[0]-u[0]):(s[1]-u[1]+f*(l[1]-s[1]))/(h[1]-u[1]);if(!(!r&&(!bi(f,0,1)||!bi(d,0,1))))return[s[0]+f*(l[0]-s[0]),s[1]+f*(l[1]-s[1])]}function t1(a){if(Array.isArray(a))return bi(a[0],0,1)&&bi(a[1],0,1)?a:[.5,.5];const n=a.split("-"),r=n.includes("left")?0:n.includes("right")?1:.5,s=n.includes("top")?0:n.includes("bottom")?1:.5;return[r,s]}function Fe(a){const{x:n=0,y:r=0,z:s=0}=a.style||{};return[+n,+r,+s]}function DP(a){const{x:n,y:r,z:s}=a.style||{};return n!==void 0||r!==void 0||s!==void 0}function e1(a,n){const[r,s]=n,{min:l,max:u}=a;return[l[0]+r*(u[0]-l[0]),l[1]+s*(u[1]-l[1])]}function Fi(a,n="center"){const r=t1(n);return e1(a,r)}function W7(a,n){const r=parseAnchor(n);return e1(a,r)}const j7=a=>{const[n,r]=a;return{left:Math.min(n[0],r[0]),right:Math.max(n[0],r[0]),top:Math.min(n[1],r[1]),bottom:Math.max(n[1],r[1])}};function Mn(a){var n;return[a.x,a.y,(n=a.z)!==null&&n!==void 0?n:0]}function qr(a){var n;return{x:a[0],y:a[1],z:(n=a[2])!==null&&n!==void 0?n:0}}function V7(a){return a.sort((n,r)=>n[0]-r[0]||n[1]-r[1])}function H7(a){const n=new Set;return a.filter(r=>{const s=r.join(",");return n.has(s)?!1:(n.add(s),!0)})}function Jo(a,n=0){return a.map(r=>parseFloat(r.toFixed(n)))}function va(a,n,r,s=!1){if(Je(a,n))return a;const l=s?Te(a,n):Te(n,a),u=Bi(l),h=[u[0]*r,u[1]*r];return Gt(Ja(a),h)}function n1(a,n){return a[1]===n[1]}function IP(a,n){return a[0]===n[0]}function BP(a,n){return n1(a,n)||IP(a,n)}function r1(a,n,r){return Jm([a,n],[n,r])}function i1(a,n){return[2*n[0]-a[0],2*n[1]-a[1]]}function a1(a,n,r,s=!0,l=!1){for(let u=0;u<r.length;u++){let h=r[u],f=r[(u+1)%r.length];s&&(h=Gt(n,h),f=Gt(n,f));const d=l?i1(a,n):a,v=Hd([n,d],[h,f]);if(v)return{point:v,line:[h,f]}}return{point:n,line:void 0}}function FP(a,n,r,s){const l=a[0],u=a[1];let h=!1;r===void 0&&(r=0),s===void 0&&(s=n.length);const f=s-r;for(let d=0,v=f-1;d<f;v=d++){const p=n[d+r][0],g=n[d+r][1],y=n[v+r][0],m=n[v+r][1];g>u!=m>u&&l<(y-p)*(u-g)/(m-g)+p&&(h=!h)}return h}function zP(a,n,r=!1){const s=Fi(n,"center"),l=[Fi(n,"left-top"),Fi(n,"right-top"),Fi(n,"right-bottom"),Fi(n,"left-bottom")];return a1(a,s,l,!1,r).point}function Vu(a,n,r=!1){const s=n.center,l=r?i1(a,s):a,u=Te(l,n.center),h=Math.atan2(u[1],u[0]);if(isNaN(h))return s;const f=xi(n)/2,d=Ei(n)/2,v=s[0]+f*Math.cos(h),p=s[1]+d*Math.sin(h);return[v,p]}function ZP(a,n){let r=1/0,s=[a[0],n[0]];return a.forEach(l=>{n.forEach(u=>{const h=Ae(l,u);h<r&&(r=h,s=[l,u])})}),s}function GP(a,n){let r=1/0,s=[[0,0],[0,0]];return n.forEach(l=>{const u=WP(a,l);u<r&&(r=u,s=l)}),s}function WP(a,n){const r=s1(a,n);return Ae(a,r)}function s1(a,n){const[r,s]=n[0],[l,u]=n[1],[h,f]=a,d=l-r,v=u-s;if(d===0&&v===0)return[r,s];let p=((h-r)*d+(f-s)*v)/(d*d+v*v);p>1?p=1:p<0&&(p=0);const g=r+p*d,y=s+p*v;return[g,y]}function jP(a){const n=a.reduce((r,s)=>Gt(r,s),[0,0]);return Xr(n,a.length)}function $d(a,n=!0){const r=jP(a);return a.sort(([s,l],[u,h])=>{const f=Math.atan2(l-r[1],s-r[0]),d=Math.atan2(h-r[1],u-r[0]);return n?d-f:f-d})}function o1(a,n){return[a,[a[0],n[1]],n,[n[0],a[1]]]}class tn{constructor(n,r,s){if(this.phase=r,this.pointerByTouch=[],this.initialDistance=null,this.emitter=n,tn.instance)return tn.callbacks[this.phase].push(s),tn.instance;this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.bindEvents(),tn.instance=this,tn.callbacks[this.phase].push(s)}bindEvents(){const{emitter:n}=this;n.on(tt.POINTER_DOWN,this.onPointerDown),n.on(tt.POINTER_MOVE,this.onPointerMove),n.on(tt.POINTER_UP,this.onPointerUp)}updatePointerPosition(n,r,s){const l=this.pointerByTouch.findIndex(u=>u.pointerId===n);l>=0&&(this.pointerByTouch[l]={x:r,y:s,pointerId:n})}onPointerDown(n){const{x:r,y:s}=n.client||{};if(!(r===void 0||s===void 0)&&(this.pointerByTouch.push({x:r,y:s,pointerId:n.pointerId}),n.pointerType==="touch"&&this.pointerByTouch.length===2)){tn.isPinching=!0;const l=this.pointerByTouch[0].x-this.pointerByTouch[1].x,u=this.pointerByTouch[0].y-this.pointerByTouch[1].y;this.initialDistance=Math.sqrt(l*l+u*u),tn.callbacks.pinchstart.forEach(h=>h(n,{scale:0}))}}onPointerMove(n){if(this.pointerByTouch.length!==2||this.initialDistance===null)return;const{x:r,y:s}=n.client||{};if(r===void 0||s===void 0)return;this.updatePointerPosition(n.pointerId,r,s);const l=this.pointerByTouch[0].x-this.pointerByTouch[1].x,u=this.pointerByTouch[0].y-this.pointerByTouch[1].y,f=Math.sqrt(l*l+u*u)/this.initialDistance;tn.callbacks.pinchmove.forEach(d=>d(n,{scale:(f-1)*5}))}onPointerUp(n){var r;tn.callbacks.pinchend.forEach(s=>s(n,{scale:0})),tn.isPinching=!1,this.initialDistance=null,this.pointerByTouch=[],(r=tn.instance)===null||r===void 0||r.tryDestroy()}destroy(){this.emitter.off(tt.POINTER_DOWN,this.onPointerDown),this.emitter.off(tt.POINTER_MOVE,this.onPointerMove),this.emitter.off(tt.POINTER_UP,this.onPointerUp),tn.instance=null}off(n,r){const s=tn.callbacks[n].indexOf(r);s>-1&&tn.callbacks[n].splice(s,1),this.tryDestroy()}tryDestroy(){Object.values(tn.callbacks).every(n=>n.length===0)&&this.destroy()}}tn.isPinching=!1,tn.instance=null,tn.callbacks={pinchstart:[],pinchmove:[],pinchend:[]};const l1=a=>a.map(n=>(0,ve.Z)(n)?n.toLocaleLowerCase():n);class ts{constructor(n){this.map=new Map,this.boundHandlePinch=()=>{},this.recordKey=new Set,this.onKeyDown=r=>{r!=null&&r.key&&(this.recordKey.add(r.key),this.trigger(r))},this.onKeyUp=r=>{r!=null&&r.key&&this.recordKey.delete(r.key)},this.onWheel=r=>{this.triggerExtendKey(tt.WHEEL,r)},this.onDrag=r=>{this.triggerExtendKey(tt.DRAG,r)},this.handlePinch=(r,s)=>{this.triggerExtendKey(tt.PINCH,Object.assign(Object.assign({},r),s))},this.onFocus=()=>{this.recordKey.clear()},this.emitter=n,this.bindEvents()}bind(n,r){n.length!==0&&(n.includes(tt.PINCH)&&!this.pinchHandler&&(this.boundHandlePinch=this.handlePinch.bind(this),this.pinchHandler=new tn(this.emitter,"pinchmove",this.boundHandlePinch)),this.map.set(n,r))}unbind(n,r){this.map.forEach((s,l)=>{Je(l,n)&&(!r||r===s)&&this.map.delete(l)})}unbindAll(){this.map.clear()}match(n){const r=l1(Array.from(this.recordKey)).sort(),s=l1(n).sort();return Je(r,s)}bindEvents(){var n;const{emitter:r}=this;r.on(tt.KEY_DOWN,this.onKeyDown),r.on(tt.KEY_UP,this.onKeyUp),r.on(tt.WHEEL,this.onWheel),r.on(tt.DRAG,this.onDrag),(n=globalThis.addEventListener)===null||n===void 0||n.call(globalThis,"focus",this.onFocus)}trigger(n){this.map.forEach((r,s)=>{this.match(s)&&r(n)})}triggerExtendKey(n,r){this.map.forEach((s,l)=>{l.includes(n)&&Je(Array.from(this.recordKey),l.filter(u=>u!==n))&&s(r)})}destroy(){var n,r;this.unbindAll(),this.emitter.off(tt.KEY_DOWN,this.onKeyDown),this.emitter.off(tt.KEY_UP,this.onKeyUp),this.emitter.off(tt.WHEEL,this.onWheel),this.emitter.off(tt.DRAG,this.onDrag),(n=this.pinchHandler)===null||n===void 0||n.off("pinchmove",this.boundHandlePinch),(r=globalThis.removeEventListener)===null||r===void 0||r.call(globalThis,"blur",this.onFocus)}}class Zs extends sr{constructor(n,r){super(n,(0,jn.Z)({},Zs.defaultOptions,r)),this.shortcut=new ts(n.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(n){if(!this.validate(n)||!this.isKeydown()||this.startPoint)return;const{canvas:r,graph:s}=this.context,l=Object.assign({},this.options.style);this.options.style.lineWidth&&(l.lineWidth=+this.options.style.lineWidth/s.getZoom()),this.rectShape=new Sn({id:"g6-brush-select",style:l}),r.appendChild(this.rectShape),this.startPoint=[n.canvas.x,n.canvas.y]}onPointerMove(n){var r;if(!this.startPoint)return;const{immediately:s,mode:l}=this.options;this.endPoint=Hu(n,this.context.graph),(r=this.rectShape)===null||r===void 0||r.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),s&&l==="default"&&this.updateElementsStates(o1(this.startPoint,this.endPoint))}onPointerUp(n){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=Hu(n,this.context.graph),this.updateElementsStates(o1(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:n}=this.context,r=Object.values(n.getData()).reduce((s,l)=>Object.assign({},s,l.reduce((u,h)=>{var f;const d=(f=h.states||[])===null||f===void 0?void 0:f.filter(v=>v!==this.options.state);return u[V(h)]=d,u},{})),{});n.setElementState(r,this.options.animation)}updateElementsStates(n){const{graph:r}=this.context,{enableElements:s,state:l,mode:u,onSelect:h}=this.options,f=this.selector(r,n,s);let d={};switch(u){case"union":f.forEach(v=>{d[v]=[...r.getElementState(v),l]});break;case"diff":f.forEach(v=>{const p=r.getElementState(v);d[v]=p.includes(l)?p.filter(g=>g!==l):[...p,l]});break;case"intersect":f.forEach(v=>{const p=r.getElementState(v);d[v]=p.includes(l)?[l]:[]});break;case"default":default:f.forEach(v=>{d[v]=[l]});break}(0,_t.Z)(h)&&(d=h(d)),r.setElementState(d,this.options.animation)}selector(n,r,s){if(!s||s.length===0)return[];const l=[],u=n.getData();if(s.forEach(h=>{u[`${h}s`].forEach(f=>{const d=V(f);n.getElementVisibility(d)!=="hidden"&&FP(n.getElementPosition(d),r)&&l.push(d)})}),s.includes("edge")){const h=u.edges;h==null||h.forEach(f=>{const{source:d,target:v}=f;l.includes(d)&&l.includes(v)&&l.push(V(f))})}return l}clearBrush(){var n;(n=this.rectShape)===null||n===void 0||n.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:n}=this.options,r=Array.isArray(n)?n:[n];return this.shortcut.match(r.filter(s=>s!=="drag"))}validate(n){if(this.destroyed)return!1;const{enable:r}=this.options;return(0,_t.Z)(r)?r(n):!!r}bindEvents(){const{graph:n}=this.context;n.on(tt.POINTER_DOWN,this.onPointerDown),n.on(tt.POINTER_MOVE,this.onPointerMove),n.on(tt.POINTER_UP,this.onPointerUp),n.on(yi.CLICK,this.clearStates)}unbindEvents(){const{graph:n}=this.context;n.off(tt.POINTER_DOWN,this.onPointerDown),n.off(tt.POINTER_MOVE,this.onPointerMove),n.off(tt.POINTER_UP,this.onPointerUp),n.off(yi.CLICK,this.clearStates)}update(n){this.unbindEvents(),this.options=(0,jn.Z)(this.options,n),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}Zs.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};const Hu=(a,n)=>{if((a.targetType==="node"||a.targetType==="combo")&&!(a.nativeEvent.target instanceof HTMLCanvasElement)){const[r,s]=n.getCanvasByClient([a.client.x,a.client.y]);return[r,s]}return[a.canvas.x,a.canvas.y]},zi=.8,es=["node","edge","combo"];function ns(a,n,r,s,l=0){s==="TB"&&n(a,l);const u=r(a);if(u)for(const h of u)ns(h,n,r,s,l+1);s==="BT"&&n(a,l)}function VP(a,n,r){const s=[[a,0]];for(;s.length;){const[l,u]=s.shift();n(l,u);const h=r(l);if(h)for(const f of h)s.push([f,u+1])}}function c1(a,n,r,s,l="both"){if(n==="combo"||n==="node")return Ud(a,r,s,l);const u=a.getEdgeData(r);if(!u)return[];const h=Ud(a,u.source,s-1,l),f=Ud(a,u.target,s-1,l);return Array.from(new Set([...h,...f,r]))}function Ud(a,n,r,s="both"){const l=new Set,u=new Set,h=new Set;return VP(n,(f,d)=>{d>r||(h.add(f),a.getRelatedEdgesData(f,s).forEach(v=>{const p=V(v);!u.has(p)&&d<r&&(h.add(p),u.add(p))}))},f=>a.getRelatedEdgesData(f,s).map(d=>d.source===f?d.target:d.source).filter(d=>l.has(d)?!1:(l.add(d),!0))),Array.from(h)}function Yd(a){return a.states||[]}var $u=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class tl extends sr{constructor(n,r){super(n,Object.assign({},tl.defaultOptions,r)),this.onClickSelect=s=>$u(this,void 0,void 0,function*(){var l,u;this.validate(s)&&(yield this.updateState(s),(u=(l=this.options).onClick)===null||u===void 0||u.call(l,s))}),this.onClickCanvas=s=>$u(this,void 0,void 0,function*(){var l,u;this.validate(s)&&(yield this.clearState(),(u=(l=this.options).onClick)===null||u===void 0||u.call(l,s))}),this.shortcut=new ts(n.graph),this.bindEvents()}bindEvents(){const{graph:n}=this.context;this.unbindEvents(),es.forEach(r=>{n.on(`${r}:${tt.CLICK}`,this.onClickSelect)}),n.on(yi.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:n,trigger:r}=this.options;return n&&this.shortcut.match(r)}getNeighborIds(n){const{target:r,targetType:s}=n,{graph:l}=this.context,{degree:u}=this.options;return c1(l,s,r.id,typeof u=="function"?u(n):u).filter(h=>h!==r.id)}updateState(n){return $u(this,void 0,void 0,function*(){const{state:r,unselectedState:s,neighborState:l,animation:u}=this.options;if(!r&&!l&&!s)return;const{target:h}=n,{graph:f}=this.context,d=f.getElementData(h.id),v=Yd(d).includes(r)?"unselect":"select",p={},g=this.isMultipleSelect,y=[h.id],m=this.getNeighborIds(n);if(g)if(Object.assign(p,this.getDataStates()),v==="select"){const b=(x,E)=>{x.forEach(w=>{const S=new Set(f.getElementState(w));S.add(E),S.delete(s),p[w]=Array.from(S)})};b(y,r),b(m,l),s&&Object.keys(p).forEach(x=>{const E=p[x];!E.includes(r)&&!E.includes(l)&&!E.includes(s)&&p[x].push(s)})}else{const b=p[h.id];p[h.id]=b.filter(x=>x!==r&&x!==l),b.includes(s)||p[h.id].push(s),m.forEach(x=>{p[x]=p[x].filter(E=>E!==l),p[x].includes(r)||p[x].push(s)})}else if(v==="select"){Object.assign(p,this.getClearStates(!!s));const b=(x,E)=>{x.forEach(w=>{p[w]||(p[w]=f.getElementState(w)),p[w].push(E)})};b(y,r),b(m,l),s&&Object.keys(p).forEach(x=>{!y.includes(x)&&!m.includes(x)&&p[x].push(s)})}else Object.assign(p,this.getClearStates());yield f.setElementState(p,u)})}getDataStates(){const{graph:n}=this.context,{nodes:r,edges:s,combos:l}=n.getData(),u={};return[...r,...s,...l].forEach(h=>{u[V(h)]=Yd(h)}),u}getClearStates(n=!1){const{graph:r}=this.context,{state:s,unselectedState:l,neighborState:u}=this.options,h=new Set([s,l,u]),{nodes:f,edges:d,combos:v}=r.getData(),p={};return[...f,...d,...v].forEach(g=>{const y=Yd(g),m=y.filter(b=>!h.has(b));(n||m.length!==y.length)&&(p[V(g)]=m)}),p}clearState(){return $u(this,void 0,void 0,function*(){const{graph:n}=this.context;yield n.setElementState(this.getClearStates(),this.options.animation)})}validate(n){if(this.destroyed)return!1;const{enable:r}=this.options;return(0,_t.Z)(r)?r(n):!!r}unbindEvents(){const{graph:n}=this.context;es.forEach(r=>{n.off(`${r}:${tt.CLICK}`,this.onClickSelect)}),n.off(yi.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}}tl.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};function Vn(a){var n;return!!(!((n=a.style)===null||n===void 0)&&n.collapsed)}var Tn=function(a,n,r){for(var s=0,l=(0,ve.Z)(n)?n.split("."):n;a&&s<l.length;)a=a[l[s++]];return a===void 0||s<l.length?r:a},el=function(a,n,r){var s=a,l=(0,ve.Z)(n)?n.split("."):n;return l.forEach(function(u,h){h<l.length-1?((0,Zn.Z)(s[u])||(s[u]=(0,se.Z)(l[h+1])?[]:{}),s=s[u]):s[u]=r}),a},HP=function(a){var n=Jy(a);return n.charAt(0).toLowerCase()+n.substring(1)},$P=HP;function nl(a,n){if(!a.startsWith(n))return!1;const r=a[n.length];return r>="A"&&r<="Z"}function u1(a,n){return`${n}${Mu(a)}`}function h1(a,n,r=!0){if(!n||!nl(a,n))return a;const s=a.slice(n.length);return r?$P(s):s}function We(a,n){const r=Object.entries(a).reduce((s,[l,u])=>(l==="className"||l==="class"||nl(l,n)&&Object.assign(s,{[h1(l,n)]:u}),s),{});if("opacity"in a){const s=u1("opacity",n),l=a.opacity;if(s in a){const u=a[s];Object.assign(r,{opacity:l*u})}else Object.assign(r,{opacity:l})}return r}function Xd(a,n){const r=n.length;return Object.keys(a).reduce((s,l)=>{if(l.startsWith(n)){const u=l.slice(r);s[u]=a[l]}return s},{})}function qd(a,n){const r=typeof n=="string"?[n]:n,s={};return Object.keys(a).forEach(l=>{r.find(u=>l.startsWith(u))||(s[l]=a[l])}),s}function $7(a,n,r){return Object.entries(a).reduce((s,[l,u])=>(nl(l,n)?s[u1(h1(l,n,!1),r)]=u:s[l]=u,s),{})}function Hn(a=0){if(typeof a=="number")return[a,a,a];const[n,r=n,s=n]=a;return[n,r,s]}var UP=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};function f1(a,n){const{datum:r,graph:s}=n;return typeof a=="function"?a.call(s,r):Object.fromEntries(Object.entries(a).map(([l,u])=>typeof u=="function"?[l,u.call(s,r)]:[l,u]))}function yn(a,n){const r=(a==null?void 0:a.style)||{},s=(n==null?void 0:n.style)||{};for(const l in r)l in s||(s[l]=r[l]);return Object.assign({},a,n,{style:s})}function YP(a){const{x:n,y:r,z:s,class:l,className:u,transform:h,transformOrigin:f,zIndex:d,visibility:v}=a;return UP(a,["x","y","z","class","className","transform","transformOrigin","zIndex","visibility"])}function XP(a,n){const r=Hn(a);let s={};return n.text&&!n.fontSize&&(s={fontSize:Math.min(...r)*.5}),n.src&&(!n.width||!n.height)&&(s={width:r[0]*.5,height:r[1]*.5}),s}function d1(a){if(a)return typeof a=="string"||typeof a=="function"||Array.isArray(a)?{type:"group",field:n=>n.id,color:a,invert:!1}:a}function qP(a,n){if(!n)return{};const{type:r,color:s,field:l,invert:u}=n,h=d=>{const v=typeof s=="string"?mi("palette",s):s;if(typeof v=="function"){const p={};return d.forEach(([g,y])=>{p[g]=v(u?1-y:y)}),p}else if(Array.isArray(v)){const p=u?[...v].reverse():v,g={};return d.forEach(([y,m])=>{g[y]=p[m%v.length]}),g}return{}},f=(d,v)=>{var p;return typeof d=="string"?(p=v.data)===null||p===void 0?void 0:p[d]:d==null?void 0:d(v)};if(r==="group"){const d=Cu(a,y=>{if(!l)return"default";const m=f(l,y);return m?String(m):"default"}),v=Object.keys(d),p=h(v.map((y,m)=>[y,m])),g={};return Object.entries(d).forEach(([y,m])=>{m.forEach(b=>{g[V(b)]=p[y]})}),g}else if(r==="value"){const[d,v]=a.reduce(([g,y],m)=>{const b=f(l,m);if(typeof b!="number")throw new Error(Ii(`Palette field ${l} is not a number`));return[Math.min(g,b),Math.max(y,b)]},[1/0,-1/0]),p=v-d;return h(a.map(g=>[g.id,(f(l,g)-d)/p]))}}function v1(a){const n=typeof a=="string"?mi("palette",a):a;if(typeof n!="function")return n}function p1(a,n){let r=2*a;return typeof n=="string"?r=a*Number(n.replace("%",""))/100:typeof n=="number"&&(r=n),isNaN(r)&&(r=2*a),r}function g1(a,n,r=1,s=!1){const l=s?r:1,u=(a.max[0]-a.min[0])*l;return p1(u,n)}function KP(a,n,r=1){const s=Ae(a[0],a[1])*r;return p1(s,n)}var QP={}.toString,JP=function(a){return QP.call(a).replace(/^\[object /,"").replace(/]$/,"")},tA=JP,eA=Object.prototype,nA=function(a){var n=a&&a.constructor,r=typeof n=="function"&&n.prototype||eA;return a===r},rA=nA,iA=Object.prototype.hasOwnProperty;function aA(a){if((0,At.Z)(a))return!0;if(Vo(a))return!a.length;var n=tA(a);if(n==="Map"||n==="Set")return!a.size;if(rA(a))return!Object.keys(a).length;for(var r in a)if(iA.call(a,r))return!1;return!0}var Si=aA;class Gs extends vd{constructor(n){y1(n.style),super(n),this.shapeMap={},this.animateMap={},this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(n,r,s,l,u){var h,f,d,v,p,g,y,m;const b=this.shapeMap[n];if(s===!1){b&&((h=u==null?void 0:u.beforeDestroy)===null||h===void 0||h.call(u,b),l.removeChild(b),delete this.shapeMap[n],(f=u==null?void 0:u.afterDestroy)===null||f===void 0||f.call(u,b));return}const x=typeof r=="string"?mi(Fs.SHAPE,r):r;if(!x)throw new Error(Ii(`Shape ${r} not found`));if(!b||b.destroyed||!(b instanceof x)){b&&((d=u==null?void 0:u.beforeDestroy)===null||d===void 0||d.call(u,b),b==null||b.destroy(),(v=u==null?void 0:u.afterDestroy)===null||v===void 0||v.call(u,b)),(p=u==null?void 0:u.beforeCreate)===null||p===void 0||p.call(u);const E=new x({className:n,style:s});return l.appendChild(E),this.shapeMap[n]=E,(g=u==null?void 0:u.afterCreate)===null||g===void 0||g.call(u,E),E}return(y=u==null?void 0:u.beforeUpdate)===null||y===void 0||y.call(u,b),bv(b,s),(m=u==null?void 0:u.afterUpdate)===null||m===void 0||m.call(u,b),b}update(n={}){const r=Object.assign({},this.attributes,n);y1(r),Q3(this,r),this.render(r,this),this.setVisibility()}bindEvents(){}getGraphicStyle(n){return YP(n)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(n,r){if(n.length===0)return null;const s=[];if(n[0].x!==void 0||n[0].y!==void 0||n[0].z!==void 0){const{x:u=0,y:h=0,z:f=0}=this.attributes;n.forEach(d=>{const{x:v=u,y:p=h,z:g=f}=d;Object.assign(d,{transform:g?[["translate3d",v,p,g]]:[["translate",v,p]]})})}const l=super.animate(n,r);if(l&&(Kd(this,l),s.push(l)),Array.isArray(n)&&n.length>0){const u=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(n[0]).some(h=>!u.includes(h))){Object.entries(this.shapeMap).forEach(([f,d])=>{const v=`get${Mu(f)}Style`,p=this[v];if((0,_t.Z)(p)){const g=n.map(m=>p.call(this,Object.assign(Object.assign({},this.attributes),m))),y=d.animate(kd(g),r);y&&(Kd(d,y),s.push(y))}});const h=(f,d)=>{if(!Si(f)){const v=`get${Mu(d)}Style`,p=this[v];if((0,_t.Z)(p)){const g=n.map(y=>p.call(this,Object.assign(Object.assign({},this.attributes),y)));Object.entries(g[0]).map(([y])=>{const m=g.map(x=>x[y]),b=f[y];if(b){const x=b.animate(kd(m),r);x&&(Kd(b,x),s.push(x))}})}}};this.compositeShapes.forEach(([f,d])=>{const v=Xd(this.shapeMap,d);h(v,f)})}}return Od(s)}getShape(n){return this.shapeMap[n]}setVisibility(){const{visibility:n}=this.attributes;fa(this,n)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function Kd(a,n){n==null||n.finished.then(()=>{const r=a.activeAnimations.findIndex(s=>s===n);r>-1&&a.activeAnimations.splice(r,1)})}function y1(a){if(!a)return{};if("x"in a||"y"in a||"z"in a){const{x:n=0,y:r=0,z:s,transform:l}=a,u=im(n,r,s,l);u&&(a.transform=u)}return a}var sA=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class Kr extends Gs{constructor(n){super(yn({style:Kr.defaultStyleProps},n))}isTextStyle(n){return nl(n,"label")}isBackgroundStyle(n){return nl(n,"background")}getTextStyle(n){const r=this.getGraphicStyle(n),{padding:s}=r,l=sA(r,["padding"]);return qd(l,"background")}getBackgroundStyle(n){if(n.background===!1)return!1;const r=this.getGraphicStyle(n),{wordWrap:s,wordWrapWidth:l,padding:u}=r,h=We(r,"background"),{min:[f,d],center:[v,p],halfExtents:[g,y]}=this.shapeMap.text.getGeometryBounds(),[m,b,x,E]=yr(u),w=g*2+E+b,{width:S,height:M}=h;S&&M?Object.assign(h,{x:v-Number(S)/2,y:p-Number(M)/2}):Object.assign(h,{x:f-E,y:d-m,width:s?Math.min(w,l+E+b):w,height:y*2+m+x});const{radius:C}=h;if(typeof C=="string"&&C.endsWith("%")){const T=Number(C.replace("%",""))/100;h.radius=Math.min(+h.width,+h.height)*T}return h}render(n=this.parsedAttributes,r=this){this.upsert("text",Xa,this.getTextStyle(n),r),this.upsert("background",Sn,this.getBackgroundStyle(n),r)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}}Kr.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class rs extends Gs{constructor(n){super(yn({style:rs.defaultStyleProps},n))}getBadgeStyle(n){return this.getGraphicStyle(n)}render(n=this.parsedAttributes,r=this){this.upsert("label",Kr,this.getBadgeStyle(n),r)}getGeometryBounds(){const n=this.getShape("label");return(n.getShape("background")||n.getShape("text")).getGeometryBounds()}}rs.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};function oA(a,n=!0){const r=[];return a.forEach((s,l)=>{r.push([l===0?"M":"L",...s])}),n&&r.push(["Z"]),r}const m1={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};function lA(a){const n=a.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),r=[];let s="",l={};for(;n.length>0;){let u=n.shift();u in m1?s=u:n.unshift(u),l={type:s},m1[s].forEach(d=>{u=n.shift(),l[d]=u}),s==="M"?s="L":s==="m"&&(s="l");const[h,...f]=Object.values(l);r.push([h,...f.map(Number)])}return r}function cA(a){const n=[];return(typeof a=="string"?lA(a):a).forEach(s=>{const l=s[0];if(l==="Z"){n.push(n[0]);return}if(l!=="A")for(let u=1;u<s.length;u=u+2)n.push([s[u],s[u+1],0]);else{const u=s.length;n.push([s[u-2],s[u-1],0])}}),n}const b1=a=>{if(a.length<2)return[["M",0,0],["L",0,0]];const n=a[0],r=a[1],s=a[a.length-1],l=a[a.length-2];a.unshift(l,s),a.push(n,r);const u=[["M",s[0],s[1]]];for(let h=1;h<a.length-2;h+=1){const[f,d]=a[h-1],[v,p]=a[h],[g,y]=a[h+1],[m,b]=h!==a.length-2?a[h+2]:[g,y],x=v+(g-f)/6,E=p+(y-d)/6,w=g-(m-v)/6,S=y-(b-p)/6;u.push(["C",x,E,w,S,g,y])}return u};function uA(a,n,r,s,l,u,h){const[f,d]=Fi(a,n),v={textAlign:n==="left"?"right":n==="right"?"left":"center",textBaseline:n==="top"?"bottom":n==="bottom"?"top":"middle",transform:[["translate",f+r,d+s]]};if(n==="center"||!l)return v;const p=cA(u);if(!p||p.length<=3)return v;const g=p.map((b,x)=>{const E=b,w=p[(x+1)%p.length];return Je(E,w)?null:[E,w]}).filter(Boolean),y=GP([f,d],g),m=s1([f,d],y);if(m&&y&&(v.transform=[["translate",m[0]+r,m[1]+s]],h)){const b=Math.atan((y[0][1]-y[1][1])/(y[0][0]-y[1][0]));v.transform.push(["rotate",b/Math.PI*180]),v.textAlign="center",(n==="right"||n==="left")&&(b>0?v.textBaseline=n==="right"?"bottom":"top":v.textBaseline=n==="right"?"top":"bottom")}return v}var hA=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class rl extends Gs{constructor(n){super(yn({style:rl.defaultStyleProps},n))}getLabelStyle(n){if(!n.label||!n.d||n.d.length===0)return!1;const r=We(this.getGraphicStyle(n),"label"),{maxWidth:s,offsetX:l,offsetY:u,autoRotate:h,placement:f,closeToPath:d}=r,v=hA(r,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),p=this.shapeMap.key,g=p==null?void 0:p.getRenderBounds();return Object.assign(uA(g,f,l,u,d,n.d,h),{wordWrapWidth:g1(g,s)},v)}getKeyStyle(n){return this.getGraphicStyle(n)}render(n,r){this.upsert("key",dr,this.getKeyStyle(n),r),this.upsert("label",Kr,this.getLabelStyle(n),r)}}rl.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};function fA(a){const n=[],r=s=>{s!=null&&s.children.length&&s.children.forEach(l=>{n.push(l),r(l)})};return r(a),n}function dA(a){const n=[];let r=a.parentNode;for(;r;)n.push(r),r=r.parentNode;return n}class Qd extends Go{constructor(n){super(n),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},Ws=this,this.isMutationObserved=!0,this.addEventListener($t.MOUNTED,this.onMounted),this.addEventListener($t.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){const{radius:n,clipPath:r,width:s=0,height:l=0}=this.attributes;if(n&&s&&l){const[u,h]=this.getBounds().min,f={x:u,y:h,radius:n,width:s,height:l};if(r)Object.assign(this.parsedStyle.clipPath.style,f);else{const d=new Sn({style:f});this.style.clipPath=d}}else r&&(this.style.clipPath=null)}}const Jd=new WeakMap;let Ws=null;const tv=a=>{if(Ws&&dA(Ws).includes(a)){const n=Jd.get(a);n?n.includes(Ws)||n.push(Ws):Jd.set(a,[Ws])}},ev=a=>{const n=Jd.get(a);n&&n.forEach(r=>r.handleRadius())};class nv extends Gs{constructor(n){super(n)}isImage(){const{src:n}=this.attributes;return!!n}getIconStyle(n=this.attributes){const{width:r=0,height:s=0}=n,l=this.getGraphicStyle(n);return this.isImage()?Object.assign({x:-r/2,y:-s/2},l):Object.assign({textBaseline:"middle",textAlign:"center"},l)}render(n=this.attributes,r=this){this.upsert("icon",this.isImage()?Qd:Xa,this.getIconStyle(n),r)}}class x1 extends Gs{get context(){return this.config.context}get parsedAttributes(){return this.attributes}onframe(){}animate(n,r){const s=super.animate(n,r);return s&&(s.onframe=()=>this.onframe(),s.finished.then(()=>this.onframe())),s}}var Uu=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class Lr extends x1{constructor(n){super(yn({style:Lr.defaultStyleProps},n)),this.type="node"}getSize(n=this.attributes){const{size:r}=n;return Hn(r)}getKeyStyle(n){const r=this.getGraphicStyle(n);return Object.assign(qd(r,["label","halo","icon","badge","port"]))}getLabelStyle(n){if(n.label===!1||!n.labelText)return!1;const r=We(this.getGraphicStyle(n),"label"),{placement:s,maxWidth:l,offsetX:u,offsetY:h}=r,f=Uu(r,["placement","maxWidth","offsetX","offsetY"]),d=this.getShape("key").getLocalBounds();return Object.assign(ib(d,s,u,h),{wordWrapWidth:g1(d,l)},f)}getHaloStyle(n){if(n.halo===!1)return!1;const r=this.getKeyStyle(n),{fill:s}=r,l=Uu(r,["fill"]),u=We(this.getGraphicStyle(n),"halo");return Object.assign(Object.assign(Object.assign({},l),{stroke:s}),u)}getIconStyle(n){if(n.icon===!1||!n.iconText&&!n.iconSrc)return!1;const r=We(this.getGraphicStyle(n),"icon");return Object.assign(XP(n.size,r),r)}getBadgesStyle(n){var r;const s=Xd(this.shapeMap,"badge-"),l={};if(Object.keys(s).forEach(g=>{l[g]=!1}),n.badge===!1||!(!((r=n.badges)===null||r===void 0)&&r.length))return l;const{badges:u=[],badgePalette:h,opacity:f=1}=n,d=Uu(n,["badges","badgePalette","opacity"]),v=v1(h),p=We(this.getGraphicStyle(d),"badge");return u.forEach((g,y)=>{l[y]=Object.assign(Object.assign({backgroundFill:v?v[y%(v==null?void 0:v.length)]:void 0,opacity:f},p),this.getBadgeStyle(g))}),l}getBadgeStyle(n){const r=this.getShape("key"),{placement:s="top",offsetX:l,offsetY:u}=n,h=Uu(n,["placement","offsetX","offsetY"]),f=ib(r.getLocalBounds(),s,l,u,!0);return Object.assign(Object.assign({},f),h)}getPortsStyle(n){var r;const s=this.getPorts(),l={};if(Object.keys(s).forEach(f=>{l[f]=!1}),n.port===!1||!(!((r=n.ports)===null||r===void 0)&&r.length))return l;const u=We(this.getGraphicStyle(n),"port"),{ports:h=[]}=n;return h.forEach((f,d)=>{const v=f.key||d,p=Object.assign(Object.assign({},u),f);if(eb(p))l[v]=!1;else{const[g,y]=this.getPortXY(n,f);l[v]=Object.assign({transform:[["translate",g,y]]},p)}}),l}getPortXY(n,r){const{placement:s="left"}=r,l=this.getShape("key");return gv(vA(this.context,l),s)}getPorts(){return Xd(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(n,r=!1){const s=this.getShape("key").getBounds();return zP(n,s,r)}drawHaloShape(n,r){const s=this.getHaloStyle(n),l=this.getShape("key");this.upsert("halo",l.constructor,s,r)}drawIconShape(n,r){const s=this.getIconStyle(n);this.upsert("icon",nv,s,r),tv(this)}drawBadgeShapes(n,r){const s=this.getBadgesStyle(n);Object.keys(s).forEach(l=>{const u=s[l];this.upsert(`badge-${l}`,rs,u,r)})}drawPortShapes(n,r){const s=this.getPortsStyle(n);Object.keys(s).forEach(l=>{const u=s[l],h=`port-${l}`;this.upsert(h,gi,u,r)})}drawLabelShape(n,r){const s=this.getLabelStyle(n);this.upsert("label",Kr,s,r)}_drawKeyShape(n,r){return this.drawKeyShape(n,r)}render(n=this.parsedAttributes,r=this){this._drawKeyShape(n,r),this.getShape("key")&&(this.drawHaloShape(n,r),this.drawIconShape(n,r),this.drawBadgeShapes(n,r),this.drawLabelShape(n,r),this.drawPortShapes(n,r))}update(n){super.update(n),n&&("x"in n||"y"in n||"z"in n)&&ev(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}}Lr.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};function vA(a,n){if(!a)return n.getLocalBounds();const r=a.canvas.getLayer(),s=n.cloneNode();fa(s,"hidden"),r.appendChild(s);const l=s.getLocalBounds();return s.destroy(),l}class pa extends Lr{constructor(n){super(yn({style:pa.defaultStyleProps},n))}drawKeyShape(n,r){return this.upsert("key",gi,this.getKeyStyle(n),r)}getKeyStyle(n){const r=super.getKeyStyle(n);return Object.assign(Object.assign({},r),{r:Math.min(...this.getSize(n))/2})}getIconStyle(n){const r=super.getIconStyle(n),{r:s}=this.getShape("key").attributes,l=s*2*zi;return r?Object.assign({width:l,height:l},r):!1}getIntersectPoint(n,r=!1){const s=this.getShape("key").getBounds();return Vu(n,s,r)}}pa.defaultStyleProps={size:32};class Yu extends Lr{constructor(n){super(n)}get parsedAttributes(){return this.attributes}drawKeyShape(n,r){return this.upsert("key",Ya,this.getKeyStyle(n),r)}getKeyStyle(n){const r=super.getKeyStyle(n);return Object.assign(Object.assign({},r),{points:this.getPoints(n)})}getIntersectPoint(n,r=!1){var s,l;const{points:u}=this.getShape("key").attributes,h=[+(((s=this.attributes)===null||s===void 0?void 0:s.x)||0),+(((l=this.attributes)===null||l===void 0?void 0:l.y)||0)];return a1(n,h,u,!0,r).point}}class E1 extends Yu{constructor(n){super(n)}getPoints(n){const[r,s]=this.getSize(n);return K3(r,s)}}var pA=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class il extends pa{constructor(n){super(yn({style:il.defaultStyleProps},n))}parseOuterR(){const{size:n}=this.parsedAttributes;return Math.min(...Hn(n))/2}parseInnerR(){const{innerR:n}=this.parsedAttributes;return(0,ve.Z)(n)?parseInt(n)/100*this.parseOuterR():n}drawDonutShape(n,r){const{donuts:s}=n;if(!(s!=null&&s.length))return;const l=s.map(g=>(0,se.Z)(g)?{value:g}:g),u=We(this.getGraphicStyle(n),"donut"),h=v1(n.donutPalette);if(!h)return;const f=l.reduce((g,y)=>{var m;return g+((m=y.value)!==null&&m!==void 0?m:0)},0),d=this.parseOuterR(),v=this.parseInnerR();let p=0;l.forEach((g,y)=>{const{value:m=0,color:b=h[y%h.length]}=g,x=pA(g,["value","color"]),E=(f===0?1/l.length:m/f)*360;this.upsert(`round${y}`,dr,Object.assign(Object.assign(Object.assign({},u),{d:mA(d,v,p,p+E),fill:b}),x),r),p+=E})}render(n,r=this){super.render(n,r),this.drawDonutShape(n,r)}}il.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};const Xu=(a,n,r,s)=>[a+Math.sin(s)*r,n-Math.cos(s)*r],gA=(a,n,r,s)=>s<=0||r<=s?[["M",a-r,n],["A",r,r,0,1,1,a+r,n],["A",r,r,0,1,1,a-r,n],["Z"]]:[["M",a-r,n],["A",r,r,0,1,1,a+r,n],["A",r,r,0,1,1,a-r,n],["Z"],["M",a+s,n],["A",s,s,0,1,0,a-s,n],["A",s,s,0,1,0,a+s,n],["Z"]],yA=(a,n,r,s,l,u)=>{const[h,f]=[l/360*2*Math.PI,u/360*2*Math.PI],d=[Xu(a,n,s,h),Xu(a,n,r,h),Xu(a,n,r,f),Xu(a,n,s,f)],v=f-h>Math.PI?1:0;return[["M",d[0][0],d[0][1]],["L",d[1][0],d[1][1]],["A",r,r,0,v,1,d[2][0],d[2][1]],["L",d[3][0],d[3][1]],["A",s,s,0,v,0,d[0][0],d[0][1]],["Z"]]},mA=(a=0,n=0,r,s)=>{const[l,u]=[0,0];return Math.abs(r-s)%360<1e-6?gA(l,u,a,n):yA(l,u,a,n,r,s)};class al extends Lr{constructor(n){super(yn({style:al.defaultStyleProps},n))}drawKeyShape(n,r){return this.upsert("key",Zo,this.getKeyStyle(n),r)}getKeyStyle(n){const r=super.getKeyStyle(n),[s,l]=this.getSize(n);return Object.assign(Object.assign({},r),{rx:s/2,ry:l/2})}getIconStyle(n){const r=super.getIconStyle(n),{rx:s,ry:l}=this.getShape("key").attributes,u=Math.min(+s,+l)*2*zi;return r?Object.assign({width:u,height:u},r):!1}getIntersectPoint(n,r=!1){const s=this.getShape("key").getBounds();return Vu(n,s,r)}}al.defaultStyleProps={size:[45,35]};class w1 extends Yu{constructor(n){super(n)}getOuterR(n){return n.outerR||Math.min(...this.getSize(n))/2}getPoints(n){return J3(this.getOuterR(n))}getIconStyle(n){const r=super.getIconStyle(n),s=this.getOuterR(n)*zi;return r?Object.assign({width:s,height:s},r):!1}}function bA(a,n){var r=n.cx,s=r===void 0?0:r,l=n.cy,u=l===void 0?0:l,h=n.r;a.arc(s,u,h,0,Math.PI*2,!1)}function xA(a,n){var r=n.cx,s=r===void 0?0:r,l=n.cy,u=l===void 0?0:l,h=n.rx,f=n.ry;if(a.ellipse)a.ellipse(s,u,h,f,0,0,Math.PI*2,!1);else{var d=h>f?h:f,v=h>f?1:h/f,p=h>f?f/h:1;a.save(),a.scale(v,p),a.arc(s,u,d,0,Math.PI*2)}}function EA(a,n){var r=n.x1,s=n.y1,l=n.x2,u=n.y2,h=n.markerStart,f=n.markerEnd,d=n.markerStartOffset,v=n.markerEndOffset,p=0,g=0,y=0,m=0,b=0,x,E;h&&ae(h)&&d&&(x=l-r,E=u-s,b=Math.atan2(E,x),p=Math.cos(b)*(d||0),g=Math.sin(b)*(d||0)),f&&ae(f)&&v&&(x=r-l,E=s-u,b=Math.atan2(E,x),y=Math.cos(b)*(v||0),m=Math.sin(b)*(v||0)),a.moveTo(r+p,s+g),a.lineTo(l+y,u+m)}function wA(a,n){var r=n.markerStart,s=n.markerEnd,l=n.markerStartOffset,u=n.markerEndOffset,h=n.d,f=h.absolutePath,d=h.segments,v=0,p=0,g=0,y=0,m=0,b,x;if(r&&ae(r)&&l){var E=r.parentNode.getStartTangent(),w=(0,W.Z)(E,2),S=w[0],M=w[1];b=S[0]-M[0],x=S[1]-M[1],m=Math.atan2(x,b),v=Math.cos(m)*(l||0),p=Math.sin(m)*(l||0)}if(s&&ae(s)&&u){var C=s.parentNode.getEndTangent(),T=(0,W.Z)(C,2),O=T[0],k=T[1];b=O[0]-k[0],x=O[1]-k[1],m=Math.atan2(x,b),g=Math.cos(m)*(u||0),y=Math.sin(m)*(u||0)}for(var P=0;P<f.length;P++){var A=f[P],N=A[0],L=f[P+1],R=P===0&&(v!==0||p!==0),z=(P===f.length-1||L&&(L[0]==="M"||L[0]==="Z"))&&g!==0&&y!==0,Z=R?[v,p]:[0,0],X=(0,W.Z)(Z,2),nt=X[0],K=X[1],rt=z?[g,y]:[0,0],U=(0,W.Z)(rt,2),at=U[0],ht=U[1];switch(N){case"M":a.moveTo(A[1]+nt,A[2]+K);break;case"L":a.lineTo(A[1]+at,A[2]+ht);break;case"Q":a.quadraticCurveTo(A[1],A[2],A[3]+at,A[4]+ht);break;case"C":a.bezierCurveTo(A[1],A[2],A[3],A[4],A[5]+at,A[6]+ht);break;case"A":{var pt=d[P].arcParams,Ct=pt.cx,Zt=pt.cy,Nt=pt.rx,Pt=pt.ry,ie=pt.startAngle,Kt=pt.endAngle,re=pt.xRotation,te=pt.sweepFlag;if(a.ellipse)a.ellipse(Ct,Zt,Nt,Pt,re,ie,Kt,!!(1-te));else{var ze=Nt>Pt?Nt:Pt,Yt=Nt>Pt?1:Nt/Pt,wr=Nt>Pt?Pt/Nt:1;a.translate(Ct,Zt),a.rotate(re),a.scale(Yt,wr),a.arc(0,0,ze,ie,Kt,!!(1-te)),a.scale(1/Yt,1/wr),a.rotate(-re),a.translate(-Ct,-Zt)}z&&a.lineTo(A[6]+g,A[7]+y);break}case"Z":a.closePath();break}}}function SA(a,n){var r=n.markerStart,s=n.markerEnd,l=n.markerStartOffset,u=n.markerEndOffset,h=n.points.points,f=h.length,d=h[0][0],v=h[0][1],p=h[f-1][0],g=h[f-1][1],y=0,m=0,b=0,x=0,E=0,w,S;r&&ae(r)&&l&&(w=h[1][0]-h[0][0],S=h[1][1]-h[0][1],E=Math.atan2(S,w),y=Math.cos(E)*(l||0),m=Math.sin(E)*(l||0)),s&&ae(s)&&u&&(w=h[f-1][0]-h[0][0],S=h[f-1][1]-h[0][1],E=Math.atan2(S,w),b=Math.cos(E)*(u||0),x=Math.sin(E)*(u||0)),a.moveTo(d+(y||b),v+(m||x));for(var M=1;M<f-1;M++){var C=h[M];a.lineTo(C[0],C[1])}a.lineTo(p,g)}function MA(a,n){var r=n.markerStart,s=n.markerEnd,l=n.markerStartOffset,u=n.markerEndOffset,h=n.points.points,f=h.length,d=h[0][0],v=h[0][1],p=h[f-1][0],g=h[f-1][1],y=0,m=0,b=0,x=0,E=0,w,S;r&&ae(r)&&l&&(w=h[1][0]-h[0][0],S=h[1][1]-h[0][1],E=Math.atan2(S,w),y=Math.cos(E)*(l||0),m=Math.sin(E)*(l||0)),s&&ae(s)&&u&&(w=h[f-2][0]-h[f-1][0],S=h[f-2][1]-h[f-1][1],E=Math.atan2(S,w),b=Math.cos(E)*(u||0),x=Math.sin(E)*(u||0)),a.moveTo(d+y,v+m);for(var M=1;M<f-1;M++){var C=h[M];a.lineTo(C[0],C[1])}a.lineTo(p+b,g+x)}function TA(a,n){var r=n.x,s=r===void 0?0:r,l=n.y,u=l===void 0?0:l,h=n.radius,f=n.width,d=n.height,v=f,p=d,g=h&&h.some(function(T){return T!==0});if(!g)a.rect(s,u,v,p);else{var y=f>0?1:-1,m=d>0?1:-1,b=y+m===0,x=h.map(function(T){return Ze(T,0,Math.min(Math.abs(v)/2,Math.abs(p)/2))}),E=(0,W.Z)(x,4),w=E[0],S=E[1],M=E[2],C=E[3];a.moveTo(y*w+s,u),a.lineTo(v-y*S+s,u),S!==0&&a.arc(v-y*S+s,m*S+u,S,-m*Math.PI/2,y>0?0:Math.PI,b),a.lineTo(v+s,p-m*M+u),M!==0&&a.arc(v-y*M+s,p-m*M+u,M,y>0?0:Math.PI,m>0?Math.PI/2:1.5*Math.PI,b),a.lineTo(y*C+s,p+u),C!==0&&a.arc(y*C+s,p-m*C+u,C,m>0?Math.PI/2:-Math.PI/2,y>0?Math.PI:0,b),a.lineTo(s,m*w+u),w!==0&&a.arc(y*w+s,m*w+u,w,y>0?Math.PI:0,m>0?Math.PI*1.5:Math.PI/2,b)}}var CA=function(a){function n(){var r;(0,I.Z)(this,n);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=(0,G.Z)(this,n,[].concat(l)),r.name="canvas-path-generator",r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"init",value:function(){var s,l=(s={},(0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)(s,J.CIRCLE,bA),J.ELLIPSE,xA),J.RECT,TA),J.LINE,EA),J.POLYLINE,MA),J.POLYGON,SA),J.PATH,wA),J.TEXT,void 0),J.GROUP,void 0),J.IMAGE,void 0),(0,St.Z)((0,St.Z)((0,St.Z)(s,J.HTML,void 0),J.MESH,void 0),J.FRAGMENT,void 0));this.context.pathGeneratorFactory=l}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory}}])}(aa);var OA=j(),kA=j(),_A=j(),PA=Ce(),S1=function(){function a(){var n=this;(0,I.Z)(this,a),this.isHit=function(r,s,l,u){var h=n.context.pointInPathPickerFactory[r.nodeName];if(h){var f=ci(PA,l),d=dn(kA,Dt(_A,s[0],s[1],0),f);if(h(r,new wn(d[0],d[1]),u,n.isPointInPath,n.context,n.runtime))return!0}return!1},this.isPointInPath=function(r,s){var l=n.runtime.offscreenCanvasCreator.getOrCreateContext(n.context.config.offscreenCanvas),u=n.context.pathGeneratorFactory[r.nodeName];return u&&(l.beginPath(),u(l,r.parsedStyle),l.closePath()),l.isPointInPath(s.x,s.y)}}return(0,D.Z)(a,[{key:"apply",value:function(r,s){var l,u=this,h=r.renderingService,f=r.renderingContext;this.context=r,this.runtime=s;var d=(l=f.root)===null||l===void 0?void 0:l.ownerDocument;h.hooks.pick.tapPromise(a.tag,function(){var v=(0,ia.Z)((0,Rn.Z)().mark(function p(g){return(0,Rn.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",u.pick(d,g));case 1:case"end":return y.stop()}},p)}));return function(p){return v.apply(this,arguments)}}()),h.hooks.pickSync.tap(a.tag,function(v){return u.pick(d,v)})}},{key:"pick",value:function(r,s){var l=s.topmost,u=s.position,h=u.x,f=u.y,d=Dt(OA,h,f,0),v=r.elementsFromBBox(d[0],d[1],d[0],d[1]),p=[],g=(0,La.Z)(v),y;try{for(g.s();!(y=g.n()).done;){var m=y.value,b=m.getWorldTransform(),x=this.isHit(m,d,b,!1);if(x){var E=hy(m);if(E){var w=E.parsedStyle.clipPath,S=this.isHit(w,d,w.getWorldTransform(),!0);if(S){if(l)return s.picked=[m],s;p.push(m)}}else{if(l)return s.picked=[m],s;p.push(m)}}}}catch(M){g.e(M)}finally{g.f()}return s.picked=p,s}}])}();S1.tag="CanvasPicker";function AA(a,n,r){var s=a.parsedStyle,l=s.cx,u=l===void 0?0:l,h=s.cy,f=h===void 0?0:h,d=s.r,v=s.fill,p=s.stroke,g=s.lineWidth,y=g===void 0?1:g,m=s.increasedLineWidthForHitTesting,b=m===void 0?0:m,x=s.pointerEvents,E=x===void 0?"auto":x,w=(y+b)/2,S=Nn(u,f,n.x,n.y),M=Ga(E,v,p),C=(0,W.Z)(M,2),T=C[0],O=C[1];return T&&O||r?S<=d+w:T?S<=d:O?S>=d-w&&S<=d+w:!1}function qu(a,n,r,s){return a/(r*r)+n/(s*s)}function NA(a,n,r){var s=a.parsedStyle,l=s.cx,u=l===void 0?0:l,h=s.cy,f=h===void 0?0:h,d=s.rx,v=s.ry,p=s.fill,g=s.stroke,y=s.lineWidth,m=y===void 0?1:y,b=s.increasedLineWidthForHitTesting,x=b===void 0?0:b,E=s.pointerEvents,w=E===void 0?"auto":E,S=n.x,M=n.y,C=Ga(w,p,g),T=(0,W.Z)(C,2),O=T[0],k=T[1],P=(m+x)/2,A=(S-u)*(S-u),N=(M-f)*(M-f);return O&&k||r?qu(A,N,d+P,v+P)<=1:O?qu(A,N,d,v)<=1:k?qu(A,N,d-P,v-P)>=1&&qu(A,N,d+P,v+P)<=1:!1}function is(a,n,r,s,l,u){return l>=a&&l<=a+r&&u>=n&&u<=n+s}function RA(a,n,r,s,l,u,h){var f=l/2;return is(a-f,n-f,r,l,u,h)||is(a+r-f,n-f,l,s,u,h)||is(a+f,n+s-f,r,l,u,h)||is(a-f,n+f,l,s,u,h)}function Ku(a,n,r,s,l,u,h,f){var d=(Math.atan2(f-n,h-a)+Math.PI*2)%(Math.PI*2),v={x:a+r*Math.cos(d),y:n+r*Math.sin(d)};return Nn(v.x,v.y,h,f)<=u/2}function ga(a,n,r,s,l,u,h){var f=Math.min(a,r),d=Math.max(a,r),v=Math.min(n,s),p=Math.max(n,s),g=l/2;return u>=f-g&&u<=d+g&&h>=v-g&&h<=p+g?lg(a,n,r,s,u,h)<=l/2:!1}function M1(a,n,r,s,l){var u=a.length;if(u<2)return!1;for(var h=0;h<u-1;h++){var f=a[h][0],d=a[h][1],v=a[h+1][0],p=a[h+1][1];if(ga(f,d,v,p,n,r,s))return!0}if(l){var g=a[0],y=a[u-1];if(ga(g[0],g[1],y[0],y[1],n,r,s))return!0}return!1}var LA=1e-6;function rv(a){return Math.abs(a)<LA?0:a<0?-1:1}function DA(a,n,r){return(r[0]-a[0])*(n[1]-a[1])===(n[0]-a[0])*(r[1]-a[1])&&Math.min(a[0],n[0])<=r[0]&&r[0]<=Math.max(a[0],n[0])&&Math.min(a[1],n[1])<=r[1]&&r[1]<=Math.max(a[1],n[1])}function T1(a,n,r){var s=!1,l=a.length;if(l<=2)return!1;for(var u=0;u<l;u++){var h=a[u],f=a[(u+1)%l];if(DA(h,f,[n,r]))return!0;rv(h[1]-r)>0!=rv(f[1]-r)>0&&rv(n-(r-h[1])*(h[0]-f[0])/(h[1]-f[1])-h[0])<0&&(s=!s)}return s}function C1(a,n,r){for(var s=!1,l=0;l<a.length;l++){var u=a[l];if(s=T1(u,n,r),s)break}return s}function IA(a,n,r){var s=a.parsedStyle,l=s.x1,u=s.y1,h=s.x2,f=s.y2,d=s.lineWidth,v=d===void 0?1:d,p=s.increasedLineWidthForHitTesting,g=p===void 0?0:p,y=s.pointerEvents,m=y===void 0?"auto":y,b=s.fill,x=s.stroke,E=Ga(m,b,x),w=(0,W.Z)(E,2),S=w[1];return!S&&!r||!v?!1:ga(l,u,h,f,v+g,n.x,n.y)}function BA(a,n,r,s,l){for(var u=!1,h=n/2,f=0;f<a.length;f++){var d=a[f],v=d.currentPoint,p=d.params,g=d.prePoint,y=d.box;if(!(y&&!is(y.x-h,y.y-h,y.width+n,y.height+n,r,s)))switch(d.command){case"L":case"Z":if(u=ga(g[0],g[1],v[0],v[1],n,r,s),u)return!0;break;case"Q":var m=JS(g[0],g[1],p[1],p[2],p[3],p[4],r,s);if(u=m<=n/2,u)return!0;break;case"C":var b=hg(g[0],g[1],p[1],p[2],p[3],p[4],p[5],p[6],r,s,l);if(u=b<=n/2,u)return!0;break;case"A":d.cubicParams||(d.cubicParams=Pf(g[0],g[1],p[1],p[2],p[3],p[4],p[5],p[6],p[7],void 0));for(var x=d.cubicParams,E=g,w=0;w<x.length;w+=6){var S=hg(E[0],E[1],x[w],x[w+1],x[w+2],x[w+3],x[w+4],x[w+5],r,s,l);if(E=[x[w+4],x[w+5]],u=S<=n/2,u)return!0}break}}return u}function FA(a,n,r,s,l,u){var h=a.parsedStyle,f=h.lineWidth,d=f===void 0?1:f,v=h.increasedLineWidthForHitTesting,p=v===void 0?0:v,g=h.stroke,y=h.fill,m=h.d,b=h.pointerEvents,x=b===void 0?"auto":b,E=m.segments,w=m.hasArc,S=m.polylines,M=m.polygons,C=Ga(x,(M==null?void 0:M.length)&&y,g),T=(0,W.Z)(C,2),O=T[0],k=T[1],P=Kf(a),A=!1;return O||r?(w?A=s(a,n):A=C1(M,n.x,n.y)||C1(S,n.x,n.y),A):((k||r)&&(A=BA(E,d+p,n.x,n.y,P)),A)}function zA(a,n,r){var s=a.parsedStyle,l=s.stroke,u=s.fill,h=s.lineWidth,f=h===void 0?1:h,d=s.increasedLineWidthForHitTesting,v=d===void 0?0:d,p=s.points,g=s.pointerEvents,y=g===void 0?"auto":g,m=Ga(y,u,l),b=(0,W.Z)(m,2),x=b[0],E=b[1],w=!1;return(E||r)&&(w=M1(p.points,f+v,n.x,n.y,!0)),!w&&(x||r)&&(w=T1(p.points,n.x,n.y)),w}function ZA(a,n,r){var s=a.parsedStyle,l=s.lineWidth,u=l===void 0?1:l,h=s.increasedLineWidthForHitTesting,f=h===void 0?0:h,d=s.points,v=s.pointerEvents,p=v===void 0?"auto":v,g=s.fill,y=s.stroke,m=Ga(p,g,y),b=(0,W.Z)(m,2),x=b[1];return!x&&!r||!u?!1:M1(d.points,u+f,n.x,n.y,!1)}function GA(a,n,r,s,l){var u=a.parsedStyle,h=u.radius,f=u.fill,d=u.stroke,v=u.lineWidth,p=v===void 0?1:v,g=u.increasedLineWidthForHitTesting,y=g===void 0?0:g,m=u.x,b=m===void 0?0:m,x=u.y,E=x===void 0?0:x,w=u.width,S=u.height,M=u.pointerEvents,C=M===void 0?"auto":M,T=Ga(C,f,d),O=(0,W.Z)(T,2),k=O[0],P=O[1],A=h&&h.some(function(z){return z!==0}),N=p+y;if(A){var R=!1;return(P||r)&&(R=WA(b,E,w,S,h.map(function(z){return Ze(z,0,Math.min(Math.abs(w)/2,Math.abs(S)/2))}),N,n.x,n.y)),!R&&(k||r)&&(R=s(a,n)),R}else{var L=N/2;if(k&&P||r)return is(b-L,E-L,w+L,S+L,n.x,n.y);if(k)return is(b,E,w,S,n.x,n.y);if(P)return RA(b,E,w,S,N,n.x,n.y)}return!1}function WA(a,n,r,s,l,u,h,f){var d=(0,W.Z)(l,4),v=d[0],p=d[1],g=d[2],y=d[3];return ga(a+v,n,a+r-p,n,u,h,f)||ga(a+r,n+p,a+r,n+s-g,u,h,f)||ga(a+r-g,n+s,a+y,n+s,u,h,f)||ga(a,n+s-y,a,n+v,u,h,f)||Ku(a+r-p,n+p,p,1.5*Math.PI,2*Math.PI,u,h,f)||Ku(a+r-g,n+s-g,g,0,.5*Math.PI,u,h,f)||Ku(a+y,n+s-y,y,.5*Math.PI,Math.PI,u,h,f)||Ku(a+v,n+v,v,Math.PI,1.5*Math.PI,u,h,f)}function jA(a,n,r,s,l,u){var h=a.parsedStyle,f=h.pointerEvents,d=f===void 0?"auto":f,v=h.x,p=v===void 0?0:v,g=h.y,y=g===void 0?0:g,m=h.width,b=h.height;if(d==="non-transparent-pixel"){var x=l.config.offscreenCanvas,E=u.offscreenCanvasCreator.getOrCreateCanvas(x),w=u.offscreenCanvasCreator.getOrCreateContext(x,{willReadFrequently:!0});E.width=m,E.height=b,l.defaultStyleRendererFactory[J.IMAGE].render(w,(0,$.Z)((0,$.Z)({},a.parsedStyle),{},{x:0,y:0}),a,void 0,void 0,void 0);var S=w.getImageData(n.x-p,n.y-y,1,1).data;return S.every(function(M){return M!==0})}return!0}function VA(a,n,r,s){var l=a.getGeometryBounds();return n.x>=l.min[0]&&n.y>=l.min[1]&&n.x<=l.max[0]&&n.y<=l.max[1]}var HA=function(a){function n(){var r;(0,I.Z)(this,n);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=(0,G.Z)(this,n,[].concat(l)),r.name="canvas-picker",r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"init",value:function(){var s,l=(s={},(0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)(s,J.CIRCLE,AA),J.ELLIPSE,NA),J.RECT,GA),J.LINE,IA),J.POLYLINE,ZA),J.POLYGON,zA),J.PATH,FA),J.TEXT,VA),J.GROUP,null),J.IMAGE,jA),(0,St.Z)((0,St.Z)(s,J.HTML,null),J.MESH,null));this.context.pointInPathPickerFactory=l,this.addRenderingPlugin(new S1)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(aa);function Mi(a,n){if(!{}.hasOwnProperty.call(a,n))throw new TypeError("attempted to use private field on non-instance");return a}var $A=0;function UA(a){return"__private_"+$A+++"_"+a}var YA=function(){function a(){(0,I.Z)(this,a),this.cacheStore=new Map}return(0,D.Z)(a,[{key:"onRefAdded",value:function(r){}},{key:"has",value:function(r){return this.cacheStore.has(r)}},{key:"put",value:function(r,s,l){return this.cacheStore.has(r)?!1:(this.cacheStore.set(r,{value:s,counter:new Set([l.entity])}),this.onRefAdded(l),!0)}},{key:"get",value:function(r,s){var l=this.cacheStore.get(r);return l?(l.counter.has(s.entity)||(l.counter.add(s.entity),this.onRefAdded(s)),l.value):null}},{key:"update",value:function(r,s,l){var u=this.cacheStore.get(r);return u?(u.value=(0,$.Z)((0,$.Z)({},u.value),s),u.counter.has(l.entity)||(u.counter.add(l.entity),this.onRefAdded(l)),!0):!1}},{key:"release",value:function(r,s){var l=this.cacheStore.get(r);return l?(l.counter.delete(s.entity),l.counter.size<=0&&this.cacheStore.delete(r),!0):!1}},{key:"releaseRef",value:function(r){var s=this;Array.from(this.cacheStore.keys()).forEach(function(l){s.release(l,r)})}},{key:"getSize",value:function(){return this.cacheStore.size}},{key:"clear",value:function(){this.cacheStore.clear()}}])}(),iv=[],av=[],sv=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,null,[{key:"stop",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a.api;a.rafId&&(r.cancelAnimationFrame(a.rafId),a.rafId=null)}},{key:"executeTask",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a.api;iv.length<=0&&av.length<=0||(av.forEach(function(s){return s()}),av=iv.splice(0,a.TASK_NUM_PER_FRAME),a.rafId=r.requestAnimationFrame(function(){a.executeTask(r)}))}},{key:"sliceImage",value:function(r,s,l,u){for(var h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,f=arguments.length>5&&arguments[5]!==void 0?arguments[5]:a.api,d=r.naturalWidth||r.width,v=r.naturalHeight||r.height,p=s-h,g=l-h,y=Math.ceil(d/p),m=Math.ceil(v/g),b={tileSize:[s,l],gridSize:[m,y],tiles:Array(m).fill(null).map(function(){return Array(y).fill(null)})},x=function(S){for(var M=function(O){iv.push(function(){var k=O*p,P=S*g,A=[Math.min(s,d-k),Math.min(l,v-P)],N=A[0],L=A[1],R=f.createCanvas();R.width=s,R.height=l;var z=R.getContext("2d");z.drawImage(r,k,P,N,L,0,0,N,L),b.tiles[S][O]={x:k,y:P,tileX:O,tileY:S,data:R},u()})},C=0;C<y;C++)M(C)},E=0;E<m;E++)x(E);return a.stop(),a.executeTask(),b}}])}();sv.TASK_NUM_PER_FRAME=10;var mr=new YA;mr.onRefAdded=function(n){var r=this;n.addEventListener($t.DESTROY,function(){r.releaseRef(n)},{once:!0})};var ov=function(){function a(n,r){(0,I.Z)(this,a),this.gradientCache={},this.patternCache={},this.context=n,this.runtime=r}return(0,D.Z)(a,[{key:"getImageSync",value:function(r,s,l){var u=(0,ve.Z)(r)?r:r.src;if(mr.has(u)){var h=mr.get(u,s);if(h.img.complete)return l==null||l(h),h}return this.getOrCreateImage(r,s).then(function(f){l==null||l(f)}).catch(function(f){console.error(f)}),null}},{key:"getOrCreateImage",value:function(r,s){var l=this,u=(0,ve.Z)(r)?r:r.src;if(!(0,ve.Z)(r)&&!mr.has(u)){var h={img:r,size:[r.naturalWidth||r.width,r.naturalHeight||r.height],tileSize:Qu(r)};mr.put(u,h,s)}if(mr.has(u)){var f=mr.get(u,s);return f.img.complete?Promise.resolve(f):new Promise(function(d,v){f.img.addEventListener("load",function(){f.size=[f.img.naturalWidth||f.img.width,f.img.naturalHeight||f.img.height],f.tileSize=Qu(f.img),d(f)}),f.img.addEventListener("error",function(p){v(p)})})}return new Promise(function(d,v){var p=l.context.config.createImage();if(p){var g={img:p,size:[0,0],tileSize:Qu(p)};mr.put(u,g,s),p.onload=function(){g.size=[p.naturalWidth||p.width,p.naturalHeight||p.height],g.tileSize=Qu(g.img),d(g)},p.onerror=function(y){v(y)},p.crossOrigin="Anonymous",p.src=u}})}},{key:"createDownSampledImage",value:function(){var n=(0,ia.Z)((0,Rn.Z)().mark(function s(l,u){var h,f,d,v,p,g,y,m,b,x,E,w,S,M;return(0,Rn.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=1,this.getOrCreateImage(l,u);case 1:if(h=C.sent,typeof h.downSamplingRate=="undefined"){C.next=2;break}return C.abrupt("return",h);case 2:if(f=this.context.config.enableLargeImageOptimization,d=typeof f=="boolean"?{}:f,v=d.maxDownSampledImageSize,p=v===void 0?2048:v,g=d.downSamplingRateThreshold,y=g===void 0?.5:g,m=this.runtime.globalThis.createImageBitmap,b=(0,W.Z)(h.size,2),x=b[0],E=b[1],w=h.img,S=Math.min((p+p)/(x+E),Math.max(.01,Math.min(y,.5))),M=(0,$.Z)((0,$.Z)({},h),{},{downSamplingRate:S}),mr.update(h.img.src,M,u),!m){C.next=7;break}return C.prev=3,C.next=4,m(h.img,{resizeWidth:x*S,resizeHeight:E*S});case 4:w=C.sent,C.next=6;break;case 5:C.prev=5,C.catch(3),S=1;case 6:C.next=8;break;case 7:S=1;case 8:return M=(0,$.Z)((0,$.Z)({},this.getImageSync(l,u)),{},{downSampled:w,downSamplingRate:S}),mr.update(h.img.src,M,u),C.abrupt("return",M);case 9:case"end":return C.stop()}},s,this,[[3,5]])}));function r(s,l){return n.apply(this,arguments)}return r}()},{key:"createImageTiles",value:function(){var n=(0,ia.Z)((0,Rn.Z)().mark(function s(l,u,h,f){var d,v,p,g,y;return(0,Rn.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=1,this.getOrCreateImage(l,f);case 1:return d=m.sent,v=f.ownerDocument.defaultView,p=v.requestAnimationFrame,g=v.cancelAnimationFrame,sv.api={requestAnimationFrame:p,cancelAnimationFrame:g,createCanvas:function(){return hd.createCanvas()}},y=(0,$.Z)((0,$.Z)({},d),sv.sliceImage(d.img,d.tileSize[0],d.tileSize[0],h)),mr.update(d.img.src,y,f),m.abrupt("return",y);case 2:case"end":return m.stop()}},s,this)}));function r(s,l,u,h){return n.apply(this,arguments)}return r}()},{key:"releaseImage",value:function(r,s){mr.release((0,ve.Z)(r)?r:r.src,s)}},{key:"releaseImageRef",value:function(r){mr.releaseRef(r)}},{key:"getOrCreatePatternSync",value:function(r,s,l,u,h,f,d){var v=this.generatePatternKey(s);if(v&&this.patternCache[v])return this.patternCache[v];var p=s.image,g=s.repetition,y=s.transform,m,b=!1;if((0,ve.Z)(p)){var x=this.getImageSync(p,r,d);m=x==null?void 0:x.img}else u?(m=u,b=!0):m=p;var E=m&&l.createPattern(m,g);if(E){var w;y?w=Ey(iy(y),new Pe({})):w=Ji(Ce()),b&&Mp(w,w,[1/h,1/h,1]),E.setTransform({a:w[0],b:w[1],c:w[4],d:w[5],e:w[12]+f[0],f:w[13]+f[1]})}return v&&E&&(this.patternCache[v]=E),E}},{key:"getOrCreateGradient",value:function(r,s){var l=this.generateGradientKey(r),u=r.type,h=r.steps,f=r.min,d=r.width,v=r.height,p=r.angle,g=r.cx,y=r.cy,m=r.size;if(this.gradientCache[l])return this.gradientCache[l];var b=null;if(u===sa.LinearGradient){var x=KM(f,d,v,p),E=x.x1,w=x.y1,S=x.x2,M=x.y2;b=s.createLinearGradient(E,w,S,M)}else if(u===sa.RadialGradient){var C=QM(f,d,v,g,y,m),T=C.x,O=C.y,k=C.r;b=s.createRadialGradient(T,O,0,T,O,k)}return b&&(h.forEach(function(P){var A=P.offset,N=P.color;if(A.unit===bt.kPercentage){var L;(L=b)===null||L===void 0||L.addColorStop(A.value/100,N.toString())}}),this.gradientCache[l]=b),this.gradientCache[l]}},{key:"generateGradientKey",value:function(r){var s=r.type,l=r.min,u=r.width,h=r.height,f=r.steps,d=r.angle,v=r.cx,p=r.cy,g=r.size;return"gradient-".concat(s,"-").concat((d==null?void 0:d.toString())||0,"-").concat((v==null?void 0:v.toString())||0,"-").concat((p==null?void 0:p.toString())||0,"-").concat((g==null?void 0:g.toString())||0,"-").concat(l[0],"-").concat(l[1],"-").concat(u,"-").concat(h,"-").concat(f.map(function(y){var m=y.offset,b=y.color;return"".concat(m).concat(b)}).join("-"))}},{key:"generatePatternKey",value:function(r){var s=r.image,l=r.repetition;if((0,ve.Z)(s))return"pattern-".concat(s,"-").concat(l);if(s.nodeName==="rect")return"pattern-".concat(s.entity,"-").concat(l)}}])}();ov.isSupportTile=!!hd.createCanvas();function Qu(a){if(!a.complete)return[0,0];var n=a.naturalWidth||a.width,r=a.naturalHeight||a.height,s=256;return[256,512].forEach(function(l){var u=Math.ceil(r/l),h=Math.ceil(n/l);u*h<1e3&&(s=l)}),[s,s]}var O1=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"apply",value:function(r){var s=r.renderingService,l=r.renderingContext,u=r.imagePool,h=l.root.ownerDocument.defaultView,f=function(g,y,m){var b=g.parsedStyle,x=b.width,E=b.height;x&&!E?g.setAttribute("height",m/y*x):!x&&E&&g.setAttribute("width",y/m*E)},d=function(g){var y=g.target,m=y.nodeName,b=y.attributes;if(m===J.IMAGE){var x=b.src,E=b.keepAspectRatio;u.getImageSync(x,y,function(w){var S=w.img,M=S.width,C=S.height;E&&f(y,M,C),y.renderable.dirty=!0,s.dirtify()})}},v=function(g){var y=g.target,m=g.attrName,b=g.prevValue,x=g.newValue;y.nodeName!==J.IMAGE||m!=="src"||(b!==x&&u.releaseImage(b,y),(0,ve.Z)(x)&&u.getOrCreateImage(x,y).then(function(E){var w=E.img,S=w.width,M=w.height;y.attributes.keepAspectRatio&&f(y,S,M),y.renderable.dirty=!0,s.dirtify()}).catch(function(){}))};s.hooks.init.tap(a.tag,function(){h.addEventListener($t.MOUNTED,d),h.addEventListener($t.ATTR_MODIFIED,v)}),s.hooks.destroy.tap(a.tag,function(){h.removeEventListener($t.MOUNTED,d),h.removeEventListener($t.ATTR_MODIFIED,v)})}}])}();O1.tag="LoadImage";var XA=function(a){function n(){var r;(0,I.Z)(this,n);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=(0,G.Z)(this,n,[].concat(l)),r.name="image-loader",r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"init",value:function(s){this.context.imagePool=new ov(this.context,s),this.addRenderingPlugin(new O1)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(aa);var en=UA("renderState"),k1=function(){function a(n){(0,I.Z)(this,a),this.removedRBushNodeAABBs=[],this.renderQueue=[],Object.defineProperty(this,en,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=Ce(),this.dprMatrix=Ce(),this.tmpMat4=Ce(),this.vec3a=j(),this.vec3b=j(),this.vec3c=j(),this.vec3d=j(),this.canvasRendererPluginOptions=n}return(0,D.Z)(a,[{key:"apply",value:function(r,s){var l=this;this.context=r;var u=this.context,h=u.config,f=u.camera,d=u.renderingService,v=u.renderingContext,p=u.rBushRoot,g=u.pathGeneratorFactory,y=h.renderer.getConfig().enableRenderingOptimization;h.renderer.getConfig().enableDirtyCheck=!1,h.renderer.getConfig().enableDirtyRectangleRendering=!1,this.rBush=p,this.pathGeneratorFactory=g;var m=r.contextService,b=v.root.ownerDocument.defaultView,x=function(C){var T=C.target,O=T.rBushNode;O!=null&&O.aabb&&l.removedRBushNodeAABBs.push(O.aabb)},E=function(C){var T=C.target,O=T.rBushNode;O.aabb&&l.removedRBushNodeAABBs.push(O.aabb)};d.hooks.init.tap(a.tag,function(){b.addEventListener($t.UNMOUNTED,x),b.addEventListener($t.CULLED,E);var M=m.getDPR(),C=h.width,T=h.height,O=m.getContext();l.clearRect(O,0,0,C*M,T*M,h.background)}),d.hooks.destroy.tap(a.tag,function(){b.removeEventListener($t.UNMOUNTED,x),b.removeEventListener($t.CULLED,E),l.renderQueue=[],l.removedRBushNodeAABBs=[],Mi(l,en)[en]={restoreStack:[],prevObject:null,currentContext:null}});var w=function(){var C,T=m.getContext(),O=m.getDPR(),k=h.width,P=h.height,A=l.canvasRendererPluginOptions,N=A.dirtyObjectNumThreshold,L=A.dirtyObjectRatioThreshold,R=d.getStats(),z=R.total,Z=R.rendered,X=Z/z;l.clearFullScreen=l.clearFullScreenLastFrame||!((C=b.context.renderingPlugins[1])!==null&&C!==void 0&&C.isFirstTimeRenderingFinished)||d.disableDirtyRectangleRendering()||Z>N&&X>L,T&&(typeof T.resetTransform=="function"?T.resetTransform():T.setTransform(1,0,0,1,0,0),l.clearFullScreen&&l.clearRect(T,0,0,k*O,P*O,h.background))},S=function(C,T){for(var O=[C];O.length>0;){var k,P=O.pop();P.isVisible()&&!P.isCulled()&&(y?l.renderDisplayObjectOptimized(P,T,l.context,Mi(l,en)[en],s):l.renderDisplayObject(P,T,l.context,Mi(l,en)[en],s));for(var A=((k=P.sortable)===null||k===void 0||(k=k.sorted)===null||k===void 0?void 0:k.length)>0?P.sortable.sorted:P.childNodes,N=A.length-1;N>=0;N--)O.push(A[N])}};d.hooks.endFrame.tap(a.tag,function(){if(w(),v.root.childNodes.length===0){l.clearFullScreenLastFrame=!0;return}y=h.renderer.getConfig().enableRenderingOptimization,Mi(l,en)[en]={restoreStack:[],prevObject:null,currentContext:Mi(l,en)[en].currentContext},Mi(l,en)[en].currentContext.clear(),l.clearFullScreenLastFrame=!1;var M=m.getContext(),C=m.getDPR();if(Na(l.dprMatrix,[C,C,1]),An(l.vpMatrix,l.dprMatrix,f.getOrthoMatrix()),l.clearFullScreen)y?(M.save(),S(v.root,M),M.restore()):S(v.root,M),l.removedRBushNodeAABBs=[];else{var T=l.safeMergeAABB.apply(l,[l.mergeDirtyAABBs(l.renderQueue)].concat((0,B.Z)(l.removedRBushNodeAABBs.map(function(Pt){var ie=Pt.minX,Kt=Pt.minY,re=Pt.maxX,te=Pt.maxY,ze=new ke;return ze.setMinMax([ie,Kt,0],[re,te,0]),ze}))));if(l.removedRBushNodeAABBs=[],ke.isEmpty(T)){l.renderQueue=[];return}var O=l.convertAABB2Rect(T),k=O.x,P=O.y,A=O.width,N=O.height,L=dn(l.vec3a,[k,P,0],l.vpMatrix),R=dn(l.vec3b,[k+A,P,0],l.vpMatrix),z=dn(l.vec3c,[k,P+N,0],l.vpMatrix),Z=dn(l.vec3d,[k+A,P+N,0],l.vpMatrix),X=Math.min(L[0],R[0],Z[0],z[0]),nt=Math.min(L[1],R[1],Z[1],z[1]),K=Math.max(L[0],R[0],Z[0],z[0]),rt=Math.max(L[1],R[1],Z[1],z[1]),U=Math.floor(X),at=Math.floor(nt),ht=Math.ceil(K-X),pt=Math.ceil(rt-nt);M.save(),l.clearRect(M,U,at,ht,pt,h.background),M.beginPath(),M.rect(U,at,ht,pt),M.clip(),M.setTransform(l.vpMatrix[0],l.vpMatrix[1],l.vpMatrix[4],l.vpMatrix[5],l.vpMatrix[12],l.vpMatrix[13]);var Ct=h.renderer.getConfig(),Zt=Ct.enableDirtyRectangleRenderingDebug;Zt&&b.dispatchEvent(new sn(vr.DIRTY_RECTANGLE,{dirtyRect:{x:U,y:at,width:ht,height:pt}}));var Nt=l.searchDirtyObjects(T);Nt.sort(function(Pt,ie){return Pt.sortable.renderOrder-ie.sortable.renderOrder}).forEach(function(Pt){Pt&&Pt.isVisible()&&!Pt.isCulled()&&l.renderDisplayObject(Pt,M,l.context,Mi(l,en)[en],s)}),M.restore(),l.renderQueue.forEach(function(Pt){l.saveDirtyAABB(Pt)}),l.renderQueue=[]}Mi(l,en)[en].restoreStack.forEach(function(){M.restore()}),Mi(l,en)[en].restoreStack=[]}),d.hooks.render.tap(a.tag,function(M){l.clearFullScreen||l.renderQueue.push(M)})}},{key:"clearRect",value:function(r,s,l,u,h,f){r.clearRect(s,l,u,h),f&&(r.fillStyle=f,r.fillRect(s,l,u,h))}},{key:"renderDisplayObjectOptimized",value:function(r,s,l,u,h){var f=r.nodeName,d=!1,v=!1,p=this.context.styleRendererFactory[f],g=this.pathGeneratorFactory[f],y=r.parsedStyle.clipPath;if(y){d=!u.prevObject||!Tf(y.getWorldTransform(),u.prevObject.getWorldTransform()),d&&(this.applyWorldTransform(s,y),u.prevObject=null);var m=this.pathGeneratorFactory[y.nodeName];m&&(s.save(),v=!0,s.beginPath(),m(s,y.parsedStyle),s.closePath(),s.clip())}if(p){d=!u.prevObject||!Tf(r.getWorldTransform(),u.prevObject.getWorldTransform()),d&&this.applyWorldTransform(s,r);var b=!u.prevObject;if(!b){var x=u.prevObject.nodeName;f===J.TEXT?b=x!==J.TEXT:f===J.IMAGE?b=x!==J.IMAGE:b=x===J.TEXT||x===J.IMAGE}p.applyStyleToContext(s,r,b,u),u.prevObject=r}g&&(s.beginPath(),g(s,r.parsedStyle),f!==J.LINE&&f!==J.PATH&&f!==J.POLYLINE&&s.closePath()),p&&p.drawToContext(s,r,Mi(this,en)[en],this,h),v&&s.restore(),r.dirty(!1)}},{key:"renderDisplayObject",value:function(r,s,l,u,h){var f=r.nodeName,d=u.restoreStack[u.restoreStack.length-1];d&&!(r.compareDocumentPosition(d)&Be.DOCUMENT_POSITION_CONTAINS)&&(s.restore(),u.restoreStack.pop());var v=this.context.styleRendererFactory[f],p=this.pathGeneratorFactory[f],g=r.parsedStyle.clipPath;if(g){this.applyWorldTransform(s,g);var y=this.pathGeneratorFactory[g.nodeName];y&&(s.save(),u.restoreStack.push(r),s.beginPath(),y(s,g.parsedStyle),s.closePath(),s.clip())}v&&(this.applyWorldTransform(s,r),s.save(),this.applyAttributesToContext(s,r)),p&&(s.beginPath(),p(s,r.parsedStyle),f!==J.LINE&&f!==J.PATH&&f!==J.POLYLINE&&s.closePath()),v&&(v.render(s,r.parsedStyle,r,l,this,h),s.restore()),r.dirty(!1)}},{key:"applyAttributesToContext",value:function(r,s){var l=s.parsedStyle,u=l.stroke,h=l.fill,f=l.opacity,d=l.lineDash,v=l.lineDashOffset;d&&r.setLineDash(d),(0,At.Z)(v)||(r.lineDashOffset=v),(0,At.Z)(f)||(r.globalAlpha*=f),!(0,At.Z)(u)&&!Array.isArray(u)&&!u.isNone&&(r.strokeStyle=s.attributes.stroke),!(0,At.Z)(h)&&!Array.isArray(h)&&!h.isNone&&(r.fillStyle=s.attributes.fill)}},{key:"convertAABB2Rect",value:function(r){var s=r.getMin(),l=r.getMax(),u=Math.floor(s[0]),h=Math.floor(s[1]),f=Math.ceil(l[0]),d=Math.ceil(l[1]),v=f-u,p=d-h;return{x:u,y:h,width:v,height:p}}},{key:"mergeDirtyAABBs",value:function(r){var s=new ke;return r.forEach(function(l){var u=l.getRenderBounds();s.add(u);var h=l.renderable.dirtyRenderBounds;h&&s.add(h)}),s}},{key:"searchDirtyObjects",value:function(r){var s=r.getMin(),l=(0,W.Z)(s,2),u=l[0],h=l[1],f=r.getMax(),d=(0,W.Z)(f,2),v=d[0],p=d[1],g=this.rBush.search({minX:u,minY:h,maxX:v,maxY:p});return g.map(function(y){var m=y.displayObject;return m})}},{key:"saveDirtyAABB",value:function(r){var s=r.renderable;s.dirtyRenderBounds||(s.dirtyRenderBounds=new ke);var l=r.getRenderBounds();l&&s.dirtyRenderBounds.update(l.center,l.halfExtents)}},{key:"applyWorldTransform",value:function(r,s,l){l?(Ts(this.tmpMat4,s.getLocalTransform()),An(this.tmpMat4,l,this.tmpMat4),An(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(Ts(this.tmpMat4,s.getWorldTransform()),An(this.tmpMat4,this.vpMatrix,this.tmpMat4)),r.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:"safeMergeAABB",value:function(){for(var r=new ke,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return l.forEach(function(h){r.add(h)}),r}}])}();k1.tag="CanvasRenderer";function Ju(a,n,r,s,l,u,h){var f,d;if(a.image.nodeName==="rect"){var v=a.image.parsedStyle,p=v.width,g=v.height;d=s.contextService.getDPR();var y=s.config.offscreenCanvas;f=u.offscreenCanvasCreator.getOrCreateCanvas(y),f.width=p*d,f.height=g*d;var m=u.offscreenCanvasCreator.getOrCreateContext(y),b={restoreStack:[],prevObject:null,currentContext:new Map};a.image.forEach(function(E){l.renderDisplayObject(E,m,s,b,u)}),b.restoreStack.forEach(function(){m.restore()})}var x=h.getOrCreatePatternSync(n,a,r,f,d,n.getGeometryBounds().min,function(){n.dirty(),s.renderingService.dirtify()});return x}function th(a,n,r,s){var l;if(a.type===sa.LinearGradient||a.type===sa.RadialGradient){var u=n.getGeometryBounds(),h=u&&u.halfExtents[0]*2||1,f=u&&u.halfExtents[1]*2||1,d=u&&u.min||[0,0];l=s.getOrCreateGradient((0,$.Z)((0,$.Z)({type:a.type},a.value),{},{min:d,width:h,height:f}),r)}return l}var eh=["shadowBlur","shadowOffsetX","shadowOffsetY"],_1=["lineCap","lineJoin","miterLimit"],on={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},P1={};function je(a,n,r,s){var l=s.has(n)?s.get(n):on[n];return l!==r&&(n==="lineDash"?a.setLineDash(r):a[n]=r,s.set(n,r)),l}var qA=function(){function a(n){(0,I.Z)(this,a),this.imagePool=n}return(0,D.Z)(a,[{key:"applyAttributesToContext",value:function(r,s){}},{key:"render",value:function(r,s,l,u,h,f){}},{key:"applyCommonStyleToContext",value:function(r,s,l,u){var h=l?P1:u.prevObject.parsedStyle,f=s.parsedStyle;(l||f.opacity!==h.opacity)&&je(r,"globalAlpha",(0,At.Z)(f.opacity)?on.globalAlpha:f.opacity,u.currentContext),(l||f.blend!==h.blend)&&je(r,"globalCompositeOperation",(0,At.Z)(f.blend)?on.globalCompositeOperation:f.blend,u.currentContext)}},{key:"applyStrokeFillStyleToContext",value:function(r,s,l,u){var h=l?P1:u.prevObject.parsedStyle,f=s.parsedStyle,d=f.lineWidth,v=d===void 0?on.lineWidth:d,p=f.fill&&!f.fill.isNone,g=f.stroke&&!f.stroke.isNone&&v>0;if(g){if(l||s.attributes.stroke!==u.prevObject.attributes.stroke){var y=!(0,At.Z)(f.stroke)&&!Array.isArray(f.stroke)&&!f.stroke.isNone?s.attributes.stroke:on.strokeStyle;je(r,"strokeStyle",y,u.currentContext)}(l||f.lineWidth!==h.lineWidth)&&je(r,"lineWidth",(0,At.Z)(f.lineWidth)?on.lineWidth:f.lineWidth,u.currentContext),(l||f.lineDash!==h.lineDash)&&je(r,"lineDash",f.lineDash||on.lineDash,u.currentContext),(l||f.lineDashOffset!==h.lineDashOffset)&&je(r,"lineDashOffset",(0,At.Z)(f.lineDashOffset)?on.lineDashOffset:f.lineDashOffset,u.currentContext);for(var m=0;m<_1.length;m++){var b=_1[m];(l||f[b]!==h[b])&&je(r,b,(0,At.Z)(f[b])?on[b]:f[b],u.currentContext)}}if(p&&(l||s.attributes.fill!==u.prevObject.attributes.fill)){var x=!(0,At.Z)(f.fill)&&!Array.isArray(f.fill)&&!f.fill.isNone?s.attributes.fill:on.fillStyle;je(r,"fillStyle",x,u.currentContext)}}},{key:"applyStyleToContext",value:function(r,s,l,u){var h=s.nodeName;this.applyCommonStyleToContext(r,s,l,u),h===J.IMAGE||this.applyStrokeFillStyleToContext(r,s,l,u)}},{key:"applyShadowAndFilterStyleToContext",value:function(r,s,l,u){var h=s.parsedStyle;if(l){je(r,"shadowColor",h.shadowColor.toString(),u.currentContext);for(var f=0;f<eh.length;f++){var d=eh[f];je(r,d,h[d]||on[d],u.currentContext)}}h.filter&&h.filter.length&&je(r,"filter",s.attributes.filter,u.currentContext)}},{key:"clearShadowAndFilterStyleForContext",value:function(r,s,l,u){var h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(s){je(r,"shadowColor",on.shadowColor,u.currentContext);for(var f=0;f<eh.length;f++){var d=eh[f];je(r,d,on[d],u.currentContext)}}if(l)if(s&&h){var v=r.filter;!(0,At.Z)(v)&&v.indexOf("drop-shadow")>-1&&je(r,"filter",v.replace(/drop-shadow\([^)]*\)/,"").trim()||on.filter,u.currentContext)}else je(r,"filter",on.filter,u.currentContext)}},{key:"fillToContext",value:function(r,s,l,u,h){var f=this,d=s.parsedStyle,v=d.fill,p=d.fillRule,g=null;if(Array.isArray(v)&&v.length>0)v.forEach(function(m){var b=je(r,"fillStyle",th(m,s,r,f.imagePool),l.currentContext);g=g!=null?g:b,p?r.fill(p):r.fill()});else{if(za(v)){var y=Ju(v,s,r,s.ownerDocument.defaultView.context,u,h,this.imagePool);y&&(r.fillStyle=y,g=!0)}p?r.fill(p):r.fill()}g!==null&&je(r,"fillStyle",g,l.currentContext)}},{key:"strokeToContext",value:function(r,s,l,u,h){var f=this,d=s.parsedStyle.stroke,v=null;if(Array.isArray(d)&&d.length>0)d.forEach(function(y){var m=je(r,"strokeStyle",th(y,s,r,f.imagePool),l.currentContext);v=v!=null?v:m,r.stroke()});else{if(za(d)){var p=Ju(d,s,r,s.ownerDocument.defaultView.context,u,h,this.imagePool);if(p){var g=je(r,"strokeStyle",p,l.currentContext);v=v!=null?v:g}}r.stroke()}v!==null&&je(r,"strokeStyle",v,l.currentContext)}},{key:"drawToContext",value:function(r,s,l,u,h){var f,d=s.nodeName,v=s.parsedStyle,p=v.opacity,g=p===void 0?on.globalAlpha:p,y=v.fillOpacity,m=y===void 0?on.fillOpacity:y,b=v.strokeOpacity,x=b===void 0?on.strokeOpacity:b,E=v.lineWidth,w=E===void 0?on.lineWidth:E,S=v.fill&&!v.fill.isNone,M=v.stroke&&!v.stroke.isNone&&w>0;if(!(!S&&!M)){var C=!(0,At.Z)(v.shadowColor)&&v.shadowBlur>0,T=v.shadowType==="inner",O=((f=v.fill)===null||f===void 0?void 0:f.alpha)===0,k=!!(v.filter&&v.filter.length),P=C&&M&&(d===J.PATH||d===J.LINE||d===J.POLYLINE||O||T),A=null;if(S){P||this.applyShadowAndFilterStyleToContext(r,s,C,l);var N=g*m;A=je(r,"globalAlpha",N,l.currentContext),this.fillToContext(r,s,l,u,h),P||this.clearShadowAndFilterStyleForContext(r,C,k,l)}if(M){var L=!1,R=g*x,z=je(r,"globalAlpha",R,l.currentContext);if(A=S?A:z,P&&(this.applyShadowAndFilterStyleToContext(r,s,C,l),L=!0,T)){var Z=r.globalCompositeOperation;r.globalCompositeOperation="source-atop",this.strokeToContext(r,s,l,u,h),r.globalCompositeOperation=Z,this.clearShadowAndFilterStyleForContext(r,C,k,l,!0)}this.strokeToContext(r,s,l,u,h),L&&this.clearShadowAndFilterStyleForContext(r,C,k,l)}A!==null&&je(r,"globalAlpha",A,l.currentContext)}}}])}(),lv=function(a){function n(){return(0,I.Z)(this,n),(0,G.Z)(this,n,arguments)}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"render",value:function(s,l,u,h,f,d){var v=l.fill,p=l.fillRule,g=l.opacity,y=g===void 0?1:g,m=l.fillOpacity,b=m===void 0?1:m,x=l.stroke,E=l.strokeOpacity,w=E===void 0?1:E,S=l.lineWidth,M=S===void 0?1:S,C=l.lineCap,T=l.lineJoin,O=l.shadowType,k=l.shadowColor,P=l.shadowBlur,A=l.filter,N=l.miterLimit,L=v&&!v.isNone,R=x&&!x.isNone&&M>0,z=(v==null?void 0:v.alpha)===0,Z=!!(A&&A.length),X=!(0,At.Z)(k)&&P>0,nt=u.nodeName,K=O==="inner",rt=R&&X&&(nt===J.PATH||nt===J.LINE||nt===J.POLYLINE||z||K);L&&(s.globalAlpha=y*b,rt||nh(u,s,X),A1(s,u,v,p,h,f,d,this.imagePool),rt||this.clearShadowAndFilter(s,Z,X)),R&&(s.globalAlpha=y*w,s.lineWidth=M,(0,At.Z)(N)||(s.miterLimit=N),(0,At.Z)(C)||(s.lineCap=C),(0,At.Z)(T)||(s.lineJoin=T),rt&&(K&&(s.globalCompositeOperation="source-atop"),nh(u,s,!0),K&&(cv(s,u,x,h,f,d,this.imagePool),s.globalCompositeOperation=on.globalCompositeOperation,this.clearShadowAndFilter(s,Z,!0))),cv(s,u,x,h,f,d,this.imagePool))}},{key:"clearShadowAndFilter",value:function(s,l,u){if(u&&(s.shadowColor="transparent",s.shadowBlur=0),l){var h=s.filter;!(0,At.Z)(h)&&h.indexOf("drop-shadow")>-1&&(s.filter=h.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}}}])}(qA);function nh(a,n,r){var s=a.parsedStyle,l=s.filter,u=s.shadowColor,h=s.shadowBlur,f=s.shadowOffsetX,d=s.shadowOffsetY;l&&l.length&&(n.filter=a.style.filter),r&&(n.shadowColor=u.toString(),n.shadowBlur=h||0,n.shadowOffsetX=f||0,n.shadowOffsetY=d||0)}function A1(a,n,r,s,l,u,h,f){var d=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1;Array.isArray(r)?r.forEach(function(v){a.fillStyle=th(v,n,a,f),d||(s?a.fill(s):a.fill())}):(za(r)&&(a.fillStyle=Ju(r,n,a,l,u,h,f)),d||(s?a.fill(s):a.fill()))}function cv(a,n,r,s,l,u,h){var f=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;Array.isArray(r)?r.forEach(function(d){a.strokeStyle=th(d,n,a,h),f||a.stroke()}):(za(r)&&(a.strokeStyle=Ju(r,n,a,s,l,u,h)),f||a.stroke())}function KA(a,n){var r=(0,W.Z)(a,4),s=r[0],l=r[1],u=r[2],h=r[3],f=(0,W.Z)(n,4),d=f[0],v=f[1],p=f[2],g=f[3],y=Math.max(s,d),m=Math.max(l,v),b=Math.min(s+u,d+p),x=Math.min(l+h,v+g);return b<=y||x<=m?null:[y,m,b-y,x-m]}function QA(a,n){var r=dn(j(),[a[0],a[1],0],n),s=dn(j(),[a[0]+a[2],a[1],0],n),l=dn(j(),[a[0],a[1]+a[3],0],n),u=dn(j(),[a[0]+a[2],a[1]+a[3],0],n);return[Math.min(r[0],s[0],l[0],u[0]),Math.min(r[1],s[1],l[1],u[1]),Math.max(r[0],s[0],l[0],u[0])-Math.min(r[0],s[0],l[0],u[0]),Math.max(r[1],s[1],l[1],u[1])-Math.min(r[1],s[1],l[1],u[1])]}var JA=function(a){function n(){return(0,I.Z)(this,n),(0,G.Z)(this,n,arguments)}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"renderDownSampled",value:function(s,l,u,h){var f=h.src,d=h.imageCache;if(!d.downSampled){this.imagePool.createDownSampledImage(f,u).then(function(){u.ownerDocument&&(u.dirty(),u.ownerDocument.defaultView.context.renderingService.dirtify())}).catch(function(v){console.error(v)});return}s.drawImage(d.downSampled,Math.floor(h.drawRect[0]),Math.floor(h.drawRect[1]),Math.ceil(h.drawRect[2]),Math.ceil(h.drawRect[3]))}},{key:"renderTile",value:function(s,l,u,h){var f=h.src,d=h.imageCache,v=h.imageRect,p=h.drawRect,g=d.size,y=s.getTransform(),m=y.a,b=y.b,x=y.c,E=y.d,w=y.e,S=y.f;if(s.resetTransform(),!(d!=null&&d.gridSize)){this.imagePool.createImageTiles(f,[],function(){u.ownerDocument&&(u.dirty(),u.ownerDocument.defaultView.context.renderingService.dirtify())},u).catch(function(X){console.error(X)});return}for(var M=[g[0]/v[2],g[1]/v[3]],C=[d.tileSize[0]/M[0],d.tileSize[1]/M[1]],T=[Math.floor((p[0]-v[0])/C[0]),Math.ceil((p[0]+p[2]-v[0])/C[0])],O=T[0],k=T[1],P=[Math.floor((p[1]-v[1])/C[1]),Math.ceil((p[1]+p[3]-v[1])/C[1])],A=P[0],N=P[1],L=A;L<=N;L++)for(var R=O;R<=k;R++){var z=d.tiles[L][R];if(z){var Z=[Math.floor(v[0]+z.tileX*C[0]),Math.floor(v[1]+z.tileY*C[1]),Math.ceil(C[0]),Math.ceil(C[1])];s.drawImage(z.data,Z[0],Z[1],Z[2],Z[3])}}s.setTransform(m,b,x,E,w,S)}},{key:"render",value:function(s,l,u){var h=l.x,f=h===void 0?0:h,d=l.y,v=d===void 0?0:d,p=l.width,g=l.height,y=l.src,m=l.shadowColor,b=l.shadowBlur,x=this.imagePool.getImageSync(y,u),E=x==null?void 0:x.img,w=p,S=g;if(E){w||(w=E.width),S||(S=E.height);var M=!(0,At.Z)(m)&&b>0;nh(u,s,M);try{var C=u.ownerDocument.defaultView.getContextService().getDomElement(),T=C.width,O=C.height,k=s.getTransform(),P=k.a,A=k.b,N=k.c,L=k.d,R=k.e,z=k.f,Z=Ep(P,N,0,0,A,L,0,0,0,0,1,0,R,z,0,1),X=QA([f,v,w,S],Z),nt=KA([0,0,T,O],X);if(!nt)return;if(!u.ownerDocument.defaultView.getConfig().enableLargeImageOptimization){n.renderFull(s,l,u,{image:E,drawRect:[f,v,w,S]});return}var K=X[2]/x.size[0];if(K<(x.downSamplingRate||.5)){this.renderDownSampled(s,l,u,{src:y,imageCache:x,drawRect:[f,v,w,S]});return}if(!ov.isSupportTile){n.renderFull(s,l,u,{image:E,drawRect:[f,v,w,S]});return}this.renderTile(s,l,u,{src:y,imageCache:x,imageRect:X,drawRect:nt})}catch(rt){}}}},{key:"drawToContext",value:function(s,l,u,h,f){this.render(s,l.parsedStyle,l)}}],[{key:"renderFull",value:function(s,l,u,h){s.drawImage(h.image,Math.floor(h.drawRect[0]),Math.floor(h.drawRect[1]),Math.ceil(h.drawRect[2]),Math.ceil(h.drawRect[3]))}}])}(lv),t3=function(a){function n(){return(0,I.Z)(this,n),(0,G.Z)(this,n,arguments)}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"render",value:function(s,l,u,h,f,d){u.getBounds();var v=l.lineWidth,p=v===void 0?1:v,g=l.textAlign,y=g===void 0?"start":g,m=l.textBaseline,b=m===void 0?"alphabetic":m,x=l.lineJoin,E=x===void 0?"miter":x,w=l.miterLimit,S=w===void 0?10:w,M=l.letterSpacing,C=M===void 0?0:M,T=l.stroke,O=l.fill,k=l.fillRule,P=l.fillOpacity,A=P===void 0?1:P,N=l.strokeOpacity,L=N===void 0?1:N,R=l.opacity,z=R===void 0?1:R,Z=l.metrics,X=l.x,nt=X===void 0?0:X,K=l.y,rt=K===void 0?0:K,U=l.dx,at=l.dy,ht=l.shadowColor,pt=l.shadowBlur,Ct=Z.font,Zt=Z.lines,Nt=Z.height,Pt=Z.lineHeight,ie=Z.lineMetrics;s.font=Ct,s.lineWidth=p,s.textAlign=y==="middle"?"center":y;var Kt=b;Kt==="alphabetic"&&(Kt="bottom"),s.lineJoin=E,(0,At.Z)(S)||(s.miterLimit=S);var re=rt;b==="middle"?re+=-Nt/2-Pt/2:b==="bottom"||b==="alphabetic"||b==="ideographic"?re+=-Nt:(b==="top"||b==="hanging")&&(re+=-Pt);var te=nt+(U||0);re+=at||0,Zt.length===1&&(Kt==="bottom"?(Kt="middle",re-=.5*Nt):Kt==="top"&&(Kt="middle",re+=.5*Nt)),s.textBaseline=Kt;var ze=!(0,At.Z)(ht)&&pt>0;nh(u,s,ze);for(var Yt=0;Yt<Zt.length;Yt++){var wr=p/2+te;re+=Pt,!(0,At.Z)(T)&&!T.isNone&&p&&this.drawLetterSpacing(s,u,Zt[Yt],ie[Yt],y,wr,re,C,O,k,A,T,L,z,!0,h,f,d),(0,At.Z)(O)||this.drawLetterSpacing(s,u,Zt[Yt],ie[Yt],y,wr,re,C,O,k,A,T,L,z,!1,h,f,d)}}},{key:"drawLetterSpacing",value:function(s,l,u,h,f,d,v,p,g,y,m,b,x,E,w,S,M,C){if(p===0){w?this.strokeText(s,l,u,d,v,b,x,S,M,C):this.fillText(s,l,u,d,v,g,y,m,E,S,M,C);return}var T=s.textAlign;s.textAlign="left";var O=d;f==="center"||f==="middle"?O=d-h.width/2:(f==="right"||f==="end")&&(O=d-h.width);for(var k=Array.from(u),P=s.measureText(u).width,A=0,N=0;N<k.length;++N){var L=k[N];w?this.strokeText(s,l,L,O,v,b,x,S,M,C):this.fillText(s,l,L,O,v,g,y,m,E,S,M,C),A=s.measureText(u.substring(N+1)).width,O+=P-A+p,P=A}s.textAlign=T}},{key:"fillText",value:function(s,l,u,h,f,d,v,p,g,y,m,b){A1(s,l,d,v,y,m,b,this.imagePool,!0);var x,E=!(0,At.Z)(p)&&p!==1;E&&(x=s.globalAlpha,s.globalAlpha=p*g),s.fillText(u,h,f),E&&(s.globalAlpha=x)}},{key:"strokeText",value:function(s,l,u,h,f,d,v,p,g,y){cv(s,l,d,p,g,y,this.imagePool,!0);var m,b=!(0,At.Z)(v)&&v!==1;b&&(m=s.globalAlpha,s.globalAlpha=v),s.strokeText(u,h,f),b&&(s.globalAlpha=m)}},{key:"drawToContext",value:function(s,l,u,h,f){this.render(s,l.parsedStyle,l,l.ownerDocument.defaultView.context,h,f)}}])}(lv),e3=function(a){function n(){var r,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,I.Z)(this,n),r=(0,G.Z)(this,n),r.name="canvas-renderer",r.options=s,r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"init",value:function(){var s,l=(0,$.Z)({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),u=this.context.imagePool,h=new lv(u),f=(s={},(0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)((0,St.Z)(s,J.CIRCLE,h),J.ELLIPSE,h),J.RECT,h),J.IMAGE,new JA(u)),J.TEXT,new t3(u)),J.LINE,h),J.POLYLINE,h),J.POLYGON,h),J.PATH,h),J.GROUP,void 0),(0,St.Z)((0,St.Z)((0,St.Z)(s,J.HTML,void 0),J.MESH,void 0),J.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=f,this.context.styleRendererFactory=f,this.addRenderingPlugin(new k1(l))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])}(aa);var N1=function(){function a(){(0,I.Z)(this,a)}return(0,D.Z)(a,[{key:"apply",value:function(r,s){var l=this,u=r.renderingService,h=r.renderingContext,f=r.config;this.context=r;var d=h.root.ownerDocument.defaultView,v=function(P){u.hooks.pointerMove.call(P)},p=function(P){u.hooks.pointerUp.call(P)},g=function(P){u.hooks.pointerDown.call(P)},y=function(P){u.hooks.pointerOver.call(P)},m=function(P){u.hooks.pointerOut.call(P)},b=function(P){u.hooks.pointerCancel.call(P)},x=function(P){u.hooks.pointerWheel.call(P)},E=function(P){u.hooks.click.call(P)},w=function(P){s.globalThis.document.addEventListener("pointermove",v,!0),P.addEventListener("pointerdown",g,!0),P.addEventListener("pointerleave",m,!0),P.addEventListener("pointerover",y,!0),s.globalThis.addEventListener("pointerup",p,!0),s.globalThis.addEventListener("pointercancel",b,!0)},S=function(P){P.addEventListener("touchstart",g,!0),P.addEventListener("touchend",p,!0),P.addEventListener("touchmove",v,!0),P.addEventListener("touchcancel",b,!0)},M=function(P){s.globalThis.document.addEventListener("mousemove",v,!0),P.addEventListener("mousedown",g,!0),P.addEventListener("mouseout",m,!0),P.addEventListener("mouseover",y,!0),s.globalThis.addEventListener("mouseup",p,!0)},C=function(P){s.globalThis.document.removeEventListener("pointermove",v,!0),P.removeEventListener("pointerdown",g,!0),P.removeEventListener("pointerleave",m,!0),P.removeEventListener("pointerover",y,!0),s.globalThis.removeEventListener("pointerup",p,!0),s.globalThis.removeEventListener("pointercancel",b,!0)},T=function(P){P.removeEventListener("touchstart",g,!0),P.removeEventListener("touchend",p,!0),P.removeEventListener("touchmove",v,!0),P.removeEventListener("touchcancel",b,!0)},O=function(P){s.globalThis.document.removeEventListener("mousemove",v,!0),P.removeEventListener("mousedown",g,!0),P.removeEventListener("mouseout",m,!0),P.removeEventListener("mouseover",y,!0),s.globalThis.removeEventListener("mouseup",p,!0)};u.hooks.init.tap(a.tag,function(){var k=l.context.contextService.getDomElement();s.globalThis.navigator.msPointerEnabled?(k.style.msContentZooming="none",k.style.msTouchAction="none"):d.supportsPointerEvents&&(k.style.touchAction="none"),d.supportsPointerEvents?w(k):M(k),d.supportsTouchEvents&&S(k),f.useNativeClickEvent&&k.addEventListener("click",E,!0),k.addEventListener("wheel",x,{passive:!0,capture:!0})}),u.hooks.destroy.tap(a.tag,function(){var k=l.context.contextService.getDomElement();s.globalThis.navigator.msPointerEnabled?(k.style.msContentZooming="",k.style.msTouchAction=""):d.supportsPointerEvents&&(k.style.touchAction=""),d.supportsPointerEvents?C(k):O(k),d.supportsTouchEvents&&T(k),f.useNativeClickEvent&&k.removeEventListener("click",E,!0),k.removeEventListener("wheel",x,!0)})}}])}();N1.tag="DOMInteraction";var n3=function(a){function n(){var r;(0,I.Z)(this,n);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=(0,G.Z)(this,n,[].concat(l)),r.name="dom-interaction",r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"init",value:function(){this.addRenderingPlugin(new N1)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(aa);var r3="g-canvas-camera",R1=function(){function a(){(0,I.Z)(this,a),this.displayObjectHTMLElementMap=new WeakMap}return(0,D.Z)(a,[{key:"joinTransformMatrix",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return"matrix(".concat([r[0],r[1],r[4],r[5],r[12]+s[0],r[13]+s[1]].join(","),")")}},{key:"apply",value:function(r,s){var l=this,u=r.camera,h=r.renderingContext,f=r.renderingService;this.context=r;var d=h.root.ownerDocument.defaultView,v=d.context.eventService.nativeHTMLMap,p=function(w,S){S.style.transform=l.joinTransformMatrix(w.getWorldTransform(),w.getOrigin())},g=function(w){var S=w.target;if(S.nodeName===J.HTML){l.$camera||(l.$camera=l.createCamera(u));var M=l.getOrCreateEl(S);l.$camera.appendChild(M),Object.keys(S.attributes).forEach(function(C){l.updateAttribute(C,S)}),p(S,M),v.set(M,S)}},y=function(w){var S=w.target;if(S.nodeName===J.HTML&&l.$camera){var M=l.getOrCreateEl(S);M&&(M.remove(),v.delete(M))}},m=function(w){var S=w.target;if(S.nodeName===J.HTML){var M=w.attrName;l.updateAttribute(M,S)}},b=function(w){var S=w.target,M=S.nodeName===J.FRAGMENT?S.childNodes:[S];M.forEach(function(C){if(C.nodeName===J.HTML){var T=l.getOrCreateEl(C);p(C,T)}})},x=function(){if(l.$camera){var w=l.context.config,S=w.width,M=w.height;l.$camera.parentElement.style.width="".concat(S||0,"px"),l.$camera.parentElement.style.height="".concat(M||0,"px")}};f.hooks.init.tap(a.tag,function(){d.addEventListener(vr.RESIZE,x),d.addEventListener($t.MOUNTED,g),d.addEventListener($t.UNMOUNTED,y),d.addEventListener($t.ATTR_MODIFIED,m),d.addEventListener($t.BOUNDS_CHANGED,b)}),f.hooks.endFrame.tap(a.tag,function(){l.$camera&&h.renderReasons.has(Bs.CAMERA_CHANGED)&&(l.$camera.style.transform=l.joinTransformMatrix(u.getOrthoMatrix()))}),f.hooks.destroy.tap(a.tag,function(){l.$camera&&l.$camera.remove(),d.removeEventListener(vr.RESIZE,x),d.removeEventListener($t.MOUNTED,g),d.removeEventListener($t.UNMOUNTED,y),d.removeEventListener($t.ATTR_MODIFIED,m),d.removeEventListener($t.BOUNDS_CHANGED,b)})}},{key:"createCamera",value:function(r){var s=this.context.config,l=s.document,u=s.width,h=s.height,f=this.context.contextService.getDomElement(),d=f.parentNode;if(d){var v=r3,p=d.querySelector("#".concat(v));if(!p){var g=(l||document).createElement("div");g.style.overflow="hidden",g.style.pointerEvents="none",g.style.position="absolute",g.style.left="0px",g.style.top="0px",g.style.width="".concat(u||0,"px"),g.style.height="".concat(h||0,"px");var y=(l||document).createElement("div");p=y,y.id=v,y.style.position="absolute",y.style.left="".concat(f.offsetLeft||0,"px"),y.style.top="".concat(f.offsetTop||0,"px"),y.style.transformOrigin="left top",y.style.transform=this.joinTransformMatrix(r.getOrthoMatrix()),y.style.pointerEvents="none",y.style.width="100%",y.style.height="100%",g.appendChild(y),d.appendChild(g)}return p}return null}},{key:"getOrCreateEl",value:function(r){var s=this.context.config.document,l=this.displayObjectHTMLElementMap.get(r);return l||(l=(s||document).createElement("div"),r.parsedStyle.$el=l,this.displayObjectHTMLElementMap.set(r,l),r.id&&(l.id=r.id),r.name&&l.setAttribute("name",r.name),r.className&&(l.className=r.className),l.style.position="absolute",l.style["will-change"]="transform",l.style.transform=this.joinTransformMatrix(r.getWorldTransform(),r.getOrigin())),l}},{key:"updateAttribute",value:function(r,s){var l=this.getOrCreateEl(s);switch(r){case"innerHTML":var u=s.parsedStyle.innerHTML;(0,ve.Z)(u)?l.innerHTML=u:(l.innerHTML="",l.appendChild(u));break;case"x":l.style.left="".concat(s.parsedStyle.x,"px");break;case"y":l.style.top="".concat(s.parsedStyle.y,"px");break;case"transformOrigin":var h=s.parsedStyle.transformOrigin;l.style["transform-origin"]="".concat(h[0].buildCSSText(null,null,"")," ").concat(h[1].buildCSSText(null,null,""));break;case"width":var f=s.parsedStyle.width;l.style.width=(0,se.Z)(f)?"".concat(f,"px"):f.toString();break;case"height":var d=s.parsedStyle.height;l.style.height=(0,se.Z)(d)?"".concat(d,"px"):d.toString();break;case"zIndex":var v=s.parsedStyle.zIndex;l.style["z-index"]="".concat(v);break;case"visibility":var p=s.parsedStyle.visibility;l.style.visibility=p;break;case"pointerEvents":var g=s.parsedStyle.pointerEvents,y=g===void 0?"auto":g;l.style.pointerEvents=y;break;case"opacity":var m=s.parsedStyle.opacity;l.style.opacity="".concat(m);break;case"fill":var b=s.parsedStyle.fill,x="";Yc(b)?b.isNone?x="transparent":x=s.getAttribute("fill"):Array.isArray(b)?x=s.getAttribute("fill"):za(b),l.style.background=x;break;case"stroke":var E=s.parsedStyle.stroke,w="";Yc(E)?E.isNone?w="transparent":w=s.getAttribute("stroke"):Array.isArray(E)?w=s.getAttribute("stroke"):za(E),l.style["border-color"]=w,l.style["border-style"]="solid";break;case"lineWidth":var S=s.parsedStyle.lineWidth;l.style["border-width"]="".concat(S||0,"px");break;case"lineDash":l.style["border-style"]="dashed";break;case"filter":var M=s.style.filter;l.style.filter=M;break;default:!(0,At.Z)(s.style[r])&&s.style[r]!==""&&(l.style[r]=s.style[r])}}}])}();R1.tag="HTMLRendering";var i3=function(a){function n(){var r;(0,I.Z)(this,n);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=(0,G.Z)(this,n,[].concat(l)),r.name="html-renderer",r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"init",value:function(){this.addRenderingPlugin(new R1)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(aa);var a3=function(){function a(n){(0,I.Z)(this,a),this.renderingContext=n.renderingContext,this.canvasConfig=n.config}return(0,D.Z)(a,[{key:"init",value:function(){var r=this.canvasConfig,s=r.container,l=r.canvas;if(l)this.$canvas=l,s&&l.parentElement!==s&&s.appendChild(l),this.$container=l.parentElement,this.canvasConfig.container=this.$container;else if(s&&(this.$container=(0,ve.Z)(s)?document.getElementById(s):s,this.$container)){var u=document.createElement("canvas");this.$container.appendChild(u),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=u}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(r,s){var l=this.canvasConfig.devicePixelRatio;this.dpr=l,this.$canvas&&(this.$canvas.width=this.dpr*r,this.$canvas.height=this.dpr*s,uC(this.$canvas,r,s)),this.renderingContext.renderReasons.add(Bs.CAMERA_CHANGED)}},{key:"applyCursorStyle",value:function(r){this.$container&&this.$container.style&&(this.$container.style.cursor=r)}},{key:"toDataURL",value:function(){var n=(0,ia.Z)((0,Rn.Z)().mark(function s(){var l,u,h,f=arguments;return(0,Rn.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return l=f.length>0&&f[0]!==void 0?f[0]:{},u=l.type,h=l.encoderOptions,d.abrupt("return",this.context.canvas.toDataURL(u,h));case 1:case"end":return d.stop()}},s,this)}));function r(){return n.apply(this,arguments)}return r}()}])}(),s3=function(a){function n(){var r;(0,I.Z)(this,n);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=(0,G.Z)(this,n,[].concat(l)),r.name="canvas-context-register",r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"init",value:function(){this.context.ContextService=a3}},{key:"destroy",value:function(){delete this.context.ContextService}}])}(aa),sl=function(a){function n(r){var s;return(0,I.Z)(this,n),s=(0,G.Z)(this,n,[r]),s.registerPlugin(new s3),s.registerPlugin(new XA),s.registerPlugin(new CA),s.registerPlugin(new e3),s.registerPlugin(new n3),s.registerPlugin(new HA),s.registerPlugin(new i3),s}return(0,F.Z)(n,a),(0,D.Z)(n)}(nM),ol=Y(23413),o3=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class js extends Lr{constructor(n){super(Object.assign(Object.assign({},n),{style:Object.assign({},js.defaultStyleProps,n.style)})),this.rootPointerEvent=new tu(null),this.forwardEvents=r=>{const s=this.context.canvas,l=s.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(r,l).forEach(h=>{const f=this.bootstrapEvent(this.rootPointerEvent,h,l,r);el(s.context.eventService,"mappingTable.pointerupoutside",[]),s.context.eventService.mapEvent(f)})}}get eventService(){return this.context.canvas.context.eventService}get events(){return[tt.CLICK,tt.POINTER_DOWN,tt.POINTER_MOVE,tt.POINTER_UP,tt.POINTER_OVER,tt.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}render(n=this.parsedAttributes,r=this){this.drawKeyShape(n,r),this.drawPortShapes(n,r)}getKeyStyle(n){const r=(0,ol.Z)(n,["dx","dy","innerHTML","pointerEvents","cursor"]),{dx:s=0,dy:l=0}=r,u=o3(r,["dx","dy"]),[h,f]=this.getSize(n);return Object.assign(Object.assign({x:s,y:l},u),{width:h,height:f})}drawKeyShape(n,r){const s=this.getKeyStyle(n),{x:l,y:u,width:h=0,height:f=0}=s,d=this.upsert("key-container",Sn,{x:l,y:u,width:h,height:f,opacity:0},r);return this.upsert("key",$a,s,d)}connectedCallback(){if(!(this.context.canvas.getRenderer("main")instanceof sl))return;const s=this.getDomElement();this.events.forEach(l=>{s.addEventListener(l,this.forwardEvents)})}attributeChangedCallback(n,r,s){n==="zIndex"&&r!==s&&(this.getDomElement().style.zIndex=s)}destroy(){const n=this.getDomElement();this.events.forEach(r=>{n.removeEventListener(r,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(n,r){const s=[];if(r.isTouchEvent(n))for(let l=0;l<n.changedTouches.length;l++){const u=n.changedTouches[l];Ft(u.button)&&(u.button=0),Ft(u.buttons)&&(u.buttons=1),Ft(u.isPrimary)&&(u.isPrimary=n.touches.length===1&&n.type==="touchstart"),Ft(u.width)&&(u.width=u.radiusX||1),Ft(u.height)&&(u.height=u.radiusY||1),Ft(u.tiltX)&&(u.tiltX=0),Ft(u.tiltY)&&(u.tiltY=0),Ft(u.pointerType)&&(u.pointerType="touch"),Ft(u.pointerId)&&(u.pointerId=u.identifier||0),Ft(u.pressure)&&(u.pressure=u.force||.5),Ft(u.twist)&&(u.twist=0),Ft(u.tangentialPressure)&&(u.tangentialPressure=0),u.isNormalized=!0,u.type=n.type,s.push(u)}else if(r.isMouseEvent(n)){const l=n;Ft(l.isPrimary)&&(l.isPrimary=!0),Ft(l.width)&&(l.width=1),Ft(l.height)&&(l.height=1),Ft(l.tiltX)&&(l.tiltX=0),Ft(l.tiltY)&&(l.tiltY=0),Ft(l.pointerType)&&(l.pointerType="mouse"),Ft(l.pointerId)&&(l.pointerId=1),Ft(l.pressure)&&(l.pressure=.5),Ft(l.twist)&&(l.twist=0),Ft(l.tangentialPressure)&&(l.tangentialPressure=0),l.isNormalized=!0,s.push(l)}else s.push(n);return s}transferMouseData(n,r){n.isTrusted=r.isTrusted,n.srcElement=r.srcElement,n.timeStamp=performance.now(),n.type=r.type,n.altKey=r.altKey,n.metaKey=r.metaKey,n.shiftKey=r.shiftKey,n.ctrlKey=r.ctrlKey,n.button=r.button,n.buttons=r.buttons,n.client.x=r.clientX,n.client.y=r.clientY,n.movement.x=r.movementX,n.movement.y=r.movementY,n.page.x=r.pageX,n.page.y=r.pageY,n.screen.x=r.screenX,n.screen.y=r.screenY,n.relatedTarget=null}bootstrapEvent(n,r,s,l){n.view=s,n.originalEvent=null,n.nativeEvent=l,n.pointerId=r.pointerId,n.width=r.width,n.height=r.height,n.isPrimary=r.isPrimary,n.pointerType=r.pointerType,n.pressure=r.pressure,n.tangentialPressure=r.tangentialPressure,n.tiltX=r.tiltX,n.tiltY=r.tiltY,n.twist=r.twist,this.transferMouseData(n,r);const{x:u,y:h}=this.getViewportXY(r);n.viewport.x=u,n.viewport.y=h;const[f,d]=this.context.canvas.getCanvasByViewport([u,h]);return n.canvas.x=f,n.canvas.y=d,n.global.copyFrom(n.canvas),n.offset.copyFrom(n.canvas),n.isTrusted=l.isTrusted,n.type==="pointerleave"&&(n.type="pointerout"),n}getViewportXY(n){let r,s;const{offsetX:l,offsetY:u,clientX:h,clientY:f}=n;if(!(0,At.Z)(l)&&!(0,At.Z)(u))r=l,s=u;else{const d=this.eventService.client2Viewport({x:h,y:f});r=d.x,s=d.y}return{x:r,y:s}}onframe(){super.onframe();const{opacity:n}=this.attributes;this.getDomElement().style.opacity=`${n}`}}js.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};var L1=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class ll extends Lr{constructor(n){super(yn({style:ll.defaultStyleProps},n))}getKeyStyle(n){const[r,s]=this.getSize(n),l=super.getKeyStyle(n),{fillOpacity:u,opacity:h=u}=l,f=L1(l,["fillOpacity","opacity"]);return Object.assign(Object.assign({opacity:h},f),{width:r,height:s,x:-r/2,y:-s/2})}getBounds(){return this.getShape("key").getBounds()}getHaloStyle(n){if(n.halo===!1)return!1;const r=this.getShape("key").attributes,{fill:s,stroke:l}=r,u=L1(r,["fill","stroke"]),h=We(this.getGraphicStyle(n),"halo"),f=Number(h.lineWidth),[d,v]=Gt(this.getSize(n),[f,f]),{lineWidth:p}=h,g={fill:"transparent",lineWidth:p/2,width:d-p/2,height:v-p/2,x:-(d-p/2)/2,y:-(v-p/2)/2};return Object.assign(Object.assign({},h),g)}getIconStyle(n){const r=super.getIconStyle(n),[s,l]=this.getSize(n);return r?Object.assign({width:s*zi,height:l*zi},r):!1}drawKeyShape(n,r){const s=this.upsert("key",Qd,this.getKeyStyle(n),r);return tv(this),s}drawHaloShape(n,r){this.upsert("halo",Sn,this.getHaloStyle(n),r)}update(n){super.update(n),n&&("x"in n||"y"in n||"z"in n)&&ev(this)}}ll.defaultStyleProps={size:32};class D1 extends Lr{constructor(n){super(n)}getKeyStyle(n){const[r,s]=this.getSize(n);return Object.assign(Object.assign({},super.getKeyStyle(n)),{width:r,height:s,x:-r/2,y:-s/2})}getIconStyle(n){const r=super.getIconStyle(n),{width:s,height:l}=this.getShape("key").attributes;return r?Object.assign({width:s*zi,height:l*zi},r):!1}drawKeyShape(n,r){return this.upsert("key",Sn,this.getKeyStyle(n),r)}}class I1 extends Yu{constructor(n){super(n)}getInnerR(n){return n.innerR||this.getOuterR(n)*3/8}getOuterR(n){return Math.min(...this.getSize(n))/2}getPoints(n){return U3(this.getOuterR(n),this.getInnerR(n))}getIconStyle(n){const r=super.getIconStyle(n),s=this.getInnerR(n)*2*zi;return r?Object.assign({width:s,height:s},r):!1}getPortXY(n,r){const{placement:s="top"}=r,l=this.getShape("key").getLocalBounds(),u=Y3(this.getOuterR(n),this.getInnerR(n));return gv(l,s,u,!1)}}class cl extends Yu{constructor(n){super(yn({style:cl.defaultStyleProps},n))}getPoints(n){const{direction:r}=n,[s,l]=this.getSize(n);return X3(s,l,r)}getPortXY(n,r){const{direction:s}=n,{placement:l="top"}=r,u=this.getShape("key").getLocalBounds(),[h,f]=this.getSize(n),d=q3(h,f,s);return gv(u,l,d,!1)}getIconStyle(n){const{icon:r,iconText:s,iconSrc:l,direction:u}=n;if(r===!1||Si(s||l))return!1;const h=We(this.getGraphicStyle(n),"icon"),f=this.getShape("key").getLocalBounds(),[d,v]=Uk(f,u),p=Yk(f,u)*2*zi;return Object.assign({x:d,y:v,width:p,height:p},h)}}cl.defaultStyleProps={size:40,direction:"up"};var B1=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class as extends Lr{constructor(n){super(yn({style:as.defaultStyleProps},n)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}getKeySize(n){const{collapsed:r,childrenNode:s=[]}=n;return s.length===0?this.getEmptyKeySize(n):r?this.getCollapsedKeySize(n):this.getExpandedKeySize(n)}getEmptyKeySize(n){const{padding:r,collapsedSize:s}=n,[l,u,h,f]=yr(r);return Gt(Hn(s),[f+u,l+h,0])}getCollapsedKeySize(n){return Hn(n.collapsedSize)}getExpandedKeySize(n){const r=this.getContentBBox(n);return[xi(r),Ei(r),0]}getContentBBox(n){const{childrenNode:r=[],padding:s}=n,l=r.map(h=>this.context.element.getElement(h)).filter(Boolean);if(l.length===0){const h=new ke,{x:f=0,y:d=0,size:v}=n,[p,g]=Hn(v);return h.setMinMax([f-p/2,d-g/2,0],[f+p/2,d+g/2,0]),h}const u=Uo(l.map(h=>h.getBounds()));return s?ua(u,s):u}drawCollapsedMarkerShape(n,r){const s=this.getCollapsedMarkerStyle(n);this.upsert("collapsed-marker",nv,s,r),tv(this)}getCollapsedMarkerStyle(n){if(!n.collapsed||!n.collapsedMarker)return!1;const r=We(this.getGraphicStyle(n),"collapsedMarker"),{type:s}=r,l=B1(r,["type"]),u=this.getShape("key"),[h,f]=Fi(u.getLocalBounds(),"center"),d=Object.assign(Object.assign({},l),{x:h,y:f});if(s){const v=this.getCollapsedMarkerText(s,n);Object.assign(d,{text:v})}return d}getCollapsedMarkerText(n,r){const{childrenData:s=[]}=r,{model:l}=this.context;return n==="descendant-count"?l.getDescendantsData(this.id).length.toString():n==="child-count"?s.length.toString():n==="node-count"?l.getDescendantsData(this.id).filter(u=>l.getElementType(V(u))==="node").length.toString():(0,_t.Z)(n)?n(s):""}getComboPosition(n){const{x:r=0,y:s=0,collapsed:l,childrenData:u=[]}=n;if(u.length===0)return[+r,+s,0];if(l){const{model:h}=this.context,f=h.getDescendantsData(this.id).filter(d=>!h.isCombo(V(d)));if(f.length>0&&f.some(DP)){const d=f.reduce((v,p)=>Gt(v,Fe(p)),[0,0,0]);return Xr(d,f.length)}return[+r,+s,0]}return this.getContentBBox(n).center}getComboStyle(n){const[r,s]=this.getComboPosition(n);return{x:r,y:s,transform:[["translate",r,s]]}}updateComboPosition(n){const r=this.getComboStyle(n);Object.assign(this.style,r);const{x:s,y:l}=r;this.context.model.syncNodeLikeDatum({id:this.id,style:{x:s,y:l}}),ev(this)}render(n,r=this){super.render(n,r),this.drawCollapsedMarkerShape(n,r)}update(n={}){super.update(n),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(n,r){const s=super.animate(this.attributes.collapsed?n:n.map(l=>{var{x:u,y:h,z:f,transform:d}=l,v=B1(l,["x","y","z","transform"]);return v}),r);return s&&new Proxy(s,{set:(l,u,h)=>(u==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(l,u,h))})}}as.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};class F1 extends as{constructor(n){super(n)}drawKeyShape(n,r){return this.upsert("key",gi,this.getKeyStyle(n),r)}getKeyStyle(n){const{collapsed:r}=n,s=super.getKeyStyle(n),[l]=this.getKeySize(n);return Object.assign(Object.assign(Object.assign({},s),r&&We(s,"collapsed")),{r:l/2})}getCollapsedKeySize(n){const[r,s]=Hn(n.collapsedSize),l=Math.max(r,s)/2;return[l*2,l*2,0]}getExpandedKeySize(n){const r=this.getContentBBox(n),[s,l]=la(r),u=Math.sqrt(Math.pow(s,2)+Math.pow(l,2))/2;return[u*2,u*2,0]}getIntersectPoint(n,r=!1){const s=this.getShape("key").getBounds();return Vu(n,s,r)}}class z1 extends as{constructor(n){super(n)}drawKeyShape(n,r){return this.upsert("key",Sn,this.getKeyStyle(n),r)}getKeyStyle(n){const r=super.getKeyStyle(n),[s,l]=this.getKeySize(n);return Object.assign(Object.assign(Object.assign({},r),n.collapsed&&We(r,"collapsed")),{width:s,height:l,x:-s/2,y:-l/2})}}var l3=function(a,n){if(!Vo(a))return a;for(var r=[],s=0;s<a.length;s++){var l=a[s];n(l,s)&&r.push(l)}return r},c3=l3,u3=function(a,n){return Vo(a)?a.indexOf(n)>-1:!1},h3=u3,f3=function(a,n){return n===void 0&&(n=[]),c3(a,function(r){return!h3(n,r)})},d3=f3;const v3={padding:10};function Z1(a,n,r,s,l,u){const{padding:h}=Object.assign(v3,u),f=ca(r,h),d=ca(s,h),v=[a,...l,n];let p=null;const g=[];for(let y=0,m=v.length;y<m-1;y++){const b=y+1,x=v[y],E=v[b],w=BP(x,E);let S=null;if(y===0)if(b===m-1)if(f.intersects(d))S=hv(x,E,f,d);else if(!ku(x,f)&&!ku(E,d)){const M=Ka(x,f),C=Ka(E,d);S=W1(M,C,$n(M,C)),S.points.unshift(M),S.points.push(C)}else w||(S=g3(x,E,f,d));else $r(E,f)?S=hv(x,E,f,ca(E,h),p):w||(S=rh(x,E,f));else b===m-1?$r(x,d)?S=hv(x,E,ca(x,h),d,p):w||(S=j1(x,E,d,p)):w||(S=W1(x,E,p));S?(g.push(...S.points),p=S.direction):p=$n(x,E),b<m-1&&g.push(E)}return g.map(Ja)}const p3={N:"S",S:"N",W:"E",E:"W"},G1={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function $n(a,n){const[r,s]=a,[l,u]=n;return r===l?s>u?"N":"S":s===u?r>l?"W":"E":null}function uv(a,n){return n==="N"||n==="S"?Ei(a):xi(a)}function W1(a,n,r){const s=[a[0],n[1]],l=[n[0],a[1]],u=$n(a,s),h=$n(a,l),f=r?p3[r]:null,d=u===r||u!==f&&h!==r?s:l;return{points:[d],direction:$n(d,n)}}function rh(a,n,r){if(ku(a,r)){const s=ul(a,n,r);return{points:[s],direction:$n(s,n)}}else{const s=Ka(a,r),u=["left","right"].includes(Yo(a,r))?[n[0],s[1]]:[s[0],n[1]];return{points:[u],direction:$n(u,n)}}}function j1(a,n,r,s){const l=ku(n,r)?n:Ka(n,r),u=[[l[0],a[1]],[a[0],l[1]]],h=u.filter(d=>$k(d,r)&&!cm(d,r,!0)),f=h.filter(d=>$n(d,a)!==s);if(f.length>0){const d=f.find(v=>$n(a,v)===s)||f[0];return{points:[d],direction:$n(d,n)}}else{const d=d3(u,h)[0],v=va(n,d,uv(r,s)/2);return{points:[ul(v,a,r),v],direction:$n(v,n)}}}function g3(a,n,r,s){let l=rh(a,n,r);const u=Qo(l.points[0]);if($r(u,s)){l=rh(n,a,s);const h=Qo(l.points[0]);if($r(h,r)){const f=va(a,u,uv(r,$n(a,u))/2),d=va(n,h,uv(s,$n(n,h))/2),v=[(f[0]+d[0])/2,(f[1]+d[1])/2],p=rh(a,v,r),g=j1(v,n,s,p.direction);l.points=[p.points[0],g.points[0]],l.direction=g.direction}}return l}function hv(a,n,r,s,l){const h=Uo([r,s]),f=Ae(n,h.center)>Ae(a,h.center),[d,v]=f?[n,a]:[a,n],p=Ei(h)+xi(h);let g;if(l){const b=[d[0]+p*Math.cos(G1[l]),d[1]+p*Math.sin(G1[l])];g=va(Ka(b,h),b,.01)}else g=va(Ka(d,h),d,-.01);let y=ul(g,v,h),m=[Jo(g,2),Jo(y,2)];if(Je(Jo(g),Jo(y))){const b=jd(Te(g,d),[1,0,0])+Math.PI/2;y=[v[0]+p*Math.cos(b),v[1]+p*Math.sin(b),0],y=Jo(va(Ka(y,h),v,-.01),2);const x=ul(g,y,h);m=[g,x,y]}return{points:f?m.reverse():m,direction:$n(f?g:y,n)}}function ul(a,n,r){let s=[a[0],n[1]];return $r(s,r)&&(s=[n[0],a[1]]),s}function V1(a,n,r,s,l){let d=typeof n=="number"?n:.5;n==="start"&&(d=0),n==="end"&&(d=.99);const v=Mn(a.getPoint(d)),p=Mn(a.getPoint(d+.01));let g=n==="start"?"left":n==="end"?"right":"center";if(n1(v,p)||!r){const[w,S]=H1(a,d,s,l);return{transform:[["translate",w,S]],textAlign:g}}let y=Math.atan2(p[1]-v[1],p[0]-v[0]);p[0]<v[0]&&(g=g==="center"?g:g==="left"?"right":"left",s*=-1,y+=Math.PI);const[b,x]=H1(a,d,s,l,y),E=[["translate",b,x],["rotate",y/Math.PI*180]];return{textAlign:g,transform:E}}function y3(a,n,r,s,l){var u,h;const f=((u=a.badge)===null||u===void 0?void 0:u.getGeometryBounds().halfExtents[0])*2||0,d=((h=a.label)===null||h===void 0?void 0:h.getGeometryBounds().halfExtents[0])*2||0;return V1(a.key,r,!0,(d?(d/2+f/2)*(n==="suffix"?1:-1):0)+s,l)}function H1(a,n,r,s,l){const[u,h]=Mn(a.getPoint(n));let f=r,d=s;return l&&(f=r*Math.cos(l)-s*Math.sin(l),d=r*Math.sin(l)+s*Math.cos(l)),[u+f,h+d]}function fv(a,n,r,s){if(Je(a,n))return a;const l=Te(n,a),u=[a[0]+r*l[0],a[1]+r*l[1]],h=Bi(ju(l,!1));return u[0]+=s*h[0],u[1]+=s*h[1],u}function m3(a){return(0,se.Z)(a)?[a,-a]:a}function b3(a){return(0,se.Z)(a)?[a,1-a]:a}function x3(a,n,r){return[["M",a[0],a[1]],["Q",r[0],r[1],n[0],n[1]]]}function $1(a,n,r){return[["M",a[0],a[1]],["C",r[0][0],r[0][1],r[1][0],r[1][1],n[0],n[1]]]}function dv(a,n=0,r=!1){const s=a.length-1,l=a[0],u=a[s],h=a.slice(1,s),f=[["M",l[0],l[1]]];return h.forEach((d,v)=>{const p=h[v-1]||l,g=h[v+1]||u;if(!r1(p,d,g)&&n){const[y,m]=E3(p,d,g,n);f.push(["L",y[0],y[1]],["Q",d[0],d[1],m[0],m[1]],["L",m[0],m[1]])}else f.push(["L",d[0],d[1]])}),f.push(["L",u[0],u[1]]),r&&f.push(["Z"]),f}function E3(a,n,r,s){const l=Wu(a,n),u=Wu(r,n),h=Math.min(s,Math.min(l,u)/2),f=[n[0]-h/l*(n[0]-a[0]),n[1]-h/l*(n[1]-a[1])],d=[n[0]-h/u*(n[0]-r[0]),n[1]-h/u*(n[1]-r[1])];return[f,d]}const w3=a=>{const n=Math.PI/2,r=Ei(a)/2,s=xi(a)/2,l=Math.atan2(r,s)/2,u=Math.atan2(s,r)/2;return{top:[-n-u,-n+u],"top-right":[-n+u,-l],"right-top":[-n+u,-l],right:[-l,l],"bottom-right":[l,n-u],"right-bottom":[l,n-u],bottom:[n-u,n+u],"bottom-left":[n+u,Math.PI-l],"left-bottom":[n+u,Math.PI-l],left:[Math.PI-l,Math.PI+l],"top-left":[Math.PI+l,-n-u],"left-top":[Math.PI+l,-n-u]}};function U1(a,n,r,s,l){const u=ca(a),h=a.getCenter();let f=s&&ma(s),d=l&&ma(l);if(!f||!d){const v=w3(u),p=v[n][0],g=v[n][1],[y,m]=la(u),b=Math.max(y,m),x=Gt(h,[b*Math.cos(p),b*Math.sin(p),0]),E=Gt(h,[b*Math.cos(g),b*Math.sin(g),0]);f=mv(a,x),d=mv(a,E),r||([f,d]=[d,f])}return[f,d]}function S3(a,n,r,s,l,u){const h=a.getPorts()[l||u],f=a.getPorts()[u||l];let[d,v]=U1(a,n,r,h,f);const p=M3(a,d,v,s);return h&&(d=yl(h,p[0])),f&&(v=yl(f,p.at(-1))),$1(d,v,p)}function M3(a,n,r,s){const l=a.getCenter();if(Je(n,r)){const u=Te(n,l),h=[s*Math.sign(u[0])||s/2,s*Math.sign(u[1])||-s/2,0];return[Gt(n,h),Gt(r,Yr(h,[1,-1,1]))]}return[va(l,n,Ae(l,n)+s),va(l,r,Ae(l,r)+s)]}function T3(a,n,r,s,l,u,h){const f=yv(a),d=f[u||h],v=f[h||u];let[p,g]=U1(a,r,s,d,v);const y=C3(a,p,g,l);return d&&(p=yl(d,y[0])),v&&(g=yl(v,y.at(-1))),dv([p,...y,g],n)}function C3(a,n,r,s){const l=[],u=ca(a);if(Je(n,r))switch(Yo(n,u)){case"left":l.push([n[0]-s,n[1]]),l.push([n[0]-s,n[1]+s]),l.push([n[0],n[1]+s]);break;case"right":l.push([n[0]+s,n[1]]),l.push([n[0]+s,n[1]+s]),l.push([n[0],n[1]+s]);break;case"top":l.push([n[0],n[1]-s]),l.push([n[0]+s,n[1]-s]),l.push([n[0]+s,n[1]]);break;case"bottom":l.push([n[0],n[1]+s]),l.push([n[0]+s,n[1]+s]),l.push([n[0]+s,n[1]]);break}else{const h=Yo(n,u),f=Yo(r,u);if(h===f){const d=h;let v,p;switch(d){case"left":v=Math.min(n[0],r[0])-s,l.push([v,n[1]]),l.push([v,r[1]]);break;case"right":v=Math.max(n[0],r[0])+s,l.push([v,n[1]]),l.push([v,r[1]]);break;case"top":p=Math.min(n[1],r[1])-s,l.push([n[0],p]),l.push([r[0],p]);break;case"bottom":p=Math.max(n[1],r[1])+s,l.push([n[0],p]),l.push([r[0],p]);break}}else{const d=(y,m)=>({left:[m[0]-s,m[1]],right:[m[0]+s,m[1]],top:[m[0],m[1]-s],bottom:[m[0],m[1]+s]})[y],v=d(h,n),p=d(f,r),g=ul(v,p,u);l.push(v,g,p)}}return l}function vv(a,n){const r=new Set,s=new Set,l=new Set;return a.forEach(u=>{n(u).forEach(f=>{r.add(f),a.includes(f.source)&&a.includes(f.target)?s.add(f):l.add(f)})}),{edges:Array.from(r),internal:Array.from(s),external:Array.from(l)}}function Y1(a,n){const r=[];let s=a;for(;s;){r.push(s);const l=n(V(s));if(l)s=l;else break}if(r.some(l=>{var u;return(u=l.style)===null||u===void 0?void 0:u.collapsed})){const l=r.reverse().findIndex(Vn);return r[l]||r.at(-1)}return a}function O3(a,n){return n||(a<4?10:a===4?12:a*2.5)}const k3=(a,n)=>{const r=Math.max(a,n)/2;return[["M",-a/2,0],["A",r,r,0,1,0,2*r-a/2,0],["A",r,r,0,1,0,-a/2,0],["Z"]]},X1=(a,n)=>[["M",-a/2,0],["L",a/2,-n/2],["L",a/2,n/2],["Z"]],_3=(a,n)=>[["M",-a/2,0],["L",0,-n/2],["L",a/2,0],["L",0,n/2],["Z"]],P3=(a,n)=>[["M",-a/2,0],["L",a/2,-n/2],["L",4*a/5-a/2,0],["L",a/2,n/2],["Z"]],A3=(a,n)=>[["M",-a/2,-n/2],["L",a/2,-n/2],["L",a/2,n/2],["L",-a/2,n/2],["Z"]],N3=(a,n)=>{const r=a/2,s=a/7,l=a-s;return[["M",-r,0],["L",0,-n/2],["L",0,n/2],["Z"],["M",l-r,-n/2],["L",l+s-r,-n/2],["L",l+s-r,n/2],["L",l-r,n/2],["Z"]]},R3=(a,n)=>[["M",a/2,-n/2],["L",-a/2,0],["L",a/2,0],["L",-a/2,0],["L",a/2,n/2]];var ih=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class Zi extends x1{constructor(n){super(yn({style:Zi.defaultStyleProps},n)),this.type="edge"}get sourceNode(){const{sourceNode:n}=this.parsedAttributes;return this.context.element.getElement(n)}get targetNode(){const{targetNode:n}=this.parsedAttributes;return this.context.element.getElement(n)}getKeyStyle(n){const r=this.getGraphicStyle(n),{loop:s}=r,l=ih(r,["loop"]),{sourceNode:u,targetNode:h}=this,d={d:s&&j3(u,h)?this.getLoopPath(n):this.getKeyPath(n)};return dr.PARSED_STYLE_LIST.forEach(v=>{v in l&&(d[v]=l[v])}),d}getLoopPath(n){const{sourcePort:r,targetPort:s}=n,l=this.sourceNode,u=ca(l),h=Math.max(xi(u),Ei(u)),{placement:f,clockwise:d,dist:v=h}=We(this.getGraphicStyle(n),"loop");return S3(l,f,d,v,r,s)}getEndpoints(n,r=!0,s=[]){const{sourcePort:l,targetPort:u}=n,{sourceNode:h,targetNode:f}=this,[d,v]=H3(h,f,l,u);if(!r){const m=d?ma(d):h.getCenter(),b=v?ma(v):f.getCenter();return[m,b]}const p=typeof s=="function"?s():s,g=rb(d||h,p[0]||v||f),y=rb(v||f,p[p.length-1]||d||h);return[g,y]}getHaloStyle(n){if(n.halo===!1)return!1;const r=this.getKeyStyle(n),s=We(this.getGraphicStyle(n),"halo");return Object.assign(Object.assign({},r),s)}getLabelStyle(n){if(n.label===!1||!n.labelText)return!1;const r=We(this.getGraphicStyle(n),"label"),{placement:s,offsetX:l,offsetY:u,autoRotate:h,maxWidth:f}=r,d=ih(r,["placement","offsetX","offsetY","autoRotate","maxWidth"]),v=V1(this.shapeMap.key,s,h,l,u),p=this.shapeMap.key.getLocalBounds(),g=KP([p.min,p.max],f);return Object.assign({wordWrapWidth:g},v,d)}getBadgeStyle(n){if(n.badge===!1||!n.badgeText)return!1;const r=We(n,"badge"),{offsetX:s,offsetY:l,placement:u}=r,h=ih(r,["offsetX","offsetY","placement"]);return Object.assign(h,y3(this.shapeMap,u,n.labelPlacement,s,l))}drawArrow(n,r){var s;const l=r==="start",h=n[r==="start"?"startArrow":"endArrow"],f=this.shapeMap.key;if(h){const d=this.getArrowStyle(n,l),[v,p,g]=l?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],y=f.parsedStyle[v];if(y)y.attr(d);else{const m=d.src?Go:dr,b=new m({style:d});f.style[v]=b}f.style[p]=n[g]||d.width/2+ +d.lineWidth}else{const d=l?"markerStart":"markerEnd";(s=f.style[d])===null||s===void 0||s.destroy(),f.style[d]=null}}getArrowStyle(n,r){const s=this.getShape("key").attributes,l=r?"startArrow":"endArrow",u=We(this.getGraphicStyle(n),l),{size:h,type:f}=u,d=ih(u,["size","type"]),[v,p]=Hn(O3(s.lineWidth,h)),y=((0,_t.Z)(f)?f:wt[f]||X1)(v,p);return Object.assign((0,ol.Z)(s,["stroke","strokeOpacity","fillOpacity"]),{width:v,height:p},Object.assign({},y&&{d:y,fill:f==="simple"?"":s.stroke}),d)}drawLabelShape(n,r){const s=this.getLabelStyle(n);this.upsert("label",Kr,s,r)}drawHaloShape(n,r){const s=this.getHaloStyle(n);this.upsert("halo",dr,s,r)}drawBadgeShape(n,r){const s=this.getBadgeStyle(n);this.upsert("badge",rs,s,r)}drawSourceArrow(n){this.drawArrow(n,"start")}drawTargetArrow(n){this.drawArrow(n,"end")}drawKeyShape(n,r){const s=this.getKeyStyle(n);return this.upsert("key",dr,s,r)}render(n=this.parsedAttributes,r=this){this.drawKeyShape(n,r),this.getShape("key")&&(this.drawSourceArrow(n),this.drawTargetArrow(n),this.drawLabelShape(n,r),this.drawHaloShape(n,r),this.drawBadgeShape(n,r))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(n,r){const s=super.animate(n,r);return s&&new Proxy(s,{set:(l,u,h)=>(u==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(l,u,h))})}}Zi.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class ya extends Zi{constructor(n){super(yn({style:ya.defaultStyleProps},n))}getKeyPath(n){const[r,s]=this.getEndpoints(n),{controlPoints:l,curvePosition:u,curveOffset:h}=n,f=this.getControlPoints(r,s,b3(u),m3(h),l);return $1(r,s,f)}getControlPoints(n,r,s,l,u){return(u==null?void 0:u.length)===2?u:[fv(n,r,s[0],l[0]),fv(n,r,s[1],l[1])]}}ya.defaultStyleProps={curvePosition:.5,curveOffset:20};class hl extends ya{constructor(n){super(yn({style:hl.defaultStyleProps},n))}getControlPoints(n,r,s,l){const u=r[0]-n[0];return[[n[0]+u*s[0]+l[0],n[1]],[r[0]-u*s[1]+l[1],r[1]]]}}hl.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class fl extends ya{constructor(n){super(yn({style:fl.defaultStyleProps},n))}get ref(){return this.context.model.getRootsData()[0]}getEndpoints(n){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(n);const r=Fe(this.ref),s=this.sourceNode.getIntersectPoint(r,!0),l=this.targetNode.getIntersectPoint(r);return[s,l]}toRadialCoordinate(n){const r=Fe(this.ref),s=Ae(n,r),l=Km(Te(n,r));return[s,l]}getControlPoints(n,r,s,l){const[u,h]=this.toRadialCoordinate(n),[f]=this.toRadialCoordinate(r),d=f-u;return[[n[0]+(d*s[0]+l[0])*Math.cos(h),n[1]+(d*s[0]+l[0])*Math.sin(h)],[r[0]-(d*s[1]-l[0])*Math.cos(h),r[1]-(d*s[1]-l[0])*Math.sin(h)]]}}fl.defaultStyleProps={curvePosition:.5,curveOffset:20};class dl extends ya{constructor(n){super(yn({style:dl.defaultStyleProps},n))}getControlPoints(n,r,s,l){const u=r[1]-n[1];return[[n[0],n[1]+u*s[0]+l[0]],[r[0],r[1]-u*s[1]+l[1]]]}}dl.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class vl extends Zi{constructor(n){super(yn({style:vl.defaultStyleProps},n))}getKeyPath(n){const[r,s]=this.getEndpoints(n);return[["M",r[0],r[1]],["L",s[0],s[1]]]}}vl.defaultStyleProps={};const L3={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:Wu},Gi=a=>`${Math.round(a[0])}|||${Math.round(a[1])}`;function ss(a,n){const r=s=>Math.round(s/n);return(0,se.Z)(a)?r(a):a.map(r)}function D3(a,n){const r=Math.abs(a-n);return r>Math.PI?2*Math.PI-r:r}function q1(a,n){const r=n[0]-a[0],s=n[1]-a[1];return!r&&!s?0:Math.atan2(s,r)}function K1(a,n,r,s){const l=q1(a,n),u=r[Gi(a)],f=q1(u||s,a);return D3(f,l)}const I3=(a,n)=>{const{offset:r,gridSize:s}=n,l={};return a.forEach(u=>{if(!u||u.destroyed||!u.isVisible())return;const h=ua(u.getRenderBounds(),r);for(let f=ss(h.min[0],s);f<=ss(h.max[0],s);f+=1)for(let d=ss(h.min[1],s);d<=ss(h.max[1],s);d+=1)l[`${f}|||${d}`]=!0}),l};function Q1(a,n,r){return Math.min(...n.map(s=>r(a,s)))}function B3(a,n,r){let s=a[0],l=r(a[0],n);for(let u=0;u<a.length;u++){const h=a[u],f=r(h,n);f<l&&(s=h,l=f)}return s}const J1=(a,n,r,s)=>{if(!n)return[a];const{directionMap:l,offset:u}=s,h=ua(n.getRenderBounds(),u),f=Object.keys(l).reduce((d,v)=>{if(r.includes(v)){const p=l[v],[g,y]=la(h),m=[a[0]+p.stepX*g,a[1]+p.stepY*y],b=Xk(h);for(let x=0;x<b.length;x++){const E=Hd([a,m],b[x]);E&&cm(E,h)&&d.push(E)}}return d},[]);return $r(a,h)||f.push(a),f.map(d=>ss(d,s.gridSize))},F3=(a,n,r,s,l,u,h)=>{const f=[];let d=[u[0]===s[0]?s[0]:a[0]*h,u[1]===s[1]?s[1]:a[1]*h];f.unshift(d);let v=a,p=n[Gi(v)];for(;p;){const m=p,b=v;K1(m,b,n,r)&&(d=[m[0]===b[0]?d[0]:m[0]*h,m[1]===b[1]?d[1]:m[1]*h],f.unshift(d)),p=n[Gi(m)],v=m}const g=l.map(m=>[m[0]*h,m[1]*h]),y=B3(g,d,Wu);return f.unshift(y),f};function z3(a,n,r,s){const l=Ja(a.getCenter()),u=Ja(n.getCenter()),h=Object.assign(L3,s),{gridSize:f}=h,d=h.enableObstacleAvoidance?r:[a,n],v=I3(d,h),p=ss(l,f),g=ss(u,f),y=J1(l,a,h.startDirections,h),m=J1(u,n,h.endDirections,h);y.forEach(P=>delete v[Gi(P)]),m.forEach(P=>delete v[Gi(P)]);const b={},x={},E={},w={},S={},M=new Z3;for(let P=0;P<y.length;P++){const A=y[P],N=Gi(A);b[N]=A,w[N]=0,S[N]=Q1(A,m,h.distFunc),M.add({id:N,value:S[N]})}const C=m.map(P=>Gi(P));let T=h.maximumLoops,O,k=1/0;for(const[P,A]of Object.entries(b))S[P]<=k&&(k=S[P],O=A);for(;Object.keys(b).length>0&&T>0;){const P=M.minId(!1);if(P)O=b[P];else break;const A=Gi(O);if(C.includes(A))return F3(O,E,p,u,y,g,f);delete b[A],M.remove(A),x[A]=!0;for(const N of Object.values(h.directionMap)){const L=Gt(O,[N.stepX,N.stepY]),R=Gi(L);if(x[R])continue;const z=K1(O,L,E,p);if(z>h.maxAllowedDirectionChange||v[R])continue;b[R]||(b[R]=L);const Z=h.penalties[z],X=h.distFunc(O,L)+(isNaN(Z)?f:Z),nt=w[A]+X,K=w[R];K&&nt>=K||(E[R]=O,w[R]=nt,S[R]=nt+Q1(L,m,h.distFunc),M.add({id:R,value:S[R]}))}T-=1}return[]}class Z3{constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}_innerAdd(n,r){let s=0,l=r-1;for(;l-s>1;){const u=Math.floor((s+l)/2);if(this.arr[u].value>n.value)l=u;else if(this.arr[u].value<n.value)s=u;else{this.arr.splice(u,0,n),this.map[n.id]=!0;return}}this.arr.splice(l,0,n),this.map[n.id]=!0}add(n){delete this.map[n.id];const r=this.arr.length;if(!r||this.arr[r-1].value<n.value){this.arr.push(n),this.map[n.id]=!0;return}this._innerAdd(n,r)}remove(n){this.map[n]&&delete this.map[n]}_clearAndGetMinId(){let n;for(let r=this.arr.length-1;r>=0;r--)this.map[this.arr[r].id]?n=this.arr[r].id:this.arr.splice(r,1);return n}_findFirstId(){for(;this.arr.length;){const n=this.arr.shift();if(this.map[n.id])return n.id}}minId(n){return n?this._clearAndGetMinId():this._findFirstId()}}class Vs extends Zi{constructor(n){super(yn({style:Vs.defaultStyleProps},n))}getControlPoints(n){const{router:r}=n,{sourceNode:s,targetNode:l}=this,[u,h]=this.getEndpoints(n,!1);let f=[];if(!r)f=n.controlPoints;else if(r.type==="shortest-path"){const d=this.context.element.getNodes();f=z3(s,l,d,r),f.length||(f=Z1(u,h,s,l,n.controlPoints,{padding:r.offset}))}else r.type==="orth"&&(f=Z1(u,h,s,l,n.controlPoints,r));return f}getPoints(n){const r=this.getControlPoints(n),[s,l]=this.getEndpoints(n,!0,r);return[s,...r,l]}getKeyPath(n){const r=this.getPoints(n);return dv(r,n.radius)}getLoopPath(n){const{sourcePort:r,targetPort:s,radius:l}=n,u=this.sourceNode,h=ca(u),f=Math.max(xi(h),Ei(h))/4,{placement:d,clockwise:v,dist:p=f}=We(this.getGraphicStyle(n),"loop");return T3(u,l,d,v,p,r,s)}}Vs.defaultStyleProps={radius:0,controlPoints:[],router:!1};class pl extends Zi{constructor(n){super(yn({style:pl.defaultStyleProps},n))}getKeyPath(n){const{curvePosition:r,curveOffset:s}=n,[l,u]=this.getEndpoints(n),h=n.controlPoint||fv(l,u,r,s);return x3(l,u,h)}}pl.defaultStyleProps={curvePosition:.5,curveOffset:30};var G3=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};function gl(a){return a instanceof Lr&&a.type==="node"}function tb(a){return a instanceof Zi}function pv(a){return a instanceof as}function W3(a){return gl(a)||tb(a)||pv(a)}function j3(a,n){return!a||!n?!1:a===n}const V3={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],"left-top":[0,0],"top-left":[0,0],"left-bottom":[0,1],"bottom-left":[0,1],"right-top":[1,0],"top-right":[1,0],"right-bottom":[1,1],"bottom-right":[1,1],default:[.5,.5]};function gv(a,n,r=V3,s=!0){const l=[.5,.5],u=(0,ve.Z)(n)?Tn(r,n.toLocaleLowerCase(),l):n;if(!s&&(0,ve.Z)(n))return u;const[h,f]=u||l;return[a.min[0]+xi(a)*h,a.min[1]+Ei(a)*f]}function yv(a){if(!a)return{};const n=a.getPorts();return(a.attributes.ports||[]).forEach((s,l)=>{var u;const{key:h,placement:f}=s;eb(s)&&(n[u=h||l]||(n[u]=Fi(a.getShape("key").getBounds(),f)))}),n}function eb(a){const{r:n}=a;return!n||Number(n)===0}function ma(a){return zs(a)?a:a.getPosition()}function H3(a,n,r,s){const l=nb(a,n,r,s),u=nb(n,a,s,r);return[l,u]}function nb(a,n,r,s){const l=yv(a);if(r)return l[r];const u=Object.values(l);if(u.length===0)return;const h=u.map(v=>ma(v)),f=$3(n,s),[d]=ZP(h,f);return u.find(v=>ma(v)===d)}function $3(a,n){const r=yv(a);if(n)return[ma(r[n])];const s=Object.values(r);return s.length>0?s.map(l=>ma(l)):[a.getCenter()]}function rb(a,n){return pv(a)||gl(a)?mv(a,n):yl(a,n)}function yl(a,n){if(!a||!n)return[0,0,0];if(zs(a))return a;if(a.attributes.linkToCenter)return a.getPosition();const r=zs(n)?n:gl(n)?n.getCenter():n.getPosition();return Vu(r,a.getBounds())}function mv(a,n){if(!a||!n)return[0,0,0];const r=zs(n)?n:gl(n)?n.getCenter():n.getPosition();return a.getIntersectPoint(r)||a.getCenter()}function ib(a,n="bottom",r=0,s=0,l=!1){const u=n.split("-"),[h,f]=Fi(a,n),[d,v]=l?["bottom","top"]:["top","bottom"],p=u.includes("top")?v:u.includes("bottom")?d:"middle",g=u.includes("left")?"right":u.includes("right")?"left":"center";return{transform:[["translate",h+r,f+s]],textBaseline:p,textAlign:g}}function U3(a,n){return[[0,-a],[n*Math.cos(3*Math.PI/10),-n*Math.sin(3*Math.PI/10)],[a*Math.cos(Math.PI/10),-a*Math.sin(Math.PI/10)],[n*Math.cos(Math.PI/10),n*Math.sin(Math.PI/10)],[a*Math.cos(3*Math.PI/10),a*Math.sin(3*Math.PI/10)],[0,n],[-a*Math.cos(3*Math.PI/10),a*Math.sin(3*Math.PI/10)],[-n*Math.cos(Math.PI/10),n*Math.sin(Math.PI/10)],[-a*Math.cos(Math.PI/10),-a*Math.sin(Math.PI/10)],[-n*Math.cos(3*Math.PI/10),-n*Math.sin(3*Math.PI/10)]]}function Y3(a,n){const r={};return r.top=[0,-a],r.left=[-a*Math.cos(Math.PI/10),-a*Math.sin(Math.PI/10)],r["left-bottom"]=[-a*Math.cos(3*Math.PI/10),a*Math.sin(3*Math.PI/10)],r.bottom=[0,n],r["right-bottom"]=[a*Math.cos(3*Math.PI/10),a*Math.sin(3*Math.PI/10)],r.right=r.default=[a*Math.cos(Math.PI/10),-a*Math.sin(Math.PI/10)],r}function X3(a,n,r){const s=n/2,l=a/2,u={up:[[-l,s],[l,s],[0,-s]],left:[[-l,0],[l,s],[l,-s]],right:[[-l,s],[-l,-s],[l,0]],down:[[-l,-s],[l,-s],[0,s]]};return u[r]||u.up}function q3(a,n,r){const s=n/2,l=a/2,u={};return r==="down"?(u.bottom=u.default=[0,s],u.right=[l,-s],u.left=[-l,-s]):r==="left"?(u.top=[l,-s],u.bottom=[l,s],u.left=u.default=[-l,0]):r==="right"?(u.top=[-l,-s],u.bottom=[-l,s],u.right=u.default=[l,0]):(u.left=[-l,s],u.top=u.default=[0,-s],u.right=[l,s]),u}function U7(a,n){return[[a/2,-n/2],[a/2,n/2],[-a/2,n/2],[-a/2,-n/2]]}function K3(a,n){return[[0,-n/2],[a/2,0],[0,n/2],[-a/2,0]]}function ab(a){return Tn(a,["style","visibility"])!=="hidden"}function Q3(a,n){const{zIndex:r,transform:s,transformOrigin:l,visibility:u,cursor:h,clipPath:f,component:d}=n,v=G3(n,["zIndex","transform","transformOrigin","visibility","cursor","clipPath","component"]);Object.assign(a.attributes,v),s&&a.setAttribute("transform",s),(0,se.Z)(r)&&a.setAttribute("zIndex",r),l&&a.setAttribute("transformOrigin",l),u&&a.setAttribute("visibility",u),h&&a.setAttribute("cursor",h),f&&a.setAttribute("clipPath",f),d&&a.setAttribute("component",d)}function bv(a,n){"update"in a?a.update(n):a.attr(n)}function J3(a){return[[0,a],[a*Math.sqrt(3)/2,a/2],[a*Math.sqrt(3)/2,-a/2],[0,-a],[-a*Math.sqrt(3)/2,-a/2],[-a*Math.sqrt(3)/2,a/2]]}function tN(a){el(a,"__to_be_destroyed__",!0)}function ml(a){return Tn(a,"__to_be_destroyed__",!1)}var eN=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class bl extends sr{constructor(n,r){super(n,Object.assign({},bl.defaultOptions,r)),this.onCollapseExpand=s=>eN(this,void 0,void 0,function*(){if(!this.validate(s))return;const{target:l}=s;if(!W3(l))return;const u=l.id,{model:h,graph:f}=this.context,d=h.getElementDataById(u);if(!d)return!1;const{onCollapse:v,onExpand:p,animation:g,align:y}=this.options;Vn(d)?(yield f.expandElement(u,{animation:g,align:y}),p==null||p(u)):(yield f.collapseElement(u,{animation:g,align:y}),v==null||v(u))}),this.bindEvents()}update(n){this.unbindEvents(),super.update(n),this.bindEvents()}bindEvents(){const{graph:n}=this.context,{trigger:r}=this.options;n.on(`node:${r}`,this.onCollapseExpand),n.on(`combo:${r}`,this.onCollapseExpand)}unbindEvents(){const{graph:n}=this.context,{trigger:r}=this.options;n.off(`node:${r}`,this.onCollapseExpand),n.off(`combo:${r}`,this.onCollapseExpand)}validate(n){if(this.destroyed)return!1;const{enable:r}=this.options;return(0,_t.Z)(r)?r(n):!!r}destroy(){this.unbindEvents(),super.destroy()}}bl.defaultOptions={enable:!0,animation:!0,trigger:tt.DBLCLICK,align:!0};var ah={},nN=function(a){return a=a||"g",ah[a]?ah[a]+=1:ah[a]=1,a+ah[a]},sh=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};const rN="g6-create-edge-assist-edge-id",oh="g6-create-edge-assist-node-id";class xl extends sr{constructor(n,r){super(n,Object.assign({},xl.defaultOptions,r)),this.drop=s=>sh(this,void 0,void 0,function*(){const{targetType:l}=s;["combo","node"].includes(l)&&this.source?yield this.handleCreateEdge(s):yield this.cancelEdge()}),this.handleCreateEdge=s=>sh(this,void 0,void 0,function*(){var l,u,h;if(!this.validate(s))return;const{graph:f,canvas:d,batch:v,element:p}=this.context,{style:g}=this.options;if(this.source){this.createEdge(s),yield this.cancelEdge();return}v.startBatch(),d.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([s.target.id])[0];const y=f.getElementData(this.source);f.addNodeData([{id:oh,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:(l=y.style)===null||l===void 0?void 0:l.x,y:(u=y.style)===null||u===void 0?void 0:u.y}}]),f.addEdgeData([{id:rN,source:this.source,target:oh,style:Object.assign({pointerEvents:"none"},g)}]),yield(h=p.draw({animation:!1}))===null||h===void 0?void 0:h.finished}),this.updateAssistEdge=s=>sh(this,void 0,void 0,function*(){var l;if(!this.source)return;const{model:u,element:h}=this.context;u.translateNodeTo(oh,[s.canvas.x,s.canvas.y]),yield(l=h.draw({animation:!1,silence:!0}))===null||l===void 0?void 0:l.finished}),this.createEdge=s=>{var l,u;const{graph:h}=this.context,{style:f,onFinish:d,onCreate:v}=this.options;if(((l=s.target)===null||l===void 0?void 0:l.id)===void 0||this.source===void 0)return;const g=(u=this.getSelectedNodeIDs([s.target.id]))===null||u===void 0?void 0:u[0],y=`${this.source}-${g}-${nN()}`,m=v({id:y,source:this.source,target:g,style:f});m&&(h.addEdgeData([m]),d(m))},this.cancelEdge=()=>sh(this,void 0,void 0,function*(){var s;if(!this.source)return;const{graph:l,element:u,batch:h}=this.context;l.removeNodeData([oh]),this.source=void 0,yield(s=u.draw({animation:!1}))===null||s===void 0?void 0:s.finished,h.endBatch()}),this.bindEvents()}update(n){super.update(n),this.bindEvents()}bindEvents(){const{graph:n}=this.context,{trigger:r}=this.options;this.unbindEvents(),r==="click"?(n.on(pr.CLICK,this.handleCreateEdge),n.on(oa.CLICK,this.handleCreateEdge),n.on(yi.CLICK,this.cancelEdge),n.on(Ho.CLICK,this.cancelEdge)):(n.on(pr.DRAG_START,this.handleCreateEdge),n.on(oa.DRAG_START,this.handleCreateEdge),n.on(tt.POINTER_UP,this.drop)),n.on(tt.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(n){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(r=>r.id).concat(n)))}validate(n){if(this.destroyed)return!1;const{enable:r}=this.options;return(0,_t.Z)(r)?r(n):!!r}unbindEvents(){const{graph:n}=this.context;n.off(pr.CLICK,this.handleCreateEdge),n.off(oa.CLICK,this.handleCreateEdge),n.off(yi.CLICK,this.cancelEdge),n.off(Ho.CLICK,this.cancelEdge),n.off(pr.DRAG_START,this.handleCreateEdge),n.off(oa.DRAG_START,this.handleCreateEdge),n.off(tt.POINTER_UP,this.drop),n.off(tt.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}}xl.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:a=>a,onFinish:()=>{}};function iN(a,n,r){var s;return function(){var l=this,u=arguments,h=function(){s=null,r||a.apply(l,u)},f=r&&!s;clearTimeout(s),s=setTimeout(h,n),f&&a.apply(l,u)}}var El=iN,sb=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class wl extends sr{constructor(n,r){super(n,Object.assign({},wl.defaultOptions,r)),this.isDragging=!1,this.onDragStart=s=>{this.validate(s)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=s=>{var l,u,h,f;if(!this.isDragging||tn.isPinching)return;const d=(u=(l=s.movement)===null||l===void 0?void 0:l.x)!==null&&u!==void 0?u:s.dx,v=(f=(h=s.movement)===null||h===void 0?void 0:h.y)!==null&&f!==void 0?f:s.dy;d|v&&this.translate([d,v],!1)},this.onDragEnd=()=>{var s,l;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),(l=(s=this.options).onFinish)===null||l===void 0||l.call(s)},this.invokeOnFinish=El(()=>{var s,l;(l=(s=this.options).onFinish)===null||l===void 0||l.call(s)},300),this.shortcut=new ts(n.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(n){this.unbindEvents(),super.update(n),this.bindEvents()}bindEvents(){const{trigger:n}=this.options;if((0,Zn.Z)(n)){const{up:r=[],down:s=[],left:l=[],right:u=[]}=n;this.shortcut.bind(r,h=>this.onTranslate([0,1],h)),this.shortcut.bind(s,h=>this.onTranslate([0,-1],h)),this.shortcut.bind(l,h=>this.onTranslate([1,0],h)),this.shortcut.bind(u,h=>this.onTranslate([-1,0],h))}else{const{graph:r}=this.context;r.on(tt.DRAG_START,this.onDragStart),r.on(tt.DRAG,this.onDrag),r.on(tt.DRAG_END,this.onDragEnd)}}onTranslate(n,r){return sb(this,void 0,void 0,function*(){if(!this.validate(r))return;const{sensitivity:s}=this.options,l=s*-1;yield this.translate(Yr(n,l),this.options.animation),this.invokeOnFinish()})}translate(n,r){return sb(this,void 0,void 0,function*(){n=this.clampByDirection(n),n=this.clampByRange(n),n=this.clampByRotation(n),yield this.context.graph.translateBy(n,r)})}clampByRotation([n,r]){const s=this.context.graph.getRotation();return Qm([n,r],s)}clampByDirection([n,r]){const{direction:s}=this.options;return s==="x"?r=0:s==="y"&&(n=0),[n,r]}clampByRange([n,r]){const{viewport:s,canvas:l}=this.context,[u,h]=l.getSize(),[f,d,v,p]=yr(this.options.range),g=[h*f,u*d,h*v,u*p],y=ua(_d(s.getCanvasCenter()),g),m=Te(s.getViewportCenter(),[n,r,0]);if(!$r(m,y)){const{min:[b,x],max:[E,w]}=y;(m[0]<b&&n>0||m[0]>E&&n<0)&&(n=0),(m[1]<x&&r>0||m[1]>w&&r<0)&&(r=0)}return[n,r]}validate(n){if(this.destroyed)return!1;const{enable:r}=this.options;return typeof r=="function"?r(n):!!r}unbindEvents(){this.shortcut.unbindAll();const{graph:n}=this.context;n.off(tt.DRAG_START,this.onDragStart),n.off(tt.DRAG,this.onDrag),n.off(tt.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}}wl.defaultOptions={enable:a=>"targetType"in a?a.targetType==="canvas":!0,sensitivity:10,direction:"both",range:1/0};var ob=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class Hs extends sr{constructor(n,r){super(n,Object.assign({},Hs.defaultOptions,r)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=s=>ob(this,void 0,void 0,function*(){var l;if(this.options.dropEffect!=="link")return;const{model:u,element:h}=this.context,f=s.target.id;this.target.forEach(d=>{const v=u.getParentData(d,Oe);v&&V(v)===f&&u.refreshComboData(f),u.setParent(d,f,Oe)}),yield(l=h==null?void 0:h.draw({animation:!0}))===null||l===void 0?void 0:l.finished}),this.setCursor=s=>{if(this.isDragging)return;const{type:l}=s,{canvas:u}=this.context,{cursor:h}=this.options;l===tt.POINTER_ENTER?u.setCursor((h==null?void 0:h.grab)||"grab"):u.setCursor((h==null?void 0:h.default)||"default")},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}update(n){this.unbindEvents(),super.update(n),this.bindEvents()}bindEvents(){const{graph:n,canvas:r}=this.context,s=r.getLayer().getContextService().$canvas;s&&(s.addEventListener("blur",this.onDragEnd),s.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(l=>{n.on(`${l}:${tt.DRAG_START}`,this.onDragStart),n.on(`${l}:${tt.DRAG}`,this.onDrag),n.on(`${l}:${tt.DRAG_END}`,this.onDragEnd),n.on(`${l}:${tt.POINTER_ENTER}`,this.setCursor),n.on(`${l}:${tt.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(n.on(oa.DROP,this.onDrop),n.on(yi.DROP,this.onDrop))}getSelectedNodeIDs(n){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(r=>r.id).concat(n)))}getDelta(n){const r=this.context.graph.getZoom();return Xr([n.dx,n.dy],r)}onDragStart(n){var r;if(this.enable=this.validate(n),!this.enable)return;const{batch:s,canvas:l,graph:u}=this.context;l.setCursor(((r=this.options.cursor)===null||r===void 0?void 0:r.grabbing)||"grabbing"),this.isDragging=!0,s.startBatch();const h=n.target.id;u.getElementState(h).includes(this.options.state)?this.target=this.getSelectedNodeIDs([h]):this.target=[h],this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(n){if(!this.enable)return;const r=this.getDelta(n);this.options.shadow?this.moveShadow(r):this.moveElement(this.target,r)}onDragEnd(){var n,r,s;if(!this.enable)return;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:h=0,y:f=0}=this.shadow.attributes,[d,v]=Te([+h,+f],this.shadowOrigin);this.moveElement(this.target,[d,v])}this.showEdges(),(r=(n=this.options).onFinish)===null||r===void 0||r.call(n,this.target);const{batch:l,canvas:u}=this.context;l.endBatch(),u.setCursor(((s=this.options.cursor)===null||s===void 0?void 0:s.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(n){if(this.destroyed||ml(n.target)||this.context.graph.isCollapsingExpanding)return!1;const{enable:r}=this.options;return(0,_t.Z)(r)?r(n):!!r}clampByRotation([n,r]){const s=this.context.graph.getRotation();return Qm([n,r],s)}moveElement(n,r){return ob(this,void 0,void 0,function*(){const{graph:s,model:l}=this.context,{dropEffect:u}=this.options;u==="move"&&n.forEach(h=>l.refreshComboData(h)),s.translateElementBy(Object.fromEntries(n.map(h=>[h,this.clampByRotation(r)])),!1)})}moveShadow(n){if(!this.shadow)return;const{x:r=0,y:s=0}=this.shadow.attributes,[l,u]=n;this.shadow.attr({x:+r+l,y:+s+u})}createShadow(n){const r=We(this.options,"shadow"),s=Uo(n.map(v=>this.context.element.getElement(v).getBounds())),[l,u]=s.min;this.shadowOrigin=[l,u];const[h,f]=la(s),d={width:h,height:f,x:l,y:u};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},r),d),{visibility:"visible"})):(this.shadow=new Sn({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},r),d),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||this.hiddenEdges.length===0||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:n,shadow:r}=this.options;if(n==="none"||r)return;const{graph:s}=this.context;n==="all"?this.hiddenEdges=s.getEdgeData().map(V):this.hiddenEdges=Array.from(new Set(this.target.map(l=>s.getRelatedEdgesData(l,n).map(V)).flat())),s.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:n,canvas:r}=this.context,s=r.getLayer().getContextService().$canvas;s&&(s.removeEventListener("blur",this.onDragEnd),s.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(l=>{n.off(`${l}:${tt.DRAG_START}`,this.onDragStart),n.off(`${l}:${tt.DRAG}`,this.onDrag),n.off(`${l}:${tt.DRAG_END}`,this.onDragEnd),n.off(`${l}:${tt.POINTER_ENTER}`,this.setCursor),n.off(`${l}:${tt.POINTER_LEAVE}`,this.setCursor)}),n.off(`combo:${tt.DROP}`,this.onDrop),n.off(`canvas:${tt.DROP}`,this.onDrop)}destroy(){var n;this.unbindEvents(),(n=this.shadow)===null||n===void 0||n.destroy(),super.destroy()}}Hs.defaultOptions={animation:!0,enable:a=>["node","combo"].includes(a.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var xv=Y(72137);class Sl{constructor(n,r){this.context=n,this.options=r||{}}}var aN=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})},sN=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};function Y7(a){const{type:n}=a;return!!(["comboCombined","comboForce"].includes(n)||n==="antv-dagre"&&a.sortByCombo)}function oN(a){const{type:n}=a;return["compact-box","mindmap","dendrogram","indented"].includes(n)}function X7(a){return isNumber(a.x)&&isNumber(a.y)}function lN(a){return!Array.isArray(a)&&(a==null?void 0:a.preLayout)}function lh(a){const{nodes:n,edges:r}=a,s={nodes:[],edges:[],combos:[]};return n.forEach(l=>{const u=l.data._isCombo?s.combos:s.nodes,{x:h,y:f,z:d=0}=l.data;u==null||u.push({id:l.id,style:{x:h,y:f,z:d}})}),r.forEach(l=>{const{id:u,source:h,target:f,data:{points:d=[],controlPoints:v=d.slice(1,d.length-1)}}=l;s.edges.push({id:u,source:h,target:f,style:Object.assign({},v!=null&&v.length?{controlPoints:v.map(Mn)}:{})})}),s}function cN(a,n){class r extends Sl{constructor(l,u){if(super(l,u),this.instance=new a({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const h=this.instance;this.stop=h.stop.bind(h),this.tick=f=>{const d=h.tick(f);return lh(d)}}}execute(l,u){return aN(this,void 0,void 0,function*(){return lh(yield this.instance.execute(this.graphData2LayoutModel(l),this.transformOptions((0,jn.Z)({},this.options,u))))})}transformOptions(l){if(!("onTick"in l))return l;const u=l.onTick;return l.onTick=h=>u(lh(h)),l}graphData2LayoutModel(l){const{nodes:u=[],edges:h=[],combos:f=[]}=l,d=u.map(m=>{const b=V(m),{data:x,style:E,combo:w}=m,S=sN(m,["data","style","combo"]),M={id:b,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},x),{data:x}),w?{parentId:w}:{}),{style:E}),S)};return E!=null&&E.x&&Object.assign(M.data,{x:E.x}),E!=null&&E.y&&Object.assign(M.data,{y:E.y}),E!=null&&E.z&&Object.assign(M.data,{z:E.z}),M}),v=new Map(d.map(m=>[m.id,m])),p=h.filter(m=>{const{source:b,target:x}=m;return v.has(b)&&v.has(x)}).map(m=>{const{source:b,target:x,data:E,style:w}=m;return{id:V(m),source:b,target:x,data:Object.assign({},E),style:Object.assign({},w)}}),g=f.map(m=>({id:V(m),data:Object.assign({_isCombo:!0},m.data),style:Object.assign({},m.style)})),y=new xv.k({nodes:[...d,...g],edges:p});return n.model.model.hasTreeStructure(Oe)&&(y.attachTreeStructure(Oe),d.forEach(m=>{const b=n.model.model.getParent(m.id,Oe);b&&y.hasNode(b.id)&&y.setParent(m.id,b.id,Oe)})),y}}return r}function ch(a,n,...r){if(n in a)return a[n](...r);if("instance"in a){const s=a.instance;if(n in s)return s[n](...r)}return null}function lb(a,n){if(n in a)return a[n];if("instance"in a){const r=a.instance;if(n in r)return r[n]}return null}var uN=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class cb extends Hs{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(n=>["d3-force","d3-force-3d"].includes(n==null?void 0:n.id))}validate(n){return this.context.layout?this.forceLayoutInstance?super.validate(n):(ar.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1):!1}moveElement(n,r){return uN(this,void 0,void 0,function*(){const s=this.forceLayoutInstance;this.context.graph.getNodeData(n).forEach((l,u)=>{const{x:h=0,y:f=0}=l.style||{};s&&ch(s,"setFixedPosition",n[u],[...Gt([+h,+f],this.clampByRotation(r))])})})}onDragStart(n){if(this.enable=this.validate(n),!this.enable)return;this.target=this.getSelectedNodeIDs([n.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const r=this.forceLayoutInstance;r&&lb(r,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(s=>{const{x:l=0,y:u=0}=s.style||{};r&&ch(r,"setFixedPosition",V(s),[+l,+u])})}onDrag(n){if(!this.enable)return;const r=this.getDelta(n);this.moveElement(this.target,r)}onDragEnd(){const n=this.forceLayoutInstance;n&&lb(n,"simulation").alphaTarget(0),!this.options.fixed&&this.context.graph.getNodeData(this.target).forEach(r=>{n&&ch(n,"setFixedPosition",V(r),[null,null,null])})}}var ub=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class Ml extends sr{constructor(n,r){super(n,Object.assign({},Ml.defaultOptions,r)),this.isZoomEvent=s=>!!(s.data&&"scale"in s.data),this.relatedEdgeToUpdate=new Set,this.zoom=this.context.graph.getZoom(),this.fixElementSize=s=>ub(this,void 0,void 0,function*(){if(!this.validate(s))return;const{graph:l}=this.context,{state:u,nodeFilter:h,edgeFilter:f,comboFilter:d}=this.options,v=(u?l.getElementDataByState("node",u):l.getNodeData()).filter(h),p=(u?l.getElementDataByState("edge",u):l.getEdgeData()).filter(f),g=(u?l.getElementDataByState("combo",u):l.getComboData()).filter(d),y=this.isZoomEvent(s)?this.zoom=Math.max(.01,Math.min(s.data.scale,10)):this.zoom,m=[...v,...g];m.length>0&&m.forEach(b=>this.fixNodeLike(b,y)),this.updateRelatedEdges(),p.length>0&&p.forEach(b=>this.fixEdge(b,y))}),this.cachedStyles=new Map,this.getOriginalFieldValue=(s,l,u)=>{var h;const f=this.cachedStyles.get(s)||[],d=((h=f.find(v=>v.shape===l))===null||h===void 0?void 0:h.style)||{};return u in d||(d[u]=l.attributes[u],this.cachedStyles.set(s,[...f.filter(v=>v.shape!==l),{shape:l,style:d}])),d[u]},this.scaleEntireElement=(s,l,u)=>{l.setLocalScale(1/u);const h=this.cachedStyles.get(s)||[];h.push({shape:l}),this.cachedStyles.set(s,h)},this.scaleSpecificShapes=(s,l,u)=>{const h=fA(s);(Array.isArray(u)?u:[u]).forEach(d=>{const{shape:v,fields:p}=d,g=typeof v=="function"?v(h):s.getShape(v);if(g){if(!p){this.scaleEntireElement(s.id,g,l);return}p.forEach(y=>{const m=this.getOriginalFieldValue(s.id,g,y);(0,se.Z)(m)&&(g.style[y]=m/l)})}})},this.skipIfExceedViewport=s=>{const{viewport:l}=this.context;return!(l!=null&&l.isInViewport(s.getRenderBounds(),!1,30))},this.fixNodeLike=(s,l)=>{const u=V(s),{element:h,model:f}=this.context,d=h.getElement(u);if(!d||this.skipIfExceedViewport(d))return;f.getRelatedEdgesData(u).forEach(g=>this.relatedEdgeToUpdate.add(V(g)));const p=this.options[d.type];if(!p){this.scaleEntireElement(u,d,l);return}this.scaleSpecificShapes(d,l,p)},this.fixEdge=(s,l)=>{const u=V(s),h=this.context.element.getElement(u);if(!h||this.skipIfExceedViewport(h))return;const f=this.options.edge;if(!f){h.style.transformOrigin="center",this.scaleEntireElement(u,h,l);return}this.scaleSpecificShapes(h,l,f)},this.updateRelatedEdges=()=>{const{element:s}=this.context;this.relatedEdgeToUpdate.size>0&&this.relatedEdgeToUpdate.forEach(l=>{const u=s.getElement(l);u==null||u.update({})}),this.relatedEdgeToUpdate.clear()},this.resetTransform=s=>ub(this,void 0,void 0,function*(){var l;!((l=s.data)===null||l===void 0)&&l.firstRender||(this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}}))}),this.bindEvents()}restoreCachedStyles(){if(this.cachedStyles.size>0){this.cachedStyles.forEach(l=>{l.forEach(({shape:u,style:h})=>{if(Si(h))u.setLocalScale(1);else{if(this.options.state)return;Object.entries(h).forEach(([f,d])=>u.style[f]=d)}})});const{graph:n,element:r}=this.context,s=Object.keys(Object.fromEntries(this.cachedStyles)).filter(l=>l&&n.getElementType(l)==="node");if(s.length>0){const l=new Set;s.forEach(u=>{n.getRelatedEdgesData(u).forEach(h=>l.add(V(h)))}),l.forEach(u=>{const h=r==null?void 0:r.getElement(u);h==null||h.update({})})}}}bindEvents(){const{graph:n}=this.context;n.on(lt.AFTER_DRAW,this.resetTransform),n.on(lt.AFTER_TRANSFORM,this.fixElementSize)}unbindEvents(){const{graph:n}=this.context;n.off(lt.AFTER_DRAW,this.resetTransform),n.off(lt.AFTER_TRANSFORM,this.fixElementSize)}validate(n){if(this.destroyed)return!1;const{enable:r}=this.options;return(0,_t.Z)(r)?r(n):!!r}destroy(){this.unbindEvents(),super.destroy()}}Ml.defaultOptions={enable:a=>a.data.scale<1,nodeFilter:()=>!0,edgeFilter:()=>!0,comboFilter:()=>!0,edge:[{shape:"key",fields:["lineWidth"]},{shape:"halo",fields:["lineWidth"]},{shape:"label"}],reset:!1};var hN=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class Tl extends sr{constructor(n,r){super(n,Object.assign({},Tl.defaultOptions,r)),this.focus=s=>hN(this,void 0,void 0,function*(){if(!this.validate(s))return;const{graph:l}=this.context;yield l.focusElement(s.target.id,this.options.animation)}),this.bindEvents()}bindEvents(){const{graph:n}=this.context;this.unbindEvents(),es.forEach(r=>{n.on(`${r}:${tt.CLICK}`,this.focus)})}validate(n){if(this.destroyed)return!1;const{enable:r}=this.options;return(0,_t.Z)(r)?r(n):!!r}unbindEvents(){const{graph:n}=this.context;es.forEach(r=>{n.off(`${r}:${tt.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}}Tl.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};class os extends sr{constructor(n,r){super(n,Object.assign({},os.defaultOptions,r)),this.isFrozen=!1,this.toggleFrozen=s=>{this.isFrozen=s.type==="dragstart"},this.hoverElement=s=>{if(!this.validate(s))return;const l=s.type===tt.POINTER_ENTER;this.updateElementsState(s,l);const{onHover:u,onHoverEnd:h}=this.options;l?u==null||u(s):h==null||h(s)},this.updateElementsState=(s,l)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:u}=this.context,{state:h,animation:f,inactiveState:d}=this.options,v=this.getActiveIds(s),p={};if(h&&Object.assign(p,this.getElementsState(v,h,l)),d){const g=Um(u.getData(),!0).filter(y=>!v.includes(y));Object.assign(p,this.getElementsState(g,d,l))}u.setElementState(p,f)},this.getElementsState=(s,l,u)=>{const{graph:h}=this.context,f={};return s.forEach(d=>{const v=h.getElementState(d);u?f[d]=v.includes(l)?v:[...v,l]:f[d]=v.filter(p=>p!==l)}),f},this.bindEvents()}bindEvents(){const{graph:n}=this.context;this.unbindEvents(),es.forEach(s=>{n.on(`${s}:${tt.POINTER_ENTER}`,this.hoverElement),n.on(`${s}:${tt.POINTER_LEAVE}`,this.hoverElement)});const r=this.context.canvas.document;r.addEventListener(`${tt.DRAG_START}`,this.toggleFrozen),r.addEventListener(`${tt.DRAG_END}`,this.toggleFrozen)}getActiveIds(n){const{graph:r}=this.context,{degree:s,direction:l}=this.options,u=n.target.id;return s?c1(r,n.targetType,u,typeof s=="function"?s(n):s,l):[u]}validate(n){if(this.destroyed||this.isFrozen||ml(n.target)||this.context.graph.isCollapsingExpanding)return!1;const{enable:r}=this.options;return(0,_t.Z)(r)?r(n):!!r}unbindEvents(){const{graph:n}=this.context;es.forEach(s=>{n.off(`${s}:${tt.POINTER_ENTER}`,this.hoverElement),n.off(`${s}:${tt.POINTER_LEAVE}`,this.hoverElement)});const r=this.context.canvas.document;r.removeEventListener(`${tt.DRAG_START}`,this.toggleFrozen),r.removeEventListener(`${tt.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}}os.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};class hb extends Zs{onPointerDown(n){if(!super.validate(n)||!super.isKeydown()||this.points)return;const{canvas:r,graph:s}=this.context;this.pathShape=new dr({id:"g6-lasso-select",style:this.options.style}),r.appendChild(this.pathShape),this.points=[Hu(n,s)]}onPointerMove(n){var r;if(!this.points)return;const{immediately:s,mode:l}=this.options;this.points.push(Hu(n,this.context.graph)),(r=this.pathShape)===null||r===void 0||r.setAttribute("d",oA(this.points)),s&&l==="default"&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var n;(n=this.pathShape)===null||n===void 0||n.remove(),this.pathShape=void 0,this.points=void 0}}class Cl extends sr{constructor(n,r){super(n,Object.assign({},Cl.defaultOptions,r)),this.hiddenShapes=[],this.isVisible=!0,this.setElementsVisibility=(s,l,u)=>{s.filter(Boolean).forEach(h=>{l==="hidden"&&!h.isVisible()?this.hiddenShapes.push(h):l==="visible"&&this.hiddenShapes.includes(h)?this.hiddenShapes.splice(this.hiddenShapes.indexOf(h),1):fa(h,l,u)})},this.filterShapes=(s,l)=>{if((0,_t.Z)(l))return h=>!l(s,h);const u=l==null?void 0:l[s];return h=>h.className?!(u!=null&&u.includes(h.className)):!0},this.hideShapes=s=>{if(!this.validate(s)||!this.isVisible)return;const{element:l}=this.context,{shapes:u={}}=this.options;this.setElementsVisibility(l.getNodes(),"hidden",this.filterShapes("node",u)),this.setElementsVisibility(l.getEdges(),"hidden",this.filterShapes("edge",u)),this.setElementsVisibility(l.getCombos(),"hidden",this.filterShapes("combo",u)),this.isVisible=!1},this.showShapes=El(s=>{if(!this.validate(s)||this.isVisible)return;const{element:l}=this.context;this.setElementsVisibility(l.getNodes(),"visible"),this.setElementsVisibility(l.getEdges(),"visible"),this.setElementsVisibility(l.getCombos(),"visible"),this.isVisible=!0},this.options.debounce),this.bindEvents()}bindEvents(){const{graph:n}=this.context;n.on(lt.BEFORE_TRANSFORM,this.hideShapes),n.on(lt.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:n}=this.context;n.off(lt.BEFORE_TRANSFORM,this.hideShapes),n.off(lt.AFTER_TRANSFORM,this.showShapes)}validate(n){if(this.destroyed)return!1;const{enable:r}=this.options;return(0,_t.Z)(r)?r(n):!!r}update(n){this.unbindEvents(),super.update(n),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}Cl.defaultOptions={enable:!0,debounce:200,shapes:a=>a==="node"};var fb=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class Ol extends sr{constructor(n,r){super(n,Object.assign({},Ol.defaultOptions,r)),this.onWheel=s=>fb(this,void 0,void 0,function*(){this.options.preventDefault&&s.preventDefault();const l=s.deltaX,u=s.deltaY;yield this.scroll([-l,-u],s)}),this.shortcut=new ts(n.graph),this.bindEvents()}update(n){super.update(n),this.bindEvents()}bindEvents(){var n,r;const{trigger:s}=this.options;if(this.shortcut.unbindAll(),(0,Zn.Z)(s)){(n=this.graphDom)===null||n===void 0||n.removeEventListener(tt.WHEEL,this.onWheel);const{up:l=[],down:u=[],left:h=[],right:f=[]}=s;this.shortcut.bind(l,d=>this.scroll([0,-10],d)),this.shortcut.bind(u,d=>this.scroll([0,10],d)),this.shortcut.bind(h,d=>this.scroll([-10,0],d)),this.shortcut.bind(f,d=>this.scroll([10,0],d))}else(r=this.graphDom)===null||r===void 0||r.addEventListener(tt.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(n){const{sensitivity:r}=this.options;return n=Yr(n,r),n=this.clampByDirection(n),n=this.clampByRange(n),n}clampByDirection([n,r]){const{direction:s}=this.options;return s==="x"?r=0:s==="y"&&(n=0),[n,r]}clampByRange([n,r]){const{viewport:s,canvas:l}=this.context,[u,h]=l.getSize(),[f,d,v,p]=yr(this.options.range),g=[h*f,u*d,h*v,u*p],y=ua(_d(s.getCanvasCenter()),g),m=Te(s.getViewportCenter(),[n,r,0]);if(!$r(m,y)){const{min:[b,x],max:[E,w]}=y;(m[0]<b&&n>0||m[0]>E&&n<0)&&(n=0),(m[1]<x&&r>0||m[1]>w&&r<0)&&(r=0)}return[n,r]}scroll(n,r){return fb(this,void 0,void 0,function*(){if(!this.validate(r))return;const{onFinish:s}=this.options,l=this.context.graph,u=this.formatDisplacement(n);yield l.translateBy(u,!1),s==null||s()})}validate(n){if(this.destroyed)return!1;const{enable:r}=this.options;return(0,_t.Z)(r)?r(n):!!r}destroy(){var n;this.shortcut.destroy(),(n=this.graphDom)===null||n===void 0||n.removeEventListener(tt.WHEEL,this.onWheel),super.destroy()}}Ol.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var db=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class kl extends sr{constructor(n,r){super(n,Object.assign({},kl.defaultOptions,r)),this.zoom=(s,l,u)=>db(this,void 0,void 0,function*(){if(!this.validate(l))return;const{graph:h}=this.context;let f=this.options.origin;!f&&"viewport"in l&&(f=Mn(l.viewport));const{sensitivity:d,onFinish:v}=this.options,p=1+Ze(s,-50,50)*d/100,g=h.getZoom();yield h.zoomTo(g*p,u,f),v==null||v()}),this.onReset=()=>db(this,void 0,void 0,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}),this.preventDefault=s=>{this.options.preventDefault&&s.preventDefault()},this.shortcut=new ts(n.graph),this.bindEvents()}update(n){super.update(n),this.bindEvents()}bindEvents(){const{trigger:n}=this.options;if(this.shortcut.unbindAll(),Array.isArray(n))if(n.includes(tt.PINCH))this.shortcut.bind([tt.PINCH],r=>{this.zoom(r.scale,r,!1)});else{const r=this.context.canvas.getContainer();r==null||r.addEventListener(tt.WHEEL,this.preventDefault),this.shortcut.bind([...n,tt.WHEEL],s=>{const{deltaX:l,deltaY:u}=s;this.zoom(-(u!=null?u:l),s,!1)})}if(typeof n=="object"){const{zoomIn:r=[],zoomOut:s=[],reset:l=[]}=n;this.shortcut.bind(r,u=>this.zoom(10,u,this.options.animation)),this.shortcut.bind(s,u=>this.zoom(-10,u,this.options.animation)),this.shortcut.bind(l,this.onReset)}}validate(n){if(this.destroyed)return!1;const{enable:r}=this.options;return(0,_t.Z)(r)?r(n):!!r}destroy(){var n;this.shortcut.destroy(),(n=this.context.canvas.getContainer())===null||n===void 0||n.removeEventListener(tt.WHEEL,this.preventDefault),super.destroy()}}kl.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var ba=Y(81746),vb=Y(45978),pb=Y(63795),gb=Y(63757),yb=Y(5192),mb=Y(58745),bb=Y(21183),xb=Y(40476),Eb=Y(70979),wb=Y(89469),Sb=Y(41733),Mb=Y(64912),Tb=Y(29257),Cb=Y(26629);function fN(a){var n,r,s,l=a||1;function u(f,d){++n>l&&(s=r,h(1),++n),r[f]=d}function h(f){n=0,r=Object.create(null),f||(s=Object.create(null))}return h(),{clear:h,has:function(f){return r[f]!==void 0||s[f]!==void 0},get:function(f){var d=r[f];if(d!==void 0)return d;if((d=s[f])!==void 0)return u(f,d),d},set:function(f,d){r[f]!==void 0?r[f]=d:u(f,d)}}}var Ev=new Map;function wv(a,n,r){r===void 0&&(r=128);var s=function(){for(var l=[],u=0;u<arguments.length;u++)l[u]=arguments[u];var h=n?n.apply(this,l):l[0];Ev.has(a)||Ev.set(a,fN(r));var f=Ev.get(a);if(f.has(h))return f.get(h);var d=a.apply(this,l);return f.set(h,d),d};return s}var dN=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class _l extends Sl{constructor(){super(...arguments),this.id="fishbone"}getRoot(){const n=this.context.model.getRootsData();if(!(Si(n)||n.length>2))return n[0]}formatSize(n){const r=typeof n=="function"?n:()=>n;return s=>Hn(r(s))}doLayout(n,r){const{hGap:s,getRibSep:l,vGap:u,nodeSize:h,height:f}=r,{model:d}=this.context,v=this.formatSize(h);let p=v(n)[0]+l(n);const g=(M,C=0)=>{var T;return C+=s*((M.children||[]).length+1),(T=M.children)===null||T===void 0||T.forEach(O=>{var k;(k=d.getNodeLikeDatum(O).children)===null||k===void 0||k.forEach(A=>{const N=d.getNodeLikeDatum(A);C=g(N,C)})}),C},y=M=>{if(M.depth===1)return p;const C=d.getParentData(M.id,"tree");if($s(M)){const T=d.getParentData(C.id,"tree"),O=x(M)-x(T);return y(C)+O*s/u}else{const T=(C.children||[]).indexOf(M.id),O=d.getNodeData((C.children||[]).slice(T));return m(C)-O.reduce((k,P)=>k+g(P),0)-v(C)[0]/2}},m=wv(M=>{if(Sv(M))return v(M)[0]/2;const C=d.getParentData(M.id,"tree");if($s(M))return y(M)+g(M)+v(M)[0]/2;{const T=x(M)-x(C),O=s/u;return y(M)+T*O}},M=>M.id),b=M=>x(d.getParentData(M,"tree")),x=wv(M=>{if(Sv(M))return f/2;if($s(M)){const C=d.getParentData(M.id,"tree"),T=C.children.indexOf(M.id);if(T===0)return b(C.id)+u;const O=d.getNodeLikeDatum(C.children[T-1]);if(Si(O.children))return x(O)+u;const k=d.getDescendantsData(O.id);return Math.max(...k.map(P=>$s(P)?b(P.id):x(P)))+u}else{if(Si(M.children))return b(M.id)+u;const C=d.getNodeLikeDatum(M.children.slice(-1)[0]);if(Si(C.children))return x(C)+u;const T=d.getDescendantsData(M.id).slice(-1)[0];return($s(T)?b(T.id):x(T))+u}},M=>M.id);let E=0;const w={nodes:[],edges:[]},S=M=>{var C;(C=M.children)===null||C===void 0||C.forEach(A=>S(d.getNodeLikeDatum(A)));const T=x(M),O=m(M);if(w.nodes.push({id:M.id,x:O,y:T}),Sv(M))return;const k=d.getRelatedEdgesData(M.id,"in")[0],P=[y(M),$s(M)?T:b(M.id)];w.edges.push({id:V(k),controlPoints:[P],relatedNodeId:M.id}),E=Math.max(E,O+l(M)),M.depth===1&&(p=E)};return S(n),w}placeAlterative(n,r){const s=(r.children||[]).filter((f,d)=>d%2!==0);if(s.length===0)return n;const{model:l}=this.context,u=n.nodes.find(f=>f.id===r.id).y,h=f=>{const d=l.getAncestorsData(f,"tree");if(Si(d))return!1;const v=d.length===1?f:d[d.length-2].id;return s.includes(v)};n.nodes.forEach(f=>{h(f.id)&&(f.y=2*u-f.y)}),n.edges.forEach(f=>{h(f.relatedNodeId)&&(f.controlPoints=f.controlPoints.map(d=>[d[0],2*u-d[1]]))})}rightToLeft(n,r){return n.nodes.forEach(s=>s.x=r.width-s.x),n.edges.forEach(s=>{s.controlPoints=s.controlPoints.map(l=>[r.width-l[0],l[1]])}),n}execute(n,r){return dN(this,void 0,void 0,function*(){const s=Object.assign(Object.assign(Object.assign({},_l.defaultOptions),this.options),r),{direction:l,nodeSize:u}=s,h=this.getRoot();if(!h)return n;const f=this.formatSize(u);s.vGap||(s.vGap=Math.max(...(n.nodes||[]).map(y=>f(y)[1]))),s.hGap||(s.hGap=Math.max(...(n.nodes||[]).map(y=>f(y)[0])));let d=this.doLayout(h,s);this.placeAlterative(d,h),l==="RL"&&(d=this.rightToLeft(d,s));const{model:v}=this.context,p=[],g=[];return d.nodes.forEach(y=>{const{id:m,x:b,y:x}=y,E=v.getNodeLikeDatum(m);p.push(Ob(E,{x:b,y:x}))}),d.edges.forEach(y=>{const{id:m,controlPoints:b}=y,x=v.getEdgeDatum(m);g.push(Ob(x,{controlPoints:b}))}),{nodes:p,edges:g}})}}_l.defaultOptions={direction:"RL",getRibSep:()=>60};const Ob=(a,n)=>Object.assign(Object.assign({},a),{style:Object.assign(Object.assign({},a.style||{}),n)}),Sv=a=>a.depth===0,$s=a=>(a.depth||(a.depth=0))%2===0;var vN=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class Pl extends Sl{constructor(){super(...arguments),this.id="snake"}formatSize(n,r){const s=typeof r=="function"?r:()=>r;return n.reduce((l,u)=>{const[h,f]=Hn(s(u))||[0,0];return[Math.max(l[0],h),Math.max(l[1],f)]},[0,0])}validate(n){const{nodes:r=[],edges:s=[]}=n,l={},u={},h={};r.forEach(y=>{l[y.id]=0,u[y.id]=0,h[y.id]=[]}),s.forEach(y=>{l[y.target]++,u[y.source]++,h[y.source].push(y.target)});const f=new Set,d=y=>{f.has(y)||(f.add(y),h[y].forEach(d))};if(d(r[0].id),f.size!==r.length)return!1;const v=r.filter(y=>l[y.id]===0),p=r.filter(y=>u[y.id]===0);return!(v.length!==1||p.length!==1||r.filter(y=>l[y.id]===1&&u[y.id]===1).length!==r.length-2)}execute(n,r){return vN(this,void 0,void 0,function*(){var s;if(!this.validate(n))return n;const{nodeSize:l,padding:u,sortBy:h,cols:f,colGap:d,rowGap:v,clockwise:p,width:g,height:y}=Object.assign({},Pl.defaultOptions,this.options,r),[m,b,x,E]=yr(u),w=this.formatSize(n.nodes||[],l),S=Math.ceil((n.nodes||[]).length/f);let M=d||(g-E-b-f*w[0])/(f-1),C=v||(y-m-x-S*w[1])/(S-1);return(C===1/0||C<0)&&(C=0),(M===1/0||M<0)&&(M=0),{nodes:((h?(s=n.nodes)===null||s===void 0?void 0:s.sort(h):pN(n))||[]).map((k,P)=>{const A=Math.floor(P/f),N=P%f,L=p?A%2===0?N:f-1-N:A%2===0?f-1-N:N,R=E+L*(w[0]+M)+w[0]/2,z=m+A*(w[1]+C)+w[1]/2;return{id:k.id,style:{x:R,y:z}}})}})}}Pl.defaultOptions={padding:0,cols:5,clockwise:!0};function pN(a){const{nodes:n=[],edges:r=[]}=a,s={},l={};n.forEach(f=>{s[f.id]=0,l[f.id]=[]}),r.forEach(f=>{s[f.target]++,l[f.source].push(f.target)});const u=[],h=[];for(n.forEach(f=>{s[f.id]===0&&u.push(f.id)});u.length>0;){const f=u.shift(),d=n.find(v=>v.id===f);h.push(d),l[f].forEach(v=>{s[v]--,s[v]===0&&u.push(v)})}return h}const gN=["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],yN=["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],mN=["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],bN=["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],xN=["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"];var EN=Y(15255),Mv=Y(83845),wN=function(a,n,r){if(!(0,Gr.Z)(a)&&!(0,Mv.Z)(a))return a;var s=r;return(0,EN.Z)(a,function(l,u){s=n(s,l,u)}),s},SN=wN,Tv=function(a,n){return SN(a,function(r,s,l){return n.includes(l)||(r[l]=s),r},{})};class ln extends Wd{}function Us(a,n=!0,r){const s=document.createElement("div");return s.setAttribute("class",`g6-${a}`),Object.assign(s.style,{position:"absolute",display:"block"}),n&&Object.assign(s.style,{position:"unset",gridArea:"1 / 1 / 2 / 2",inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),r&&Object.assign(s.style,r),s}function Cv(a,n="div",r={},s="",l=document.body){const u=document.getElementById(a);u&&u.remove();const h=document.createElement(n);return h.innerHTML=s,h.id=a,Object.assign(h.style,r),l.appendChild(h),h}var MN=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class Al extends ln{constructor(n,r){super(n,Object.assign({},Al.defaultOptions,r)),this.$element=Us("background"),this.context.canvas.getContainer().prepend(this.$element),this.update(r)}update(n){const r=Object.create(null,{update:{get:()=>super.update}});return MN(this,void 0,void 0,function*(){r.update.call(this,n),Object.assign(this.$element.style,Tv(this.options,["key","type"]))})}destroy(){super.destroy(),this.$element.remove()}}Al.defaultOptions={transition:"background 0.5s",backgroundSize:"cover",zIndex:"-1"};function Ov(a,n,r,s,l,u){const h=a,f=n,d=r-h,v=s-f;let p=l-h,g=u-f,y=p*d+g*v,m=0;y<=0?m=0:(p=d-p,g=v-g,y=p*d+g*v,y<=0?m=0:m=y*y/(d*d+v*v));const b=p*p+g*g-m;return b<0?0:b}function xa(a,n,r,s){return(a-r)*(a-r)+(n-s)*(n-s)}function kb(a,n,r,s,l){return xa(a,n,r,s)<l*l}function TN(a){if(!Number.isFinite(a))return r=>r;if(a===0)return Math.round;const n=Math.pow(10,a);return r=>Math.round(r*n)/n}function _b(a){const n=Math.min(a.x1,a.x2),r=Math.max(a.x1,a.x2),s=Math.min(a.y1,a.y2),l=Math.max(a.y1,a.y2);return{x:n,y:s,x2:r,y2:l,width:r-n,height:l-s}}class mn{constructor(n,r,s,l){this.x1=n,this.y1=r,this.x2=s,this.y2=l}equals(n){return this.x1===n.x1&&this.y1===n.y1&&this.x2===n.x2&&this.y2===n.y2}draw(n){n.moveTo(this.x1,this.y1),n.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(n){return new mn(n.x1,n.y1,n.x2,n.y2)}cuts(n,r){if(this.y1===this.y2||r<this.y1&&r<=this.y2||r>this.y1&&r>=this.y2||n>this.x1&&n>=this.x2)return!1;if(n<this.x1&&n<=this.x2)return!0;const s=this.x1+(r-this.y1)*(this.x2-this.x1)/(this.y2-this.y1);return n<=s}distSquare(n,r){return Ov(this.x1,this.y1,this.x2,this.y2,n,r)}ptClose(n,r,s){if(this.x1<this.x2){if(n<this.x1-s||n>this.x2+s)return!1}else if(n<this.x2-s||n>this.x1+s)return!1;if(this.y1<this.y2){if(r<this.y1-s||r>this.y2+s)return!1}else if(r<this.y2-s||r>this.y1+s)return!1;return!0}}var Ue;(function(a){a[a.POINT=1]="POINT",a[a.PARALLEL=2]="PARALLEL",a[a.COINCIDENT=3]="COINCIDENT",a[a.NONE=4]="NONE"})(Ue||(Ue={}));class kv{constructor(n,r=0,s=0){this.state=n,this.x=r,this.y=s}}function uh(a,n){const r=(n.x2-n.x1)*(a.y1-n.y1)-(n.y2-n.y1)*(a.x1-n.x1),s=(a.x2-a.x1)*(a.y1-n.y1)-(a.y2-a.y1)*(a.x1-n.x1),l=(n.y2-n.y1)*(a.x2-a.x1)-(n.x2-n.x1)*(a.y2-a.y1);if(l){const u=r/l,h=s/l;return 0<=u&&u<=1&&0<=h&&h<=1?new kv(Ue.POINT,a.x1+u*(a.x2-a.x1),a.y1+u*(a.y2-a.y1)):new kv(Ue.NONE)}return new kv(r===0||s===0?Ue.COINCIDENT:Ue.PARALLEL)}function Pb(a,n){const r=(n.x2-n.x1)*(a.y1-n.y1)-(n.y2-n.y1)*(a.x1-n.x1),s=(a.x2-a.x1)*(a.y1-n.y1)-(a.y2-a.y1)*(a.x1-n.x1),l=(n.y2-n.y1)*(a.x2-a.x1)-(n.x2-n.x1)*(a.y2-a.y1);if(l){const u=r/l,h=s/l;if(0<=u&&u<=1&&0<=h&&h<=1)return u}return Number.POSITIVE_INFINITY}function CN(a,n){function r(l,u,h,f){let d=Pb(n,new mn(l,u,h,f));return d=Math.abs(d-.5),d>=0&&d<=1?1:0}let s=r(a.x,a.y,a.x2,a.y);return s+=r(a.x,a.y,a.x,a.y2),s>1||(s+=r(a.x,a.y2,a.x2,a.y2),s>1)?!0:(s+=r(a.x2,a.y,a.x2,a.y2),s>0)}var Ye;(function(a){a[a.LEFT=0]="LEFT",a[a.TOP=1]="TOP",a[a.RIGHT=2]="RIGHT",a[a.BOTTOM=3]="BOTTOM"})(Ye||(Ye={}));function hh(a,n,r){const s=new Set;return a.width<=0?(s.add(Ye.LEFT),s.add(Ye.RIGHT)):n<a.x?s.add(Ye.LEFT):n>a.x+a.width&&s.add(Ye.RIGHT),a.height<=0?(s.add(Ye.TOP),s.add(Ye.BOTTOM)):r<a.y?s.add(Ye.TOP):r>a.y+a.height&&s.add(Ye.BOTTOM),s}function Ab(a,n){let r=n.x1,s=n.y1;const l=n.x2,u=n.y2,h=Array.from(hh(a,l,u));if(h.length===0)return!0;let f=hh(a,r,s);for(;f.size!==0;){for(const d of h)if(f.has(d))return!1;if(f.has(Ye.RIGHT)||f.has(Ye.LEFT)){let d=a.x;f.has(Ye.RIGHT)&&(d+=a.width),s=s+(d-r)*(u-s)/(l-r),r=d}else{let d=a.y;f.has(Ye.BOTTOM)&&(d+=a.height),r=r+(d-s)*(l-r)/(u-s),s=d}f=hh(a,r,s)}return!0}function ON(a,n){let r=Number.POSITIVE_INFINITY,s=0;function l(u,h,f,d){let v=Pb(n,new mn(u,h,f,d));v=Math.abs(v-.5),v>=0&&v<=1&&(s++,v<r&&(r=v))}return l(a.x,a.y,a.x2,a.y),l(a.x,a.y,a.x,a.y2),s>1||(l(a.x,a.y2,a.x2,a.y2),s>1)?r:(l(a.x2,a.y,a.x2,a.y2),s===0?-1:r)}function kN(a,n){let r=0;const s=uh(a,new mn(n.x,n.y,n.x2,n.y));r+=s.state===Ue.POINT?1:0;const l=uh(a,new mn(n.x,n.y,n.x,n.y2));r+=l.state===Ue.POINT?1:0;const u=uh(a,new mn(n.x,n.y2,n.x2,n.y2));r+=u.state===Ue.POINT?1:0;const h=uh(a,new mn(n.x2,n.y,n.x2,n.y2));return r+=h.state===Ue.POINT?1:0,{top:s,left:l,bottom:u,right:h,count:r}}class Ln{constructor(n,r,s,l){this.x=n,this.y=r,this.width=s,this.height=l}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(n){return new Ln(n.x,n.y,n.width,n.height)}equals(n){return this.x===n.x&&this.y===n.y&&this.width===n.width&&this.height===n.height}clone(){return new Ln(this.x,this.y,this.width,this.height)}add(n){const r=Math.min(this.x,n.x),s=Math.min(this.y,n.y),l=Math.max(this.x2,n.x+n.width),u=Math.max(this.y2,n.y+n.height);this.x=r,this.y=s,this.width=l-r,this.height=u-s}addPoint(n){const r=Math.min(this.x,n.x),s=Math.min(this.y,n.y),l=Math.max(this.x2,n.x),u=Math.max(this.y2,n.y);this.x=r,this.y=s,this.width=l-r,this.height=u-s}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(n){n.rect(this.x,this.y,this.width,this.height)}containsPt(n,r){return n>=this.x&&n<=this.x2&&r>=this.y&&r<=this.y2}get area(){return this.width*this.height}intersects(n){return this.area<=0||n.width<=0||n.height<=0?!1:n.x+n.width>this.x&&n.y+n.height>this.y&&n.x<this.x2&&n.y<this.y2}distSquare(n,r){if(this.containsPt(n,r))return 0;const s=hh(this,n,r);return s.has(Ye.TOP)?s.has(Ye.LEFT)?xa(n,r,this.x,this.y):s.has(Ye.RIGHT)?xa(n,r,this.x2,this.y):(this.y-r)*(this.y-r):s.has(Ye.BOTTOM)?s.has(Ye.LEFT)?xa(n,r,this.x,this.y2):s.has(Ye.RIGHT)?xa(n,r,this.x2,this.y2):(r-this.y2)*(r-this.y2):s.has(Ye.LEFT)?(this.x-n)*(this.x-n):s.has(Ye.RIGHT)?(n-this.x2)*(n-this.x2):0}}function _N(a){if(a.length===0)return null;const n=a[0],r=new Ln(n.x,n.y,0,0);for(const s of a)r.addPoint(s);return r}class fh{constructor(n,r,s){this.cx=n,this.cy=r,this.radius=s}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return this.radius*2}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return this.radius*2}static from(n){return new fh(n.cx,n.cy,n.radius)}containsPt(n,r){return xa(this.cx,this.cy,n,r)<this.radius*this.radius}distSquare(n,r){const s=xa(this.cx,this.cy,n,r);if(s<this.radius*this.radius)return 0;const l=Math.sqrt(s)-this.radius;return l*l}draw(n){n.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,Math.PI*2)}}class ls{constructor(n,r=0,s=0,l=0,u=0,h=10,f=10,d=new Float32Array(Math.max(0,h*f)).fill(0)){this.pixelGroup=n,this.i=r,this.j=s,this.pixelX=l,this.pixelY=u,this.width=h,this.height=f,this.area=d}createSub(n,r){return new ls(this.pixelGroup,n.x,n.y,r.x,r.y,n.width,n.height)}static fromPixelRegion(n,r){return new ls(r,0,0,n.x,n.y,Math.ceil(n.width/r),Math.ceil(n.height/r))}copy(n,r){return new ls(this.pixelGroup,this.scaleX(r.x),this.scaleY(r.y),r.x,r.y,n.width,n.height,n.area)}boundX(n){return n<this.i?this.i:n>=this.width?this.width-1:n}boundY(n){return n<this.j?this.j:n>=this.height?this.height-1:n}scaleX(n){return this.boundX(Math.floor((n-this.pixelX)/this.pixelGroup))}scaleY(n){return this.boundY(Math.floor((n-this.pixelY)/this.pixelGroup))}scale(n){const r=this.scaleX(n.x),s=this.scaleY(n.y),l=this.boundX(Math.ceil((n.x+n.width-this.pixelX)/this.pixelGroup)),u=this.boundY(Math.ceil((n.y+n.height-this.pixelY)/this.pixelGroup)),h=l-r,f=u-s;return new Ln(r,s,h,f)}invertScaleX(n){return Math.round(n*this.pixelGroup+this.pixelX)}invertScaleY(n){return Math.round(n*this.pixelGroup+this.pixelY)}addPadding(n,r){const s=Math.ceil(r/this.pixelGroup),l=this.boundX(n.x-s),u=this.boundY(n.y-s),h=this.boundX(n.x2+s),f=this.boundY(n.y2+s),d=h-l,v=f-u;return new Ln(l,u,d,v)}get(n,r){return n<0||r<0||n>=this.width||r>=this.height?Number.NaN:this.area[n+r*this.width]}inc(n,r,s){n<0||r<0||n>=this.width||r>=this.height||(this.area[n+r*this.width]+=s)}set(n,r,s){n<0||r<0||n>=this.width||r>=this.height||(this.area[n+r*this.width]=s)}incArea(n,r){if(n.width<=0||n.height<=0||r===0)return;const s=this.width,l=n.width,u=Math.max(0,n.i),h=Math.max(0,n.j),f=Math.min(n.i+n.width,s),d=Math.min(n.j+n.height,this.height);if(!(d<=0||f<=0||u>=s||d>=this.height))for(let v=h;v<d;v++){const p=(v-n.j)*l,g=v*s;for(let y=u;y<f;y++){const m=n.area[y-n.i+p];m!==0&&(this.area[y+g]+=r*m)}}}fill(n){this.area.fill(n)}fillArea(n,r){const s=n.x+n.y*this.width;for(let l=0;l<n.height;l++){const u=s+l*this.width;this.area.fill(r,u,u+n.width)}}fillHorizontalLine(n,r,s,l){const u=n+r*this.width;this.area.fill(l,u,u+s)}fillVerticalLine(n,r,s,l){const u=n+r*this.width;for(let h=0;h<s;h++)this.area[u+h*this.width]=l}clear(){this.area.fill(0)}toString(){let n="";for(let r=0;r<this.height;r++){const s=r*this.width;for(let l=0;l<this.width;l++){const u=this.area[s+l];n+=u.toFixed(1).padStart(6),n+=" "}n+=`
`}return n}draw(n,r=!0){if(this.width<=0||this.height<=0)return;n.save(),r&&n.translate(this.pixelX,this.pixelY);const s=this.area.reduce((h,f)=>Math.min(h,f),Number.POSITIVE_INFINITY),l=this.area.reduce((h,f)=>Math.max(h,f),Number.NEGATIVE_INFINITY),u=h=>(h-s)/(l-s);n.scale(this.pixelGroup,this.pixelGroup);for(let h=0;h<this.width;h++)for(let f=0;f<this.height;f++){const d=this.area[h+f*this.width];n.fillStyle=`rgba(0, 0, 0, ${u(d)})`,n.fillRect(h,f,1,1)}n.restore()}drawThreshold(n,r,s=!0){if(!(this.width<=0||this.height<=0)){n.save(),s&&n.translate(this.pixelX,this.pixelY),n.scale(this.pixelGroup,this.pixelGroup);for(let l=0;l<this.width;l++)for(let u=0;u<this.height;u++){const h=this.area[l+u*this.width];n.fillStyle=h>r?"black":"white",n.fillRect(l,u,1,1)}n.restore()}}}function Nb(a,n){const r=s=>({x:s.x-n,y:s.y-n,width:s.width+2*n,height:s.height+2*n});return Array.isArray(a)?a.map(r):r(a)}function Rb(a,n,r){return Lb(Object.assign(_b(a),{distSquare:(s,l)=>Ov(a.x1,a.y1,a.x2,a.y2,s,l)}),n,r)}function Lb(a,n,r){const s=Nb(a,r),l=n.scale(s),u=n.createSub(l,s);return PN(u,n,r,(h,f)=>a.distSquare(h,f)),u}function PN(a,n,r,s){const l=r*r;for(let u=0;u<a.height;u++)for(let h=0;h<a.width;h++){const f=n.invertScaleX(a.i+h),d=n.invertScaleY(a.j+u),v=s(f,d);if(v===0){a.set(h,u,l);continue}if(v<l){const p=r-Math.sqrt(v);a.set(h,u,p*p)}}return a}function AN(a,n,r){const s=n.scale(a),l=n.addPadding(s,r),u=n.createSub(l,{x:a.x-r,y:a.y-r}),h=s.x-l.x,f=s.y-l.y,d=l.x2-s.x2,v=l.y2-s.y2,p=l.width-h-d,g=l.height-f-v,y=r*r;u.fillArea({x:h,y:f,width:p+1,height:g+1},y);const m=[0],b=Math.max(f,h,d,v);{const S=n.invertScaleX(s.x+s.width/2);for(let M=1;M<b;M++){const C=n.invertScaleY(s.y-M),T=a.distSquare(S,C);if(T<y){const O=r-Math.sqrt(T);m.push(O*O)}else break}}const x=[],E=Math.max(h,d),w=Math.max(f,d);for(let S=1;S<E;S++){const M=n.invertScaleX(s.x-S),C=[];for(let T=1;T<w;T++){const O=n.invertScaleY(s.y-T),k=a.distSquare(M,O);if(k<y){const P=r-Math.sqrt(k);C.push(P*P)}else C.push(0)}x.push(C)}for(let S=1;S<Math.min(f,m.length);S++){const M=m[S];u.fillHorizontalLine(h,f-S,p+1,M)}for(let S=1;S<Math.min(v,m.length);S++){const M=m[S];u.fillHorizontalLine(h,f+g+S,p+1,M)}for(let S=1;S<Math.min(h,m.length);S++){const M=m[S];u.fillVerticalLine(h-S,f,g+1,M)}for(let S=1;S<Math.min(v,m.length);S++){const M=m[S];u.fillVerticalLine(h+p+S,f,g+1,M)}for(let S=1;S<h;S++){const M=x[S-1],C=h-S;for(let T=1;T<f;T++)u.set(C,f-T,M[T-1]);for(let T=1;T<v;T++)u.set(C,f+g+T,M[T-1])}for(let S=1;S<d;S++){const M=x[S-1],C=h+p+S;for(let T=1;T<f;T++)u.set(C,f-T,M[T-1]);for(let T=1;T<v;T++)u.set(C,f+g+T,M[T-1])}return u}function q7(a,n,r,s){return{x:a,y:n,width:r,height:s}}function K7(a,n,r){return{cx:a,cy:n,radius:r}}function Q7(a,n,r,s){return{x1:a,y1:n,x2:r,y2:s}}function De(a,n){return{x:a,y:n}}function NN(a,n,r,s){if(a.length===0)return[];const l=BN(a);return l.map((u,h)=>{const f=l.slice(0,h);return RN(n,u,f,r,s)}).flat()}function RN(a,n,r,s,l){const u=De(n.cx,n.cy),h=IN(u,r,a);if(h==null)return[];const f=new mn(u.x,u.y,h.cx,h.cy),d=LN(f,a,s,l);return DN(d,a)}function LN(a,n,r,s){const l=[],u=[];u.push(a);let h=!0;for(let f=0;f<r&&h;f++)for(h=!1;!h&&u.length>0;){const d=u.pop(),v=Db(n,d),p=v?kN(d,v):null;if(!v||!p||p.count!==2){h||l.push(d);continue}let g=s,y=vh(v,g,p,!0),m=Ea(y,u)||Ea(y,l),b=dh(y,n);for(;!m&&b&&g>=1;)g/=1.5,y=vh(v,g,p,!0),m=Ea(y,u)||Ea(y,l),b=dh(y,n);if(y&&!m&&!b&&(u.push(new mn(d.x1,d.y1,y.x,y.y)),u.push(new mn(y.x,y.y,d.x2,d.y2)),h=!0),h)continue;g=s,y=vh(v,g,p,!1);let x=Ea(y,u)||Ea(y,l);for(b=dh(y,n);!x&&b&&g>=1;)g/=1.5,y=vh(v,g,p,!1),x=Ea(y,u)||Ea(y,l),b=dh(y,n);y&&!x&&(u.push(new mn(d.x1,d.y1,y.x,y.y)),u.push(new mn(y.x,y.y,d.x2,d.y2)),h=!0),h||l.push(d)}for(;u.length>0;)l.push(u.pop());return l}function DN(a,n){const r=[];for(;a.length>0;){const s=a.pop();if(a.length===0){r.push(s);break}const l=a.pop(),u=new mn(s.x1,s.y1,l.x2,l.y2);Db(n,u)?(r.push(s),a.push(l)):a.push(u)}return r}function IN(a,n,r){let s=Number.POSITIVE_INFINITY;return n.reduce((l,u)=>{const h=xa(a.x,a.y,u.cx,u.cy);if(h>s)return l;const f=new mn(a.x,a.y,u.cx,u.cy),d=FN(r,f);return h*(d+1)*(d+1)<s&&(l=u,s=h*(d+1)*(d+1)),l},null)}function BN(a){if(a.length<2)return a;let n=0,r=0;return a.forEach(s=>{n+=s.cx,r+=s.cy}),n/=a.length,r/=a.length,a.map(s=>{const l=n-s.cx,u=r-s.cy,h=l*l+u*u;return[s,h]}).sort((s,l)=>s[1]-l[1]).map(s=>s[0])}function dh(a,n){return n.some(r=>r.containsPt(a.x,a.y))}function Ea(a,n){return n.some(r=>!!(kb(r.x1,r.y1,a.x,a.y,.001)||kb(r.x2,r.y2,a.x,a.y,.001)))}function Db(a,n){let r=Number.POSITIVE_INFINITY,s=null;for(const l of a){if(!Ab(l,n))continue;const u=ON(l,n);u>=0&&u<r&&(s=l,r=u)}return s}function FN(a,n){return a.reduce((r,s)=>Ab(s,n)&&CN(s,n)?r+1:r,0)}function vh(a,n,r,s){const l=r.top,u=r.left,h=r.bottom,f=r.right;if(s){if(u.state===Ue.POINT){if(l.state===Ue.POINT)return De(a.x-n,a.y-n);if(h.state===Ue.POINT)return De(a.x-n,a.y2+n);const y=a.width*a.height;return a.width*((u.y-a.y+(f.y-a.y))*.5)<y*.5?u.y>f.y?De(a.x-n,a.y-n):De(a.x2+n,a.y-n):u.y<f.y?De(a.x-n,a.y2+n):De(a.x2+n,a.y2+n)}if(f.state===Ue.POINT){if(l.state===Ue.POINT)return De(a.x2+n,a.y-n);if(h.state===Ue.POINT)return De(a.x2+n,a.y2+n)}const p=a.height*a.width;return a.height*((l.x-a.x+(f.x-a.x))*.5)<p*.5?l.x>h.x?De(a.x-n,a.y-n):De(a.x-n,a.y2+n):l.x<h.x?De(a.x2+n,a.y-n):De(a.x2+n,a.y2+n)}if(u.state===Ue.POINT){if(l.state===Ue.POINT)return De(a.x2+n,a.y2+n);if(h.state===Ue.POINT)return De(a.x2+n,a.y-n);const p=a.height*a.width;return a.width*((u.y-a.y+(f.y-a.y))*.5)<p*.5?u.y>f.y?De(a.x2+n,a.y2+n):De(a.x-n,a.y2+n):u.y<f.y?De(a.x2+n,a.y-n):De(a.x-n,a.y-n)}if(f.state===Ue.POINT){if(l.state===Ue.POINT)return De(a.x-n,a.y2+n);if(h.state===Ue.POINT)return De(a.x-n,a.y-n)}const d=a.height*a.width;return a.height*((l.x-a.x+(f.x-a.x))*.5)<d*.5?l.x>h.x?De(a.x2+n,a.y2+n):De(a.x2+n,a.y-n):l.x<h.x?De(a.x-n,a.y2+n):De(a.x-n,a.y-n)}function zN(a,n,r,s){if(!(a.closed?r<a.length:r<a.length-1))return!1;const u=a.get(n),h=a.get(r+1);for(let f=n+1;f<=r;f++){const d=a.get(f);if(Ov(u.x,u.y,h.x,h.y,d.x,d.y)>s)return!1}return!0}function ZN(a=0){return n=>{if(a<0||n.length<3)return n;const r=[];let s=0;const l=a*a;for(;s<n.length;){let u=s+1;for(;zN(n,s,u,l);)u++;r.push(n.get(s)),s=u}return new cs(r)}}function GN(a,n){switch(a){case-2:return(((-n+3)*n-3)*n+1)/6;case-1:return((3*n-6)*n*n+4)/6;case 0:return(((-3*n+3)*n+3)*n+1)/6;case 1:return n*n*n/6;default:throw new Error("unknown error")}}function WN(a=6){function u(h,f,d){let v=0,p=0;for(let g=-2;g<=1;g++){const y=h.get(f+g),m=GN(g,d);v+=m*y.x,p+=m*y.y}return{x:v,y:p}}return h=>{if(h.length<3)return h;const f=[],d=h.closed,v=h.length+3-1+(d?0:2);f.push(u(h,2-(d?0:2),0));for(let p=2-(d?0:2);p<v;p++)for(let g=1;g<=a;g++)f.push(u(h,p,g/a));return new cs(f)}}function jN(a=8){return n=>{let r=a,s=n.length;if(r>1)for(s=Math.floor(n.length/r);s<3&&r>1;)r-=1,s=Math.floor(n.length/r);const l=[];for(let u=0,h=0;h<s;h++,u+=r)l.push(n.get(u));return new cs(l)}}class cs{constructor(n=[],r=!0){this.points=n,this.closed=r}get(n){const r=n,s=this.points.length;return n<0?this.closed?this.get(n+s):this.points[0]:n>=s?this.closed?this.get(n-s):this.points[s-1]:this.points[r]}get length(){return this.points.length}toString(n=1/0){const r=this.points;if(r.length===0)return"";const s=typeof n=="function"?n:TN(n);let l="M";for(const u of r)l+=`${s(u.x)},${s(u.y)} L`;return l=l.slice(0,-1),this.closed&&(l+=" Z"),l}draw(n){const r=this.points;if(r.length!==0){n.beginPath(),n.moveTo(r[0].x,r[0].y);for(const s of r)n.lineTo(s.x,s.y);this.closed&&n.closePath()}}sample(n){return jN(n)(this)}simplify(n){return ZN(n)(this)}bSplines(n){return WN(n)(this)}apply(n){return n(this)}containsElements(n){const r=_N(this.points);return r?n.every(s=>r.containsPt(s.cx,s.cy)&&this.withinArea(s.cx,s.cy)):!1}withinArea(n,r){if(this.length===0)return!1;let s=0;const l=this.points[0],u=new mn(l.x,l.y,l.x,l.y);for(let h=1;h<this.points.length;h++){const f=this.points[h];u.x1=u.x2,u.y1=u.y2,u.x2=f.x,u.y2=f.y,u.cuts(n,r)&&s++}return u.x1=u.x2,u.y1=u.y2,u.x2=l.x,u.y2=l.y,u.cuts(n,r)&&s++,s%2===1}}class VN{constructor(n=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=n}add(n){this.set.add(`${n.x}x${n.y}`),this.arr[this.count++]=n}contains(n){return this.set.has(`${n.x}x${n.y}`)}isFirst(n){if(this.count===0)return!1;const r=this.arr[0];return r!=null&&r.x===n.x&&r.y===n.y}path(){return new cs(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(n){return this.arr[n]}get length(){return this.count}}const Nl=0,ph=1,gh=2,_v=3;function HN(a,n){const r=(Math.floor(a.width)+Math.floor(a.height))*2,s=new VN(r);function l(d,v,p,g){const y=a.get(d,v);return Number.isNaN(y)?Number.NaN:y>n?p+g:p}function u(d,v){let p=Nl;return p=l(d,v,p,1),p=l(d+1,v,p,2),p=l(d,v+1,p,4),p=l(d+1,v+1,p,8),Number.isNaN(p)?-1:p}let h=ph;function f(d,v){let p=d,g=v,y=a.invertScaleX(p),m=a.invertScaleY(g);for(let b=0;b<a.width*a.height;b++){const x={x:y,y:m};if(s.contains(x)){if(s.isFirst(x))return!0}else s.add(x);const E=u(p,g);switch(E){case-1:return!0;case 0:case 3:case 2:case 7:h=gh;break;case 12:case 14:case 4:h=_v;break;case 6:h=h===Nl?_v:gh;break;case 1:case 13:case 5:h=Nl;break;case 9:h=h===gh?Nl:ph;break;case 10:case 8:case 11:h=ph;break;default:return console.warn("Marching squares invalid state: "+E),!0}switch(h){case Nl:g--,m-=a.pixelGroup;break;case ph:g++,m+=a.pixelGroup;break;case _v:p--,y-=a.pixelGroup;break;case gh:p++,y+=a.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+E),!0}}return!0}for(let d=0;d<a.width;d++)for(let v=0;v<a.height;v++){if(a.get(d,v)<=n)continue;const p=u(d,v);if(!(p<0||p===15)&&f(d,v))return s.path()}return null}const yh={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function Rl(a){return a!=null&&typeof a.radius=="number"}function Ib(a,n){if(Rl(a)!==Rl(n))return!1;if(Rl(a)){const s=n;return a.cx===s.cx&&a.cy===s.cy&&a.radius===s.radius}const r=n;return a.x===r.x&&a.y===r.y&&a.width===r.width&&a.height===r.height}var Qr;(function(a){a[a.MEMBERS=0]="MEMBERS",a[a.NON_MEMBERS=1]="NON_MEMBERS",a[a.EDGES=2]="EDGES"})(Qr||(Qr={}));class Pv{constructor(n={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new Ln(0,0,0,0),this.potentialArea=new ls(1,0,0,0,0,0,0),this.o=Object.assign({},yh,n)}pushMember(...n){if(n.length!==0){this.dirty.add(Qr.MEMBERS);for(const r of n)this.members.push({raw:r,obj:Rl(r)?fh.from(r):Ln.from(r),area:null})}}removeMember(n){const r=this.members.findIndex(s=>Ib(s.raw,n));return r<0?!1:(this.members.splice(r,1),this.dirty.add(Qr.MEMBERS),!0)}removeNonMember(n){const r=this.nonMembers.findIndex(s=>Ib(s.raw,n));return r<0?!1:(this.nonMembers.splice(r,1),this.dirty.add(Qr.NON_MEMBERS),!0)}removeEdge(n){const r=this.edges.findIndex(s=>s.obj.equals(n));return r<0?!1:(this.edges.splice(r,1),this.dirty.add(Qr.NON_MEMBERS),!0)}pushNonMember(...n){if(n.length!==0){this.dirty.add(Qr.NON_MEMBERS);for(const r of n)this.nonMembers.push({raw:r,obj:Rl(r)?fh.from(r):Ln.from(r),area:null})}}pushEdge(...n){if(n.length!==0){this.dirty.add(Qr.EDGES);for(const r of n)this.edges.push({raw:r,obj:mn.from(r),area:null})}}update(){const n=this.dirty.has(Qr.MEMBERS),r=this.dirty.has(Qr.NON_MEMBERS);let s=this.dirty.has(Qr.EDGES);this.dirty.clear();const l=this.members.map(v=>v.obj);if(this.o.virtualEdges&&(n||r)){const v=this.nonMembers.map(y=>y.obj),p=NN(l,v,this.o.maxRoutingIterations,this.o.morphBuffer),g=new Map(this.virtualEdges.map(y=>[y.obj.toString(),y.area]));this.virtualEdges=p.map(y=>{var m;return{raw:y,obj:y,area:(m=g.get(y.toString()))!==null&&m!==void 0?m:null}}),s=!0}let u=!1;if(n||s){const v=this.virtualEdges.concat(this.edges).map(m=>m.obj),p=UN(l,v),g=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,y=Ln.from(Nb(p,g));y.equals(this.activeRegion)||(u=!0,this.activeRegion=y)}if(u){const v=Math.ceil(this.activeRegion.width/this.o.pixelGroup),p=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=ls.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(g=>g.area=null),this.nonMembers.forEach(g=>g.area=null),this.edges.forEach(g=>g.area=null),this.virtualEdges.forEach(g=>g.area=null)):(v!==this.potentialArea.width||p!==this.potentialArea.height)&&(this.potentialArea=ls.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}const h=new Map,f=v=>{if(v.area){const p=`${v.obj.width}x${v.obj.height}x${v.obj instanceof Ln?"R":"C"}`;h.set(p,v.area)}},d=v=>{if(v.area)return;const p=`${v.obj.width}x${v.obj.height}x${v.obj instanceof Ln?"R":"C"}`;if(h.has(p)){const y=h.get(p);v.area=this.potentialArea.copy(y,{x:v.obj.x-this.o.nodeR1,y:v.obj.y-this.o.nodeR1});return}const g=v.obj instanceof Ln?AN(v.obj,this.potentialArea,this.o.nodeR1):Lb(v.obj,this.potentialArea,this.o.nodeR1);v.area=g,h.set(p,g)};this.members.forEach(f),this.nonMembers.forEach(f),this.members.forEach(d),this.nonMembers.forEach(v=>{this.activeRegion.intersects(v.obj)?d(v):v.area=null}),this.edges.forEach(v=>{v.area||(v.area=Rb(v.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(v=>{v.area||(v.area=Rb(v.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(n){for(const r of this.members)r.obj.draw(n)}drawNonMembers(n){for(const r of this.nonMembers)r.obj.draw(n)}drawEdges(n){for(const r of this.edges)r.obj.draw(n)}drawPotentialArea(n,r=!0){this.potentialArea.draw(n,r)}compute(){if(this.members.length===0)return new cs([]);this.dirty.size>0&&this.update();const{o:n,potentialArea:r}=this,s=this.members.map(f=>f.area),l=this.virtualEdges.concat(this.edges).map(f=>f.area),u=this.nonMembers.filter(f=>f.area!=null).map(f=>f.area),h=this.members.map(f=>f.obj);return $N(r,s,l,u,f=>f.containsElements(h),n)}}function $N(a,n,r,s,l,u={}){const h=Object.assign({},yh,u);let f=h.threshold,d=h.memberInfluenceFactor,v=h.edgeInfluenceFactor,p=h.nonMemberInfluenceFactor;const g=(h.nodeR0-h.nodeR1)*(h.nodeR0-h.nodeR1),y=(h.edgeR0-h.edgeR1)*(h.edgeR0-h.edgeR1);for(let m=0;m<h.maxMarchingIterations;m++){if(a.clear(),d!==0){const x=d/g;for(const E of n)a.incArea(E,x)}if(v!==0){const x=v/y;for(const E of r)a.incArea(E,x)}if(p!==0){const x=p/g;for(const E of s)a.incArea(E,x)}const b=HN(a,f);if(b&&l(b))return b;if(f*=.95,m<=h.maxMarchingIterations*.5)d*=1.2,v*=1.2;else if(p!==0&&s.length>0)p*=.8;else break}return new cs([])}function UN(a,n){if(a.length===0)return new Ln(0,0,0,0);const r=Ln.from(a[0]);for(const s of a)r.add(s);for(const s of n)r.add(_b(s));return r}function J7(a,n=[],r=[],s={}){if(a.length===0)return new cs([]);const l=new Pv(s);return l.pushMember(...a),l.pushNonMember(...n),l.pushEdge(...r),l.compute()}var YN=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class Ll extends ln{constructor(n,r){super(n,(0,jn.Z)({},Ll.defaultOptions,r)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{const{style:s,bubbleSetOptions:l}=this.parseOptions();Je(this.bubbleSetOptions,l)||this.init(),this.bubbleSetOptions=Object.assign({},l);const u=Object.assign(Object.assign({},s),{d:this.getPath()});this.shape?this.shape.update(u):(this.shape=new rl({style:u}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=s=>{if(!this.shape)return;const l=V(s.data);[...this.options.members,...this.options.avoidMembers].includes(l)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(l)}))},this.getPath=s=>{const{graph:l}=this.context,u=this.options.members,h=[...this.members.keys()],f=this.options.avoidMembers,d=[...this.avoidMembers.keys()];if(!s&&Je(u,h)&&Je(f,d))return this.path;const{enter:v=[],exit:p=[]}=ha(h,u,E=>E),{enter:g=[],exit:y=[]}=ha(d,f,E=>E);s&&(p.push(s),v.push(s));const m=(E,w,S)=>{E.forEach(M=>{const C=S?this.members:this.avoidMembers,T=S?"pushMember":"pushNonMember",O=S?"removeMember":"removeNonMember";if(w){let k;l.getElementType(M)==="edge"?([k]=qN(l,M),this.bubbleSets.pushEdge(k)):([k]=XN(l,M),this.bubbleSets[T](k)),C.set(M,k)}else{const k=C.get(M);k&&(l.getElementType(M)==="edge"?this.bubbleSets.removeEdge(k):this.bubbleSets[O](k),C.delete(M))}})};m(p,!1,!0),m(v,!0,!0),m(y,!1,!1),m(g,!0,!1);const x=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=b1(x.points.map(Mn)),this.path},this.bindEvents(),this.bubbleSets=new Pv(this.options)}bindEvents(){this.context.graph.on(lt.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(lt.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new Pv(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){const n=this.options,{type:r,key:s,members:l,avoidMembers:u}=n,h=YN(n,["type","key","members","avoidMembers"]),f=Object.keys(h).reduce((d,v)=>(v in yh?d.bubbleSetOptions[v]=h[v]:d.style[v]=h[v],d),{style:{},bubbleSetOptions:{}});return Object.assign({type:r,key:s,members:l,avoidMembers:u},f)}addMember(n){const r=Array.isArray(n)?n:[n];r.some(s=>this.options.avoidMembers.includes(s))&&(this.options.avoidMembers=this.options.avoidMembers.filter(s=>!r.includes(s))),this.options.members=[...new Set([...this.options.members,...r])],this.drawBubbleSets()}removeMember(n){const r=Array.isArray(n)?n:[n];this.options.members=this.options.members.filter(s=>!r.includes(s)),this.drawBubbleSets()}updateMember(n){this.options.members=(0,_t.Z)(n)?n(this.options.members):n,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(n){const r=Array.isArray(n)?n:[n];r.some(s=>this.options.members.includes(s))&&(this.options.members=this.options.members.filter(s=>!r.includes(s))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...r])],this.drawBubbleSets()}removeAvoidMember(n){const r=Array.isArray(n)?n:[n];this.options.avoidMembers.some(s=>r.includes(s))&&(this.options.avoidMembers=this.options.avoidMembers.filter(s=>!r.includes(s)),this.drawBubbleSets())}updateAvoidMember(n){this.options.avoidMembers=Array.isArray(n)?n:[n],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(lt.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(lt.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}}Ll.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},yh);const XN=(a,n)=>(Array.isArray(n)?n:[n]).map(s=>{const l=a.getElementRenderBounds(s);return new Ln(l.min[0],l.min[1],xi(l),Ei(l))}),qN=(a,n)=>(Array.isArray(n)?n:[n]).map(s=>{const l=a.getEdgeData(s),u=a.getElementPosition(l.source),h=a.getElementPosition(l.target);return mn.from({x1:u[0],y1:u[1],x2:h[0],y2:h[1]})});class KN extends ln{constructor(n,r){super(n,r),this.setOptions=s=>{const l={cameraType:"setType",near:"setNear",far:"setFar",fov:"setFov",aspect:"setAspect",projectionMode:"setProjectionMode",distance:"setDistance",minDistance:"setMinDistance",maxDistance:"setMaxDistance",roll:"setRoll",elevation:"setElevation",azimuth:"setAzimuth"},u=(h,f)=>{switch(h){case"projectionMode":return f==="perspective"?1:0;case"cameraType":return{orbiting:0,exploring:1,tracking:2}[f];case"aspect":return typeof f=="number"?f:this.getCanvasAspect();default:return f}};Object.entries(l).forEach(([h,f])=>{const d=s[h];if(d!==void 0){const v=u(h,d);this.context.canvas.getCamera()[f](v)}})},this.bindEvents()}update(n){this.setOptions(n),super.update(n)}bindEvents(){this.context.graph.once(lt.BEFORE_DRAW,()=>this.setOptions(this.options))}getCanvasAspect(){const[n,r]=this.context.viewport.getCanvasSize();return n/r}}function QN(a){return`
    <ul class="g6-contextmenu-ul">
      ${a.map(n=>`<li  class="g6-contextmenu-li" value="${n.value}">${n.name}</li>`).join("")}
    </ul>
  `}const JN=`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`;var Bb=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class Dl extends ln{constructor(n,r){super(n,Object.assign({},Dl.defaultOptions,r)),this.targetElement=null,this.onTriggerEvent=s=>{var l;(l=s.preventDefault)===null||l===void 0||l.call(s),this.show(s)},this.onMenuItemClick=s=>{const{onClick:l,trigger:u}=this.options;if(s.target instanceof HTMLElement&&s.target.className.includes("g6-contextmenu-li")){const h=s.target.getAttribute("value");l==null||l(h,s.target,this.targetElement),this.hide()}u!=="click"&&this.hide()},this.initElement(),this.update(r)}initElement(){this.$element=Us("contextmenu",!1,{zIndex:"99"});const{className:n}=this.options;n&&this.$element.classList.add(n),this.context.canvas.getContainer().appendChild(this.$element),Cv("g6-contextmenu-css","style",{},JN,document.head)}show(n){return Bb(this,void 0,void 0,function*(){const{enable:r,offset:s}=this.options;if(typeof r=="function"&&!r(n)||!r){this.hide();return}const l=yield this.getDOMContent(n);l instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(l)):this.$element.innerHTML=l;const u=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${n.client.x-u.left+s[0]}px`,this.$element.style.top=`${n.client.y-u.top+s[1]}px`,this.$element.style.display="block",this.targetElement=n.target})}hide(){this.$element.style.display="none",this.targetElement=null}update(n){this.unbindEvents(),super.update(n),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(n){return Bb(this,void 0,void 0,function*(){const{getContent:r,getItems:s}=this.options;return s?QN(yield s(n)):yield r(n)})}bindEvents(){const{graph:n}=this.context,{trigger:r}=this.options;n.on(`canvas:${r}`,this.onTriggerEvent),n.on(`node:${r}`,this.onTriggerEvent),n.on(`edge:${r}`,this.onTriggerEvent),n.on(`combo:${r}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:n}=this.context,{trigger:r}=this.options;n.off(`canvas:${r}`,this.onTriggerEvent),n.off(`node:${r}`,this.onTriggerEvent),n.off(`edge:${r}`,this.onTriggerEvent),n.off(`combo:${r}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}}Dl.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};class Il extends ln{constructor(n,r){super(n,Object.assign({},Il.defaultOptions,r)),this.edgeBundles={},this.edgePoints={},this.onBundle=()=>{const{model:s,element:l}=this.context,u=s.getEdgeData();this.divideEdges(this.options.divisions);const{cycles:h,iterRate:f,divRate:d}=this.options;let{lambda:v,divisions:p,iterations:g}=this.options;for(let y=0;y<h;y++){for(let m=0;m<g;m++){const b={};u.forEach(x=>{var E;if(x.source===x.target)return;const w=V(x);b[w]=this.getEdgeForces(x,p,v);for(let S=0;S<p+1;S++)(E=this.edgePoints)[w]||(E[w]=[]),this.edgePoints[w][S]=Gt(this.edgePoints[w][S],b[w][S])})}v/=2,p*=d,g*=f,this.divideEdges(p)}u.forEach(y=>{const m=V(y),b=l.getElement(m);b==null||b.update({d:dv(this.edgePoints[m])})})},this.bindEvents()}get nodeMap(){const n=this.context.model.getNodeData();return Object.fromEntries(n.map(r=>[V(r),Ja(Fe(r))]))}divideEdges(n){this.context.model.getEdgeData().forEach(s=>{var l;const u=V(s);(l=this.edgePoints)[u]||(l[u]=[]);const h=this.nodeMap[s.source],f=this.nodeMap[s.target];if(n===1)this.edgePoints[u].push(h),this.edgePoints[u].push(Xr(Gt(h,f),2)),this.edgePoints[u].push(f);else{const v=(this.edgePoints[u].length===0?Ae(h,f):iR(this.edgePoints[u]))/(n+1);let p=v;const g=[h];for(let y=1;y<this.edgePoints[u].length;y++){const m=this.edgePoints[u][y-1],b=this.edgePoints[u][y];let x=Ae(b,m);for(;x>p;){const E=p/x,w=Gt(m,Yr(Te(b,m),E));g.push(w),x-=p,p=v}p-=x}g.push(f),this.edgePoints[u]=g}})}getVectorPosition(n){const r=this.nodeMap[n.source],s=this.nodeMap[n.target],[l,u]=Te(s,r),h=Ae(r,s);return{source:r,target:s,vx:l,vy:u,length:h}}measureEdgeCompatibility(n,r){const s=this.getVectorPosition(n),l=this.getVectorPosition(r),u=tR(s,l),h=eR(s,l),f=nR(s,l),d=rR(s,l);return u*h*f*d}getEdgeBundles(){const n={},r=this.options.bundleThreshold,s=this.context.model.getEdgeData();return s.forEach((l,u)=>{s.forEach((h,f)=>{var d,v;if(f<=u)return;this.measureEdgeCompatibility(l,h)>=r&&(n[d=V(l)]||(n[d]=[]),n[V(l)].push(h),n[v=V(h)]||(n[v]=[]),n[V(h)].push(l))})}),n}getSpringForce(n,r){const{pre:s,cur:l,next:u}=n;return Yr(Te(Gt(s,u),Yr(l,2)),r)}getElectrostaticForce(n,r){Si(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());const s=this.edgeBundles[V(r)];let l=[0,0];return s==null||s.forEach(u=>{const h=this.edgePoints[V(u)][n],f=this.edgePoints[V(r)][n],d=Te(h,f),v=Ae(h,f);l=Gt(l,Yr(d,1/v))}),l}getEdgeForces(n,r,s){const l=this.nodeMap[n.source],u=this.nodeMap[n.target],h=this.options.K/(Ae(l,u)*(r+1)),f=[[0,0]],d=V(n);for(let v=1;v<r;v++){const p=this.getSpringForce({pre:this.edgePoints[d][v-1],cur:this.edgePoints[d][v],next:this.edgePoints[d][v+1]||[0,0]},h),g=this.getElectrostaticForce(v,n);f.push(Yr(Gt(p,g),s))}return f.push([0,0]),f}bindEvents(){const{graph:n}=this.context;n.on(lt.AFTER_RENDER,this.onBundle)}unbindEvents(){const{graph:n}=this.context;n.off(lt.AFTER_RENDER,this.onBundle)}destroy(){this.unbindEvents(),super.destroy()}}Il.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};const tR=(a,n)=>Math.abs(RP([a.vx,a.vy],[n.vx,n.vy])/(a.length*n.length)),eR=(a,n)=>{const r=(a.length+n.length)/2;return 2/(r/Math.min(a.length,n.length)+Math.max(a.length,n.length)/r)},nR=(a,n)=>{const r=(a.length+n.length)/2,s=Xr(Gt(a.source,a.target),2),l=Xr(Gt(n.source,n.target),2);return r/(r+Ae(s,l))},Fb=(a,n)=>{if(n.source[0]===n.target[0])return[n.source[0],a[1]];if(n.source[1]===n.target[1])return[a[0],n.source[1]];const r=(n.source[1]-n.target[1])/(n.source[0]-n.target[0]),s=(r*r*n.source[0]+r*(a[1]-n.source[1])+a[0])/(r*r+1),l=r*(s-n.source[0])+n.source[1];return[s,l]},zb=(a,n)=>{const r=Fb(n.source,a),s=Fb(n.target,a),l=Xr(Gt(r,s),2),u=Xr(Gt(a.source,a.target),2);return Ae(r,s)===0?0:Math.max(0,1-2*Ae(u,l)/Ae(r,s))},rR=(a,n)=>Math.min(zb(a,n),zb(n,a)),iR=a=>{let n=0;for(let r=1;r<a.length;r++)n+=Ae(a[r],a[r-1]);return n},aR={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8,zIndex:-1/0},Zb=.05;class Bl extends ln{constructor(n,r){super(n,Object.assign({},Bl.defaultOptions,r)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=s=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const l=Mn(s.canvas);this.renderLens(l),this.renderFocusElements()},this.renderLens=s=>{const l=Object.assign({},aR,this.options.style);this.isLensOn||(this.lens=new pa({style:l}),this.canvas.appendChild(this.lens)),Object.assign(l,qr(s),{size:this.r*2}),this.lens.update(l)},this.getFilterData=()=>{const{filter:s}=this.options,{model:l}=this.context,u=l.getData();if(!s)return u;const{nodes:h,edges:f,combos:d}=u;return{nodes:h.filter(v=>s(V(v),"node")),edges:f.filter(v=>s(V(v),"edge")),combos:d.filter(v=>s(V(v),"combo"))}},this.getFocusElements=s=>{const{nodes:l,edges:u}=this.getFilterData(),h=l.filter(v=>Ae(Fe(v),s)<this.r),f=h.map(v=>V(v)),d=u.filter(v=>{const{source:p,target:g}=v,y=f.includes(p),m=f.includes(g);switch(this.options.nodeType){case"both":return y&&m;case"either":return y!==m;case"source":return y&&!m;case"target":return!y&&m;default:return!1}});return{nodes:h,edges:d}},this.renderFocusElements=()=>{const{element:s,graph:l}=this.context;if(!this.isLensOn)return;const u=this.lens.getCenter(),{nodes:h,edges:f}=this.getFocusElements(u),d=new Set,v=p=>{const g=V(p);d.add(g);const y=s.getElement(g);if(!y)return;const m=this.shapes.get(g)||y.cloneNode();m.setPosition(y.getPosition()),m.id=y.id,this.shapes.has(g)?Object.entries(y.attributes).forEach(([E,w])=>{m.style[E]!==w&&(m.style[E]=w)}):(this.canvas.appendChild(m),this.shapes.set(g,m));const b=l.getElementType(g),x=this.getElementStyle(b,p);m.update(x)};h.forEach(v),f.forEach(v),this.shapes.forEach((p,g)=>{d.has(g)||(p.destroy(),this.shapes.delete(g))})},this.scaleRByWheel=s=>{var l;this.options.preventDefault&&s.preventDefault();const{clientX:u,clientY:h,deltaX:f,deltaY:d}=s,{graph:v,canvas:p}=this.context,g=v.getCanvasByClient([u,h]),y=(l=this.lens)===null||l===void 0?void 0:l.getCenter();if(!this.isLensOn||Ae(g,y)>this.r)return;const{maxR:m,minR:b}=this.options,x=f+d>0?1/(1-Zb):1-Zb,E=Math.min(...p.getSize())/2;this.r=Math.max(b||0,Math.min(m||E,this.r*x)),this.renderLens(y),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=s=>{var l;const u=Mn(s.canvas),h=(l=this.lens)===null||l===void 0?void 0:l.getCenter();!this.isLensOn||Ae(u,h)>this.r||(this.isLensDragging=!0)},this.onDrag=s=>{if(!this.isLensDragging)return;const l=Mn(s.canvas);this.renderLens(l),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(n,r){const s=n==="node"?this.options.nodeStyle:this.options.edgeStyle;return typeof s=="function"?s(r):s}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var n;const{graph:r}=this.context,{trigger:s,scaleRBy:l}=this.options,u=r.getCanvas().getLayer();["click","drag"].includes(s)&&u.addEventListener(tt.CLICK,this.onEdgeFilter),s==="pointermove"?u.addEventListener(tt.POINTER_MOVE,this.onEdgeFilter):s==="drag"&&(u.addEventListener(tt.DRAG_START,this.onDragStart),u.addEventListener(tt.DRAG,this.onDrag),u.addEventListener(tt.DRAG_END,this.onDragEnd)),l==="wheel"&&((n=this.graphDom)===null||n===void 0||n.addEventListener(tt.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var n;const{graph:r}=this.context,{trigger:s,scaleRBy:l}=this.options,u=r.getCanvas().getLayer();["click","drag"].includes(s)&&u.removeEventListener(tt.CLICK,this.onEdgeFilter),s==="pointermove"?u.removeEventListener(tt.POINTER_MOVE,this.onEdgeFilter):s==="drag"&&(u.removeEventListener(tt.DRAG_START,this.onDragStart),u.removeEventListener(tt.DRAG,this.onDrag),u.removeEventListener(tt.DRAG_END,this.onDragEnd)),l==="wheel"&&((n=this.graphDom)===null||n===void 0||n.removeEventListener(tt.WHEEL,this.scaleRByWheel))}update(n){var r;this.unbindEvents(),super.update(n),this.r=(r=n.r)!==null&&r!==void 0?r:this.r,this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((n,r)=>{n.destroy(),this.shapes.delete(r)}),super.destroy()}}Bl.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};const sR={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12},Gb=.05,Wb=.1;class Fl extends ln{constructor(n,r){super(n,Object.assign({},Fl.defaultOptions,r)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=s=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const l=Mn(s.canvas);this.onMagnify(l)},this.onMagnify=s=>{s.some(isNaN)||(this.renderLens(s),this.renderFocusElements())},this.renderLens=s=>{const l=Object.assign({},sR,this.options.style);this.isLensOn||(this.lens=new pa({style:l}),this.canvas.appendChild(this.lens)),Object.assign(l,qr(s),{size:this.r*2,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(l)},this.getDPercent=()=>{const{minD:s,maxD:l}=this.options;return`${Math.round((this.d-s)/(l-s)*100)}%`},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;const{graph:s}=this.context,l=this.lens.getCenter(),u=(this.d+1)*this.r,h=new Map,f=new Map;s.getNodeData().forEach(v=>{const p=Fe(v),g=Ae(p,l);if(g>this.r)return;const y=u*g/(this.d*g+this.r),[m,b]=p,[x,E]=l,w=(m-x)/g,S=(b-E)/g,M=[x+y*w,E+y*S],C=V(v),T=this.getNodeStyle(v),O=(0,ol.Z)(s.getElementRenderStyle(C),Object.keys(T));h.set(C,Object.assign(Object.assign({},qr(M)),T)),f.set(C,Object.assign(Object.assign({},qr(p)),O))}),this.updateStyle(h,f)},this.getNodeStyle=s=>{const{nodeStyle:l}=this.options;return typeof l=="function"?l(s):l},this.updateStyle=(s,l)=>{const{graph:u,element:h}=this.context,{enter:f,exit:d,keep:v}=ha(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(s.keys()),y=>y),p=new Set,g=(y,m)=>{const b=h.getElement(y);b==null||b.update(m),u.getRelatedEdgesData(y).forEach(x=>{p.add(V(x))})};[...f,...v].forEach(y=>{g(y,s.get(y))}),d.forEach(y=>{g(y,this.prevOriginStyleMap.get(y)),this.prevOriginStyleMap.delete(y)}),p.forEach(y=>{const m=h.getElement(y);m==null||m.update({})}),this.prevMagnifiedStyleMap=s,l.forEach((y,m)=>{this.prevOriginStyleMap.has(m)||this.prevOriginStyleMap.set(m,y)})},this.isWheelValid=s=>{if(this.options.preventDefault&&s.preventDefault(),!this.isLensOn)return!1;const{clientX:l,clientY:u}=s,h=this.context.graph.getCanvasByClient([l,u]),f=this.lens.getCenter();return!(Ae(h,f)>this.r)},this.scaleR=s=>{const{maxR:l,minR:u}=this.options,h=s?1/(1-Gb):1-Gb,f=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(u||0,Math.min(l||f,this.r*h))},this.scaleD=s=>{const{maxD:l,minD:u}=this.options,h=s?this.d+Wb:this.d-Wb;this.d=Math.max(u,Math.min(l,h))},this.scaleRByWheel=s=>{if(!this.isWheelValid(s))return;const{deltaX:l,deltaY:u}=s;this.scaleR(l+u>0);const h=this.lens.getCenter();this.onMagnify(h)},this.scaleDByWheel=s=>{if(!this.isWheelValid(s))return;const{deltaX:l,deltaY:u}=s;this.scaleD(l+u>0);const h=this.lens.getCenter();this.onMagnify(h)},this.isDragValid=s=>{if(this.options.preventDefault&&s.preventDefault(),!this.isLensOn)return!1;const l=Mn(s.canvas),u=this.lens.getCenter();return!(Ae(l,u)>this.r)},this.isLensDragging=!1,this.onDragStart=s=>{this.isDragValid(s)&&(this.isLensDragging=!0)},this.onDrag=s=>{if(!this.isLensDragging)return;const l=Mn(s.canvas);this.onMagnify(l)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=s=>{if(!this.isLensDragging)return;const{dx:l,dy:u}=s;this.scaleR(l-u>0);const h=this.lens.getCenter();this.onMagnify(h)},this.scaleDByDrag=s=>{if(!this.isLensDragging)return;const{dx:l,dy:u}=s;this.scaleD(l-u>0);const h=this.lens.getCenter();this.onMagnify(h)},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var n;const{graph:r}=this.context,{trigger:s,scaleRBy:l,scaleDBy:u}=this.options,h=r.getCanvas().getLayer();if(["click","drag"].includes(s)&&h.addEventListener(tt.CLICK,this.onCreateFisheye),s==="pointermove"&&h.addEventListener(tt.POINTER_MOVE,this.onCreateFisheye),s==="drag"||l==="drag"||u==="drag"){h.addEventListener(tt.DRAG_START,this.onDragStart),h.addEventListener(tt.DRAG_END,this.onDragEnd);const f=s==="drag"?this.onDrag:l==="drag"?this.scaleRByDrag:this.scaleDByDrag;h.addEventListener(tt.DRAG,f)}if(l==="wheel"||u==="wheel"){const f=l==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(n=this.graphDom)===null||n===void 0||n.addEventListener(tt.WHEEL,f,{passive:!1})}}unbindEvents(){var n;const{graph:r}=this.context,{trigger:s,scaleRBy:l,scaleDBy:u}=this.options,h=r.getCanvas().getLayer();if(["click","drag"].includes(s)&&h.removeEventListener(tt.CLICK,this.onCreateFisheye),s==="pointermove"&&h.removeEventListener(tt.POINTER_MOVE,this.onCreateFisheye),s==="drag"||l==="drag"||u==="drag"){h.removeEventListener(tt.DRAG_START,this.onDragStart),h.removeEventListener(tt.DRAG_END,this.onDragEnd);const f=s==="drag"?this.onDrag:l==="drag"?this.scaleRByDrag:this.scaleDByDrag;h.removeEventListener(tt.DRAG,f)}if(l==="wheel"||u==="wheel"){const f=l==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(n=this.graphDom)===null||n===void 0||n.removeEventListener(tt.WHEEL,f)}}update(n){var r,s;this.unbindEvents(),super.update(n),this.r=(r=n.r)!==null&&r!==void 0?r:this.r,this.d=(s=n.d)!==null&&s!==void 0?s:this.d,this.bindEvents()}destroy(){var n;this.unbindEvents(),this.isLensOn&&((n=this.lens)===null||n===void 0||n.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}}Fl.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class zl extends ln{constructor(n,r){super(n,Object.assign({},zl.defaultOptions,r)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var s,l,u,h;const f=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(f),f?(l=(s=this.options).onEnter)===null||l===void 0||l.call(s):(h=(u=this.options).onExit)===null||h===void 0||h.call(u)},this.shortcut=new ts(n.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:n=[],exit:r=[]}=this.options.trigger;this.shortcut.bind(n,this.request),this.shortcut.bind(r,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(l=>{document.addEventListener(l,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(r=>{document.removeEventListener(r,this.onFullscreenChange,!1)})}setGraphSize(n=!0){var r,s;let l,u;n?(l=((r=globalThis.screen)===null||r===void 0?void 0:r.width)||0,u=((s=globalThis.screen)===null||s===void 0?void 0:s.height)||0,this.graphSize=this.context.graph.getSize()):[l,u]=this.graphSize,this.context.graph.setSize(l,u),this.context.graph.render()}request(){document.fullscreenElement||!oR()||this.$el.requestFullscreen().catch(n=>{ar.warn(`Error attempting to enable full-screen: ${n.message} (${n.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(n){this.unbindEvents(),super.update(n),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}}zl.defaultOptions={trigger:{},autoFit:!0};function oR(){return document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled")}class Zl extends ln{constructor(n,r){super(n,Object.assign({},Zl.defaultOptions,r)),this.$element=Us("grid-line",!0),this.offset=[0,0],this.currentScale=1,this.followZoom=l=>{const{data:{scale:u,origin:h}}=l;if(!u||h===void 0&&this.context.viewport===void 0)return;const f=this.currentScale;this.currentScale=u;const d=u/f,v=Yr(h||this.context.graph.getCanvasCenter(),1-d),p=this.baseSize*u,g=Yr(this.offset,d),y=Vd(g,p),m=Gt(y,v);this.$element.style.backgroundSize=`${p}px ${p}px`,this.$element.style.backgroundPosition=`${m[0]}px ${m[1]}px`,this.offset=Vd(m,p)},this.followTranslate=l=>{if(!this.options.follow)return;const{data:{translate:u}}=l;u&&this.updateOffset(u)},this.onTransform=l=>{const u=this.parseFollow(this.options.follow);u.zoom&&this.followZoom(l),u.translate&&this.followTranslate(l)},this.context.canvas.getContainer().prepend(this.$element),this.baseSize=this.options.size,this.updateStyle(),this.bindEvents()}update(n){super.update(n),n.size!==void 0&&(this.baseSize=n.size),this.updateStyle()}bindEvents(){const{graph:n}=this.context;n.on(lt.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{stroke:n,lineWidth:r,border:s,borderLineWidth:l,borderStroke:u,borderStyle:h}=this.options,f=this.baseSize*this.currentScale;Object.assign(this.$element.style,{border:s?`${l}px ${h} ${u}`:"none",backgroundImage:`linear-gradient(${n} ${r}px, transparent ${r}px), linear-gradient(90deg, ${n} ${r}px, transparent ${r}px)`,backgroundSize:`${f}px ${f}px`,backgroundRepeat:"repeat"})}updateOffset(n){const r=this.baseSize*this.currentScale;this.offset=Vd(Gt(this.offset,n),r),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}parseFollow(n){var r,s;return Co(n)?{translate:n,zoom:n}:{translate:(r=n==null?void 0:n.translate)!==null&&r!==void 0?r:!1,zoom:(s=n==null?void 0:n.zoom)!==null&&s!==void 0?s:!1}}destroy(){this.context.graph.off(lt.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}}Zl.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};var Av=Y(90494);function Nv(a){const n={Added:new Map,Updated:new Map,Removed:new Map};return a.forEach(r=>{const{type:s,value:l}=r,u=V(l);if(s==="NodeAdded"||s==="EdgeAdded"||s==="ComboAdded")n.Added.set(u,r);else if(s==="NodeUpdated"||s==="EdgeUpdated"||s==="ComboUpdated")if(n.Added.has(u))n.Added.set(u,{type:s.replace("Updated","Added"),value:l});else if(n.Updated.has(u)){const{original:h}=n.Updated.get(u);n.Updated.set(u,{type:s,value:l,original:h})}else n.Removed.has(u)||n.Updated.set(u,r);else(s==="NodeRemoved"||s==="EdgeRemoved"||s==="ComboRemoved")&&(n.Added.has(u)?n.Added.delete(u):(n.Updated.has(u)&&n.Updated.delete(u),n.Removed.set(u,r)))}),[...Array.from(n.Added.values()),...Array.from(n.Updated.values()),...Array.from(n.Removed.values())]}function jb(a){const{NodeAdded:n=[],NodeUpdated:r=[],NodeRemoved:s=[],EdgeAdded:l=[],EdgeUpdated:u=[],EdgeRemoved:h=[],ComboAdded:f=[],ComboUpdated:d=[],ComboRemoved:v=[]}=Cu(a,p=>p.type);return{add:{nodes:n,edges:l,combos:f},update:{nodes:r,edges:u,combos:d},remove:{nodes:s,edges:h,combos:v}}}function Vb(a,n){for(const r in a)(0,Zn.Z)(a[r])&&!Array.isArray(a[r])&&a[r]!==null?(n[r]||(n[r]={}),Vb(a[r],n[r])):n[r]===void 0&&(n[r]=$o(r))}function lR(a,n=!1,r){const s={animation:n,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:l,update:u,remove:h}=jb(Nv(a));return["nodes","edges","combos"].forEach(f=>{u[f]&&u[f].forEach(d=>{var v,p;const g=Object.assign({},d.value);let y=Object.assign({},d.original);if(r){const m=r.graph.getElementType(V(d.original)),b=m==="edge"?"stroke":"fill",x=r.element.getElementComputedStyle(m,d.original);y=Object.assign(Object.assign({},d.original),{style:Object.assign({[b]:x[b]},d.original.style)})}Vb(g,y),(v=s.current.update)[f]||(v[f]=[]),s.current.update[f].push(g),(p=s.original.update)[f]||(p[f]=[]),s.original.update[f].push(y)}),l[f]&&l[f].forEach(d=>{var v,p;const g=Object.assign({},d.value);(v=s.current.add)[f]||(v[f]=[]),s.current.add[f].push(g),(p=s.original.remove)[f]||(p[f]=[]),s.original.remove[f].push(g)}),h[f]&&h[f].forEach(d=>{var v,p;const g=Object.assign({},d.value);(v=s.current.remove)[f]||(v[f]=[]),s.current.remove[f].push(g),(p=s.original.add)[f]||(p[f]=[]),s.original.add[f].push(g)})}),s}class Gl extends ln{constructor(n,r){super(n,Object.assign({},Gl.defaultOptions,r)),this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=(l,u=!0)=>{var h,f,d;this.freezed=!0,(f=(h=this.options).executeCommand)===null||f===void 0||f.call(h,l);const v=u?l.original:l.current;this.context.graph.addData(v.add),this.context.graph.updateData(v.update),this.context.graph.removeData(Um(v.remove,!1)),(d=this.context.element)===null||d===void 0||d.draw({silence:!0,animation:l.animation}),this.freezed=!1},this.addCommand=l=>{var u;if(!this.freezed){if(l.type===lt.AFTER_DRAW){const{dataChanges:h=[],animation:f=!0}=l.data;if(!((u=this.context.batch)===null||u===void 0)&&u.isBatching){if(!this.batchChanges)return;this.batchChanges.push(h),this.batchAnimation&&(this.batchAnimation=f);return}this.batchChanges=[h],this.batchAnimation=f}this.undoStackPush(lR(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(Di.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=l=>{const{initiate:u}=l.data;this.batchAnimation=!1,u?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)},this.emitter=new Av.Z;const{graph:s}=this.context;s.on(lt.AFTER_DRAW,this.addCommand),s.on(lt.BATCH_START,this.initBatchCommand),s.on(lt.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var n,r,s,l;const u=this.undoStack.pop();if(u){if(this.executeCommand(u),((r=(n=this.options).beforeAddCommand)===null||r===void 0?void 0:r.call(n,u,!1))===!1)return;this.redoStack.push(u),(l=(s=this.options).afterAddCommand)===null||l===void 0||l.call(s,u,!1),this.notify(Di.UNDO,u)}return this}redo(){const n=this.redoStack.pop();return n&&(this.executeCommand(n,!1),this.undoStackPush(n),this.notify(Di.REDO,n)),this}undoAndCancel(){const n=this.undoStack.pop();return n&&(this.executeCommand(n,!1),this.redoStack=[],this.notify(Di.CANCEL,n)),this}undoStackPush(n){var r,s,l,u;const{stackSize:h}=this.options;h!==0&&this.undoStack.length>=h&&this.undoStack.shift(),((s=(r=this.options).beforeAddCommand)===null||s===void 0?void 0:s.call(r,n,!0))!==!1&&(this.undoStack.push(n),(u=(l=this.options).afterAddCommand)===null||u===void 0||u.call(l,n,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(Di.CLEAR,null)}notify(n,r){this.emitter.emit(n,{cmd:r}),this.emitter.emit(Di.CHANGE,{cmd:r})}on(n,r){this.emitter.on(n,r)}destroy(){const{graph:n}=this.context;n.off(lt.AFTER_DRAW,this.addCommand),n.off(lt.BATCH_START,this.initBatchCommand),n.off(lt.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}}Gl.defaultOptions={stackSize:0};const Rv={toXy(a,n){if(!n)return[...a];const r=n[0].slice(1),s=n[1].slice(1);return a.map(l=>[l[r],l[s]])},fromXy(a,n){if(!n)return[...a];const r=n[0].slice(1),s=n[1].slice(1);return a.map(([l,u])=>({[r]:l,[s]:u}))}};class cR{constructor(n,r){this._cells=[],this._cellSize=r,this._reverseCellSize=1/r;for(const s of n){const l=this.coordToCellNum(s[0]),u=this.coordToCellNum(s[1]);this._cells[l]||(this._cells[l]=[]),this._cells[l][u]||(this._cells[l][u]=[]),this._cells[l][u].push(s)}}cellPoints(n,r){var s;return((s=this._cells[n])===null||s===void 0?void 0:s[r])||[]}rangePoints(n){const r=this.coordToCellNum(n[0]),s=this.coordToCellNum(n[1]),l=this.coordToCellNum(n[2]),u=this.coordToCellNum(n[3]),h=[];for(let f=r;f<=l;f++)for(let d=s;d<=u;d++){const v=this.cellPoints(f,d);for(const p of v)h.push(p)}return h}removePoint(n){const r=this.coordToCellNum(n[0]),s=this.coordToCellNum(n[1]),l=this._cells[r][s],u=l.findIndex(([h,f])=>h===n[0]&&f===n[1]);return u>-1&&l.splice(u,1),l}trunc(n){return Math.trunc(n)}coordToCellNum(n){return this.trunc(n*this._reverseCellSize)}extendBbox(n,r){return[n[0]-r*this._cellSize,n[1]-r*this._cellSize,n[2]+r*this._cellSize,n[3]+r*this._cellSize]}}function uR(a,n){return new cR(a,n)}const Hb=+(Math.pow(2,27)+1);function mh(a,n,r){const s=a*n,l=Hb*a,u=l-a,h=l-u,f=a-h,d=Hb*n,v=d-n,p=d-v,g=n-p,b=s-h*p-f*p-h*g,x=f*g-b;return r?(r[0]=x,r[1]=s,r):[x,s]}function hR(a,n,r){const s=a+n,l=s-a,u=s-l,h=n-l,f=a-u;return r?(r[0]=f+h,r[1]=s,r):[f+h,s]}function fR(a,n){const r=a.length;if(r===1){const f=mh(a[0],n);return f[0]?f:[f[1]]}const s=new Array(2*r),l=[.1,.1],u=[.1,.1];let h=0;mh(a[0],n,l),l[0]&&(s[h++]=l[0]);for(let f=1;f<r;++f){mh(a[f],n,u);const d=l[1];hR(d,u[0],l),l[0]&&(s[h++]=l[0]);const v=u[1],p=l[1],g=v+p,y=g-v,m=p-y;l[1]=g,m&&(s[h++]=m)}return l[1]&&(s[h++]=l[1]),h===0&&(s[h++]=0),s.length=h,s}function dR(a,n){const r=a+n,s=r-a,l=r-s,u=n-s,f=a-l+u;return f?[f,r]:[r]}function vR(a,n){const r=a.length|0,s=n.length|0;if(r===1&&s===1)return dR(a[0],-n[0]);const l=r+s,u=new Array(l);let h=0,f=0,d=0;const v=Math.abs;let p=a[f],g=v(p),y=-n[d],m=v(y),b,x;g<m?(x=p,f+=1,f<r&&(p=a[f],g=v(p))):(x=y,d+=1,d<s&&(y=-n[d],m=v(y))),f<r&&g<m||d>=s?(b=p,f+=1,f<r&&(p=a[f],g=v(p))):(b=y,d+=1,d<s&&(y=-n[d],m=v(y)));let E=b+x,w=E-b,S=x-w,M=S,C=E,T,O,k,P,A;for(;f<r&&d<s;)g<m?(b=p,f+=1,f<r&&(p=a[f],g=v(p))):(b=y,d+=1,d<s&&(y=-n[d],m=v(y))),x=M,E=b+x,w=E-b,S=x-w,S&&(u[h++]=S),T=C+E,O=T-C,k=T-O,P=E-O,A=C-k,M=A+P,C=T;for(;f<r;)b=p,x=M,E=b+x,w=E-b,S=x-w,S&&(u[h++]=S),T=C+E,O=T-C,k=T-O,P=E-O,A=C-k,M=A+P,C=T,f+=1,f<r&&(p=a[f]);for(;d<s;)b=y,x=M,E=b+x,w=E-b,S=x-w,S&&(u[h++]=S),T=C+E,O=T-C,k=T-O,P=E-O,A=C-k,M=A+P,C=T,d+=1,d<s&&(y=-n[d]);return M&&(u[h++]=M),C&&(u[h++]=C),h||(u[h++]=0),u.length=h,u}function pR(a,n){const r=a+n,s=r-a,l=r-s,u=n-s,f=a-l+u;return f?[f,r]:[r]}function gR(a,n){const r=a.length|0,s=n.length|0;if(r===1&&s===1)return pR(a[0],n[0]);const l=r+s,u=new Array(l);let h=0,f=0,d=0;const v=Math.abs;let p=a[f],g=v(p),y=n[d],m=v(y),b,x;g<m?(x=p,f+=1,f<r&&(p=a[f],g=v(p))):(x=y,d+=1,d<s&&(y=n[d],m=v(y))),f<r&&g<m||d>=s?(b=p,f+=1,f<r&&(p=a[f],g=v(p))):(b=y,d+=1,d<s&&(y=n[d],m=v(y)));let E=b+x,w=E-b,S=x-w,M=S,C=E,T,O,k,P,A;for(;f<r&&d<s;)g<m?(b=p,f+=1,f<r&&(p=a[f],g=v(p))):(b=y,d+=1,d<s&&(y=n[d],m=v(y))),x=M,E=b+x,w=E-b,S=x-w,S&&(u[h++]=S),T=C+E,O=T-C,k=T-O,P=E-O,A=C-k,M=A+P,C=T;for(;f<r;)b=p,x=M,E=b+x,w=E-b,S=x-w,S&&(u[h++]=S),T=C+E,O=T-C,k=T-O,P=E-O,A=C-k,M=A+P,C=T,f+=1,f<r&&(p=a[f]);for(;d<s;)b=y,x=M,E=b+x,w=E-b,S=x-w,S&&(u[h++]=S),T=C+E,O=T-C,k=T-O,P=E-O,A=C-k,M=A+P,C=T,d+=1,d<s&&(y=n[d]);return M&&(u[h++]=M),C&&(u[h++]=C),h||(u[h++]=0),u.length=h,u}const $b=5,bh=11102230246251565e-32,yR=(3+16*bh)*bh,mR=(7+56*bh)*bh;function bR(a,n,r,s){return function(u,h,f){const d=a(a(n(h[1],f[0]),n(-f[1],h[0])),a(n(u[1],h[0]),n(-h[1],u[0]))),v=a(n(u[1],f[0]),n(-f[1],u[0])),p=s(d,v);return p[p.length-1]}}function xR(a,n,r,s){return function(u,h,f,d){const v=a(a(r(a(n(f[1],d[0]),n(-d[1],f[0])),h[2]),a(r(a(n(h[1],d[0]),n(-d[1],h[0])),-f[2]),r(a(n(h[1],f[0]),n(-f[1],h[0])),d[2]))),a(r(a(n(h[1],d[0]),n(-d[1],h[0])),u[2]),a(r(a(n(u[1],d[0]),n(-d[1],u[0])),-h[2]),r(a(n(u[1],h[0]),n(-h[1],u[0])),d[2])))),p=a(a(r(a(n(f[1],d[0]),n(-d[1],f[0])),u[2]),a(r(a(n(u[1],d[0]),n(-d[1],u[0])),-f[2]),r(a(n(u[1],f[0]),n(-f[1],u[0])),d[2]))),a(r(a(n(h[1],f[0]),n(-f[1],h[0])),u[2]),a(r(a(n(u[1],f[0]),n(-f[1],u[0])),-h[2]),r(a(n(u[1],h[0]),n(-h[1],u[0])),f[2])))),g=s(v,p);return g[g.length-1]}}function ER(a,n,r,s){return function(u,h,f,d,v){const p=a(a(a(r(a(r(a(n(d[1],v[0]),n(-v[1],d[0])),f[2]),a(r(a(n(f[1],v[0]),n(-v[1],f[0])),-d[2]),r(a(n(f[1],d[0]),n(-d[1],f[0])),v[2]))),h[3]),a(r(a(r(a(n(d[1],v[0]),n(-v[1],d[0])),h[2]),a(r(a(n(h[1],v[0]),n(-v[1],h[0])),-d[2]),r(a(n(h[1],d[0]),n(-d[1],h[0])),v[2]))),-f[3]),r(a(r(a(n(f[1],v[0]),n(-v[1],f[0])),h[2]),a(r(a(n(h[1],v[0]),n(-v[1],h[0])),-f[2]),r(a(n(h[1],f[0]),n(-f[1],h[0])),v[2]))),d[3]))),a(r(a(r(a(n(f[1],d[0]),n(-d[1],f[0])),h[2]),a(r(a(n(h[1],d[0]),n(-d[1],h[0])),-f[2]),r(a(n(h[1],f[0]),n(-f[1],h[0])),d[2]))),-v[3]),a(r(a(r(a(n(d[1],v[0]),n(-v[1],d[0])),h[2]),a(r(a(n(h[1],v[0]),n(-v[1],h[0])),-d[2]),r(a(n(h[1],d[0]),n(-d[1],h[0])),v[2]))),u[3]),r(a(r(a(n(d[1],v[0]),n(-v[1],d[0])),u[2]),a(r(a(n(u[1],v[0]),n(-v[1],u[0])),-d[2]),r(a(n(u[1],d[0]),n(-d[1],u[0])),v[2]))),-h[3])))),a(a(r(a(r(a(n(h[1],v[0]),n(-v[1],h[0])),u[2]),a(r(a(n(u[1],v[0]),n(-v[1],u[0])),-h[2]),r(a(n(u[1],h[0]),n(-h[1],u[0])),v[2]))),d[3]),a(r(a(r(a(n(h[1],d[0]),n(-d[1],h[0])),u[2]),a(r(a(n(u[1],d[0]),n(-d[1],u[0])),-h[2]),r(a(n(u[1],h[0]),n(-h[1],u[0])),d[2]))),-v[3]),r(a(r(a(n(f[1],d[0]),n(-d[1],f[0])),h[2]),a(r(a(n(h[1],d[0]),n(-d[1],h[0])),-f[2]),r(a(n(h[1],f[0]),n(-f[1],h[0])),d[2]))),u[3]))),a(r(a(r(a(n(f[1],d[0]),n(-d[1],f[0])),u[2]),a(r(a(n(u[1],d[0]),n(-d[1],u[0])),-f[2]),r(a(n(u[1],f[0]),n(-f[1],u[0])),d[2]))),-h[3]),a(r(a(r(a(n(h[1],d[0]),n(-d[1],h[0])),u[2]),a(r(a(n(u[1],d[0]),n(-d[1],u[0])),-h[2]),r(a(n(u[1],h[0]),n(-h[1],u[0])),d[2]))),f[3]),r(a(r(a(n(h[1],f[0]),n(-f[1],h[0])),u[2]),a(r(a(n(u[1],f[0]),n(-f[1],u[0])),-h[2]),r(a(n(u[1],h[0]),n(-h[1],u[0])),f[2]))),-d[3]))))),g=a(a(a(r(a(r(a(n(d[1],v[0]),n(-v[1],d[0])),f[2]),a(r(a(n(f[1],v[0]),n(-v[1],f[0])),-d[2]),r(a(n(f[1],d[0]),n(-d[1],f[0])),v[2]))),u[3]),r(a(r(a(n(d[1],v[0]),n(-v[1],d[0])),u[2]),a(r(a(n(u[1],v[0]),n(-v[1],u[0])),-d[2]),r(a(n(u[1],d[0]),n(-d[1],u[0])),v[2]))),-f[3])),a(r(a(r(a(n(f[1],v[0]),n(-v[1],f[0])),u[2]),a(r(a(n(u[1],v[0]),n(-v[1],u[0])),-f[2]),r(a(n(u[1],f[0]),n(-f[1],u[0])),v[2]))),d[3]),r(a(r(a(n(f[1],d[0]),n(-d[1],f[0])),u[2]),a(r(a(n(u[1],d[0]),n(-d[1],u[0])),-f[2]),r(a(n(u[1],f[0]),n(-f[1],u[0])),d[2]))),-v[3]))),a(a(r(a(r(a(n(f[1],v[0]),n(-v[1],f[0])),h[2]),a(r(a(n(h[1],v[0]),n(-v[1],h[0])),-f[2]),r(a(n(h[1],f[0]),n(-f[1],h[0])),v[2]))),u[3]),r(a(r(a(n(f[1],v[0]),n(-v[1],f[0])),u[2]),a(r(a(n(u[1],v[0]),n(-v[1],u[0])),-f[2]),r(a(n(u[1],f[0]),n(-f[1],u[0])),v[2]))),-h[3])),a(r(a(r(a(n(h[1],v[0]),n(-v[1],h[0])),u[2]),a(r(a(n(u[1],v[0]),n(-v[1],u[0])),-h[2]),r(a(n(u[1],h[0]),n(-h[1],u[0])),v[2]))),f[3]),r(a(r(a(n(h[1],f[0]),n(-f[1],h[0])),u[2]),a(r(a(n(u[1],f[0]),n(-f[1],u[0])),-h[2]),r(a(n(u[1],h[0]),n(-h[1],u[0])),f[2]))),-v[3])))),y=s(p,g);return y[y.length-1]}}function xh(a){return(a===3?bR:a===4?xR:ER)(gR,mh,fR,vR)}const wR=xh(3),SR=xh(4),us=[function(){return 0},function(){return 0},function(n,r){return r[0]-n[0]},function(n,r,s){const l=(n[1]-s[1])*(r[0]-s[0]),u=(n[0]-s[0])*(r[1]-s[1]),h=l-u;let f;if(l>0){if(u<=0)return h;f=l+u}else if(l<0){if(u>=0)return h;f=-(l+u)}else return h;const d=yR*f;return h>=d||h<=-d?h:wR(n,r,s)},function(n,r,s,l){const u=n[0]-l[0],h=r[0]-l[0],f=s[0]-l[0],d=n[1]-l[1],v=r[1]-l[1],p=s[1]-l[1],g=n[2]-l[2],y=r[2]-l[2],m=s[2]-l[2],b=h*p,x=f*v,E=f*d,w=u*p,S=u*v,M=h*d,C=g*(b-x)+y*(E-w)+m*(S-M),T=(Math.abs(b)+Math.abs(x))*Math.abs(g)+(Math.abs(E)+Math.abs(w))*Math.abs(y)+(Math.abs(S)+Math.abs(M))*Math.abs(m),O=mR*T;return C>O||-C>O?C:SR(n,r,s,l)}];function MR(a){let n=us[a.length];return n||(n=us[a.length]=xh(a.length)),n.apply(void 0,...a)}function TR(a,n,r,s,l,u,h){return function(...d){switch(d.length){case 0:case 1:return 0;case 2:return s(d[0],d[1]);case 3:return l(d[0],d[1],d[2]);case 4:return u(d[0],d[1],d[2],d[3]);case 5:return h(d[0],d[1],d[2],d[3],d[4])}return a(d)}}function CR(){for(;us.length<=$b;)us.push(xh(us.length));const a=TR(void 0,MR,...us);for(let n=0;n<=$b;++n)a[n]=us[n];return a}var Wl=CR();const Ub=Wl[3];function OR(a){const n=a.length;if(n<3){const f=new Array(n);for(let d=0;d<n;++d)f[d]=d;return n===2&&a[0][0]===a[1][0]&&a[0][1]===a[1][1]?[0]:f}const r=new Array(n);for(let f=0;f<n;++f)r[f]=f;r.sort((f,d)=>{const v=a[f][0]-a[d][0];return v||a[f][1]-a[d][1]});const s=[r[0],r[1]],l=[r[0],r[1]];for(let f=2;f<n;++f){const d=r[f],v=a[d];let p=s.length;for(;p>1&&Ub(a[s[p-2]],a[s[p-1]],v)<=0;)p-=1,s.pop();for(s.push(d),p=l.length;p>1&&Ub(a[l[p-2]],a[l[p-1]],v)>=0;)p-=1,l.pop();l.push(d)}const u=new Array(l.length+s.length-2);let h=0;for(let f=0,d=s.length;f<d;++f)u[h++]=s[f];for(let f=l.length-2;f>0;--f)u[h++]=l[f];return u}function kR(a,n,r,s){for(let l=0;l<2;++l){const u=a[l],h=n[l],[f,d]=[Math.min(u,h),Math.max(u,h)],v=r[l],p=s[l],[g,y]=[Math.min(v,p),Math.max(v,p)];if(y<f||d<g)return!1}return!0}function _R(a,n,r,s){const l=Wl(a,r,s),u=Wl(n,r,s);if(l>0&&u>0||l<0&&u<0)return!1;const h=Wl(r,a,n),f=Wl(s,a,n);return h>0&&f>0||h<0&&f<0?!1:l===0&&u===0&&h===0&&f===0?kR(a,n,r,s):!0}function PR(a){const n=[a[0]];let r=a[0];for(let s=1;s<a.length;s++){const l=a[s];(r[0]!==l[0]||r[1]!==l[1])&&n.push(l),r=l}return n}function AR(a){return a.sort(function(n,r){return n[0]-r[0]||n[1]-r[1]})}function Lv(a,n){return Math.pow(n[0]-a[0],2)+Math.pow(n[1]-a[1],2)}function Yb(a,n,r){const s=[n[0]-a[0],n[1]-a[1]],l=[r[0]-a[0],r[1]-a[1]],u=Lv(a,n),h=Lv(a,r);return(s[0]*l[0]+s[1]*l[1])/Math.sqrt(u*h)}function Xb(a,n){for(let r=0;r<n.length-1;r++){const s=[n[r],n[r+1]];if(!(a[0][0]===s[0][0]&&a[0][1]===s[0][1]||a[0][0]===s[1][0]&&a[0][1]===s[1][1])&&_R(a[0],a[1],s[0],s[1]))return!0}return!1}function NR(a){let n=1/0,r=1/0,s=-1/0,l=-1/0;for(let u=a.length-1;u>=0;u--)a[u][0]<n&&(n=a[u][0]),a[u][1]<r&&(r=a[u][1]),a[u][0]>s&&(s=a[u][0]),a[u][1]>l&&(l=a[u][1]);return[s-n,l-r]}function RR(a){return[Math.min(a[0][0],a[1][0]),Math.min(a[0][1],a[1][1]),Math.max(a[0][0],a[1][0]),Math.max(a[0][1],a[1][1])]}function LR(a,n,r){let s=null,l=Kb,u=Kb,h,f;for(let d=0;d<n.length;d++)h=Yb(a[0],a[1],n[d]),f=Yb(a[1],a[0],n[d]),h>l&&f>u&&!Xb([a[0],n[d]],r)&&!Xb([a[1],n[d]],r)&&(l=h,u=f,s=n[d]);return s}function qb(a,n,r,s,l){let u=!1;for(let h=0;h<a.length-1;h++){const f=[a[h],a[h+1]],d=f[0][0]+","+f[0][1]+","+f[1][0]+","+f[1][1];if(Lv(f[0],f[1])<n||l.has(d))continue;let v=0,p=RR(f),g,y,m;do p=s.extendBbox(p,v),g=p[2]-p[0],y=p[3]-p[1],m=LR(f,s.rangePoints(p),a),v++;while(m===null&&(r[0]>g||r[1]>y));g>=r[0]&&y>=r[1]&&l.add(d),m!==null&&(a.splice(h+1,0,m),s.removePoint(m),u=!0)}return u?qb(a,n,r,s,l):a}function DR(a,n,r){const s=n||20,l=PR(AR(Rv.toXy(a,r)));if(l.length<4){const g=l.concat([l[0]]);return r?Rv.fromXy(g,r):g}const u=NR(l),h=[u[0]*Qb,u[1]*Qb],f=OR(l).reverse().map(g=>l[g]);f.push(f[0]);const d=l.filter(function(g){return f.indexOf(g)<0}),v=Math.ceil(1/(l.length/(u[0]*u[1]))),p=qb(f,Math.pow(s,2),h,uR(d,v),new Set);return r?Rv.fromXy(p,r):p}const Kb=Math.cos(90/(180/Math.PI)),Qb=.6;function IR(a,n,r){if(a.length===1)return BR(a[0],n,r);if(a.length===2)return Jb(a,n,r);if(a.length===3){const[s,l,u]=$d(a);if(r1(s,l,u))return Jb([s,u],n,r)}switch(r){case"smooth":return zR(a,n);case"sharp":return ZR(a,n);case"rounded":default:return FR(a,n)}}const BR=(a,n,r)=>{if(r==="sharp")return[["M",a[0]-n,a[1]-n],["L",a[0]+n,a[1]-n],["L",a[0]+n,a[1]+n],["L",a[0]-n,a[1]+n],["Z"]];const s=[n,n,0,0,0];return[["M",a[0],a[1]-n],["A",...s,a[0],a[1]+n],["A",...s,a[0],a[1]-n]]},Jb=(a,n,r)=>{const s=[n,n,0,0,0],l=r==="sharp"?Gt(a[0],da(Bi(Te(a[0],a[1])),n)):a[0],u=r==="sharp"?Gt(a[1],da(Bi(Te(a[1],a[0])),n)):a[1],h=da(Bi(ju(Te(l,u),!1)),n),f=da(h,-1),d=Gt(l,h),v=Gt(u,h),p=Gt(u,f),g=Gt(l,f);return r==="sharp"?[["M",d[0],d[1]],["L",v[0],v[1]],["L",p[0],p[1]],["L",g[0],g[1]],["Z"]]:[["M",d[0],d[1]],["L",v[0],v[1]],["A",...s,p[0],p[1]],["L",g[0],g[1]],["A",...s,d[0],d[1]]]},FR=(a,n)=>{const r=$d(a).map((f,d)=>{const v=(d-2+a.length)%a.length,p=(d-1+a.length)%a.length,g=(d+1)%a.length,y=a[v],m=a[p],b=a[g],x=Te(y,m),E=Te(m,f),w=Te(f,b),S=(k,P)=>jd(k,P,!0)<Math.PI,M=S(x,E),C=S(E,w),T=k=>da(Bi(ju(k,!1)),n),O=T(E);return[{p:Ja(M?Gt(m,T(x)):Gt(m,O)),concave:M&&m},{p:Ja(C?Gt(f,T(w)):Gt(f,O)),concave:C&&f}]}),s=[n,n,0,0,0],l=r.findIndex((f,d)=>!r[(d-1+r.length)%r.length][0].concave&&!r[(d-1+r.length)%r.length][1].concave&&!f[0].concave&&!f[0].concave&&!f[1].concave),u=r.slice(l).concat(r.slice(0,l));let h=[];return u.flatMap((f,d)=>{const v=[],p=u[r.length-1];return d===0&&v.push(["M",...p[1].p]),f[0].concave?h.push(f[0].p,f[1].p):v.push(["A",...s,...f[0].p]),f[1].concave?h.unshift(f[1].p):v.push(["L",...f[1].p]),h.length===3&&(v.pop(),v.push(["C",...h.flat()]),h=[]),v})},zR=(a,n)=>{const r=$d(a).map((s,l)=>{const u=a[(l+1)%a.length];return{p:s,v:Bi(Te(u,s))}});return r.forEach((s,l)=>{const u=l>0?l-1:a.length-1,h=r[u].v,f=Bi(Gt(h,da(s.v,jd(h,s.v,!0)<Math.PI?1:-1)));s.p=Gt(s.p,da(f,n))}),b1(r.map(s=>s.p))},ZR=(a,n)=>{const s=a.map((u,h)=>{const f=a[h===0?a.length-1:h-1],d=Qo(da(Bi(ju(Te(f,u),!1)),n));return[Gt(f,d),Gt(u,d)]}).flat();return s.map((u,h)=>{if(h%2===0)return null;const f=[s[(h-1)%s.length],s[h%s.length]],d=[s[(h+1)%s.length],s[(h+2)%s.length]];return Hd(f,d,!0)}).filter(Boolean).map((u,h)=>[h===0?"M":"L",u[0],u[1]]).concat([["Z"]])};var GR=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class jl extends ln{constructor(n,r){super(n,Object.assign({},jl.defaultOptions,r)),this.hullMemberIds=[],this.drawHull=()=>{if(!this.shape)this.shape=new rl({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);else{const s=!Je(this.optionsCache,this.options);this.shape.update(this.getHullStyle(s))}this.optionsCache=Object.assign({},this.options)},this.updateHullPath=s=>{this.shape&&this.options.members.includes(V(s.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=(s=!1)=>{const{graph:l}=this.context,u=this.getMember();if(u.length===0)return"";const h=u.map(v=>l.getNodeData(v)),f=DR(h.map(Fe),this.options.concavity).slice(1).reverse(),d=f.flatMap(v=>h.filter(p=>Je(Fe(p),v)).map(V));return Je(d,this.hullMemberIds)&&!s?this.path:(this.hullMemberIds=d,this.path=IR(f,this.getPadding(),this.options.corner),this.path)},this.bindEvents()}bindEvents(){this.context.graph.on(lt.AFTER_RENDER,this.drawHull),this.context.graph.on(lt.AFTER_ELEMENT_UPDATE,this.updateHullPath)}unbindEvents(){this.context.graph.off(lt.AFTER_RENDER,this.drawHull),this.context.graph.off(lt.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(n){const r=this.options,{members:s,padding:l,corner:u}=r,h=GR(r,["members","padding","corner"]);return Object.assign(Object.assign({},h),{d:this.getHullPath(n)})}getPadding(){const{graph:n}=this.context;return this.hullMemberIds.reduce((s,l)=>{const{halfExtents:u}=n.getElementRenderBounds(l),h=Math.max(u[0],u[1]);return Math.max(s,h)},0)+this.options.padding}addMember(n){const r=Array.isArray(n)?n:[n];this.options.members=[...new Set([...this.options.members,...r])],this.shape.update({d:this.getHullPath()})}removeMember(n){const r=Array.isArray(n)?n:[n];this.options.members=this.options.members.filter(s=>!r.includes(s)),r.some(s=>this.hullMemberIds.includes(s))&&this.shape.update({d:this.getHullPath()})}updateMember(n){this.options.members=(0,_t.Z)(n)?n(this.options.members):n,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.unbindEvents(),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}}jl.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};function tx(a,n){n(a),a.children&&a.children.forEach(function(r){r&&tx(r,n)})}function Vl(a){Eh(a,!0)}function Jr(a){Eh(a,!1)}function Eh(a,n){var r=n?"visible":"hidden";tx(a,function(s){s.attr("visibility",r)})}var WR=5,ex=function(a,n,r,s){r===void 0&&(r=0),s===void 0&&(s=WR),Object.entries(n).forEach(function(l){var u=(0,_.CR)(l,2),h=u[0],f=u[1],d=a;Object.prototype.hasOwnProperty.call(n,h)&&(f?(0,Mv.Z)(f)?((0,Mv.Z)(a[h])||(d[h]={}),r<s?ex(a[h],f,r+1,s):d[h]=n[h]):(0,Gr.Z)(f)?(d[h]=[],d[h]=d[h].concat(f)):d[h]=f:d[h]=f)})},cn=function(a){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];for(var s=0;s<n.length;s+=1)ex(a,n[s]);return a},jR=function(a){(0,_.ZT)(n,a);function n(){for(var r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];var l=a.apply(this,(0,_.ev)([],(0,_.CR)(r),!1))||this;return l.isMutationObserved=!0,l.addEventListener($t.INSERTED,function(){Jr(l)}),l}return n}(vn);function nx(a){var n=a.appendChild(new jR({class:"offscreen"}));return Jr(n),n}function VR(a){for(var n=a;n;){if(n.className==="offscreen")return!0;n=n.parent}return!1}function HR(){Eh(this,this.attributes.visibility!=="hidden")}var Ve=function(a){(0,_.ZT)(n,a);function n(r,s){s===void 0&&(s={});var l=a.call(this,cn({},{style:s},r))||this;return l.initialized=!1,l._defaultOptions=s,l}return Object.defineProperty(n.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=nx(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),n.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},n.prototype.disconnectedCallback=function(){var r;(r=this._offscreen)===null||r===void 0||r.destroy()},n.prototype.attributeChangedCallback=function(r){r==="visibility"&&HR.call(this)},n.prototype.update=function(r,s){var l;return this.attr(cn({},this.attributes,r||{})),(l=this.render)===null||l===void 0?void 0:l.call(this,this.attributes,this,s)},n.prototype.clear=function(){this.removeChildren()},n.prototype.bindEvents=function(r,s){},n.prototype.getSubShapeStyle=function(r){var s=r.x,l=r.y,u=r.transform,h=r.transformOrigin,f=r.class,d=r.className,v=r.zIndex,p=(0,_._T)(r,["x","y","transform","transformOrigin","class","className","zIndex"]);return p},n}(vd);function Dv(a){return a.toString().charAt(0).toUpperCase()+a.toString().slice(1)}function $R(a){return a.toString().charAt(0).toLowerCase()+a.toString().slice(1)}function UR(a,n){return"".concat(n).concat(Dv(a))}function rx(a,n,r){var s;r===void 0&&(r=!0);var l=n||((s=a.match(/^([a-z][a-z0-9]+)/))===null||s===void 0?void 0:s[0])||"",u=a.replace(new RegExp("^(".concat(l,")")),"");return r?$R(u):u}function YR(a,n){Object.entries(n).forEach(function(r){var s=(0,_.CR)(r,2),l=s[0],u=s[1];(0,_.ev)([a],(0,_.CR)(a.querySelectorAll(l)),!1).filter(function(h){return h.matches(l)}).forEach(function(h){if(h){var f=h;f.style.cssText+=Object.entries(u).reduce(function(d,v){return"".concat(d).concat(v.join(":"),";")},"")}})})}var wh=function(a,n){if(!(a!=null&&a.startsWith(n)))return!1;var r=a[n.length];return r>="A"&&r<="Z"};function Wt(a,n,r){r===void 0&&(r=!1);var s={};return Object.entries(a).forEach(function(l){var u=(0,_.CR)(l,2),h=u[0],f=u[1];if(!(h==="className"||h==="class")){if(wh(h,"show")&&wh(rx(h,"show"),n)!==r)h===UR(n,"show")?s[h]=f:s[h.replace(new RegExp(Dv(n)),"")]=f;else if(!wh(h,"show")&&wh(h,n)!==r){var d=rx(h,n);d==="filter"&&typeof f=="function"||(s[d]=f)}}}),s}function Ys(a,n){return Object.entries(a).reduce(function(r,s){var l=(0,_.CR)(s,2),u=l[0],h=l[1];return u.startsWith("show")?r["show".concat(n).concat(u.slice(4))]=h:r["".concat(n).concat(Dv(u))]=h,r},{})}function Wi(a,n){n===void 0&&(n=["x","y","class","className"]);var r=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],s={},l={};return Object.entries(a).forEach(function(u){var h=(0,_.CR)(u,2),f=h[0],d=h[1];n.includes(f)||(r.indexOf(f)!==-1?l[f]=d:s[f]=d)}),[s,l]}var XR=function(a){if(!(0,Gr.Z)(a))return[];for(var n=[],r=0;r<a.length;r++)n=n.concat(a[r]);return n},qR=XR,Iv=function(a){(0,_.ZT)(n,a);function n(r){r===void 0&&(r={});var s=r.style,l=(0,_._T)(r,["style"]);return a.call(this,(0,_.pi)({style:(0,_.pi)({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},s)},l))||this}return Object.defineProperty(n.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=nx(this)),this._offscreen},enumerable:!1,configurable:!0}),n.prototype.disconnectedCallback=function(){var r;(r=this._offscreen)===null||r===void 0||r.destroy()},n}(Xa);function KR(a,n){var r=new Map;return a.forEach(function(s){var l=n(s);r.has(l)||r.set(l,[]),r.get(l).push(s)}),r}function QR(a){throw new Error(a)}var JR=function(){function a(l,u,h,f,d,v,p){l===void 0&&(l=null),u===void 0&&(u=null),h===void 0&&(h=null),f===void 0&&(f=null),d===void 0&&(d=[null,null,null,null,null]),v===void 0&&(v=[]),p===void 0&&(p=[]),n.add(this),this._elements=Array.from(l),this._data=u,this._parent=h,this._document=f,this._enter=d[0],this._update=d[1],this._exit=d[2],this._merge=d[3],this._split=d[4],this._transitions=v,this._facetElements=p}a.prototype.selectAll=function(l){var u=typeof l=="string"?this._parent.querySelectorAll(l):l;return new r(u,null,this._elements[0],this._document)},a.prototype.selectFacetAll=function(l){var u=typeof l=="string"?this._parent.querySelectorAll(l):l;return new r(this._elements,null,this._parent,this._document,void 0,void 0,u)},a.prototype.select=function(l){var u=typeof l=="string"?this._parent.querySelectorAll(l)[0]||null:l;return new r([u],null,u,this._document)},a.prototype.append=function(l){var u=this,h=typeof l=="function"?l:function(){return u.createElement(l)},f=[];if(this._data!==null){for(var d=0;d<this._data.length;d++){var v=this._data[d],p=(0,_.CR)(Array.isArray(v)?v:[v,null],2),g=p[0],y=p[1],m=h(g,d);m.__data__=g,y!==null&&(m.__fromElements__=y),this._parent.appendChild(m),f.push(m)}return new r(f,null,this._parent,this._document)}for(var d=0;d<this._elements.length;d++){var b=this._elements[d],g=b.__data__,m=h(g,d);b.appendChild(m),f.push(m)}return new r(f,null,f[0],this._document)},a.prototype.maybeAppend=function(l,u){var h=(0,_.Q_)(this,n,"m",s).call(this,l[0]==="#"?l:"#".concat(l),u);return h.attr("id",l),h},a.prototype.maybeAppendByClassName=function(l,u){var h=l.toString(),f=(0,_.Q_)(this,n,"m",s).call(this,h[0]==="."?h:".".concat(h),u);return f.attr("className",h),f},a.prototype.maybeAppendByName=function(l,u){var h=(0,_.Q_)(this,n,"m",s).call(this,'[name="'.concat(l,'"]'),u);return h.attr("name",l),h},a.prototype.data=function(l,u,h){var f,d;u===void 0&&(u=function(N){return N}),h===void 0&&(h=function(){return null});for(var v=[],p=[],g=new Set(this._elements),y=[],m=new Set,b=new Map(this._elements.map(function(N,L){return[u(N.__data__,L),N]})),x=new Map(this._facetElements.map(function(N,L){return[u(N.__data__,L),N]})),E=KR(this._elements,function(N){return h(N.__data__)}),w=0;w<l.length;w++){var S=l[w],M=u(S,w),C=h(S,w);if(b.has(M)){var T=b.get(M);T.__data__=S,T.__facet__=!1,p.push(T),g.delete(T),b.delete(M)}else if(x.has(M)){var T=x.get(M);T.__data__=S,T.__facet__=!0,p.push(T),x.delete(M)}else if(E.has(M)){var O=E.get(M);y.push([S,O]);try{for(var k=(f=void 0,(0,_.XA)(O)),P=k.next();!P.done;P=k.next()){var T=P.value;g.delete(T)}}catch(N){f={error:N}}finally{try{P&&!P.done&&(d=k.return)&&d.call(k)}finally{if(f)throw f.error}}E.delete(M)}else if(b.has(C)){var T=b.get(C);T.__toData__?T.__toData__.push(S):T.__toData__=[S],m.add(T),g.delete(T)}else v.push(S)}var A=[new r([],v,this._parent,this._document),new r(p,null,this._parent,this._document),new r(g,null,this._parent,this._document),new r([],y,this._parent,this._document),new r(m,null,this._parent,this._document)];return new r(this._elements,null,this._parent,this._document,A)},a.prototype.merge=function(l){var u=(0,_.ev)((0,_.ev)([],(0,_.CR)(this._elements),!1),(0,_.CR)(l._elements),!1),h=(0,_.ev)((0,_.ev)([],(0,_.CR)(this._transitions),!1),(0,_.CR)(l._transitions),!1);return new r(u,null,this._parent,this._document,void 0,h)},a.prototype.createElement=function(l){if(this._document)return this._document.createElement(l,{});var u=r.registry[l];return u?new u:QR("Unknown node type: ".concat(l))},a.prototype.join=function(l,u,h,f,d){l===void 0&&(l=function(b){return b}),u===void 0&&(u=function(b){return b}),h===void 0&&(h=function(b){return b.remove()}),f===void 0&&(f=function(b){return b}),d===void 0&&(d=function(b){return b.remove()});var v=l(this._enter),p=u(this._update),g=h(this._exit),y=f(this._merge),m=d(this._split);return p.merge(v).merge(g).merge(y).merge(m)},a.prototype.remove=function(){for(var l=function(f){var d=u._elements[f],v=u._transitions[f];v?v.then(function(){return d.remove()}):d.remove()},u=this,h=0;h<this._elements.length;h++)l(h);return new r([],null,this._parent,this._document,void 0,this._transitions)},a.prototype.each=function(l){for(var u=0;u<this._elements.length;u++){var h=this._elements[u],f=h.__data__;l.call(h,f,u)}return this},a.prototype.attr=function(l,u){var h=typeof u!="function"?function(){return u}:u;return this.each(function(f,d){u!==void 0&&(this[l]=h.call(this,f,d))})},a.prototype.style=function(l,u,h){h===void 0&&(h=!0);var f=typeof u!="function"||!h?function(){return u}:u;return this.each(function(d,v){u!==void 0&&(this.style[l]=f.call(this,d,v))})},a.prototype.styles=function(l,u){return l===void 0&&(l={}),u===void 0&&(u=!0),this.each(function(h,f){var d=this;Object.entries(l).forEach(function(v){var p=(0,_.CR)(v,2),g=p[0],y=p[1],m=typeof y!="function"||!u?function(){return y}:y;y!==void 0&&d.attr(g,m.call(d,h,f))})})},a.prototype.update=function(l,u){u===void 0&&(u=!0);var h=typeof l!="function"||!u?function(){return l}:l;return this.each(function(f,d){l&&this.update&&this.update(h.call(this,f,d))})},a.prototype.maybeUpdate=function(l,u){u===void 0&&(u=!0);var h=typeof l!="function"||!u?function(){return l}:l;return this.each(function(f,d){l&&this.update&&this.update(h.call(this,f,d))})},a.prototype.transition=function(l){var u=this._transitions,h=new Array(this._elements.length);return this.each(function(f,d){h[d]=l.call(this,f,d)}),this._transitions=qR(h),this},a.prototype.on=function(l,u){return this.each(function(){this.addEventListener(l,u)}),this},a.prototype.call=function(l){for(var u=[],h=1;h<arguments.length;h++)u[h-1]=arguments[h];return l.call.apply(l,(0,_.ev)([this._parent,this],(0,_.CR)(u),!1)),this},a.prototype.node=function(){return this._elements[0]},a.prototype.nodes=function(){return this._elements},a.prototype.transitions=function(){return this._transitions.filter(function(l){return!!l})},a.prototype.parent=function(){return this._parent};var n,r,s;return r=a,n=new WeakSet,s=function(u,h){var f=this._elements[0],d=f.querySelector(u);if(d)return new r([d],null,this._parent,this._document);var v=typeof h=="string"?this.createElement(h):h();return f.appendChild(v),new r([v],null,this._parent,this._document)},a.registry={g:vn,rect:Sn,circle:gi,path:dr,text:Iv,ellipse:Zo,image:Go,line:Ua,polygon:Ya,polyline:au,html:$a},a}();function Tt(a){return new JR([a],null,a,a.ownerDocument)}function tL(a,n,r){return a.querySelector(n)?Tt(a).select(n):Tt(a).append(r)}var Dn=function(){function a(n,r,s,l){n===void 0&&(n=0),r===void 0&&(r=0),s===void 0&&(s=0),l===void 0&&(l=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=n,this.y=r,this.width=s,this.height=l}return Object.defineProperty(a.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),a.fromRect=function(n){return new a(n.x,n.y,n.width,n.height)},a.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},a.prototype.isPointIn=function(n,r){return n>=this.left&&n<=this.right&&r>=this.top&&r<=this.bottom},a}();function tG(a){var n=a.getRenderBounds(),r=__read(n.min,2),s=r[0],l=r[1],u=__read(n.max,2),h=u[0],f=u[1],d=h-s,v=f-l;return new Dn(s,l,d,v)}var ti=function(a,n){var r=function(l){return"".concat(n,"-").concat(l)},s=Object.fromEntries(Object.entries(a).map(function(l){var u=(0,_.CR)(l,2),h=u[0],f=u[1],d=r(f);return[h,{name:d,class:".".concat(d),id:"#".concat(d),toString:function(){return d}}]}));return Object.assign(s,{prefix:r}),s};function Sh(a){return/\S+-\S+/g.test(a)?a.split("-").map(function(n){return n[0]}):a.length>2?[a[0]]:a.split("")}function Cn(a){if((0,se.Z)(a))return[a,a,a,a];if((0,Gr.Z)(a)){var n=a.length;if(n===1)return[a[0],a[0],a[0],a[0]];if(n===2)return[a[0],a[1],a[0],a[1]];if(n===3)return[a[0],a[1],a[2],a[1]];if(n===4)return a}return[0,0,0,0]}function or(a,n,r,s,l){return s===void 0&&(s=!0),l===void 0&&(l=function(u){u.node().removeChildren()}),a?r(n):(s&&l(n),null)}function In(a,n,r){return r?"".concat(a," ").concat(r,"legend-").concat(n):a}function eG(a,n,r){var s=a.classNamePrefix,l=s===void 0?"":s;return In(n.name,r,l)}var Un={title:"title",item:"item",marker:"marker",label:"label",value:"value",focusIcon:"focus-icon",background:"background",ribbon:"ribbon",track:"track",selection:"selection",handle:"handle",handleMarker:"handle-marker",handleLabel:"handle-label",indicator:"indicator",prevBtn:"prev-btn",nextBtn:"next-btn",pageInfo:"page-info"},Bv=ti({text:"text"},"title");function eL(a,n){var r=a.attributes,s=r.position,l=r.spacing,u=r.inset,h=r.text,f=a.getBBox(),d=n.getBBox(),v=Sh(s),p=(0,_.CR)(Cn(h?l:0),4),g=p[0],y=p[1],m=p[2],b=p[3],x=(0,_.CR)(Cn(u),4),E=x[0],w=x[1],S=x[2],M=x[3],C=(0,_.CR)([b+y,g+m],2),T=C[0],O=C[1],k=(0,_.CR)([M+w,E+S],2),P=k[0],A=k[1];if(v[0]==="l")return new Dn(f.x,f.y,d.width+f.width+T+P,Math.max(d.height+A,f.height));if(v[0]==="t")return new Dn(f.x,f.y,Math.max(d.width+P,f.width),d.height+f.height+O+A);var N=(0,_.CR)([n.attributes.width||d.width,n.attributes.height||d.height],2),L=N[0],R=N[1];return new Dn(d.x,d.y,L+f.width+T+P,R+f.height+O+A)}function nL(a,n){var r=Object.entries(n).reduce(function(s,l){var u=(0,_.CR)(l,2),h=u[0],f=u[1],d=a.node().attr(h);return d||(s[h]=f),s},{});a.styles(r)}function rL(a){var n,r,s,l,u=a,h=u.width,f=u.height,d=u.position,v=(0,_.CR)([+h/2,+f/2],2),p=v[0],g=v[1],y=(0,_.CR)([+p,+g,"center","middle"],4),m=y[0],b=y[1],x=y[2],E=y[3],w=Sh(d);return w.includes("l")&&(n=(0,_.CR)([0,"start"],2),m=n[0],x=n[1]),w.includes("r")&&(r=(0,_.CR)([+h,"end"],2),m=r[0],x=r[1]),w.includes("t")&&(s=(0,_.CR)([0,"top"],2),b=s[0],E=s[1]),w.includes("b")&&(l=(0,_.CR)([+f,"bottom"],2),b=l[0],E=l[1]),{x:m,y:b,textAlign:x,textBaseline:E}}var iL=function(a){(0,_.ZT)(n,a);function n(r){return a.call(this,r,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return n.prototype.getAvailableSpace=function(){var r=this,s=this.attributes,l=s.width,u=s.height,h=s.position,f=s.spacing,d=s.inset,v=r.querySelector(Bv.text.class);if(!v)return new Dn(0,0,+l,+u);var p=v.getBBox(),g=p.width,y=p.height,m=(0,_.CR)(Cn(f),4),b=m[0],x=m[1],E=m[2],w=m[3],S=(0,_.CR)([0,0,+l,+u],4),M=S[0],C=S[1],T=S[2],O=S[3],k=Sh(h);if(k.includes("i"))return new Dn(M,C,T,O);k.forEach(function(nt,K){var rt,U,at,ht;nt==="t"&&(rt=(0,_.CR)(K===0?[y+E,+u-y-E]:[0,+u],2),C=rt[0],O=rt[1]),nt==="r"&&(U=(0,_.CR)([+l-g-w],1),T=U[0]),nt==="b"&&(at=(0,_.CR)([+u-y-b],1),O=at[0]),nt==="l"&&(ht=(0,_.CR)(K===0?[g+x,+l-g-x]:[0,+l],2),M=ht[0],T=ht[1])});var P=(0,_.CR)(Cn(d),4),A=P[0],N=P[1],L=P[2],R=P[3],z=(0,_.CR)([R+N,A+L],2),Z=z[0],X=z[1];return new Dn(M+R,C+A,T-Z,O-X)},n.prototype.getBBox=function(){return this.title?this.title.getBBox():new Dn(0,0,0,0)},n.prototype.render=function(r,s){var l=this,u=r.width,h=r.height,f=r.position,d=r.spacing,v=r.classNamePrefix,p=(0,_._T)(r,["width","height","position","spacing","classNamePrefix"]),g=(0,_.CR)(Wi(p),1),y=g[0],m=rL(r),b=m.x,x=m.y,E=m.textAlign,w=m.textBaseline;or(!!p.text,Tt(s),function(S){var M=In(Bv.text.name,Un.title,v);l.title=S.maybeAppendByClassName(Bv.text,"text").attr("className",M).styles(y).call(nL,{x:b,y:x,textAlign:E,textBaseline:w}).node()})},n}(Ve),Fv=function(){};function lr(a,n){return(0,_t.Z)(a)?a.apply(void 0,(0,_.ev)([],(0,_.CR)(n),!1)):a}function aL(a,n){return a.reduce(function(r,s){return(r[s[n]]=r[s[n]]||[]).push(s),r},{})}function sL(a){return typeof a=="boolean"?!1:"enter"in a&&"update"in a&&"exit"in a}function ix(a){if(!a)return{enter:!1,update:!1,exit:!1};var n=["enter","update","exit"],r=Object.fromEntries(Object.entries(a).filter(function(s){var l=(0,_.CR)(s,1),u=l[0];return!n.includes(u)}));return Object.fromEntries(n.map(function(s){return sL(a)?a[s]===!1?[s,!1]:[s,(0,_.pi)((0,_.pi)({},a[s]),r)]:[s,r]}))}function Xs(a,n){a?a.finished.then(n):n()}function oL(a,n){a.length===0?n():Promise.all(a.map(function(r){return r==null?void 0:r.finished})).then(n)}function ax(a,n){"update"in a?a.update(n):a.attr(n)}function sx(a,n,r){if(n.length===0)return null;if(!r){var s=n.slice(-1)[0];return ax(a,{style:s}),null}return a.animate(n,r)}function lL(a,n){return!(a.nodeName!=="text"||n.nodeName!=="text"||a.attributes.text!==n.attributes.text)}function cL(a,n,r,s){if(s===void 0&&(s="destroy"),lL(a,n))return a.remove(),[null];var l=function(){s==="destroy"?a.destroy():s==="hide"&&Jr(a),n.isVisible()&&Vl(n)};if(!r)return l(),[null];var u=r.duration,h=u===void 0?0:u,f=r.delay,d=f===void 0?0:f,v=Math.ceil(+h/2),p=+h/4,g=(0,_.CR)(a.getGeometryBounds().center,2),y=g[0],m=g[1],b=(0,_.CR)(n.getGeometryBounds().center,2),x=b[0],E=b[1],w=(0,_.CR)([(y+x)/2-y,(m+E)/2-m],2),S=w[0],M=w[1],C=a.style.opacity,T=C===void 0?1:C,O=n.style.opacity,k=O===void 0?1:O,P=a.style.transform||"",A=n.style.transform||"",N=a.animate([{opacity:T,transform:"translate(0, 0) ".concat(P)},{opacity:0,transform:"translate(".concat(S,", ").concat(M,") ").concat(P)}],(0,_.pi)((0,_.pi)({fill:"both"},r),{duration:d+v+p})),L=n.animate([{opacity:0,transform:"translate(".concat(-S,", ").concat(-M,") ").concat(A),offset:.01},{opacity:k,transform:"translate(0, 0) ".concat(A)}],(0,_.pi)((0,_.pi)({fill:"both"},r),{duration:v+p,delay:d+v-p}));return Xs(L,l),[N,L]}function ei(a,n,r){var s={},l={};return Object.entries(n).forEach(function(u){var h=(0,_.CR)(u,2),f=h[0],d=h[1];if(!(0,At.Z)(d)){var v=a.style[f]||a.parsedStyle[f]||0;v!==d&&(s[f]=v,l[f]=d)}}),r?sx(a,[s,l],(0,_.pi)({fill:"both"},r)):(ax(a,l),null)}function uL(a){var n;return((n=a[0])===null||n===void 0?void 0:n.map(function(r,s){return a.map(function(l){return l[s]})}))||[]}function zv(a,n,r){r===void 0&&(r=!1);var s=a.getBBox(),l=s.width,u=s.height,h=n/Math.max(l,u);return r&&(a.style.transform="scale(".concat(h,")")),h}var ox=function(a,n,r){return[["M",a-r,n],["A",r,r,0,1,0,a+r,n],["A",r,r,0,1,0,a-r,n],["Z"]]},hL=ox,fL=function(a,n,r){return[["M",a-r,n-r],["L",a+r,n-r],["L",a+r,n+r],["L",a-r,n+r],["Z"]]},dL=function(a,n,r){return[["M",a-r,n],["L",a,n-r],["L",a+r,n],["L",a,n+r],["Z"]]},vL=function(a,n,r){var s=r*Math.sin(.3333333333333333*Math.PI);return[["M",a-r,n+s],["L",a,n-s],["L",a+r,n+s],["Z"]]},pL=function(a,n,r){var s=r*Math.sin(.3333333333333333*Math.PI);return[["M",a-r,n-s],["L",a+r,n-s],["L",a,n+s],["Z"]]},gL=function(a,n,r){var s=r/2*Math.sqrt(3);return[["M",a,n-r],["L",a+s,n-r/2],["L",a+s,n+r/2],["L",a,n+r],["L",a-s,n+r/2],["L",a-s,n-r/2],["Z"]]},yL=function(a,n,r){var s=r-1.5;return[["M",a-r,n-s],["L",a+r,n+s],["L",a+r,n-s],["L",a-r,n+s],["Z"]]},lx=function(a,n,r){return[["M",a,n+r],["L",a,n-r]]},mL=function(a,n,r){return[["M",a-r,n-r],["L",a+r,n+r],["M",a+r,n-r],["L",a-r,n+r]]},bL=function(a,n,r){return[["M",a-r/2,n-r],["L",a+r/2,n-r],["M",a,n-r],["L",a,n+r],["M",a-r/2,n+r],["L",a+r/2,n+r]]},xL=function(a,n,r){return[["M",a-r,n],["L",a+r,n],["M",a,n-r],["L",a,n+r]]},EL=function(a,n,r){return[["M",a-r,n],["L",a+r,n]]},cx=function(a,n,r){return[["M",a-r,n],["L",a+r,n]]},wL=cx,SL=function(a,n,r){return[["M",a-r,n],["A",r/2,r/2,0,1,1,a,n],["A",r/2,r/2,0,1,0,a+r,n]]},ML=function(a,n,r){return[["M",a-r-1,n-2.5],["L",a,n-2.5],["L",a,n+2.5],["L",a+r+1,n+2.5]]},TL=function(a,n,r){return[["M",a-r-1,n+2.5],["L",a,n+2.5],["L",a,n-2.5],["L",a+r+1,n-2.5]]},CL=function(a,n,r){return[["M",a-(r+1),n+2.5],["L",a-r/2,n+2.5],["L",a-r/2,n-2.5],["L",a+r/2,n-2.5],["L",a+r/2,n+2.5],["L",a+r+1,n+2.5]]};function OL(a,n){return[["M",a-5,n+2.5],["L",a-5,n],["L",a,n],["L",a,n-3],["L",a,n+3],["L",a+6.5,n+3]]}var kL=function(a,n,r){return[["M",a-r,n-r],["L",a+r,n],["L",a-r,n+r],["Z"]]},_L=function(a,n,r){var s=r,l=r*.2,u=r*.7;return[["M",a-s,n],["A",s,s,0,1,0,a+s,n],["A",s,s,0,1,0,a-s,n],["Z"],["M",a-u,n],["L",a-l,n],["M",a+l,n],["L",a+u,n],["M",a,n-u],["L",a,n-l],["M",a,n+l],["L",a,n+u]]},Yn=ti({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),PL=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,r,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:kL(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(l,u){return"".concat(l,"/").concat(u)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return s.playState="idle",s.contentGroup=s.appendChild(new vn({class:Yn.contentGroup.name})),s.playWindow=s.contentGroup.appendChild(new vn({class:Yn.playWindow.name})),s.innerCurrPage=s.defaultPage,s}return Object.defineProperty(n.prototype,"defaultPage",{get:function(){var r=this.attributes.defaultPage;return Ze(r,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageShape",{get:function(){var r=this.pageViews,s=(0,_.CR)(uL(r.map(function(g){var y=g.getBBox(),m=y.width,b=y.height;return[m,b]})).map(function(g){return Math.max.apply(Math,(0,_.ev)([],(0,_.CR)(g),!1))}),2),l=s[0],u=s[1],h=this.attributes,f=h.pageWidth,d=f===void 0?l:f,v=h.pageHeight,p=v===void 0?u:v;return{pageWidth:d,pageHeight:p}},enumerable:!1,configurable:!0}),n.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(n.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),n.prototype.getBBox=function(){var r=a.prototype.getBBox.call(this),s=r.x,l=r.y,u=this.controllerShape,h=this.pageShape,f=h.pageWidth,d=h.pageHeight;return new Dn(s,l,f+u.width,d)},n.prototype.goTo=function(r){var s=this,l=this.attributes.animate,u=this,h=u.currPage,f=u.playState,d=u.playWindow,v=u.pageViews;if(f!=="idle"||r<0||v.length<=0||r>=v.length)return null;v[h].setLocalPosition(0,0),this.prepareFollowingPage(r);var p=(0,_.CR)(this.getFollowingPageDiff(r),2),g=p[0],y=p[1];this.playState="running";var m=sx(d,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-g,", ").concat(-y,")")}],l);return Xs(m,function(){s.innerCurrPage=r,s.playState="idle",s.setVisiblePages([r]),s.updatePageInfo()}),m},n.prototype.prev=function(){var r=this.attributes.loop,s=this.pageViews.length,l=this.currPage;if(!r&&l<=0)return null;var u=r?(l-1+s)%s:Ze(l-1,0,s);return this.goTo(u)},n.prototype.next=function(){var r=this.attributes.loop,s=this.pageViews.length,l=this.currPage;if(!r&&l>=s-1)return null;var u=r?(l+1)%s:Ze(l+1,0,s);return this.goTo(u)},n.prototype.renderClipPath=function(r){var s=this.pageShape,l=s.pageWidth,u=s.pageHeight;if(!l||!u){this.contentGroup.style.clipPath=void 0;return}this.clipPath=r.maybeAppendByClassName(Yn.clipPath,"rect").styles({width:l,height:u}),this.contentGroup.attr("clipPath",this.clipPath.node())},n.prototype.setVisiblePages=function(r){this.playWindow.children.forEach(function(s,l){r.includes(l)?Vl(s):Jr(s)})},n.prototype.adjustControllerLayout=function(){var r=this,s=r.prevBtnGroup,l=r.nextBtnGroup,u=r.pageInfoGroup,h=this.attributes,f=h.orientation,d=h.controllerPadding,v=u.getBBox(),p=v.width,g=v.height,y=(0,_.CR)(f==="horizontal"?[-180,0]:[-90,90],2),m=y[0],b=y[1];s.setLocalEulerAngles(m),l.setLocalEulerAngles(b);var x=s.getBBox(),E=x.width,w=x.height,S=l.getBBox(),M=S.width,C=S.height,T=Math.max(E,p,M),O=f==="horizontal"?{offset:[[0,0],[E/2+d,0],[E+p+d*2,0]],textAlign:"start"}:{offset:[[T/2,-w-d],[T/2,0],[T/2,C+d]],textAlign:"center"},k=(0,_.CR)(O.offset,3),P=(0,_.CR)(k[0],2),A=P[0],N=P[1],L=(0,_.CR)(k[1],2),R=L[0],z=L[1],Z=(0,_.CR)(k[2],2),X=Z[0],nt=Z[1],K=O.textAlign,rt=u.querySelector("text");rt&&(rt.style.textAlign=K),s.setLocalPosition(A,N),u.setLocalPosition(R,z),l.setLocalPosition(X,nt)},n.prototype.updatePageInfo=function(){var r,s=this,l=s.currPage,u=s.pageViews,h=s.attributes.formatter;u.length<2||((r=this.pageInfoGroup.querySelector(Yn.pageInfo.class))===null||r===void 0||r.attr("text",h(l+1,u.length)),this.adjustControllerLayout())},n.prototype.getFollowingPageDiff=function(r){var s=this.currPage;if(s===r)return[0,0];var l=this.attributes.orientation,u=this.pageShape,h=u.pageWidth,f=u.pageHeight,d=r<s?-1:1;return l==="horizontal"?[d*h,0]:[0,d*f]},n.prototype.prepareFollowingPage=function(r){var s=this,l=s.currPage,u=s.pageViews;if(this.setVisiblePages([r,l]),r!==l){var h=(0,_.CR)(this.getFollowingPageDiff(r),2),f=h[0],d=h[1];u[r].setLocalPosition(f,d)}},n.prototype.renderController=function(r){var s=this,l=this.attributes,u=l.controllerSpacing,h=l.classNamePrefix,f=h===void 0?"":h,d=this.pageShape,v=d.pageWidth,p=d.pageHeight,g=this.pageViews.length>=2,y=r.maybeAppendByClassName(Yn.controller,"g");if(Eh(y.node(),g),!!g){var m=Wt(this.attributes,"button"),b=Wt(this.attributes,"pageNum"),x=(0,_.CR)(Wi(m),2),E=x[0],w=x[1],S=E.size,M=(0,_._T)(E,["size"]),C=!y.select(Yn.prevBtnGroup.class).node(),T=y.maybeAppendByClassName(Yn.prevBtnGroup,"g").styles(w);this.prevBtnGroup=T.node();var O=T.maybeAppendByClassName(Yn.prevBtn,"path");if(f){var k=In(Yn.prevBtn.name,Un.prevBtn,f);O.node().setAttribute("class",k)}var P=y.maybeAppendByClassName(Yn.nextBtnGroup,"g").styles(w);this.nextBtnGroup=P.node();var A=P.maybeAppendByClassName(Yn.nextBtn,"path");if(f){var N=In(Yn.nextBtn.name,Un.nextBtn,f);A.node().setAttribute("class",N)}[O,A].forEach(function(Z){Z.styles((0,_.pi)((0,_.pi)({},M),{transformOrigin:"center"})),zv(Z.node(),S,!0)});var L=y.maybeAppendByClassName(Yn.pageInfoGroup,"g");this.pageInfoGroup=L.node();var R=L.maybeAppendByClassName(Yn.pageInfo,"text");if(R.styles(b),f){var z=In(Yn.pageInfo.name,Un.pageInfo,f);R.node().setAttribute("class",z)}this.updatePageInfo(),y.node().setLocalPosition(v+u,p/2),C&&(this.prevBtnGroup.addEventListener("click",function(){s.prev()}),this.nextBtnGroup.addEventListener("click",function(){s.next()}))}},n.prototype.render=function(r,s){var l=r.x,u=l===void 0?0:l,h=r.y,f=h===void 0?0:h;this.attr("transform","translate(".concat(u,", ").concat(f,")"));var d=Tt(s);this.renderClipPath(d),this.renderController(d),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},n.prototype.bindEvents=function(){var r=this,s=El(function(){return r.render(r.attributes,r)},50);this.playWindow.addEventListener($t.INSERTED,s),this.playWindow.addEventListener($t.REMOVED,s)},n}(Ve);function AL(a){var n="default";if((0,Zn.Z)(a)&&a instanceof Image)n="image";else if((0,_t.Z)(a))n="symbol";else if((0,ve.Z)(a)){var r=new RegExp("data:(image|text)");a.match(r)?n="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(a)?n="url":n="symbol"}return n}function NL(a){var n=AL(a);return["base64","url","image"].includes(n)?"image":a&&n==="symbol"?"path":null}var pe=function(a){(0,_.ZT)(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return n.prototype.render=function(r,s){var l=r.x,u=l===void 0?0:l,h=r.y,f=h===void 0?0:h,d=this.getSubShapeStyle(r),v=d.symbol,p=d.size,g=p===void 0?16:p,y=(0,_._T)(d,["symbol","size"]),m=NL(v);or(!!m,Tt(s),function(b){b.maybeAppendByClassName("marker",m).attr("className","marker ".concat(m,"-marker")).call(function(x){if(m==="image"){var E=g*2;x.styles({img:v,width:E,height:E,x:u-g,y:f-g})}else{var E=g/2,w=(0,_t.Z)(v)?v:n.getSymbol(v);x.styles((0,_.pi)({d:w==null?void 0:w(u,f,E)},y))}})})},n.MARKER_SYMBOL_MAP=new Map,n.registerSymbol=function(r,s){n.MARKER_SYMBOL_MAP.set(r,s)},n.getSymbol=function(r){return n.MARKER_SYMBOL_MAP.get(r)},n.getSymbols=function(){return Array.from(n.MARKER_SYMBOL_MAP.keys())},n}(Ve);pe.registerSymbol("cross",mL),pe.registerSymbol("hyphen",EL),pe.registerSymbol("line",lx),pe.registerSymbol("plus",xL),pe.registerSymbol("tick",bL),pe.registerSymbol("circle",ox),pe.registerSymbol("point",hL),pe.registerSymbol("bowtie",yL),pe.registerSymbol("hexagon",gL),pe.registerSymbol("square",fL),pe.registerSymbol("diamond",dL),pe.registerSymbol("triangle",vL),pe.registerSymbol("triangle-down",pL),pe.registerSymbol("line",lx),pe.registerSymbol("dot",cx),pe.registerSymbol("dash",wL),pe.registerSymbol("smooth",SL),pe.registerSymbol("hv",ML),pe.registerSymbol("vh",TL),pe.registerSymbol("hvh",CL),pe.registerSymbol("vhv",OL),pe.registerSymbol("focus",_L);function nG(a,n,r){var s=Math.round((a-r)/n);return r+s*n}function RL(a,n,r){var s=1.4,l=s*r;return[["M",a-r,n-l],["L",a+r,n-l],["L",a+r,n+l],["L",a-r,n+l],["Z"]]}var ux=1.4,hx=.4;function LL(a,n,r){var s=r,l=s*ux,u=s/2,h=s/6,f=a+l*hx;return[["M",a,n],["L",f,n+u],["L",a+l,n+u],["L",a+l,n-u],["L",f,n-u],["Z"],["M",f,n+h],["L",a+l-2,n+h],["M",f,n-h],["L",a+l-2,n-h]]}function DL(a,n,r){var s=r,l=s*ux,u=s/2,h=s/6,f=n+l*hx;return[["M",a,n],["L",a-u,f],["L",a-u,n+l],["L",a+u,n+l],["L",a+u,f],["Z"],["M",a-h,f],["L",a-h,n+l-2],["M",a+h,f],["L",a+h,n+l-2]]}pe.registerSymbol("hiddenHandle",RL),pe.registerSymbol("verticalHandle",LL),pe.registerSymbol("horizontalHandle",DL);var rG=function(a,n,r){return a===void 0&&(a="horizontal"),a==="horizontal"?n:r};function iG(a,n,r,s){var l;s===void 0&&(s=4);var u=__read(a,2),h=u[0],f=u[1],d=__read(n,2),v=d[0],p=d[1],g=__read(r,2),y=g[0],m=g[1],b=__read([v,p],2),x=b[0],E=b[1],w=E-x;return x>E&&(l=__read([E,x],2),x=l[0],E=l[1]),w>f-h?[h,f]:x<h?y===h&&m===E?[h,E]:[h,w+h]:E>f?m===f&&y===x?[x,f]:[f-w,f]:[x,E]}function Zv(a,n,r){return a===void 0&&(a="horizontal"),a==="horizontal"?n:r}function aG(a){var n=a&&a.getRenderBounds();if(!n)return{width:0,height:0};var r=n.getMax(),s=n.getMin();return{width:r[0]-s[0],height:r[1]-s[1]}}function fx(a){var n=a.getLocalBounds(),r=n.min,s=n.max,l=(0,_.CR)([r,s],2),u=(0,_.CR)(l[0],2),h=u[0],f=u[1],d=(0,_.CR)(l[1],2),v=d[0],p=d[1];return{x:h,y:f,width:v-h,height:p-f,left:h,bottom:p,top:f,right:v}}function sG(a,n){var r=select(a).append("text").node();return r.attr(__assign(__assign({},n),{visibility:"hidden"})),r}function IL(a,n){var r=(0,_.CR)(a,2),s=r[0],l=r[1],u=(0,_.CR)(n,2),h=u[0],f=u[1];return s!==h&&l===f}function oG(a,n){var r=__read(a,2),s=r[0],l=r[1],u=__read(n,2),h=u[0],f=u[1];return s===h&&l!==f}function BL(a,n){var r,s,l=n.attributes;try{for(var u=(0,_.XA)(Object.entries(l)),h=u.next();!h.done;h=u.next()){var f=(0,_.CR)(h.value,2),d=f[0],v=f[1];d!=="id"&&d!=="className"&&a.attr(d,v)}}catch(p){r={error:p}}finally{try{h&&!h.done&&(s=u.return)&&s.call(u)}finally{if(r)throw r.error}}}function ji(a){return typeof a=="function"?a():(0,ve.Z)(a)||(0,se.Z)(a)?new Iv({style:{text:String(a)}}):a}function FL(a,n){return typeof a=="function"?a():(0,ve.Z)(a)||(0,se.Z)(a)?new $a({style:(0,_.pi)((0,_.pi)({pointerEvents:"auto"},n),{innerHTML:a})}):a}var Mh,Gv;function lG(a){Gv=a}var zL=wv(function(a,n){var r=n.fontSize,s=n.fontFamily,l=n.fontWeight,u=n.fontStyle,h=n.fontVariant;return Gv?Gv(a,r):(Mh||(Mh=st.offscreenCanvasCreator.getOrCreateContext(void 0)),Mh.font=[u,h,l,"".concat(r,"px"),s].join(" "),Mh.measureText(a).width)},function(a,n){return[a,Object.values(n||dx(a)).join()].join("")},4096),dx=function(a){var n=a.style.fontFamily||"sans-serif",r=a.style.fontWeight||"normal",s=a.style.fontStyle||"normal",l=a.style.fontVariant,u=a.style.fontSize;return u=typeof u=="object"?u.value:u,{fontSize:u,fontFamily:n,fontWeight:r,fontStyle:s,fontVariant:l}};function vx(a){return a.nodeName==="text"?a:a.nodeName==="g"&&a.children.length===1&&a.children[0].nodeName==="text"?a.children[0]:null}function px(a,n){var r=vx(a);r&&r.attr(n)}function Wv(a,n,r){r===void 0&&(r="..."),px(a,{wordWrap:!0,wordWrapWidth:n,maxLines:1,textOverflow:r})}function jv(a,n){for(var r in n)n.hasOwnProperty(r)&&r!=="constructor"&&n[r]!==void 0&&(a[r]=n[r])}function ZL(a,n,r,s){return n&&jv(a,n),r&&jv(a,r),s&&jv(a,s),a}function GL(a){return a instanceof Element||a instanceof Document}var Ut,WL="component-poptip",jt={CONTAINER:"component-poptip",ARROW:"component-poptip-arrow",TEXT:"component-poptip-text"},gx=(Ut={},Ut[".".concat(jt.CONTAINER)]={visibility:"visible",position:"absolute","background-color":"rgba(0, 0, 0)","box-shadow":"0px 0px 10px #aeaeae","border-radius":"3px",color:"#fff",opacity:.8,"font-size":"12px",padding:"4px 6px",display:"flex","justify-content":"center","align-items":"center","z-index":8,transition:"visibility 50ms"},Ut[".".concat(jt.TEXT)]={"text-align":"center"},Ut[".".concat(jt.CONTAINER,"[data-position='top']")]={transform:"translate(-50%, -100%)"},Ut[".".concat(jt.CONTAINER,"[data-position='left']")]={transform:"translate(-100%, -50%)"},Ut[".".concat(jt.CONTAINER,"[data-position='right']")]={transform:"translate(0, -50%)"},Ut[".".concat(jt.CONTAINER,"[data-position='bottom']")]={transform:"translate(-50%, 0)"},Ut[".".concat(jt.CONTAINER,"[data-position='top-left']")]={transform:"translate(0,-100%)"},Ut[".".concat(jt.CONTAINER,"[data-position='top-right']")]={transform:"translate(-100%,-100%)"},Ut[".".concat(jt.CONTAINER,"[data-position='left-top']")]={transform:"translate(-100%, 0)"},Ut[".".concat(jt.CONTAINER,"[data-position='left-bottom']")]={transform:"translate(-100%, -100%)"},Ut[".".concat(jt.CONTAINER,"[data-position='right-top']")]={transform:"translate(0, 0)"},Ut[".".concat(jt.CONTAINER,"[data-position='right-bottom']")]={transform:"translate(0, -100%)"},Ut[".".concat(jt.CONTAINER,"[data-position='bottom-left']")]={transform:"translate(0, 0)"},Ut[".".concat(jt.CONTAINER,"[data-position='bottom-right']")]={transform:"translate(-100%, 0)"},Ut[".".concat(jt.ARROW)]={width:"4px",height:"4px",transform:"rotate(45deg)","background-color":"rgba(0, 0, 0)",position:"absolute","z-index":-1},Ut[".".concat(jt.CONTAINER,"[data-position='top']")]={transform:"translate(-50%, calc(-100% - 5px))"},Ut["[data-position='top'] .".concat(jt.ARROW)]={bottom:"-2px"},Ut[".".concat(jt.CONTAINER,"[data-position='left']")]={transform:"translate(calc(-100% - 5px), -50%)"},Ut["[data-position='left'] .".concat(jt.ARROW)]={right:"-2px"},Ut[".".concat(jt.CONTAINER,"[data-position='right']")]={transform:"translate(5px, -50%)"},Ut["[data-position='right'] .".concat(jt.ARROW)]={left:"-2px"},Ut[".".concat(jt.CONTAINER,"[data-position='bottom']")]={transform:"translate(-50%, 5px)"},Ut["[data-position='bottom'] .".concat(jt.ARROW)]={top:"-2px"},Ut[".".concat(jt.CONTAINER,"[data-position='top-left']")]={transform:"translate(0, calc(-100% - 5px))"},Ut["[data-position='top-left'] .".concat(jt.ARROW)]={left:"10px",bottom:"-2px"},Ut[".".concat(jt.CONTAINER,"[data-position='top-right']")]={transform:"translate(-100%, calc(-100% - 5px))"},Ut["[data-position='top-right'] .".concat(jt.ARROW)]={right:"10px",bottom:"-2px"},Ut[".".concat(jt.CONTAINER,"[data-position='left-top']")]={transform:"translate(calc(-100% - 5px), 0)"},Ut["[data-position='left-top'] .".concat(jt.ARROW)]={right:"-2px",top:"8px"},Ut[".".concat(jt.CONTAINER,"[data-position='left-bottom']")]={transform:"translate(calc(-100% - 5px), -100%)"},Ut["[data-position='left-bottom'] .".concat(jt.ARROW)]={right:"-2px",bottom:"8px"},Ut[".".concat(jt.CONTAINER,"[data-position='right-top']")]={transform:"translate(5px, 0)"},Ut["[data-position='right-top'] .".concat(jt.ARROW)]={left:"-2px",top:"8px"},Ut[".".concat(jt.CONTAINER,"[data-position='right-bottom']")]={transform:"translate(5px, -100%)"},Ut["[data-position='right-bottom'] .".concat(jt.ARROW)]={left:"-2px",bottom:"8px"},Ut[".".concat(jt.CONTAINER,"[data-position='bottom-left']")]={transform:"translate(0, 5px)"},Ut["[data-position='bottom-left'] .".concat(jt.ARROW)]={top:"-2px",left:"8px"},Ut[".".concat(jt.CONTAINER,"[data-position='bottom-right']")]={transform:"translate(-100%, 5px)"},Ut["[data-position='bottom-right'] .".concat(jt.ARROW)]={top:"-2px",right:"8px"},Ut),jL=void 0;function VL(a,n,r,s,l,u){if(l===void 0&&(l=!1),u===void 0&&(u=!1),u)return[a,n];var h=r.getBoundingClientRect(),f=h.x,d=h.y,v=h.width,p=h.height;switch(s){case"top":return l?[f+v/2,d]:[a,d];case"left":return l?[f,d+p/2]:[f,n];case"bottom":return l?[f+v/2,d+p]:[a,d+p];case"right":return l?[f+v,d+p/2]:[f+v,n];case"top-right":case"right-top":return[f+v,d];case"left-bottom":case"bottom-left":return[f,d+p];case"right-bottom":case"bottom-right":return[f+v,d+p];case"top-left":case"left-top":default:return[f,d]}}var HL=function(a){var n;return function(){for(var r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];return n||(n=a.apply(jL,r)),n}};function $L(a){var n=a&&document.getElementById(a);return n||(n=document.createElement("div"),n.setAttribute("id",a),document.body.appendChild(n)),n}function UL(a){var n=HL($L)(a);return n}var YL=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,(0,jn.Z)({style:{id:WL}},n.defaultOptions,r))||this;return s.visibility="visible",s.map=new Map,s.domStyles="",s.initShape(),s.render(s.attributes,s),s}return Object.defineProperty(n.prototype,"visible",{get:function(){return this.visibility==="visible"},enumerable:!1,configurable:!0}),n.prototype.render=function(r,s){this.visibility=this.style.visibility,this.updatePoptipElement()},n.prototype.update=function(r){this.attr((0,jn.Z)({},this.style,r)),this.render(this.attributes,this)},n.prototype.bind=function(r,s){var l=this;if(r){var u=this.style.text,h=function(d){var v=r,p=l.style,g=u;if(s){var y=typeof s=="function"?s.call(null,d):s,m=y.html,b=y.target,x=(0,_._T)(y,["html","target"]);p=ZL({},l.style,x),(b||b===!1)&&(v=b),typeof m=="string"&&(g=m)}var E=p.position,w=p.arrowPointAtCenter,S=p.follow,M=p.offset;if(v){var C=d,T=C.clientX,O=C.clientY,k=(0,_.CR)(VL(T,O,v,E,w,S),2),P=k[0],A=k[1];l.showTip(P,A,{text:g,position:E,offset:M})}else l.hideTip()},f=function(){l.hideTip()};r.addEventListener("mousemove",h),r.addEventListener("mouseleave",f),this.map.set(r,[h,f])}},n.prototype.unbind=function(r){if(this.map.has(r)){var s=(0,_.CR)(this.map.get(r)||[],2),l=s[0],u=s[1];l&&r.removeEventListener("mousemove",l),u&&r.removeEventListener("mouseleave",u),this.map.delete(r)}},n.prototype.clear=function(){this.container.innerHTML=""},n.prototype.destroy=function(){var r=this,s;(0,_.ev)([],(0,_.CR)(this.map.keys()),!1).forEach(function(l){return r.unbind(l)}),(s=this.container)===null||s===void 0||s.remove(),a.prototype.destroy.call(this)},n.prototype.showTip=function(r,s,l){var u=Tn(l,"text");if(!(u&&typeof u!="string")&&(this.applyStyles(),r&&s&&l)){var h=l.offset,f=l.position;if(f&&this.container.setAttribute("data-position",f),this.setOffsetPosition(r,s,h),typeof u=="string"){var d=this.container.querySelector(".".concat(jt.TEXT));d&&(d.innerHTML=u)}this.visibility="visible",this.container.style.visibility="visible"}},n.prototype.hideTip=function(){this.visibility="hidden",this.container.style.visibility="hidden"},n.prototype.getContainer=function(){return this.container},n.prototype.getClassName=function(){var r=this.style.containerClassName;return"".concat(jt.CONTAINER).concat(r?" ".concat(r):"")},n.prototype.initShape=function(){var r=this,s=this.style.id;this.container=UL(s),this.container.className=this.getClassName(),this.container.addEventListener("mousemove",function(){return r.showTip()}),this.container.addEventListener("mouseleave",function(){return r.hideTip()})},n.prototype.updatePoptipElement=function(){var r=this.container;this.clear();var s=this.style,l=s.id,u=s.template,h=s.text;this.container.setAttribute("id",l),this.container.className=this.getClassName();var f='<span class="'.concat(jt.ARROW,'"></span>');r.innerHTML=f,(0,ve.Z)(u)?r.innerHTML+=u:u&&GL(u)&&r.appendChild(u),h&&(r.getElementsByClassName(jt.TEXT)[0].textContent=h),this.applyStyles(),this.container.style.visibility=this.visibility},n.prototype.applyStyles=function(){var r=cn({},gx,this.style.domStyles),s=Object.entries(r).reduce(function(u,h){var f=(0,_.CR)(h,2),d=f[0],v=f[1],p=Object.entries(v).reduce(function(g,y){var m=(0,_.CR)(y,2),b=m[0],x=m[1];return"".concat(g).concat(b,": ").concat(x,";")},"");return"".concat(u).concat(d,"{").concat(p,"}")},"");if(this.domStyles!==s){this.domStyles=s;var l=this.container.querySelector("style");l&&this.container.removeChild(l),l=document.createElement("style"),l.innerHTML=s,this.container.appendChild(l)}},n.prototype.setOffsetPosition=function(r,s,l){l===void 0&&(l=this.style.offset);var u=(0,_.CR)(l,2),h=u[0],f=h===void 0?0:h,d=u[1],v=d===void 0?0:d;this.container.style.left="".concat(r+f,"px"),this.container.style.top="".concat(s+v,"px")},n.tag="poptip",n.defaultOptions={style:{x:0,y:0,width:0,height:0,target:null,visibility:"hidden",text:"",position:"top",follow:!1,offset:[0,0],domStyles:gx,template:'<div class="'.concat(jt.TEXT,'"></div>')}},n}(Ve),un=ti({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",focusGroup:"focus-group",focus:"focus",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item"),XL={offset:[0,20],domStyles:{".component-poptip":{opacity:"1",padding:"8px 12px",background:"#fff",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)"},".component-poptip-arrow":{display:"none"},".component-poptip-text":{color:"#000",lineHeight:"20px"}}};function qL(a){var n=a.querySelector(un.marker.class);return n?n.style:{}}var KL=function(a){(0,_.ZT)(n,a);function n(r,s){var l=a.call(this,r,{span:[1,1],marker:function(){return new gi({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this;return l.keyFields={},l.keyFields=s||{},l}return Object.defineProperty(n.prototype,"showValue",{get:function(){var r=this.attributes.valueText;return r?typeof r=="string"||typeof r=="number"?r!=="":typeof r=="function"?!0:r.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"actualSpace",{get:function(){var r=this.labelGroup,s=this.valueGroup,l=this.attributes,u=l.markerSize,h=l.focus,f=l.focusMarkerSize,d=r.node().getBBox(),v=d.width,p=d.height,g=s.node().getBBox(),y=g.width,m=g.height,b=h?f!=null?f:12:0;return{markerWidth:u,labelWidth:v,valueWidth:y,focusWidth:b,height:Math.max(u,p,m)}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"span",{get:function(){var r=this.attributes.span;if(!r)return[1,1];var s=(0,_.CR)(Cn(r),2),l=s[0],u=s[1],h=this.showValue?u:0,f=l+h;return[l/f,h/f]},enumerable:!1,configurable:!0}),n.prototype.setAttribute=function(r,s){a.prototype.setAttribute.call(this,r,s)},Object.defineProperty(n.prototype,"shape",{get:function(){var r,s=this.attributes,l=s.markerSize,u=s.width,h=this.actualSpace,f=h.markerWidth,d=h.focusWidth,v=h.height,p=this.actualSpace,g=p.labelWidth,y=p.valueWidth,m=(0,_.CR)(this.spacing,3),b=m[0],x=m[1],E=m[2];if(u){var w=u-l-b-x-d-E,S=(0,_.CR)(this.span,2),M=S[0],C=S[1];r=(0,_.CR)([M*w,C*w],2),g=r[0],y=r[1]}var T=f+g+y+b+x+d+E;return{width:T,height:v,markerWidth:f,labelWidth:g,valueWidth:y,focusWidth:d}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"spacing",{get:function(){var r=this.attributes,s=r.spacing,l=r.focus;if(!s)return[0,0,0];var u=(0,_.CR)(Cn(s),3),h=u[0],f=u[1],d=u[2];return[h,this.showValue?f:0,l?d:0]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layout",{get:function(){var r=this.shape,s=r.markerWidth,l=r.labelWidth,u=r.valueWidth,h=r.focusWidth,f=r.width,d=r.height,v=(0,_.CR)(this.spacing,3),p=v[0],g=v[1],y=v[2];return{height:d,width:f,markerWidth:s,labelWidth:l,valueWidth:u,focusWidth:h,position:[s/2,s+p,s+l+p+g,s+l+u+p+g+y+h/2]}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"scaleSize",{get:function(){var r=qL(this.markerGroup.node()),s=this.attributes,l=s.markerSize,u=s.markerStrokeWidth,h=u===void 0?r.strokeWidth:u,f=s.markerLineWidth,d=f===void 0?r.lineWidth:f,v=s.markerStroke,p=v===void 0?r.stroke:v,g=+(h||d||(p?1:0))*Math.sqrt(2),y=this.markerGroup.node().getBBox(),m=y.width,b=y.height;return(1-g/Math.max(m,b))*l},enumerable:!1,configurable:!0}),n.prototype.renderMarker=function(r){var s=this,l=this.attributes,u=l.marker,h=l.classNamePrefix,f=Wt(this.attributes,"marker");this.markerGroup=r.maybeAppendByClassName(un.markerGroup,"g").style("zIndex",0),or(!!u,this.markerGroup,function(){var d,v=s.markerGroup.node(),p=(d=v.childNodes)===null||d===void 0?void 0:d[0],g=In(un.marker.name,Un.marker,h),y=typeof u=="string"?new pe({style:{symbol:u},className:g}):u();if(p)if(y.nodeName===p.nodeName)p instanceof pe?p.update((0,_.pi)((0,_.pi)({},f),{symbol:u})):(BL(p,y),Tt(p).styles(f));else{if(p.remove(),!(y instanceof pe)){var b=In(un.marker.name,Un.marker,h);y.className=b}Tt(y).styles(f),v.appendChild(y)}else{if(!(y instanceof pe)){var m=In(un.marker.name,Un.marker,h);y.className=m,Tt(y).styles(f)}v.appendChild(y)}s.markerGroup.node().scale(1/s.markerGroup.node().getScale()[0]);var x=zv(s.markerGroup.node(),s.scaleSize,!0);s.markerGroup.node().style._transform="scale(".concat(x,")")})},n.prototype.renderLabel=function(r){var s=Wt(this.attributes,"label"),l=s.text,u=(0,_._T)(s,["text"]),h=this.attributes.classNamePrefix;this.labelGroup=r.maybeAppendByClassName(un.labelGroup,"g").style("zIndex",0);var f=In(un.label.name,Un.label,h),d=this.labelGroup.maybeAppendByClassName(un.label,function(){return ji(l)});d.node().setAttribute("class",f),d.styles(u)},n.prototype.renderValue=function(r){var s=this,l=Wt(this.attributes,"value"),u=l.text,h=(0,_._T)(l,["text"]),f=this.attributes.classNamePrefix;this.valueGroup=r.maybeAppendByClassName(un.valueGroup,"g").style("zIndex",0),or(this.showValue,this.valueGroup,function(){var d=In(un.value.name,Un.value,f),v=s.valueGroup.maybeAppendByClassName(un.value,function(){return ji(u)});v.node().setAttribute("class",d),v.styles(h)})},n.prototype.createPoptip=function(){var r=this.attributes.poptip,s=r||{},l=s.render,u=(0,_._T)(s,["render"]),h=new YL({style:cn(XL,u)});return this.poptipGroup=h,h},n.prototype.bindPoptip=function(r){var s=this,l=this.attributes.poptip;if(l){var u=this.poptipGroup||this.createPoptip();u.bind(r,function(){var h=s.attributes,f=h.labelText,d=h.valueText,v=h.markerFill,p=typeof f=="string"?f:f==null?void 0:f.attr("text"),g=typeof d=="string"?d:d==null?void 0:d.attr("text");if(typeof l.render=="function")return{html:l.render((0,_.pi)((0,_.pi)({},s.keyFields),{label:p,value:g,color:v}))};var y="";return(typeof p=="string"||typeof p=="number")&&(y+='<div class="component-poptip-label">'.concat(p,"</div>")),(typeof g=="string"||typeof g=="number")&&(y+='<div class="component-poptip-value">'.concat(g,"</div>")),{html:y}})}},n.prototype.renderFocus=function(r){var s=this,l=this.attributes,u=l.focus,h=l.focusMarkerSize,f=l.classNamePrefix,d={x:0,y:0,size:h,opacity:.6,symbol:"focus",stroke:"#aaaaaa",lineWidth:1};Ft(u)||(this.focusGroup=r.maybeAppendByClassName(un.focusGroup,"g").style("zIndex",0),or(u,this.focusGroup,function(){var v=In(un.focus.name,Un.focusIcon,f),p=new pe({style:(0,_.pi)((0,_.pi)({},d),{symbol:"focus"}),className:v}),g=new gi({style:{r:d.size/2,fill:"transparent"}}),y=s.focusGroup.node();y.appendChild(g),y.appendChild(p),p.update({opacity:0}),r.node().addEventListener("pointerenter",function(){p.update({opacity:1})}),r.node().addEventListener("pointerleave",function(){p.update({opacity:0})})}))},n.prototype.renderPoptip=function(r){var s=this,l=this.attributes.poptip;if(l){var u=r.maybeAppendByClassName(un.value,"g").node(),h=r.maybeAppendByClassName(un.label,"g").node();[u,h].forEach(function(f){f&&s.bindPoptip(f)})}},n.prototype.renderBackground=function(r){var s=this.shape,l=s.width,u=s.height,h=Wt(this.attributes,"background");this.background=r.maybeAppendByClassName(un.backgroundGroup,"g").style("zIndex",-1);var f=this.background.maybeAppendByClassName(un.background,"rect");f.styles((0,_.pi)({width:l,height:u},h));var d=this.attributes.classNamePrefix,v=d===void 0?"":d;if(v){var p=In(un.background.name,Un.background,v);f.node().setAttribute("class",p)}},n.prototype.adjustLayout=function(){var r=this.layout,s=r.labelWidth,l=r.valueWidth,u=r.height,h=(0,_.CR)(r.position,4),f=h[0],d=h[1],v=h[2],p=h[3],g=u/2;this.markerGroup.styles({transform:"translate(".concat(f,", ").concat(g,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(d,", ").concat(g,")")}),this.focusGroup&&this.focusGroup.styles({transform:"translate(".concat(p,", ").concat(g,")")}),Wv(this.labelGroup.select(un.label.class).node(),Math.ceil(s)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(v,", ").concat(g,")")}),Wv(this.valueGroup.select(un.value.class).node(),Math.ceil(l)))},n.prototype.render=function(r,s){var l=Tt(s),u=r.x,h=u===void 0?0:u,f=r.y,d=f===void 0?0:f;l.styles({transform:"translate(".concat(h,", ").concat(d,")")}),this.renderMarker(l),this.renderLabel(l),this.renderValue(l),this.renderBackground(l),this.renderPoptip(l),this.renderFocus(l),this.adjustLayout()},n}(Ve),hs=ti({page:"item-page",navigator:"navigator",item:"item"},"items"),yx=function(a,n,r){return r===void 0&&(r=!0),a?n(a):r},QL=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,r,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:Fv,mouseenter:Fv,mouseleave:Fv})||this;return s.navigatorShape=[0,0],s}return Object.defineProperty(n.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"grid",{get:function(){var r=this.attributes,s=r.gridRow,l=r.gridCol,u=r.data;if(!s&&!l)throw new Error("gridRow and gridCol can not be set null at the same time");return s&&l?[s,l]:s?[s,u.length]:[u.length,l]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"renderData",{get:function(){var r=this.attributes,s=r.data,l=r.layout,u=r.poptip,h=r.focus,f=r.focusMarkerSize,d=r.classNamePrefix,v=Wt(this.attributes,"item"),p=s.map(function(g,y){var m=g.id,b=m===void 0?y:m,x=g.label,E=g.value;return{id:"".concat(b),index:y,style:(0,_.pi)({layout:l,labelText:x,valueText:E,poptip:u,focus:h,focusMarkerSize:f,classNamePrefix:d},Object.fromEntries(Object.entries(v).map(function(w){var S=(0,_.CR)(w,2),M=S[0],C=S[1];return[M,lr(C,[g,y,s])]})))}});return p},enumerable:!1,configurable:!0}),n.prototype.getGridLayout=function(){var r=this,s=this.attributes,l=s.orientation,u=s.width,h=s.rowPadding,f=s.colPadding,d=(0,_.CR)(this.navigatorShape,1),v=d[0],p=(0,_.CR)(this.grid,2),g=p[0],y=p[1],m=y*g,b=0;return this.pageViews.children.map(function(x,E){var w,S,M=Math.floor(E/m),C=E%m,T=r.ifHorizontal(y,g),O=[Math.floor(C/T),C%T];l==="vertical"&&O.reverse();var k=(0,_.CR)(O,2),P=k[0],A=k[1],N=(u-v-(y-1)*f)/y,L=x.getBBox().height,R=(0,_.CR)([0,0],2),z=R[0],Z=R[1];return l==="horizontal"?(w=(0,_.CR)([b,P*(L+h)],2),z=w[0],Z=w[1],b=A===y-1?0:b+N+f):(S=(0,_.CR)([A*(N+f),b],2),z=S[0],Z=S[1],b=P===g-1?0:b+L+h),{page:M,index:E,row:P,col:A,pageIndex:C,width:N,height:L,x:z,y:Z}})},n.prototype.getFlexLayout=function(){var r=this.attributes,s=r.width,l=r.height,u=r.rowPadding,h=r.colPadding,f=(0,_.CR)(this.navigatorShape,1),d=f[0],v=(0,_.CR)(this.grid,2),p=v[0],g=v[1],y=(0,_.CR)([s-d,l],2),m=y[0],b=y[1],x=(0,_.CR)([0,0,0,0,0,0,0,0],8),E=x[0],w=x[1],S=x[2],M=x[3],C=x[4],T=x[5],O=x[6],k=x[7];return this.pageViews.children.map(function(P,A){var N,L,R,z,Z=P.getBBox(),X=Z.width,nt=Z.height,K=O===0?0:h,rt=O+K+X;if(rt<=m&&yx(C,function(at){return at<g}))return N=(0,_.CR)([O+K,k,rt],3),E=N[0],w=N[1],O=N[2],{width:X,height:nt,x:E,y:w,page:S,index:A,pageIndex:M++,row:T,col:C++};L=(0,_.CR)([T+1,0,0,k+nt+u],4),T=L[0],C=L[1],O=L[2],k=L[3];var U=k+nt;return U<=b&&yx(T,function(at){return at<p})?(R=(0,_.CR)([O,k,X],3),E=R[0],w=R[1],O=R[2],{width:X,height:nt,x:E,y:w,page:S,index:A,pageIndex:M++,row:T,col:C++}):(z=(0,_.CR)([0,0,X,0,S+1,0,0,0],8),E=z[0],w=z[1],O=z[2],k=z[3],S=z[4],M=z[5],T=z[6],C=z[7],{width:X,height:nt,x:E,y:w,page:S,index:A,pageIndex:M++,row:T,col:C++})})},Object.defineProperty(n.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var r=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,s=r.call(this);return s.slice(-1)[0].page>0?(this.navigatorShape=[55,0],r.call(this)):s},enumerable:!1,configurable:!0}),n.prototype.ifHorizontal=function(r,s){var l=this.attributes.orientation;return Zv(l,r,s)},n.prototype.flattenPage=function(r){r.querySelectorAll(hs.item.class).forEach(function(s){r.appendChild(s)}),r.querySelectorAll(hs.page.class).forEach(function(s){var l=r.removeChild(s);l.destroy()})},n.prototype.renderItems=function(r){var s=this.attributes,l=s.click,u=s.mouseenter,h=s.mouseleave,f=s.classNamePrefix;this.flattenPage(r);var d=this.dispatchCustomEvent.bind(this),v=In(hs.item.name,Un.item,f);Tt(r).selectAll(hs.item.class).data(this.renderData,function(p){return p.id}).join(function(p){return p.append(function(g){var y=g.style,m=(0,_._T)(g,["style"]);return new KL({style:y},m)}).attr("className",v).on("click",function(){l==null||l(this),d("itemClick",{item:this})}).on("pointerenter",function(){u==null||u(this),d("itemMouseenter",{item:this})}).on("pointerleave",function(){h==null||h(this),d("itemMouseleave",{item:this})})},function(p){return p.each(function(g){var y=g.style;this.update(y)})},function(p){return p.remove()})},n.prototype.relayoutNavigator=function(){var r,s=this.attributes,l=s.layout,u=s.width,h=((r=this.pageViews.children[0])===null||r===void 0?void 0:r.getBBox().height)||0,f=(0,_.CR)(this.navigatorShape,2),d=f[0],v=f[1];this.navigator.update(l==="grid"?{pageWidth:u-d,pageHeight:h-v}:{})},n.prototype.adjustLayout=function(){var r=this,s=Object.entries(aL(this.itemsLayout,"page")).map(function(u){var h=(0,_.CR)(u,2),f=h[0],d=h[1];return{page:f,layouts:d}}),l=(0,_.ev)([],(0,_.CR)(this.navigator.getContainer().children),!1);s.forEach(function(u){var h=u.layouts,f=r.pageViews.appendChild(new vn({className:hs.page.name}));h.forEach(function(d){var v=d.x,p=d.y,g=d.index,y=d.width,m=d.height,b=l[g];f.appendChild(b),el(b,"__layout__",d),b.update({x:v,y:p,width:y,height:m})})}),this.relayoutNavigator()},n.prototype.renderNavigator=function(r){var s=this.attributes,l=s.orientation,u=s.classNamePrefix,h=Wt(this.attributes,"nav"),f=cn({orientation:l,classNamePrefix:u},h),d=this;return r.selectAll(hs.navigator.class).data(["nav"]).join(function(v){return v.append(function(){return new PL({style:f})}).attr("className",hs.navigator.name).each(function(){d.navigator=this})},function(v){return v.each(function(){this.update(f)})},function(v){return v.remove()}),this.navigator},n.prototype.getBBox=function(){return this.navigator.getBBox()},n.prototype.render=function(r,s){var l=this.attributes.data;if(!(!l||l.length===0)){var u=this.renderNavigator(Tt(s));this.renderItems(u.getContainer()),this.adjustLayout()}},n.prototype.dispatchCustomEvent=function(r,s){var l=new sn(r,{detail:s});this.dispatchEvent(l)},n}(Ve),fs=ti({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),mx={showLabel:!0,formatter:function(a){return a.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0},cG=function(a){(0,_.ZT)(n,a);function n(r){return a.call(this,r,mx)||this}return n.prototype.render=function(r,s){var l=Tt(s).maybeAppendByClassName(fs.markerGroup,"g");this.renderMarker(l);var u=Tt(s).maybeAppendByClassName(fs.labelGroup,"g");this.renderLabel(u)},n.prototype.renderMarker=function(r){var s=this,l=this.attributes,u=l.orientation,h=l.classNamePrefix,f=l.markerSymbol,d=f===void 0?Zv(u,"horizontalHandle","verticalHandle"):f;or(!!d,r,function(v){var p=Wt(s.attributes,"marker"),g=(0,_.pi)({symbol:d},p),y=In(fs.marker.name,Un.handleMarker,h);if(s.marker=v.maybeAppendByClassName(fs.marker,function(){return new pe({style:g,className:y})}).update(g),h){var m=s.marker.node().querySelector(".marker");if(m){var b=m.getAttribute("class")||"",x=b.split(" ")[0],E=In(x,Un.handleMarker,h);m.setAttribute("class",E)}}})},n.prototype.renderLabel=function(r){var s=this,l=this.attributes,u=l.showLabel,h=l.orientation,f=l.spacing,d=f===void 0?0:f,v=l.formatter,p=l.classNamePrefix;or(u,r,function(g){var y,m=Wt(s.attributes,"label"),b=m.text,x=(0,_._T)(m,["text"]),E=((y=g.select(fs.marker.class))===null||y===void 0?void 0:y.node().getBBox())||{},w=E.width,S=w===void 0?0:w,M=E.height,C=M===void 0?0:M,T=(0,_.CR)(Zv(h,[0,C+d,"center","top"],[S+d,0,"start","middle"]),4),O=T[0],k=T[1],P=T[2],A=T[3],N=In(fs.label.name,Un.handleLabel,p);g.maybeAppendByClassName(fs.label,"text").attr("className",N).styles((0,_.pi)((0,_.pi)({},x),{x:O,y:k,text:v(b).toString(),textAlign:P,textBaseline:A}))})},n}(Ve),bx={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},JL=cn({},bx,{}),uG=cn({},bx,Ys(mx,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"}),hG=.01,fG=.5,ds=ti({title:"title",html:"html",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend"),tD=function(a){(0,_.ZT)(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return n.prototype.update=function(r){this.attr(r)},n}($a),eD=function(a){(0,_.ZT)(n,a);function n(r){return a.call(this,r,JL)||this}return n.prototype.renderTitle=function(r,s,l){var u=this.attributes,h=u.showTitle,f=u.titleText,d=u.classNamePrefix,v=Wt(this.attributes,"title"),p=(0,_.CR)(Wi(v),2),g=p[0],y=p[1];this.titleGroup=r.maybeAppendByClassName(ds.titleGroup,"g").styles(y);var m=(0,_.pi)((0,_.pi)({width:s,height:l},g),{text:h?f:"",classNamePrefix:d});this.title=this.titleGroup.maybeAppendByClassName(ds.title,function(){return new iL({style:m})}).update(m)},n.prototype.renderCustom=function(r){var s=this.attributes.data,l={innerHTML:this.attributes.render(s),pointerEvents:"auto"};r.maybeAppendByClassName(ds.html,function(){return new tD({className:ds.html.name,style:l})}).update(l)},n.prototype.renderItems=function(r,s){var l=s.x,u=s.y,h=s.width,f=s.height,d=Wt(this.attributes,"title",!0),v=(0,_.CR)(Wi(d),2),p=v[0],g=v[1],y=(0,_.pi)((0,_.pi)({},p),{width:h,height:f,x:0,y:0});this.itemsGroup=r.maybeAppendByClassName(ds.itemsGroup,"g").styles((0,_.pi)((0,_.pi)({},g),{transform:"translate(".concat(l,", ").concat(u,")")}));var m=this;this.itemsGroup.selectAll(ds.items.class).data(["items"]).join(function(b){return b.append(function(){return new QL({style:y})}).attr("className",ds.items.name).each(function(){m.items=Tt(this)})},function(b){return b.update(y)},function(b){return b.remove()})},n.prototype.adjustLayout=function(){var r=this.attributes.showTitle;if(r){var s=this.title.node().getAvailableSpace(),l=s.x,u=s.y;this.itemsGroup.node().style.transform="translate(".concat(l,", ").concat(u,")")}},Object.defineProperty(n.prototype,"availableSpace",{get:function(){var r=this.attributes,s=r.showTitle,l=r.width,u=r.height;return s?this.title.node().getAvailableSpace():new Dn(0,0,l,u)},enumerable:!1,configurable:!0}),n.prototype.getBBox=function(){var r,s,l=(r=this.title)===null||r===void 0?void 0:r.node(),u=(s=this.items)===null||s===void 0?void 0:s.node();return!l||!u?a.prototype.getBBox.call(this):eL(l,u)},n.prototype.render=function(r,s){var l=this.attributes,u=l.width,h=l.height,f=l.x,d=f===void 0?0:f,v=l.y,p=v===void 0?0:v,g=l.classNamePrefix,y=l.render,m=Tt(s),b=s.className||"legend-category";g?s.attr("className","".concat(b," ").concat(g,"legend")):s.className||s.attr("className","legend-category"),s.style.transform="translate(".concat(d,", ").concat(p,")"),y?this.renderCustom(m):(this.renderTitle(m,u,h),this.renderItems(m,this.availableSpace),this.adjustLayout())},n}(Ve);function Th(a){const{width:n,height:r,renderer:s}=a,l=nD(a),u=new yd({width:n,height:r,container:l,renderer:s||new sl});return[l,u]}function nD(a){var n;const{container:r,className:s,graphCanvas:l}=a;if(r)return typeof r=="string"?document.getElementById(r):r;const u=Us(s,!1),{width:h,height:f,containerStyle:d}=a,[v,p]=rD(a);return Object.assign(u.style,Object.assign({position:"absolute",left:v+"px",top:p+"px",width:h+"px",height:f+"px"},d)),(n=l.getContainer())===null||n===void 0||n.appendChild(u),u}function rD(a){const{width:n,height:r,placement:s,graphCanvas:l}=a,[u,h]=l.getSize(),[f,d]=t1(s);return[f*(u-n),d*(h-r)]}var iD=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class Hl extends ln{constructor(n,r){super(n,Object.assign({},Hl.defaultOptions,r)),this.typePrefix="__data__",this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{const{graph:s}=this.context;s.on(lt.AFTER_DRAW,this.createElement)},this.changeState=(s,l)=>{const{graph:u}=this.context,{typePrefix:h}=this,f=Tn(s,[h,"id"]),d=Tn(s,[h,"style","labelText"]),[v]=f.split("__"),p=this.fieldMap[v].get(d)||[];u.setElementState(Object.fromEntries(p==null?void 0:p.map(g=>[g,l])))},this.click=s=>{if(this.options.trigger==="hover")return;const l=Tn(s,[this.typePrefix,"id"]);this.selectedItems.includes(l)?(this.selectedItems=this.selectedItems.filter(u=>u!==l),this.changeState(s,[])):(this.selectedItems.push(l),this.changeState(s,"selected"))},this.mouseleave=s=>{this.options.trigger!=="click"&&(this.selectedItems=[],this.changeState(s,[]))},this.mouseenter=s=>{if(this.options.trigger==="click")return;const l=Tn(s,[this.typePrefix,"id"]);this.selectedItems.includes(l)?this.selectedItems=this.selectedItems.filter(u=>u!==l):(this.selectedItems.push(l),this.changeState(s,"active"))},this.setFieldMap=(s,l,u)=>{if(!s)return;const h=this.fieldMap[u];if(h)if(!h.has(s))h.set(s,[l]);else{const f=h.get(s);f&&(f.push(l),h.set(s,f))}},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(s,l)=>{if(!s)return[];const{model:u,element:h}=this.context,{nodes:f,edges:d,combos:v}=u.getData(),p={},g=E=>(0,_t.Z)(s)?s(E):s,y={node:"circle",edge:"line",combo:"rect"},m={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},b=(E,w)=>h==null?void 0:h.getElementComputedStyle(E,w),x=(E,w)=>{E.forEach(S=>{const{id:M}=S,C=Tn(S,["data",g(S)]),T=(h==null?void 0:h.getElementType(w,S))||"circle",O=b(w,S),k=(w==="edge"?O==null?void 0:O.stroke:O==null?void 0:O.fill)||"#1783ff";M&&C&&C.replace(/\s+/g,"")&&(this.setFieldMap(C,M,w),p[C]||(p[C]={id:`${w}__${M}`,label:C,marker:m[T]||y[w],elementType:w,lineWidth:1,stroke:k,fill:k}))})};switch(l){case"node":x(f,"node");break;case"edge":x(d,"edge");break;case"combo":x(v,"combo");break;default:return[]}return Object.values(p)},this.createElement=()=>{if(this.draw){this.updateElement();return}const s=this.options,{width:l,height:u,nodeField:h,edgeField:f,comboField:d,trigger:v,position:p,container:g,containerStyle:y,className:m}=s,b=iD(s,["width","height","nodeField","edgeField","comboField","trigger","position","container","containerStyle","className"]),x=this.getMarkerData(h,"node"),E=this.getMarkerData(f,"edge"),w=this.getMarkerData(d,"combo"),S=[...x,...w,...E],M=Object.assign({width:l,height:u,data:S,itemMarkerLineWidth:({lineWidth:O})=>O,itemMarker:({marker:O})=>O,itemMarkerStroke:({stroke:O})=>O,itemMarkerFill:({fill:O})=>O,gridCol:x.length},b,this.getEvents()),C=new eD({className:"legend",style:M});this.category=C,this.upsertCanvas().appendChild(C),this.draw=!0},this.bindEvents()}update(n){super.update(n),this.clear(),this.createElement()}clear(){var n,r;(n=this.canvas)===null||n===void 0||n.destroy(),(r=this.container)===null||r===void 0||r.remove(),this.canvas=void 0,this.container=void 0,this.draw=!1}updateElement(){this.category&&this.category.update({itemMarkerOpacity:({id:n})=>!this.selectedItems.length||this.selectedItems.includes(n)?1:.5,itemLabelOpacity:({id:n})=>!this.selectedItems.length||this.selectedItems.includes(n)?1:.5})}upsertCanvas(){if(this.canvas)return this.canvas;const n=this.context.canvas,[r,s]=n.getSize(),{width:l=r,height:u=s,position:h,container:f,containerStyle:d,className:v}=this.options,[p,g]=Th({width:l,height:u,graphCanvas:n,container:f,containerStyle:d,placement:h,className:"legend"});return this.container=p,v&&p.classList.add(v),this.canvas=g,this.canvas}destroy(){this.clear(),this.context.graph.off(lt.AFTER_DRAW,this.createElement),super.destroy()}}Hl.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16,width:240,height:160};class $l extends ln{constructor(n,r){super(n,Object.assign({},$l.defaultOptions,r)),this.onDraw=s=>{var l;!((l=s==null?void 0:s.data)===null||l===void 0)&&l.render||this.onRender()},this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=s=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(s.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=s=>{if(!this.mask||!this.isMaskDragging)return;const{size:[l,u]}=this.options,{movementX:h,movementY:f}=s,{left:d,top:v,width:p,height:g}=this.mask.style,[,,y,m]=this.maskBBox;let b=parseInt(d)+h,x=parseInt(v)+f,E=parseInt(p),w=parseInt(g);b<0&&(b=0),x<0&&(x=0),b+E>l&&(b=Sa(l-E,0)),x+w>u&&(x=Sa(u-w,0)),E<y&&(h>0?(b=Sa(b-h,0),E=wa(E+h,l)):h<0&&(E=wa(E-h,l))),w<m&&(f>0?(x=Sa(x-f,0),w=wa(w+f,u)):f<0&&(w=wa(w-f,u))),Object.assign(this.mask.style,{left:b+"px",top:x+"px",width:E+"px",height:w+"px"});const S=parseInt(d)-b,M=parseInt(v)-x;if(S===0&&M===0)return;const C=this.context.canvas.getCamera().getZoom(),T=this.canvas.getCamera().getZoom(),O=C/T;this.context.graph.translateBy([S*O,M*O],!1)},this.onMaskDragEnd=s=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(s.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=lm(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}),this.setOnRender(),this.bindEvents()}update(n){this.unbindEvents(),super.update(n),"delay"in n&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=El(()=>{this.renderMinimap(),this.renderMask()},this.options.delay)}bindEvents(){const{graph:n}=this.context;n.on(lt.AFTER_DRAW,this.onDraw),n.on(lt.AFTER_RENDER,this.onRender),n.on(lt.AFTER_ANIMATE,this.onRender),n.on(lt.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:n}=this.context;n.off(lt.AFTER_DRAW,this.onDraw),n.off(lt.AFTER_RENDER,this.onRender),n.off(lt.AFTER_ANIMATE,this.onRender),n.off(lt.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){const n=this.getElements(),r=this.initCanvas();this.setShapes(r,n)}getElements(){const{filter:n}=this.options,{model:r,element:s}=this.context,l=r.getData(),u={nodes:l.nodes.filter(v=>s==null?void 0:s.getElement(V(v))),edges:l.edges.filter(v=>{const p=s==null?void 0:s.getElement(V(v));return p&&ab(p)}),combos:l.combos.filter(v=>s==null?void 0:s.getElement(V(v)))};if(!n)return u;const{nodes:h,edges:f,combos:d}=u;return{nodes:h.filter(v=>n(V(v),"node")),edges:f.filter(v=>n(V(v),"edge")),combos:d.filter(v=>n(V(v),"combo"))}}setShapes(n,r){const{nodes:s,edges:l,combos:u}=r,{shape:h}=this.options,{element:f}=this.context,d=(v,p)=>{const g=V(v),y=f==null?void 0:f.getElement(g);if(!y)return;const m=y.getShape("key");let b;if(typeof h=="string"){const x=h;b=y.getShape(x).cloneNode()}else{const x=h(g,p,y);x===y?b=x.cloneNode(!0):b=x}b.setPosition(m.getPosition()),y.style.zIndex&&(b.style.zIndex=y.style.zIndex),b.id=y.id,n.appendChild(b)};n.removeChildren(),l.forEach(v=>d(v,"edge")),u.forEach(v=>d(v,"combo")),s.forEach(v=>d(v,"node"))}initCanvas(){const{renderer:n,size:[r,s]}=this.options;if(this.canvas){const{width:l,height:u}=this.canvas.getConfig();(r!==l||s!==u)&&this.canvas.resize(r,s),n&&this.canvas.setRenderer(n)}else{const{className:l,position:u,container:h,containerStyle:f}=this.options,[d,v]=Th({renderer:n,width:r,height:s,placement:u,className:"minimap",container:h,containerStyle:f,graphCanvas:this.context.canvas});l&&d.classList.add(l),this.container=d,this.canvas=v}return this.setCamera(),this.canvas}createLandmark(n,r,s){const l=`${n.join(",")}-${r.join(",")}-${s}`;if(this.landmarkMap.has(l))return this.landmarkMap.get(l);const h=this.canvas.getCamera().createLandmark(l,{position:n,focalPoint:r,zoom:s});return this.landmarkMap.set(l,h),h}setCamera(){var n;const{canvas:r}=this.context,s=(n=this.canvas)===null||n===void 0?void 0:n.getCamera();if(!s)return;const{size:[l,u],padding:h}=this.options,[f,d,v,p]=yr(h),{min:g,max:y,center:m}=r.getBounds("elements"),b=y[0]-g[0],x=y[1]-g[1],E=l-p-d,w=u-f-v,S=E/b,M=w/x,C=Math.min(S,M),T=this.createLandmark(m,m,C);s.gotoLandmark(T,0)}get maskBBox(){const{canvas:n}=this.context,r=n.getSize(),s=n.getCanvasByViewport([0,0]),l=n.getCanvasByViewport(r),u=this.canvas.canvas2Viewport(qr(s)),h=this.canvas.canvas2Viewport(qr(l)),f=h.x-u.x,d=h.y-u.y;return[u.x,u.y,f,d]}calculateMaskBBox(){const{size:[n,r]}=this.options;let[s,l,u,h]=this.maskBBox;return s<0&&(u=wa(u+s,n),s=0),l<0&&(h=wa(h+l,r),l=0),s+u>n&&(u=Sa(n-s,0)),l+h>r&&(h=Sa(r-l,0)),[wa(s,n),wa(l,r),Sa(u,0),Sa(h,0)]}renderMask(){const{maskStyle:n}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart),this.mask.draggable=!0,this.mask.addEventListener("dragstart",r=>r.preventDefault&&r.preventDefault())),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},n),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;const[n,r,s,l]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:r+"px",left:n+"px",width:s+"px",height:l+"px"})}destroy(){var n,r,s;this.unbindEvents(),(n=this.canvas)===null||n===void 0||n.destroy(),(r=this.mask)===null||r===void 0||r.remove(),(s=this.container)===null||s===void 0||s.remove(),super.destroy()}}$l.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};const wa=(a,n)=>Math.min(a,n),Sa=(a,n)=>Math.max(a,n);var Vv=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};const Hv={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class Ul extends ln{constructor(n,r){super(n,Object.assign({},Ul.defaultOptions,r)),this.initSnapline=()=>{const s=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=s.appendChild(new Ua({style:Object.assign(Object.assign({},Hv),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=s.appendChild(new Ua({style:Object.assign(Object.assign({},Hv),this.options.verticalLineStyle)})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(s,l,u)=>Vv(this,void 0,void 0,function*(){const{verticalX:h,horizontalY:f}=u,{tolerance:d}=this.options,{min:[v,p],max:[g,y],center:[m,b]}=l;let x=0,E=0;h!==null&&(Bn(g,h)<d&&(x=h-g),Bn(v,h)<d&&(x=h-v),Bn(m,h)<d&&(x=h-m),x!==0&&(this.isVerticalSticking=!0)),f!==null&&(Bn(y,f)<d&&(E=f-y),Bn(p,f)<d&&(E=f-p),Bn(b,f)<d&&(E=f-b),E!==0&&(this.isHorizontalSticking=!0)),(x!==0||E!==0)&&(yield this.context.graph.translateElementBy({[s]:[x,E]},!1))}),this.enableSnap=s=>{const{target:l}=s,u=.5;if(this.isHorizontalSticking||this.isVerticalSticking){const[h,f]=this.getDelta(s);if(this.isHorizontalSticking&&this.isVerticalSticking&&Math.abs(h)<=u&&Math.abs(f)<=u)return this.context.graph.translateElementBy({[l.id]:[-h,-f]},!1),!1;if(this.isHorizontalSticking&&Math.abs(f)<=u)return this.context.graph.translateElementBy({[l.id]:[0,-f]},!1),!1;if(this.isVerticalSticking&&Math.abs(h)<=u)return this.context.graph.translateElementBy({[l.id]:[-h,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick},this.calcSnaplineMetadata=(s,l)=>{const{tolerance:u,shape:h}=this.options,{min:[f,d],max:[v,p],center:[g,y]}=l;let m=null,b=null,x=null,E=null,w=null,S=null;return this.getNodes().some(M=>{if(Je(s.id,M.id))return!1;const C=xx(M,h).getRenderBounds(),{min:[T,O],max:[k,P],center:[A,N]}=C;return m===null&&(Bn(A,g)<u?m=A:Bn(T,f)<u||Bn(T,v)<u?m=T:(Bn(k,v)<u||Bn(k,f)<u)&&(m=k),m!==null&&(b=Math.min(O,d),x=Math.max(P,p))),E===null&&(Bn(N,y)<u?E=N:Bn(O,d)<u||Bn(O,p)<u?E=O:(Bn(P,p)<u||Bn(P,d)<u)&&(E=P),E!==null&&(w=Math.min(T,f),S=Math.max(k,v))),m!==null&&E!==null}),{verticalX:m,verticalMinY:b,verticalMaxY:x,horizontalY:E,horizontalMinX:w,horizontalMaxX:S}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=s=>Vv(this,void 0,void 0,function*(){const{target:l}=s;if(this.options.autoSnap&&!this.enableSnap(s))return;const u=xx(l,this.options.shape).getRenderBounds(),h=this.calcSnaplineMetadata(l,u);this.hideSnapline(),(h.verticalX!==null||h.horizontalY!==null)&&this.updateSnapline(h),this.options.autoSnap&&(yield this.autoSnapToLine(l.id,u,h))}),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}getNodes(){var n;const{filter:r}=this.options,l=(((n=this.context.element)===null||n===void 0?void 0:n.getNodes())||[]).filter(u=>{var h;return ab(u)&&((h=this.context.viewport)===null||h===void 0?void 0:h.isInViewport(u.getRenderBounds()))});return r?l.filter(u=>r(u)):l}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(n){const{lineWidth:r}=this.options[`${n}LineStyle`];return+(r||Hv.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(n){const{verticalX:r,verticalMinY:s,verticalMaxY:l,horizontalY:u,horizontalMinX:h,horizontalMaxX:f}=n,[d,v]=this.context.canvas.getSize(),{offset:p}=this.options;u!==null?Object.assign(this.horizontalLine.style,{x1:p===1/0?0:h-p,y1:u,x2:p===1/0?d:f+p,y2:u,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",r!==null?Object.assign(this.verticalLine.style,{x1:r,y1:p===1/0?0:s-p,x2:r,y2:p===1/0?v:l+p,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(n){const r=this.context.graph.getZoom();return Xr([n.dx,n.dy],r)}bindEvents(){return Vv(this,void 0,void 0,function*(){const{graph:n}=this.context;n.on(pr.DRAG_START,this.onDragStart),n.on(pr.DRAG,this.onDrag),n.on(pr.DRAG_END,this.onDragEnd)})}unbindEvents(){const{graph:n}=this.context;n.off(pr.DRAG_START,this.onDragStart),n.off(pr.DRAG,this.onDrag),n.off(pr.DRAG_END,this.onDragEnd)}destroyElements(){var n,r;(n=this.horizontalLine)===null||n===void 0||n.destroy(),(r=this.verticalLine)===null||r===void 0||r.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}}Ul.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};const Bn=(a,n)=>Math.abs(a-n),xx=(a,n)=>typeof n=="function"?n(a):a.getShape(n);var Ex=null,aD=null;function Ch(a){return a instanceof Date?a:new Date(a)}function sD(a){for(var n=__read(a,2),r=n[0],s=n[1],l=Ex.indexOf(r),u=Ex.indexOf(s),h="",f=l;f<=u;f+=1)if(h+=aD[f],f<u){var d="-";f===2?d=" ":f>2&&(d=":"),h+=d}return h}function Xn(a,n){var r={YYYY:a.getFullYear(),MM:a.getMonth()+1,DD:a.getDate(),HH:a.getHours(),mm:a.getMinutes(),ss:a.getSeconds()},s=n;return Object.keys(r).forEach(function(l){var u=r[l];s=s.replace(l,l==="YYYY"?"".concat(u):"".concat(u).padStart(2,"0"))}),s}function dG(a,n){return Ch(a).getTime()-Ch(n).getTime()}function vG(a,n){var r=__read([Ch(a),Ch(n)],2),s=r[0],l=r[1];return s.getFullYear()!==l.getFullYear()?"year":s.getMonth()!==l.getMonth()?"month":s.getDay()!==l.getDay()?"day":s.getHours()!==l.getHours()?"hour":s.getMinutes()!==l.getMinutes()?"minute":"second"}function pG(a,n){var r=new Date(a),s={year:function(l){l.setMonth(0),l.setHours(0,0,0,0)},month:function(l){l.setDate(1),l.setHours(0,0,0,0)},day:function(l){return l.setHours(0,0,0,0)},hour:function(l){return l.setMinutes(0,0,0)},minute:function(l){return l.setSeconds(0,0)},second:function(l){return l.setMilliseconds(0)}};return s[n](r),Xn(r,sD(["year",n]))}function oD(a,n){if(a.length<=n)return a;for(var r=Math.floor(a.length/n),s=[],l=0;l<a.length;l+=r)s.push(a[l]);return s}var ge={gridGroup:"grid-group",mainGroup:"main-group",lineGroup:"line-group",tickGroup:"tick-group",labelGroup:"label-group",titleGroup:"title-group",grid:"grid",line:"line",lineFirst:"line-first",lineSecond:"line-second",tick:"tick",tickItem:"tick-item",label:"label",labelItem:"label-item",title:"title"},$v={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new dr({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]},gG=(0,jn.Z)({},$v,{style:{type:"arc"}}),yG=(0,jn.Z)({},$v,{style:{}}),zt=ti({mainGroup:ge.mainGroup,gridGroup:ge.gridGroup,grid:ge.grid,lineGroup:ge.lineGroup,line:ge.line,tickGroup:ge.tickGroup,tick:ge.tick,tickItem:ge.tickItem,labelGroup:ge.labelGroup,label:ge.label,labelItem:ge.labelItem,titleGroup:ge.titleGroup,title:ge.title,lineFirst:ge.lineFirst,lineSecond:ge.lineSecond},"axis");function Vi(a,n){return[a[0]*n,a[1]*n]}function Yl(a,n){return[a[0]+n[0],a[1]+n[1]]}function Uv(a,n){return[a[0]-n[0],a[1]-n[1]]}function vs(a,n){return[Math.min(a[0],n[0]),Math.min(a[1],n[1])]}function ps(a,n){return[Math.max(a[0],n[0]),Math.max(a[1],n[1])]}function Xl(a,n){return Math.sqrt(Math.pow(a[0]-n[0],2)+Math.pow(a[1]-n[1],2))}function wx(a){if(a[0]===0&&a[1]===0)return[0,0];var n=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2));return[a[0]/n,a[1]/n]}function mG(a,n,r){var s=__read(a,2),l=s[0],u=s[1],h=__read(n,2),f=h[0],d=h[1],v=l-f,p=u-d,g=Math.sin(r),y=Math.cos(r);return[v*y-p*g+f,v*g+p*y+d]}function lD(a,n){return n?[a[1],-a[0]]:[-a[1],a[0]]}function qs(a){return a*Math.PI/180}function Sx(a){return Number((a*180/Math.PI).toPrecision(5))}function Oh(a,n){return a.style.opacity||(a.style.opacity=1),ei(a,{opacity:0},n)}var cD=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function uD(a){return cD.includes(a)}function Mx(a){var n={};for(var r in a)uD(r)&&(n[r]=a[r]);return n}var Ks=ti({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function Tx(a){return a.reduce(function(n,r,s){return n.push((0,_.ev)([s===0?"M":"L"],(0,_.CR)(r),!1)),n},[])}function hD(a,n,r){var s=n.connect,l=s===void 0?"line":s,u=n.center;if(l==="line")return Tx(a);if(!u)return[];var h=Xl(a[0],u),f=r?0:1;return a.reduce(function(d,v,p){return p===0?d.push((0,_.ev)(["M"],(0,_.CR)(v),!1)):d.push((0,_.ev)(["A",h,h,0,0,f],(0,_.CR)(v),!1)),d},[])}function Yv(a,n,r){return n.type==="surround"?hD(a,n,r):Tx(a)}function fD(a,n,r){var s=r.type,l=r.connect,u=r.center,h=r.closed,f=h?[["Z"]]:[],d=(0,_.CR)([Yv(a,r),Yv(n.slice().reverse(),r,!0)],2),v=d[0],p=d[1],g=(0,_.CR)([a[0],n.slice(-1)[0]],2),y=g[0],m=g[1],b=function(S,M){return[v,S,p,M,f].flat()};if(l==="line"||s==="surround")return b([(0,_.ev)(["L"],(0,_.CR)(m),!1)],[(0,_.ev)(["L"],(0,_.CR)(y),!1)]);if(!u)throw new Error("Arc grid need to specified center");var x=(0,_.CR)([Xl(m,u),Xl(y,u)],2),E=x[0],w=x[1];return b([(0,_.ev)(["A",E,E,0,0,1],(0,_.CR)(m),!1),(0,_.ev)(["L"],(0,_.CR)(m),!1)],[(0,_.ev)(["A",w,w,0,0,0],(0,_.CR)(y),!1),(0,_.ev)(["L"],(0,_.CR)(y),!1)])}function dD(a,n,r,s){var l=r.animate,u=r.isBillboard,h=n.map(function(f,d){return{id:f.id||"grid-line-".concat(d),d:Yv(f.points,r)}});return a.selectAll(Ks.line.class).data(h,function(f){return f.id}).join(function(f){return f.append("path").each(function(d,v){var p=lr(Mx((0,_.pi)({d:d.d},s)),[d,v,h]);this.attr((0,_.pi)({class:Ks.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:u},p))})},function(f){return f.transition(function(d,v){var p=lr(Mx((0,_.pi)({d:d.d},s)),[d,v,h]);return ei(this,p,l.update)})},function(f){return f.transition(function(){var d=this,v=Oh(this,l.exit);return Xs(v,function(){return d.remove()}),v})}).transitions()}function vD(a,n,r){var s=r.animate,l=r.connect,u=r.areaFill;if(n.length<2||!u||!l)return[];for(var h=Array.isArray(u)?u:[u,"transparent"],f=function(b){return h[b%h.length]},d=[],v=0;v<n.length-1;v++){var p=(0,_.CR)([n[v].points,n[v+1].points],2),g=p[0],y=p[1],m=fD(g,y,r);d.push({d:m,fill:f(v)})}return a.selectAll(Ks.region.class).data(d,function(b,x){return x}).join(function(b){return b.append("path").each(function(x,E){var w=lr(x,[x,E,d]);this.attr(w)}).attr("className",Ks.region.name)},function(b){return b.transition(function(x,E){var w=lr(x,[x,E,d]);return ei(this,w,s.update)})},function(b){return b.transition(function(){var x=this,E=Oh(this,s.exit);return Xs(E,function(){return x.remove()}),E})}).transitions()}function pD(a){var n=a.data,r=n===void 0?[]:n,s=a.closed;return s?r.map(function(l){var u=l.points,h=(0,_.CR)(u,1),f=h[0];return(0,_.pi)((0,_.pi)({},l),{points:(0,_.ev)((0,_.ev)([],(0,_.CR)(u),!1),[f],!1)})}):r}var gD=function(a){(0,_.ZT)(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return n.prototype.render=function(r,s){var l=r.type,u=r.center,h=r.areaFill,f=r.closed,d=(0,_._T)(r,["type","center","areaFill","closed"]),v=pD(r),p=Tt(s).maybeAppendByClassName(Ks.lineGroup,"g"),g=Tt(s).maybeAppendByClassName(Ks.regionGroup,"g"),y=dD(p,v,r,d),m=vD(g,v,r);return(0,_.ev)((0,_.ev)([],(0,_.CR)(y),!1),(0,_.CR)(m),!1)},n}(Ve),yD=function(a,n){return function(r){return a*(1-r)+n*r}};function mD(a,n){var r=n?n.length:0,s=a?Math.min(r,a.length):0;return function(l){var u=new Array(s),h=new Array(r),f=0;for(f=0;f<s;++f)u[f]=Xv(a[f],n[f]);for(;f<r;++f)h[f]=n[f];for(f=0;f<s;++f)h[f]=u[f](l);return h}}function bD(a,n){a===void 0&&(a={}),n===void 0&&(n={});var r={},s={};return Object.entries(n).forEach(function(l){var u=(0,_.CR)(l,2),h=u[0],f=u[1];h in a?r[h]=Xv(a[h],f):s[h]=f}),function(l){return Object.entries(r).forEach(function(u){var h=(0,_.CR)(u,2),f=h[0],d=h[1];return s[f]=d(l)}),s}}function Xv(a,n){return typeof a=="number"&&typeof n=="number"?yD(a,n):Array.isArray(a)&&Array.isArray(n)?mD(a,n):typeof a=="object"&&typeof n=="object"?bD(a,n):function(r){return a}}function xD(a,n,r,s){if(!s)return a.attr("__keyframe_data__",r),null;var l=s.duration,u=l===void 0?0:l,h=Xv(n,r),f=Math.ceil(+u/16),d=new Array(f).fill(0).map(function(v,p,g){return{__keyframe_data__:h(p/(g.length-1))}});return a.animate(d,(0,_.pi)({fill:"both"},s))}function qv(a,n){var r={},s=Array.isArray(n)?n:[n];for(var l in a)s.includes(l)||(r[l]=a[l]);return r}function Cx(a,n){return Object.fromEntries(Object.entries(a).map(function(r){var s=(0,_.CR)(r,2),l=s[0],u=s[1];return[l,lr(u,n)]}))}function bG(a){if(a.type==="linear"){var n=a.startPos,r=a.endPos;return __spreadArray(__spreadArray([],__read(n),!1),__read(r),!1)}var s=a.startAngle,l=a.endAngle,u=a.center,h=a.radius;return __spreadArray(__spreadArray([s,l],__read(u),!1),[h],!1)}function Kv(a,n){return n&&(0,_t.Z)(n)?a.filter(n):a}function Ox(a,n){var r=n.startAngle,s=n.endAngle;return(s-r)*a+r}function kh(a,n){if(n.type==="linear"){var r=(0,_.CR)(n.startPos,2),s=r[0],l=r[1],u=(0,_.CR)(n.endPos,2),h=u[0],f=u[1],d=(0,_.CR)([h-s,f-l],2),v=d[0],p=d[1];return wx([v,p])}var g=qs(Ox(a,n));return[-Math.sin(g),Math.cos(g)]}function Qv(a,n,r){var s=kh(a,r);return lD(s,n!=="positive")}function Qs(a,n){return Qv(a,n.labelDirection,n)}function ql(a,n,r){return r?"".concat(a," ").concat(r,"axis-").concat(n):a}function xG(a,n,r){var s=a.classNamePrefix,l=s===void 0?"":s;return ql(n.name,r,l)}function br(a,n,r,s){return s&&a.attr("className",ql(n.name,r,s)),a}function ED(a,n){var r=(0,_.CR)(n.startPos,2),s=r[0],l=r[1],u=(0,_.CR)(n.endPos,2),h=u[0],f=u[1],d=(0,_.CR)([h-s,f-l],2),v=d[0],p=d[1];return[s+v*a,l+p*a]}function wD(a,n){var r=n.radius,s=(0,_.CR)(n.center,2),l=s[0],u=s[1],h=qs(Ox(a,n));return[l+r*Math.cos(h),u+r*Math.sin(h)]}function _h(a,n){return n.type==="linear"?ED(a,n):wD(a,n)}function Jv(a){return kh(0,a)[1]===0}function kx(a){return kh(0,a)[0]===0}function _x(a,n){return n-a===360}function Px(a,n,r,s,l){var u=n-a,h=(0,_.CR)([l,l],2),f=h[0],d=h[1],v=(0,_.CR)([qs(a),qs(n)],2),p=v[0],g=v[1],y=function(N){return[r+l*Math.cos(N),s+l*Math.sin(N)]},m=(0,_.CR)(y(p),2),b=m[0],x=m[1],E=(0,_.CR)(y(g),2),w=E[0],S=E[1];if(_x(a,n)){var M=(g+p)/2,C=(0,_.CR)(y(M),2),T=C[0],O=C[1];return[["M",b,x],["A",f,d,0,1,0,T,O],["A",f,d,0,1,0,w,S]]}var k=u>180?1:0,P=a>n?0:1,A=!1;return A?"M".concat(r,",").concat(s,",L").concat(b,",").concat(x,",A").concat(f,",").concat(d,",0,").concat(k,",").concat(P,",").concat(w,",").concat(S,",L").concat(r,",").concat(s):"M".concat(b,",").concat(x,",A").concat(f,",").concat(d,",0,").concat(k,",").concat(P,",").concat(w,",").concat(S)}function SD(a){var n=a.attributes,r=n.startAngle,s=n.endAngle,l=n.center,u=n.radius;return(0,_.ev)((0,_.ev)([r,s],(0,_.CR)(l),!1),[u],!1)}function MD(a,n,r,s){var l=n.startAngle,u=n.endAngle,h=n.center,f=n.radius,d=n.classNamePrefix;return a.selectAll(zt.line.class).data([{d:Px.apply(void 0,(0,_.ev)((0,_.ev)([l,u],(0,_.CR)(h),!1),[f],!1))}],function(v,p){return p}).join(function(v){var p=v.append("path").attr("className",zt.line.name).styles(n).styles({d:function(g){return g.d}});return br(p,zt.line,ge.line,d),p},function(v){return v.transition(function(){var p=this,g=xD(this,SD(this),(0,_.ev)((0,_.ev)([l,u],(0,_.CR)(h),!1),[f],!1),s.update);if(g){var y=function(){var m=Tn(p.attributes,"__keyframe_data__");p.style.d=Px.apply(void 0,(0,_.ev)([],(0,_.CR)(m),!1))};g.onframe=y,g.onfinish=y}return g}).styles(n)},function(v){return v.remove()}).styles(r).transitions()}function TD(a,n){var r=n.truncRange,s=n.truncShape,l=n.lineExtension}function CD(a,n,r){r===void 0&&(r=[0,0]);var s=(0,_.CR)([a,n,r],3),l=(0,_.CR)(s[0],2),u=l[0],h=l[1],f=(0,_.CR)(s[1],2),d=f[0],v=f[1],p=(0,_.CR)(s[2],2),g=p[0],y=p[1],m=(0,_.CR)([d-u,v-h],2),b=m[0],x=m[1],E=Math.sqrt(Math.pow(b,2)+Math.pow(x,2)),w=(0,_.CR)([-g/E,y/E],2),S=w[0],M=w[1];return[S*b,S*x,M*b,M*x]}function Ax(a){var n=(0,_.CR)(a,2),r=(0,_.CR)(n[0],2),s=r[0],l=r[1],u=(0,_.CR)(n[1],2),h=u[0],f=u[1];return{x1:s,y1:l,x2:h,y2:f}}function OD(a,n,r,s){var l=n.showTrunc,u=n.startPos,h=n.endPos,f=n.truncRange,d=n.lineExtension,v=n.classNamePrefix,p=(0,_.CR)([u,h],2),g=(0,_.CR)(p[0],2),y=g[0],m=g[1],b=(0,_.CR)(p[1],2),x=b[0],E=b[1],w=(0,_.CR)(d?CD(u,h,d):new Array(4).fill(0),4),S=w[0],M=w[1],C=w[2],T=w[3],O=function(U){return a.selectAll(zt.line.class).data(U,function(at,ht){return ht}).join(function(at){var ht=at.append("line").styles(r).transition(function(pt){return ei(this,Ax(pt.line),!1)});return ht.attr("className",function(pt){if(!v)return"".concat(zt.line.name," ").concat(pt.className);var Ct=ql(zt.line.name,ge.line,v);if(pt.className===zt.lineFirst.name){var Zt=ql(zt.lineFirst.name,ge.lineFirst,v);return"".concat(Ct," ").concat(Zt)}if(pt.className===zt.lineSecond.name){var Zt=ql(zt.lineSecond.name,ge.lineSecond,v);return"".concat(Ct," ").concat(Zt)}return Ct}),ht},function(at){return at.styles(r).transition(function(ht){var pt=ht.line;return ei(this,Ax(pt),s.update)})},function(at){return at.remove()}).transitions()};if(!l||!f)return O([{line:[[y+S,m+M],[x+C,E+T]],className:zt.line.name}]);var k=(0,_.CR)(f,2),P=k[0],A=k[1],N=x-y,L=E-m,R=(0,_.CR)([y+N*P,m+L*P],2),z=R[0],Z=R[1],X=(0,_.CR)([y+N*A,m+L*A],2),nt=X[0],K=X[1],rt=O([{line:[[y+S,m+M],[z,Z]],className:zt.lineFirst.name},{line:[[nt,K],[x+C,E+T]],className:zt.lineSecond.name}]);return TD(a,n),rt}function kD(a,n,r,s){var l=r.showArrow,u=r.showTrunc,h=r.lineArrow,f=r.lineArrowOffset,d=r.lineArrowSize,v;if(n==="arc"?v=a.select(zt.line.class):u?v=a.select(zt.lineSecond.class):v=a.select(zt.line.class),!l||!h||r.type==="arc"&&_x(r.startAngle,r.endAngle)){var p=v.node();p&&(p.style.markerEnd=void 0);return}var g=ji(h);g.attr(s),zv(g,d,!0),v.style("markerEnd",g).style("markerEndOffset",-f)}function _D(a,n,r){var s=n.type,l,u=Wt(n,"line");return s==="linear"?l=OD(a,n,qv(u,"arrow"),r):l=MD(a,n,qv(u,"arrow"),r),kD(a,s,n,u),l}function PD(a,n){return Qv(a,n.gridDirection,n)}function Nx(a){var n=a.type,r=a.gridCenter;return n==="linear"?r:r||a.center}function AD(a,n){var r=n.gridLength;return a.map(function(s,l){var u=s.value,h=(0,_.CR)(_h(u,n),2),f=h[0],d=h[1],v=(0,_.CR)(Vi(PD(u,n),r),2),p=v[0],g=v[1];return{id:l,points:[[f,d],[f+p,d+g]]}})}function ND(a,n){var r=n.gridControlAngles,s=Nx(n);if(!s)throw new Error("grid center is not provide");if(a.length<2)throw new Error("Invalid grid data");if(!r||r.length===0)throw new Error("Invalid gridControlAngles");var l=(0,_.CR)(s,2),u=l[0],h=l[1];return a.map(function(f,d){var v=f.value,p=(0,_.CR)(_h(v,n),2),g=p[0],y=p[1],m=(0,_.CR)([g-u,y-h],2),b=m[0],x=m[1],E=[];return r.forEach(function(w){var S=qs(w),M=(0,_.CR)([Math.cos(S),Math.sin(S)],2),C=M[0],T=M[1],O=b*C-x*T+u,k=b*T+x*C+h;E.push([O,k])}),{points:E,id:d}})}function RD(a,n,r,s){var l=r.classNamePrefix,u=Wt(r,"grid"),h=u.type,f=u.areaFill,d=Nx(r),v=Kv(n,r.gridFilter),p=h==="segment"?AD(v,r):ND(v,r),g=(0,_.pi)((0,_.pi)({},u),{center:d,areaFill:(0,_t.Z)(f)?v.map(function(y,m){return lr(f,[y,m,v])}):f,animate:s,data:p});return a.selectAll(zt.grid.class).data([1]).join(function(y){var m=y.append(function(){return new gD({style:g})}).attr("className",zt.grid.name);return br(m,zt.grid,ge.grid,l),m},function(y){return y.transition(function(){return this.update(g)})},function(y){return y.remove()}).transitions()}function On(a,n,r,s,l){return s===void 0&&(s=!0),l===void 0&&(l=!1),s&&a===n||l&&a===r?!0:a>n&&a<r}var LD=function(a){var n=new DOMParser,r=n.parseFromString(a,"text/html"),s=r.body.firstElementChild;if(console.log(s==null?void 0:s.getClientRects(),11),!s)return 0;var l=s.getAttribute("style")||"",u=Object.fromEntries(l.split(";").map(function(E){return E.trim()}).filter(function(E){return E.includes(":")}).map(function(E){var w=(0,_.CR)(E.split(":").map(function(C){return C.trim()}),2),S=w[0],M=w[1];return[S.toLowerCase(),M]})),h=function(E){if(!E)return 0;var w=E.match(/([\d.]+)px/);return w?parseFloat(w[1]):0};if(u.height)return h(u.height);var f=h(u["font-size"])||16,d=u["line-height"],v;!d||d==="normal"?v=1.2*f:d.endsWith("px")?v=h(d):/^[\d.]+$/.test(d)?v=parseFloat(d)*f:v=f;var p=h(u["padding-top"]),g=h(u["padding-bottom"]);if(u.padding){var y=u.padding.split(/\s+/).map(h);y.length===1||y.length===2?(p=y[0],g=y[0]):(y.length===3||y.length===4)&&(p=y[0],g=y[2])}var m=h(u["border-top-width"]),b=h(u["border-bottom-width"]);if(u.border){var x=u.border.match(/([\d.]+)px/);x&&(m=parseFloat(x[1]),b=parseFloat(x[1]))}if(u["border-width"]){var y=u["border-width"].split(/\s+/).map(h);y.length===1||y.length===2?(m=y[0],b=y[0]):(y.length===3||y.length===4)&&(m=y[0],b=y[2])}return v+p+g+m+b};function DD(a,n,r,s){r===void 0&&(r=2),s===void 0&&(s="top"),px(a,{wordWrap:!0,wordWrapWidth:n,maxLines:r,textBaseline:s})}function ID(a,n,r){var s=a.getBBox(),l=s.width,u=s.height,h=(0,_.CR)([n,r].map(function(v,p){var g;return v.includes("%")?parseFloat(((g=v.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||g===void 0?void 0:g[0])||"0")/100*(p===0?l:u):v}),2),f=h[0],d=h[1];return[f,d]}function Rx(a,n){if(n)try{var r=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,s=n.replace(r,function(l,u,h){return"translate(".concat(ID(a,u,h),")")});a.attr("transform",s)}catch(l){}}var t0=function(){function a(n,r,s,l){this.set(n,r,s,l)}return Object.defineProperty(a.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),a.prototype.rotatedPoints=function(n,r,s){var l=this,u=l.x1,h=l.y1,f=l.x2,d=l.y2,v=Math.cos(n),p=Math.sin(n),g=r-r*v+s*p,y=s-r*p-s*v,m=[[v*u-p*d+g,p*u+v*d+y],[v*f-p*d+g,p*f+v*d+y],[v*u-p*h+g,p*u+v*h+y],[v*f-p*h+g,p*f+v*h+y]];return m},a.prototype.set=function(n,r,s,l){return s<n?(this.x2=n,this.x1=s):(this.x1=n,this.x2=s),l<r?(this.y2=r,this.y1=l):(this.y1=r,this.y2=l),this},a.prototype.defined=function(n){return this[n]!==Number.MAX_VALUE&&this[n]!==-Number.MAX_VALUE},a}();function Ph(a,n){var r=a.getEulerAngles()||0;a.setEulerAngles(0);var s=a.getBounds(),l=(0,_.CR)(s.min,2),u=l[0],h=l[1],f=(0,_.CR)(s.max,2),d=f[0],v=f[1],p=a.getBBox(),g=p.width,y=p.height,m=y,b=0,x=0,E=u,w=h,S=vx(a);if(S){m-=1.5;var M=S.style.textAlign,C=S.style.textBaseline;M==="center"?E=(u+d)/2:(M==="right"||M==="end")&&(E=d),C==="middle"?w=(h+v)/2:C==="bottom"&&(w=v)}var T=(0,_.CR)(Cn(n),4),O=T[0],k=O===void 0?0:O,P=T[1],A=P===void 0?0:P,N=T[2],L=N===void 0?k:N,R=T[3],z=R===void 0?A:R,Z=new t0((b+=u)-z,(x+=h)-k,b+g+A,x+m+L);return a.setEulerAngles(r),Z.rotatedPoints(qs(r),E,w)}function Kl(a,n){return n[0]<=Math.max(a[0][0],a[1][0])&&n[0]<=Math.min(a[0][0],a[1][0])&&n[1]<=Math.max(a[0][1],a[1][1])&&n[1]<=Math.min(a[0][1],a[1][1])}function Ql(a,n,r){var s=(n[1]-a[1])*(r[0]-n[0])-(n[0]-a[0])*(r[1]-n[1]);return s===0?0:s<0?2:1}function BD(a,n){var r=Ql(a[0],a[1],n[0]),s=Ql(a[0],a[1],n[1]),l=Ql(n[0],n[1],a[0]),u=Ql(n[0],n[1],a[1]);return!!(r!==s&&l!==u||r===0&&Kl(a,n[0])||s===0&&Kl(a,n[1])||l===0&&Kl(n,a[0])||u===0&&Kl(n,a[1]))}function FD(a,n){var r=a.length;if(r<3)return!1;var s=[n,[9999,n[1]]],l=0,u=0;do{var h=[a[u],a[(u+1)%r]];if(BD(h,s)){if(Ql(h[0],n,h[1])===0)return Kl(h,n);l++}u=(u+1)%r}while(u!==0);return!!(l&1)}function zD(a,n){return n.every(function(r){return FD(a,r)})}function ZD(a,n,r){var s=a.x1,l=a.x2,u=a.y1,h=a.y2,f=[[s,u],[l,u],[l,h],[s,h]],d=Ph(n,r);return zD(f,d)}function Lx(a,n){var r=(0,_.CR)(a,4),s=r[0],l=r[1],u=r[2],h=r[3],f=(0,_.CR)(n,4),d=f[0],v=f[1],p=f[2],g=f[3],y=u-s,m=h-l,b=p-d,x=g-v,E=y*x-b*m;if(E===0)return!1;var w=E>0,S=s-d,M=l-v,C=y*M-m*S;if(C<0===w)return!1;var T=b*M-x*S;return!(T<0===w||C>E===w||T>E===w)}function Dx(a,n){var r=[[a[0],a[1],a[2],a[3]],[a[2],a[3],a[4],a[5]],[a[4],a[5],a[6],a[7]],[a[6],a[7],a[0],a[1]]];return r.some(function(s){return Lx(n,s)})}var EG={lineToLine:Lx,intersectBoxLine:Dx,getBounds:Ph};function GD(a,n,r){var s,l,u=Ph(a,r).flat(1),h=Ph(n,r).flat(1),f=[[u[0],u[1],u[2],u[3]],[u[0],u[1],u[4],u[5]],[u[4],u[5],u[6],u[7]],[u[2],u[3],u[6],u[7]]];try{for(var d=(0,_.XA)(f),v=d.next();!v.done;v=d.next()){var p=v.value;if(Dx(h,p))return!0}}catch(g){s={error:g}}finally{try{v&&!v.done&&(l=d.return)&&l.call(d)}finally{if(s)throw s.error}}return!1}function WD(a,n){var r=a.type,s=a.labelDirection,l=a.crossSize;if(!l)return!1;if(r==="arc"){var u=a.center,h=a.radius,f=(0,_.CR)(u,2),d=f[0],v=f[1],p=s==="negative"?0:l,g=-h-p,y=h+p,m=(0,_.CR)(Cn(n),4),b=m[0],x=m[1],E=m[2],w=m[3];return new t0(d+g-w,v+g-b,d+y+x,v+y+E)}var S=(0,_.CR)(a.startPos,2),M=S[0],C=S[1],T=(0,_.CR)(a.endPos,2),O=T[0],k=T[1],P=(0,_.CR)(kx(a)?[-n,0,n,0]:[0,n,0,-n],4),A=P[0],N=P[1],L=P[2],R=P[3],z=Qs(0,a),Z=Vi(z,l),X=new t0(M,C,O,k);return X.x1+=R,X.y1+=A,X.x2+=N+Z[0],X.y2+=L+Z[1],X}function Ah(a,n,r){var s,l,u=n.crossPadding,h=new Set,f=null,d=WD(n,u),v=function(b){return d?ZD(d,b):!0},p=function(b,x){return!b||!b.firstChild?!0:!GD(b.firstChild,x.firstChild,Cn(r))};try{for(var g=(0,_.XA)(a),y=g.next();!y.done;y=g.next()){var m=y.value;v(m)?!f||p(f,m)?f=m:(h.add(f),h.add(m)):h.add(m)}}catch(b){s={error:b}}finally{try{y&&!y.done&&(l=g.return)&&l.call(g)}finally{if(s)throw s.error}}return Array.from(h)}function e0(a,n){return n===void 0&&(n={}),(0,At.Z)(a)?0:typeof a=="number"?a:Math.floor(zL(a,n))}function jD(a,n,r,s){if(!(a.length<=0)){var l=n.suffix,u=l===void 0?"...":l,h=n.minLength,f=n.maxLength,d=f===void 0?1/0:f,v=n.step,p=v===void 0?" ":v,g=n.margin,y=g===void 0?[0,0,0,0]:g,m=dx(s.getTextShape(a[0])),b=e0(p,m),x=h?e0(h,m):b,E=e0(d,m);((0,At.Z)(E)||E===1/0)&&(E=Math.max.apply(null,a.map(function(Z){return Z.getBBox().width})));for(var w=a.slice(),S=(0,_.CR)(y,4),M=S[0],C=M===void 0?0:M,T=S[1],O=T===void 0?0:T,k=S[2],P=k===void 0?C:k,A=S[3],N=A===void 0?O:A,L=function(Z){if(w.forEach(function(X){s.ellipsis(s.getTextShape(X),Z,u)}),w=Ah(a,r,y),w.length<1)return{value:void 0}},R=E;R>x+b;R-=b){var z=L(R);if(typeof z=="object")return z.value}}}var VD=function(a){return a!==void 0&&a!=null&&!Number.isNaN(a)},HD={parity:function(a,n){var r=n.seq,s=r===void 0?2:r;return a.filter(function(l,u){return u%s?(Jr(l),!1):!0})}},$D=function(a){return a.filter(VD)};function UD(a,n,r,s){var l=a.length,u=n.keepHeader,h=n.keepTail;if(!(l<=1||l===2&&u&&h)){var f=HD.parity,d=function(M){return M.forEach(s.show),M},v=2,p=a.slice(),g=a.slice(),y=Math.min.apply(Math,(0,_.ev)([1],(0,_.CR)(a.map(function(M){return M.getBBox().width})),!1));if(r.type==="linear"&&(Jv(r)||kx(r))){var m=fx(a[0]).left,b=fx(a[l-1]).right,x=Math.abs(b-m)||1;v=Math.max(Math.floor(l*y/x),v)}var E,w;for(u&&(E=p.splice(0,1)[0]),h&&(w=p.splice(-1,1)[0],p.reverse()),d(p);v<a.length&&Ah($D(w?(0,_.ev)((0,_.ev)([w],(0,_.CR)(g),!1),[E],!1):(0,_.ev)([E],(0,_.CR)(g),!1)),r,n==null?void 0:n.margin).length;){if(w&&!E&&v%2===0){var S=p.splice(0,1);S.forEach(s.hide)}else if(w&&E){var S=p.splice(0,1);S.forEach(s.hide)}g=f(d(p),{seq:v}),v++}}}function YD(a,n,r,s){var l,u,h=n.optionalAngles,f=h===void 0?[0,45,90]:h,d=n.margin,v=n.recoverWhenFailed,p=v===void 0?!0:v,g=a.map(function(w){return w.getLocalEulerAngles()}),y=function(){return Ah(a,r,d).length<1},m=function(w){return a.forEach(function(S,M){var C=Array.isArray(w)?w[M]:w;s.rotate(S,+C)})};try{for(var b=(0,_.XA)(f),x=b.next();!x.done;x=b.next()){var E=x.value;if(m(E),y())return}}catch(w){l={error:w}}finally{try{x&&!x.done&&(u=b.return)&&u.call(b)}finally{if(l)throw l.error}}p&&m(g)}function XD(a){var n=a.type,r=a.labelDirection;return n==="linear"&&Jv(a)?r==="negative"?"bottom":"top":"middle"}function qD(a,n,r,s,l){var u,h=n.maxLines,f=h===void 0?3:h,d=n.recoverWhenFailed,v=d===void 0?!0:d,p=n.margin,g=p===void 0?[0,0,0,0]:p,y=lr((u=n.wordWrapWidth)!==null&&u!==void 0?u:50,[l]),m=a.map(function(M){return M.attr("maxLines")||1}),b=Math.min.apply(Math,(0,_.ev)([],(0,_.CR)(m),!1)),x=function(){return Ah(a,r,g).length<1},E=XD(r),w=function(M){return a.forEach(function(C,T){var O=Array.isArray(M)?M[T]:M;s.wrap(C,y,O,E)})};if(!(b>f)){if(r.type==="linear"&&Jv(r)){if(w(f),x())return}else for(var S=b;S<=f;S++)if(w(S),x())return;v&&w(m)}}var KD=new Map([["hide",UD],["rotate",YD],["ellipsis",jD],["wrap",qD]]);function QD(a,n,r){return n.labelOverlap.length<1?!1:r==="hide"?!VR(a[0]):r==="rotate"?!a.some(function(s){var l;return!!(!((l=s.attr("transform"))===null||l===void 0)&&l.includes("rotate"))}):r==="ellipsis"||r==="wrap"?a.filter(function(s){return s.querySelector("text")}).length>=1:!0}function JD(a,n,r,s){var l=n.labelOverlap,u=l===void 0?[]:l;u.length&&u.forEach(function(h){var f=h.type,d=KD.get(f);QD(a,n,f)&&(d==null||d(a,h,n,s,r))})}function tI(){for(var a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];var r=function(s){return s==="positive"?-1:1};return a.reduce(function(s,l){return s*r(l)},1)}function Ix(a){for(var n=a;n<0;)n+=360;return Math.round(n%360)}function n0(a,n){var r=(0,_.CR)(a,2),s=r[0],l=r[1],u=(0,_.CR)(n,2),h=u[0],f=u[1],d=(0,_.CR)([s*h+l*f,s*f-l*h],2),v=d[0],p=d[1];return Math.atan2(p,v)}function eI(a){var n=(a+360)%180;return On(n,-90,90)||(n+=180),n}function nI(a,n,r){var s,l=r.labelAlign,u=(s=n.style.transform)===null||s===void 0?void 0:s.includes("rotate");if(u)return n.getLocalEulerAngles();var h=0,f=Qs(a.value,r),d=kh(a.value,r);return l==="horizontal"?0:(l==="perpendicular"?h=n0([1,0],f):h=n0([d[0]<0?-1:1,0],d),eI(Sx(h)))}function Bx(a,n,r){var s=r.type,l=r.labelAlign,u=Qs(a,r),h=Ix(n),f=Ix(Sx(n0([1,0],u))),d="center",v="middle";return s==="linear"?[90,270].includes(f)&&h===0?(d="center",v=u[1]===1?"top":"bottom"):!(f%180)&&[90,270].includes(h)?d="center":f===0?(On(h,0,90,!1,!0)||On(h,0,90)||On(h,270,360))&&(d="start"):f===90?On(h,0,90,!1,!0)?d="start":(On(h,90,180)||On(h,270,360))&&(d="end"):f===270?On(h,0,90,!1,!0)?d="end":(On(h,90,180)||On(h,270,360))&&(d="start"):f===180&&(h===90?d="start":(On(h,0,90)||On(h,270,360))&&(d="end")):l==="parallel"?On(f,0,180,!0)?v="top":v="bottom":l==="horizontal"?On(f,90,270,!1)?d="end":(On(f,270,360,!1)||On(f,0,90))&&(d="start"):l==="perpendicular"&&(On(f,90,270)?d="end":d="start"),{textAlign:d,textBaseline:v}}function rI(a,n,r){n.setLocalEulerAngles(a);var s=n.__data__.value,l=Bx(s,a,r),u=n.querySelector(zt.labelItem.class);u&&zx(u,l)}function Fx(a,n,r){var s=r.showTick,l=r.tickLength,u=r.tickDirection,h=r.labelDirection,f=r.labelSpacing,d=n.indexOf(a),v=lr(f,[a,d,n]),p=(0,_.CR)([Qs(a.value,r),tI(h,u)],2),g=p[0],y=p[1],m=y===1?lr(s?l:0,[a,d,n]):0,b=(0,_.CR)(Yl(Vi(g,v+m),_h(a.value,r)),2),x=b[0],E=b[1];return{x,y:E}}function iI(a,n,r,s){var l=s.labelFormatter,u=(0,_t.Z)(l)?function(){return ji(lr(l,[a,n,r,Qs(a.value,s)]))}:function(){return ji(a.label||"")};return u}function aI(a,n,r,s){var l=s.labelRender,u=(Tn(s,"endPos.0",400)-Tn(s,"startPos.0",0))/r.length,h=(0,_t.Z)(l)?lr(l,[a,n,r,Qs(a.value,s)]):a.label||"",f=LD(h)||30;return function(){return FL(h,{width:u,height:f})}}var sI={html:["fill"],text:[]};function zx(a,n){["text","html"].includes(a.nodeName)&&a.attr(qv(n,sI[a.nodeName]))}function oI(a,n){JD(this.node().childNodes,a,n,{hide:Jr,show:Vl,rotate:function(r,s){rI(+s,r,a)},ellipsis:function(r,s,l){r&&Wv(r,s||1/0,l)},wrap:function(r,s,l){r&&DD(r,s,l)},getTextShape:function(r){return r.querySelector(zt.labelItem.class)}})}function Zx(a,n,r,s,l){var u=r.indexOf(n),h=l.labelRender,f=l.classNamePrefix,d=Tt(a).append(h?aI(n,u,r,l):iI(n,u,r,l)).attr("className",zt.labelItem.name).node();br(Tt(d),zt.labelItem,ge.labelItem,f);var v=(0,_.CR)(Wi(Cx(s,[n,u,r])),2),p=v[0],g=v[1],y=g.transform,m=(0,_._T)(g,["transform"]);Rx(d,y);var b=nI(n,d,l);if(d.getLocalEulerAngles()||d.setLocalEulerAngles(b),zx(d,(0,_.pi)((0,_.pi)({},Bx(n.value,b,l)),p)),d.nodeName==="html"){var x=d.getBBox(),E=d.style.x||0;d.attr("x",E-x.width/2)}return a.attr(m),d}function lI(a,n,r,s,l){var u=r.classNamePrefix,h=Kv(n,r.labelFilter),f=Wt(r,"label"),d,v=a.selectAll(zt.label.class).data(h,function(p,g){return g}).join(function(p){var g=p.append("g").attr("className",zt.label.name).transition(function(y){Zx(this,y,n,f,r);var m=Fx(y,n,r),b=m.x,x=m.y;return this.style.transform="translate(".concat(b,", ").concat(x,")"),null});return br(g,zt.label,ge.label,u),g},function(p){return p.transition(function(g){var y=this.querySelector(zt.labelItem.class),m=Zx(this,g,n,f,r),b=cL(y,m,s.update),x=Fx(g,n,r),E=x.x,w=x.y,S=ei(this,{transform:"translate(".concat(E,", ").concat(w,")")},s.update);return(0,_.ev)((0,_.ev)([],(0,_.CR)(b),!1),[S],!1)})},function(p){return d=p,p.transition(function(){var g=this,y=Oh(this.childNodes[0],s.exit);return Xs(y,function(){return Tt(g).remove()}),y}),d}).transitions();return oL(v,function(){oI.call(a,r,l)}),v}function Gx(a,n){return Qv(a,n.tickDirection,n)}function cI(a,n){var r=(0,_.CR)(a,2),s=r[0],l=r[1];return[[0,0],[s*n,l*n]]}function uI(a,n,r,s,l){var u=l.tickLength,h=(0,_.CR)(cI(s,lr(u,[a,n,r])),2),f=(0,_.CR)(h[0],2),d=f[0],v=f[1],p=(0,_.CR)(h[1],2),g=p[0],y=p[1];return{x1:d,x2:g,y1:v,y2:y}}function hI(a,n,r,s,l){var u=l.tickFormatter,h=l.classNamePrefix,f=Gx(n.value,l),d="line";(0,_t.Z)(u)&&(d=function(){return lr(u,[n,r,s,f])});var v=a.append(d).attr("className",zt.tickItem.name);return br(v,zt.tickItem,ge.tickItem,h),v}function fI(a,n,r,s,l,u,h){var f=Gx(a.value,u),d=uI(a,n,r,f,u),v=d.x1,p=d.x2,g=d.y1,y=d.y2,m=(0,_.CR)(Wi(Cx(h,[a,n,r,f])),2),b=m[0],x=m[1];s.node().nodeName==="line"&&s.styles((0,_.pi)({x1:v,x2:p,y1:g,y2:y},b)),l.attr(x),s.styles(b)}function Wx(a,n,r,s,l,u){var h=hI(Tt(this),a,n,r,s);fI(a,n,r,h,this,s,l);var f=(0,_.CR)(_h(a.value,s),2),d=f[0],v=f[1];return ei(this,{transform:"translate(".concat(d,", ").concat(v,")")},u)}function dI(a,n,r,s){var l=r.classNamePrefix,u=Kv(n,r.tickFilter),h=Wt(r,"tick");return a.selectAll(zt.tick.class).data(u,function(f){return f.id||f.label}).join(function(f){var d=f.append("g").attr("className",zt.tick.name).transition(function(v,p){return Wx.call(this,v,p,u,r,h,!1)});return br(d,zt.tick,ge.tick,l),d},function(f){return f.transition(function(d,v){return this.removeChildren(),Wx.call(this,d,v,u,r,h,s.update)})},function(f){return f.transition(function(){var d=this,v=Oh(this.childNodes[0],s.exit);return Xs(v,function(){return d.remove()}),v})}).transitions()}function vI(a,n,r){var s=r.titlePosition,l=s===void 0?"lb":s,u=r.titleSpacing,h=Sh(l),f=a.node().getLocalBounds(),d=(0,_.CR)(f.min,2),v=d[0],p=d[1],g=(0,_.CR)(f.halfExtents,2),y=g[0],m=g[1],b=(0,_.CR)(n.node().getLocalBounds().halfExtents,2),x=b[0],E=b[1],w=(0,_.CR)([v+y,p+m],2),S=w[0],M=w[1],C=(0,_.CR)(Cn(u),4),T=C[0],O=C[1],k=C[2],P=C[3];if(["start","end"].includes(l)&&r.type==="linear"){var A=r.startPos,N=r.endPos,L=(0,_.CR)(l==="start"?[A,N]:[N,A],2),R=L[0],z=L[1],Z=wx([-z[0]+R[0],-z[1]+R[1]]),X=(0,_.CR)(Vi(Z,T),2),nt=X[0],K=X[1];return{x:R[0]+nt,y:R[1]+K}}return h.includes("t")&&(M-=m+E+T),h.includes("r")&&(S+=y+x+O),h.includes("l")&&(S-=y+x+P),h.includes("b")&&(M+=m+E+k),{x:S,y:M}}function pI(a,n,r){var s=a.getGeometryBounds().halfExtents,l=s[1]*2;if(n==="vertical"){if(r==="left")return"rotate(-90) translate(0, ".concat(l/2,")");if(r==="right")return"rotate(-90) translate(0, -".concat(l/2,")")}return""}function jx(a,n,r,s,l){var u=Wt(s,"title"),h=(0,_.CR)(Wi(u),2),f=h[0],d=h[1],v=d.transform,p=d.transformOrigin,g=(0,_._T)(d,["transform","transformOrigin"]);n.styles(g);var y=v||pI(a.node(),f.direction,f.position);a.styles((0,_.pi)((0,_.pi)({},f),{transformOrigin:p})),Rx(a.node(),y);var m=vI(Tt(r._offscreen||r.querySelector(zt.mainGroup.class)),n,s),b=m.x,x=m.y,E=ei(n.node(),{transform:"translate(".concat(b,", ").concat(x,")")},l);return E}function gI(a,n,r,s){var l=r.titleText,u=r.classNamePrefix;return a.selectAll(zt.title.class).data([{title:l}].filter(function(h){return!!h.title}),function(h,f){return h.title}).join(function(h){var f=h.append(function(){return ji(l)}).attr("className",zt.title.name).transition(function(){return jx(Tt(this),a,n,r,s.enter)});return br(f,zt.title,ge.title,u),f},function(h){return h.transition(function(){return jx(Tt(this),a,n,r,s.update)})},function(h){return h.remove()}).transitions()}function Vx(a,n,r,s){var l=a.showLine,u=a.showTick,h=a.showLabel,f=a.classNamePrefix,d=n.maybeAppendByClassName(zt.lineGroup,"g");br(d,zt.lineGroup,ge.lineGroup,f);var v=or(l,d,function(b){return _D(b,a,s)})||[],p=n.maybeAppendByClassName(zt.tickGroup,"g");br(p,zt.tickGroup,ge.tickGroup,f);var g=or(u,p,function(b){return dI(b,r,a,s)})||[],y=n.maybeAppendByClassName(zt.labelGroup,"g");br(y,zt.labelGroup,ge.labelGroup,f);var m=or(h,y,function(b){return lI(b,r,a,s,n.node())})||[];return(0,_.ev)((0,_.ev)((0,_.ev)([],(0,_.CR)(v),!1),(0,_.CR)(g),!1),(0,_.CR)(m),!1).filter(function(b){return!!b})}var yI=function(a){(0,_.ZT)(n,a);function n(r){return a.call(this,r,$v)||this}return n.prototype.render=function(r,s,l){var u=this,h=r.titleText,f=r.data,d=r.animate,v=r.showTitle,p=r.showGrid,g=r.dataThreshold,y=r.truncRange,m=r.classNamePrefix,b=s.className||"axis";m?s.attr("className","".concat(b," ").concat(m,"axis")):s.className||s.attr("className","axis");var x=oD(f,g).filter(function(k){var P=k.value;return!(y&&P>y[0]&&P<y[1])}),E=ix(l===void 0?d:l),w=Tt(s).maybeAppendByClassName(zt.gridGroup,"g");br(w,zt.gridGroup,ge.gridGroup,m);var S=or(p,w,function(k){return RD(k,x,r,E)})||[],M=Tt(s).maybeAppendByClassName(zt.mainGroup,"g");br(M,zt.mainGroup,ge.mainGroup,m),h&&(!this.initialized&&E.enter||this.initialized&&E.update)&&Vx(r,Tt(this.offscreenGroup),x,ix(!1));var C=Vx(r,Tt(M.node()),x,E),T=Tt(s).maybeAppendByClassName(zt.titleGroup,"g");br(T,zt.titleGroup,ge.titleGroup,m);var O=or(v,T,function(k){return gI(k,u,r,E)})||[];return(0,_.ev)((0,_.ev)((0,_.ev)([],(0,_.CR)(S),!1),(0,_.CR)(C),!1),(0,_.CR)(O),!1).flat().filter(function(k){return!!k})},n}(Ve);function wG(a){var n=a.canvas,r=a.touches,s=a.offsetX,l=a.offsetY;if(n){var u=n.x,h=n.y;return[u,h]}if(r){var f=r[0],d=f.clientX,v=f.clientY;return[d,v]}return s&&l?[s,l]:[0,0]}function Hx(a){var n=a.nativeEvent,r=a.touches,s=a.clientX,l=a.clientY;if(n)return[n.clientX,n.clientY];if(r){var u=r[0],h=u.clientX,f=u.clientY;return[h,f]}return typeof s=="number"&&typeof l=="number"?[s,l]:[0,0]}function r0(a,n){return+a.toPrecision(n)}function SG(a){return a.toLocaleString()}function MG(a){return a.toExponential()}function TG(a,n){return n===void 0&&(n=0),Math.abs(a)<1e3?String(a):"".concat(r0(a/1e3,n).toLocaleString(),"K")}var CG=function(a,n,r){return a<0&&Number.isFinite(a)?n:r},OG=function(a,n,r){return a>0&&Number.isFinite(a)?n:r},kG=function(a,n){return a*n},_G=function(a,n){return a/2+(n||0)/2},i0=function(a){return a};class $x{constructor(n){this.options=(0,jn.Z)({},this.getDefaultOptions()),this.update(n)}getOptions(){return this.options}update(n={}){this.options=(0,jn.Z)({},this.options,n),this.rescale(n)}rescale(n){}}function a0(a,n){return n-a?r=>(r-a)/(n-a):r=>.5}function Nh(a,...n){return n.reduce((r,s)=>l=>r(s(l)),a)}function mI(a,n,r,s,l){let u=r||0,h=s||a.length;const f=l||(d=>d);for(;u<h;){const d=Math.floor((u+h)/2);f(a[d])>n?h=d:u=d+1}return u}var bI=Y(19818),xI=Y.n(bI);function s0(a,n,r){let s=r;return s<0&&(s+=1),s>1&&(s-=1),s<1/6?a+(n-a)*6*s:s<1/2?n:s<2/3?a+(n-a)*(2/3-s)*6:a}function EI(a){const n=a[0]/360,r=a[1]/100,s=a[2]/100,l=a[3];if(r===0)return[s*255,s*255,s*255,l];const u=s<.5?s*(1+r):s+r-s*r,h=2*s-u,f=s0(h,u,n+1/3),d=s0(h,u,n),v=s0(h,u,n-1/3);return[f*255,d*255,v*255,l]}function Ux(a){const n=xI().get(a);if(!n)return null;const{model:r,value:s}=n;return r==="rgb"?s:r==="hsl"?EI(s):null}const Rh=(a,n)=>r=>a*(1-r)+n*r,wI=(a,n)=>{const r=Ux(a),s=Ux(n);return r===null||s===null?r?()=>a:()=>n:l=>{const u=new Array(4);for(let p=0;p<4;p+=1){const g=r[p],y=s[p];u[p]=g*(1-l)+y*l}const[h,f,d,v]=u;return`rgba(${Math.round(h)}, ${Math.round(f)}, ${Math.round(d)}, ${v})`}},SI=(a,n)=>typeof a=="number"&&typeof n=="number"?Rh(a,n):typeof a=="string"&&typeof n=="string"?wI(a,n):()=>a,MI=(a,n)=>{const r=Rh(a,n);return s=>Math.round(r(s))};function TI(a){return a===null}function Yx(a){return!Ft(a)&&!TI(a)&&!Number.isNaN(a)}const o0=Math.sqrt(50),l0=Math.sqrt(10),c0=Math.sqrt(2);function Lh(a,n,r){const s=(n-a)/Math.max(0,r),l=Math.floor(Math.log(s)/Math.LN10),u=s/xc(10,l);return l>=0?(u>=o0?10:u>=l0?5:u>=c0?2:1)*xc(10,l):-xc(10,-l)/(u>=o0?10:u>=l0?5:u>=c0?2:1)}function PG(a,n,r){const s=Math.abs(n-a)/Math.max(0,r);let l=xc(10,Math.floor(Math.log(s)/Math.LN10));const u=s/l;return u>=o0?l*=10:u>=l0?l*=5:u>=c0&&(l*=2),n<a?-l:l}const CI=(a,n,r=5)=>{const s=[a,n];let l=0,u=s.length-1,h=s[l],f=s[u],d;return f<h&&([h,f]=[f,h],[l,u]=[u,l]),d=Lh(h,f,r),d>0?(h=Math.floor(h/d)*d,f=Math.ceil(f/d)*d,d=Lh(h,f,r)):d<0&&(h=Math.ceil(h*d)/d,f=Math.floor(f*d)/d,d=Lh(h,f,r)),d>0?(s[l]=Math.floor(h/d)*d,s[u]=Math.ceil(f/d)*d):d<0&&(s[l]=Math.ceil(h*d)/d,s[u]=Math.floor(f*d)/d),s};function OI(a,n){const r=n<a?n:a,s=a>n?a:n;return l=>Math.min(Math.max(r,l),s)}const kI=(a,n,r)=>{const[s,l]=a,[u,h]=n;let f,d;return s<l?(f=a0(s,l),d=r(u,h)):(f=a0(l,s),d=r(h,u)),Nh(d,f)},_I=(a,n,r)=>{const s=Math.min(a.length,n.length)-1,l=new Array(s),u=new Array(s),h=a[0]>a[s],f=h?[...a].reverse():a,d=h?[...n].reverse():n;for(let v=0;v<s;v+=1)l[v]=a0(f[v],f[v+1]),u[v]=r(d[v],d[v+1]);return v=>{const p=mI(a,v,1,s)-1,g=l[p],y=u[p];return Nh(y,g)(v)}},Xx=(a,n,r,s)=>(Math.min(a.length,n.length)>2?_I:kI)(a,n,s?MI:r);class PI extends $x{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:Rh,tickCount:5}}map(n){return Yx(n)?this.output(n):this.options.unknown}invert(n){return Yx(n)?this.input(n):this.options.unknown}nice(){if(!this.options.nice)return;const[n,r,s,...l]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(n,r,s,...l)}getTicks(){const{tickMethod:n}=this.options,[r,s,l,...u]=this.getTickMethodOptions();return n(r,s,l,...u)}getTickMethodOptions(){const{domain:n,tickCount:r}=this.options,s=n[0],l=n[n.length-1];return[s,l,r]}chooseNice(){return CI}rescale(){this.nice();const[n,r]=this.chooseTransforms();this.composeOutput(n,this.chooseClamp(n)),this.composeInput(n,r,this.chooseClamp(r))}chooseClamp(n){const{clamp:r,range:s}=this.options,l=this.options.domain.map(n),u=Math.min(l.length,s.length);return r?OI(l[0],l[u-1]):i0}composeOutput(n,r){const{domain:s,range:l,round:u,interpolate:h}=this.options,f=Xx(s.map(n),l,h,u);this.output=Nh(f,r,n)}composeInput(n,r,s){const{domain:l,range:u}=this.options,h=Xx(u,l.map(n),Rh);this.input=Nh(r,s,h)}}const AI=(a,n,r)=>{let s,l,u=a,h=n;if(u===h&&r>0)return[u];let f=Lh(u,h,r);if(f===0||!Number.isFinite(f))return[];if(f>0){u=Math.ceil(u/f),h=Math.floor(h/f),l=new Array(s=Math.ceil(h-u+1));for(let d=0;d<s;d+=1)l[d]=(u+d)*f}else{f=-f,u=Math.ceil(u*f),h=Math.floor(h*f),l=new Array(s=Math.ceil(h-u+1));for(let d=0;d<s;d+=1)l[d]=(u+d)/f}return l};class Jl extends PI{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:SI,tickMethod:AI,tickCount:5}}chooseTransforms(){return[i0,i0]}clone(){return new Jl(this.options)}}function qx({map:a,initKey:n},r){const s=n(r);return a.has(s)?a.get(s):r}function NI({map:a,initKey:n},r){const s=n(r);return a.has(s)?a.get(s):(a.set(s,r),r)}function RI({map:a,initKey:n},r){const s=n(r);return a.has(s)&&(r=a.get(s),a.delete(s)),r}function LI(a){return typeof a=="object"?a.valueOf():a}class Kx extends Map{constructor(n){if(super(),this.map=new Map,this.initKey=LI,n!==null)for(const[r,s]of n)this.set(r,s)}get(n){return super.get(qx({map:this.map,initKey:this.initKey},n))}has(n){return super.has(qx({map:this.map,initKey:this.initKey},n))}set(n,r){return super.set(NI({map:this.map,initKey:this.initKey},n),r)}delete(n){return super.delete(RI({map:this.map,initKey:this.initKey},n))}}const u0=Symbol("defaultUnknown");function Qx(a,n,r){for(let s=0;s<n.length;s+=1)a.has(n[s])||a.set(r(n[s]),s)}function Jx(a){const{value:n,from:r,to:s,mapper:l,notFoundReturn:u}=a;let h=l.get(n);if(h===void 0){if(u!==u0)return u;h=r.push(n)-1,l.set(n,h)}return s[h%s.length]}function tE(a){return a instanceof Date?n=>`${n}`:typeof a=="object"?n=>JSON.stringify(n):n=>n}class h0 extends $x{getDefaultOptions(){return{domain:[],range:[],unknown:u0}}constructor(n){super(n)}map(n){return this.domainIndexMap.size===0&&Qx(this.domainIndexMap,this.getDomain(),this.domainKey),Jx({value:this.domainKey(n),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(n){return this.rangeIndexMap.size===0&&Qx(this.rangeIndexMap,this.getRange(),this.rangeKey),Jx({value:this.rangeKey(n),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(n){const[r]=this.options.domain,[s]=this.options.range;if(this.domainKey=tE(r),this.rangeKey=tE(s),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!n||n.range)&&this.rangeIndexMap.clear(),(!n||n.domain||n.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new h0(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:n,compare:r}=this.options;return this.sortedDomain=r?[...n].sort(r):n,this.sortedDomain}}function DI(a){const n=Math.min(...a);return a.map(r=>r/n)}function II(a,n){const r=a.length,s=n-r;return s>0?[...a,...new Array(s).fill(1)]:s<0?a.slice(0,n):a}function BI(a){return Math.round(a*1e12)/1e12}function FI(a){const{domain:n,range:r,paddingOuter:s,paddingInner:l,flex:u,round:h,align:f}=a,d=n.length,v=II(u,d),[p,g]=r,y=g-p,m=2/d*s+1-1/d*l,b=y/m,x=b*l/d,E=b-d*x,w=DI(v),S=w.reduce((R,z)=>R+z),M=E/S,C=new Kx(n.map((R,z)=>{const Z=w[z]*M;return[R,h?Math.floor(Z):Z]})),T=new Kx(n.map((R,z)=>{const X=w[z]*M+x;return[R,h?Math.floor(X):X]})),O=Array.from(T.values()).reduce((R,z)=>R+z),P=(y-(O-O/d*l))*f,A=p+P;let N=h?Math.round(A):A;const L=new Array(d);for(let R=0;R<d;R+=1){L[R]=BI(N);const z=n[R];N+=T.get(z)}return{valueBandWidth:C,valueStep:T,adjustedRange:L}}function zI(a){var n;const{domain:r}=a,s=r.length;if(s===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((n=a.flex)===null||n===void 0)&&n.length))return FI(a);const{range:u,paddingOuter:h,paddingInner:f,round:d,align:v}=a;let p,g,y=u[0];const b=u[1]-y,x=h*2,E=s-f;p=b/Math.max(1,x+E),d&&(p=Math.floor(p)),y+=(b-p*(s-f))*v,g=p*(1-f),d&&(y=Math.round(y),g=Math.round(g));const w=new Array(s).fill(0).map((S,M)=>y+M*p);return{valueStep:p,valueBandWidth:g,adjustedRange:w}}class f0 extends h0{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:u0,flex:[]}}constructor(n){super(n)}clone(){return new f0(this.options)}getStep(n){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:n===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(n)}getBandWidth(n){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:n===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(n)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:n,paddingInner:r}=this.options;return n>0?n:r}getPaddingOuter(){const{padding:n,paddingOuter:r}=this.options;return n>0?n:r}rescale(){super.rescale();const{align:n,domain:r,range:s,round:l,flex:u}=this.options,{adjustedRange:h,valueBandWidth:f,valueStep:d}=zI({align:n,range:s,round:l,flex:u,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:r});this.valueStep=d,this.valueBandWidth=f,this.adjustedRange=h}}var ZI=function(a){(0,_.ZT)(n,a);function n(r){var s=this,l=r.style,u=(0,_._T)(r,["style"]);return s=a.call(this,(0,jn.Z)({},{type:"column"},(0,_.pi)({style:l},u)))||this,s.columnsGroup=new vn({name:"columns"}),s.appendChild(s.columnsGroup),s.render(),s}return n.prototype.render=function(){var r=this.attributes,s=r.columns,l=r.x,u=r.y;this.columnsGroup.style.transform="translate(".concat(l,", ").concat(u,")"),Tt(this.columnsGroup).selectAll(".column").data(s.flat()).join(function(h){return h.append("rect").attr("className","column").each(function(f){this.attr(f)})},function(h){return h.each(function(f){this.attr(f)})},function(h){return h.remove()})},n.prototype.update=function(r){this.attr(cn({},this.attributes,r)),this.render()},n.prototype.clear=function(){this.removeChildren()},n}(Pe),GI=function(a){(0,_.ZT)(n,a);function n(r){var s=this,l=r.style,u=(0,_._T)(r,["style"]);return s=a.call(this,(0,jn.Z)({},{type:"lines"},(0,_.pi)({style:l},u)))||this,s.linesGroup=s.appendChild(new vn),s.areasGroup=s.appendChild(new vn),s.render(),s}return n.prototype.render=function(){var r=this.attributes,s=r.lines,l=r.areas,u=r.x,h=r.y;this.style.transform="translate(".concat(u,", ").concat(h,")"),s&&this.renderLines(s),l&&this.renderAreas(l)},n.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},n.prototype.update=function(r){this.attr(cn({},this.attributes,r)),this.render()},n.prototype.renderLines=function(r){Tt(this.linesGroup).selectAll(".line").data(r).join(function(s){return s.append("path").attr("className","line").each(function(l){this.attr(l)})},function(s){return s.each(function(l){this.attr(l)})},function(s){return s.remove()})},n.prototype.renderAreas=function(r){Tt(this.linesGroup).selectAll(".area").data(r).join(function(s){return s.append("path").attr("className","area").each(function(l){this.attr(l)})},function(s){return s.each(function(l){this.style(l)})},function(s){return s.remove()})},n}(Pe);function WI(a,n,r,s){var l,u=[],h=!!s,f,d,v=[1/0,1/0],p=[-1/0,-1/0],g,y,m;if(h){l=(0,_.CR)(s,2),v=l[0],p=l[1];for(var b=0,x=a.length;b<x;b+=1){var E=a[b];v=vs(v,E),p=ps(p,E)}}for(var b=0,w=a.length;b<w;b+=1){var E=a[b];if(b===0&&!r)m=E;else if(b===w-1&&!r)y=E,u.push(m),u.push(y);else{var S=[b?b-1:w-1,b-1][r?0:1];f=a[S],d=a[r?(b+1)%w:b+1];var M=[0,0];M=Uv(d,f),M=Vi(M,n);var C=Xl(E,f),T=Xl(E,d),O=C+T;O!==0&&(C/=O,T/=O);var k=Vi(M,-C),P=Vi(M,T);y=Yl(E,k),g=Yl(E,P),g=vs(g,ps(d,E)),g=ps(g,vs(d,E)),k=Uv(g,E),k=Vi(k,-C/T),y=Yl(E,k),y=vs(y,ps(f,E)),y=ps(y,vs(f,E)),P=Uv(E,y),P=Vi(P,T/C),g=Yl(E,P),h&&(y=ps(y,v),y=vs(y,p),g=ps(g,v),g=vs(g,p)),u.push(m),u.push(y),m=g}}return r&&u.push(u.shift()),u}function jI(a,n,r){var s;n===void 0&&(n=!1),r===void 0&&(r=[[0,0],[1,1]]);for(var l=!!n,u=[],h=0,f=a.length;h<f;h+=2)u.push([a[h],a[h+1]]);for(var d=WI(u,.4,l,r),v=u.length,p=[],g,y,m,h=0;h<v-1;h+=1)g=d[h*2],y=d[h*2+1],m=u[h+1],p.push(["C",g[0],g[1],y[0],y[1],m[0],m[1]]);return l&&(g=d[v],y=d[v+1],s=(0,_.CR)(u,1),m=s[0],p.push(["C",g[0],g[1],y[0],y[1],m[0],m[1]])),p}function VI(a,n){var r,s=n.x,l=n.y,u=(0,_.CR)(l.getOptions().range||[0,0],2),h=u[0],f=u[1];return f>h&&(r=(0,_.CR)([h,f],2),f=r[0],h=r[1]),a.map(function(d){var v=d.map(function(p,g){return[s.map(g),Ze(l.map(p),f,h)]});return v})}function tc(a,n){n===void 0&&(n=!1);var r=n?a.length-1:0,s=a.map(function(l,u){return(0,_.ev)([u===r?"M":"L"],(0,_.CR)(l),!1)});return n?s.reverse():s}function Dh(a,n){if(n===void 0&&(n=!1),a.length<=2)return tc(a);for(var r=[],s=a.length,l=0;l<s;l+=1){var u=n?a[s-l-1]:a[l];Je(u,r.slice(-2))||r.push.apply(r,(0,_.ev)([],(0,_.CR)(u),!1))}var h=jI(r,!1);return n?h.unshift((0,_.ev)(["M"],(0,_.CR)(a[s-1]),!1)):h.unshift((0,_.ev)(["M"],(0,_.CR)(a[0]),!1)),h}function d0(a,n,r){var s=(0,Ou.Z)(a);return s.push(["L",n,r],["L",0,r],["Z"]),s}function HI(a,n,r,s){return a.map(function(l){return d0(n?Dh(l):tc(l),r,s)})}function $I(a,n,r){for(var s=[],l=a.length-1;l>=0;l-=1){var u=a[l],h=tc(u),f=void 0;if(l===0)f=d0(h,n,r);else{var d=a[l-1],v=tc(d,!0);v[0][0]="L",f=(0,_.ev)((0,_.ev)((0,_.ev)([],(0,_.CR)(h),!1),(0,_.CR)(v),!1),[["Z"]],!1)}s.push(f)}return s}function UI(a,n,r){for(var s=[],l=a.length-1;l>=0;l-=1){var u=a[l],h=Dh(u),f=void 0;if(l===0)f=d0(h,n,r);else{var d=a[l-1],v=Dh(d,!0),p=u[0];v[0][0]="L",f=(0,_.ev)((0,_.ev)((0,_.ev)([],(0,_.CR)(h),!1),(0,_.CR)(v),!1),[(0,_.ev)(["M"],(0,_.CR)(p),!1),["Z"]],!1)}s.push(f)}return s}var YI=function(a,n){if((0,Gr.Z)(a)){for(var r,s=1/0,l=0;l<a.length;l++){var u=a[l],h=(0,_t.Z)(n)?n(u):u[n];h<s&&(r=u,s=h)}return r}},XI=function(a,n){if((0,Gr.Z)(a)){for(var r,s=-1/0,l=0;l<a.length;l++){var u=a[l],h=(0,_t.Z)(n)?n(u):u[n];h>s&&(r=u,s=h)}return r}};function eE(a){return a.length===0?[0,0]:[Rc(YI(a,function(n){return Rc(n)||0})),Lc(XI(a,function(n){return Lc(n)||0}))]}function nE(a){for(var n=(0,Ou.Z)(a),r=n[0].length,s=(0,_.CR)([Array(r).fill(0),Array(r).fill(0)],2),l=s[0],u=s[1],h=0;h<n.length;h+=1)for(var f=n[h],d=0;d<r;d+=1)f[d]>=0?(f[d]+=l[d],l[d]=f[d]):(f[d]+=u[d],u[d]=f[d]);return n}var qI=function(a){(0,_.ZT)(n,a);function n(r){return a.call(this,r,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(n.prototype,"rawData",{get:function(){var r=this.attributes.data;if(!r||(r==null?void 0:r.length)===0)return[[]];var s=(0,Ou.Z)(r);return(0,se.Z)(s[0])?[s]:s},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this.attributes.isStack?nE(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"baseline",{get:function(){var r=this.scales.y,s=(0,_.CR)(r.getOptions().domain||[0,0],2),l=s[0],u=s[1];return u<0?r.map(u):r.map(l<0?0:l)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"containerShape",{get:function(){var r=this.attributes,s=r.width,l=r.height;return{width:s,height:l}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"linesStyle",{get:function(){var r=this,s=this.attributes,l=s.type,u=s.isStack,h=s.smooth;if(l!=="line")throw new Error("linesStyle can only be used in line type");var f=Wt(this.attributes,"area"),d=Wt(this.attributes,"line"),v=this.containerShape.width,p=this.data;if(p[0].length===0)return{lines:[],areas:[]};var g=this.scales,y=g.x,m=g.y,b=VI(p,{type:"line",x:y,y:m}),x=[];if(f){var E=this.baseline;u?x=h?UI(b,v,E):$I(b,v,E):x=HI(b,h,v,E)}return{lines:b.map(function(w,S){return(0,_.pi)({stroke:r.getColor(S),d:h?Dh(w):tc(w)},d)}),areas:x.map(function(w,S){return(0,_.pi)({d:w,fill:r.getColor(S)},f)})}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnsStyle",{get:function(){var r=this,s=Wt(this.attributes,"column"),l=this.attributes,u=l.isStack,h=l.type,f=l.scale;if(h!=="column")throw new Error("columnsStyle can only be used in column type");var d=this.containerShape.height,v=this.rawData;if(!v)return{columns:[]};u&&(v=nE(v));var p=this.createScales(v),g=p.x,y=p.y,m=(0,_.CR)(eE(v),2),b=m[0],x=m[1],E=new Jl({domain:[0,x-(b>0?0:b)],range:[0,d*f]}),w=g.getBandWidth(),S=this.rawData;return{columns:v.map(function(M,C){return M.map(function(T,O){var k=w/v.length,P=function(){return{x:g.map(O)+k*C,y:T>=0?y.map(T):y.map(0),width:k,height:E.map(Math.abs(T))}},A=function(){return{x:g.map(O),y:y.map(T),width:w,height:E.map(S[C][O])}};return(0,_.pi)((0,_.pi)({fill:r.getColor(C)},s),u?A():P())})})}},enumerable:!1,configurable:!0}),n.prototype.render=function(r,s){tL(s,".container","rect").attr("className","container").node();var l=r.type,u=r.x,h=r.y,f="spark".concat(l),d=(0,_.pi)({x:u,y:h},l==="line"?this.linesStyle:this.columnsStyle);Tt(s).selectAll(".spark").data([l]).join(function(v){return v.append(function(p){return p==="line"?new GI({className:f,style:d}):new ZI({className:f,style:d})}).attr("className","spark ".concat(f))},function(v){return v.update(d)},function(v){return v.remove()})},n.prototype.getColor=function(r){var s=this.attributes.color;return(0,Gr.Z)(s)?s[r%s.length]:(0,_t.Z)(s)?s.call(null,r):s},n.prototype.createScales=function(r){var s,l,u=this.attributes,h=u.type,f=u.scale,d=u.range,v=d===void 0?[]:d,p=u.spacing,g=this.containerShape,y=g.width,m=g.height,b=(0,_.CR)(eE(r),2),x=b[0],E=b[1],w=new Jl({domain:[(s=v[0])!==null&&s!==void 0?s:x,(l=v[1])!==null&&l!==void 0?l:E],range:[m,m*(1-f)]});return h==="line"?{type:h,x:new Jl({domain:[0,r[0].length-1],range:[0,y]}),y:w}:{type:h,x:new f0({domain:r[0].map(function(S,M){return M}),range:[0,y],paddingInner:p,paddingOuter:p/2,align:.5}),y:w}},n.tag="sparkline",n}(Ve),rE={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},iE={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},aE={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},Ti=ti({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),Dr=ti({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),KI=function(a){(0,_.ZT)(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return n.prototype.render=function(r,s){var l=r.x,u=r.y,h=r.size,f=h===void 0?10:h,d=r.radius,v=d===void 0?f/4:d,p=r.orientation,g=r.classNamePrefix,y=(0,_._T)(r,["x","y","size","radius","orientation","classNamePrefix"]),m=f,b=m*2.4,x=g?"".concat(Dr.iconRect.name," ").concat(g,"handle-icon-rect"):Dr.iconRect.name,E=function(O){return g?"".concat(Dr.iconLine,"-").concat(O," ").concat(g,"handle-icon-line"):"".concat(Dr.iconLine,"-").concat(O)},w=Tt(s).maybeAppendByClassName(Dr.iconRect,"rect").attr("className",x).styles((0,_.pi)((0,_.pi)({},y),{width:m,height:b,radius:v,x:l-m/2,y:u-b/2,transformOrigin:"center"})),S=l+1/3*m-m/2,M=l+2/3*m-m/2,C=u+1/4*b-b/2,T=u+3/4*b-b/2;w.maybeAppendByClassName("".concat(Dr.iconLine,"-1"),"line").attr("className",E(1)).styles((0,_.pi)({x1:S,x2:S,y1:C,y2:T},y)),w.maybeAppendByClassName("".concat(Dr.iconLine,"-2"),"line").attr("className",E(2)).styles((0,_.pi)({x1:M,x2:M,y1:C,y2:T},y)),p==="vertical"&&(w.node().style.transform="rotate(90)")},n}(Ve),QI=function(a){(0,_.ZT)(n,a);function n(r){return a.call(this,r,aE)||this}return n.prototype.renderLabel=function(r){var s=this,l=this.attributes,u=l.x,h=l.y,f=l.showLabel,d=Wt(this.attributes,"label"),v=d.x,p=v===void 0?0:v,g=d.y,y=g===void 0?0:g,m=d.transform,b=d.transformOrigin,x=(0,_._T)(d,["x","y","transform","transformOrigin"]),E=(0,_.CR)(Wi(x,[]),2),w=E[0],S=E[1],M=Tt(r).maybeAppendByClassName(Dr.labelGroup,"g").styles(S),C=(0,_.pi)((0,_.pi)({},iE),w),T=C.text,O=(0,_._T)(C,["text"]);or(!!f,M,function(k){s.label=k.maybeAppendByClassName(Dr.label,"text").styles((0,_.pi)((0,_.pi)({},O),{x:u+p,y:h+y,transform:m,transformOrigin:b,text:"".concat(T)})),s.label.on("mousedown",function(P){P.stopPropagation()}),s.label.on("touchstart",function(P){P.stopPropagation()})})},n.prototype.renderIcon=function(r){var s=this.attributes,l=s.x,u=s.y,h=s.orientation,f=s.type,d=s.classNamePrefix,v=(0,_.pi)((0,_.pi)({x:l,y:u,orientation:h,classNamePrefix:d},rE),Wt(this.attributes,"icon")),p=this.attributes.iconShape,g=p===void 0?function(){return new KI({style:v})}:p,y=Tt(r).maybeAppendByClassName(Dr.iconGroup,"g");y.selectAll(Dr.icon.class).data([g]).join(function(m){return m.append(typeof g=="string"?g:function(){return g(f)}).attr("className",Dr.icon.name)},function(m){return m.update(v)},function(m){return m.remove()})},n.prototype.render=function(r,s){this.renderIcon(s),this.renderLabel(s)},n}(Ve),JI=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,r,(0,_.pi)((0,_.pi)((0,_.pi)({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(l){return l.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},Ys(aE,"handle")),Ys(rE,"handleIcon")),Ys(iE,"handleLabel")))||this;return s.range=[0,1],s.onDragStart=function(l){return function(u){u.stopPropagation(),s.target=l,s.prevPos=s.getOrientVal(Hx(u));var h=s.availableSpace,f=h.x,d=h.y,v=s.getBBox(),p=v.x,g=v.y;s.selectionStartPos=s.getRatio(s.prevPos-s.getOrientVal([f,d])-s.getOrientVal([+p,+g])),s.selectionWidth=0,document.addEventListener("pointermove",s.onDragging),document.addEventListener("pointerup",s.onDragEnd)}},s.onDragging=function(l){var u=s.attributes,h=u.slidable,f=u.brushable,d=u.type;l.stopPropagation();var v=s.getOrientVal(Hx(l)),p=v-s.prevPos;if(p){var g=s.getRatio(p);switch(s.target){case"start":h&&s.setValuesOffset(g);break;case"end":h&&s.setValuesOffset(0,g);break;case"selection":h&&s.setValuesOffset(g,g);break;case"track":if(!f)return;s.selectionWidth+=g,d==="range"?s.innerSetValues([s.selectionStartPos,s.selectionStartPos+s.selectionWidth].sort(),!0):s.innerSetValues([0,s.selectionStartPos+s.selectionWidth],!0);break;default:break}s.prevPos=v}},s.onDragEnd=function(){document.removeEventListener("pointermove",s.onDragging),document.removeEventListener("pointermove",s.onDragging),document.removeEventListener("pointerup",s.onDragEnd),s.target="",s.updateHandlesPosition(!1)},s.onValueChange=function(l){var u=s.attributes,h=u.onChange,f=u.type,d=f==="range"?l:l[1],v=f==="range"?s.getValues():s.getValues()[1],p=new sn("valuechange",{detail:{oldValue:d,value:v}});s.dispatchEvent(p),h==null||h(v)},s.selectionStartPos=0,s.selectionWidth=0,s.prevPos=0,s.target="",s}return Object.defineProperty(n.prototype,"values",{get:function(){return this.attributes.values},set:function(r){this.attributes.values=this.clampValues(r)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sparklineStyle",{get:function(){var r=this.attributes.orientation;if(r!=="horizontal")return null;var s=Wt(this.attributes,"sparkline");return(0,_.pi)((0,_.pi)({zIndex:0},this.availableSpace),s)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"shape",{get:function(){var r=this.attributes,s=r.trackLength,l=r.trackSize,u=(0,_.CR)(this.getOrientVal([[s,l],[l,s]]),2),h=u[0],f=u[1];return{width:h,height:f}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"availableSpace",{get:function(){var r=this.attributes,s=r.x,l=r.y,u=r.padding,h=(0,_.CR)(Cn(u),4),f=h[0],d=h[1],v=h[2],p=h[3],g=this.shape,y=g.width,m=g.height;return{x:p,y:f,width:y-(p+d),height:m-(f+v)}},enumerable:!1,configurable:!0}),n.prototype.getValues=function(){return this.values},n.prototype.setValues=function(r,s){r===void 0&&(r=[0,0]),s===void 0&&(s=!1),this.attributes.values=r;var l=s===!1?!1:this.attributes.animate;this.updateSelectionArea(l),this.updateHandlesPosition(l)},n.prototype.updateSelectionArea=function(r){var s=this.calcSelectionArea();this.foregroundGroup.selectAll(Ti.selection.class).each(function(l,u){ei(this,s[u],r)})},n.prototype.updateHandlesPosition=function(r){this.attributes.showHandle&&(this.startHandle&&ei(this.startHandle,this.getHandleStyle("start"),r),this.endHandle&&ei(this.endHandle,this.getHandleStyle("end"),r))},n.prototype.innerSetValues=function(r,s){r===void 0&&(r=[0,0]),s===void 0&&(s=!1);var l=this.values,u=this.clampValues(r);this.attributes.values=u,this.setValues(u),s&&this.onValueChange(l)},n.prototype.renderTrack=function(r){var s=this.attributes,l=s.x,u=s.y,h=Wt(this.attributes,"track");this.trackShape=Tt(r).maybeAppendByClassName(Ti.track,"rect").styles((0,_.pi)((0,_.pi)({x:l,y:u},this.shape),h))},n.prototype.renderBrushArea=function(r){var s=this.attributes,l=s.x,u=s.y,h=s.brushable;this.brushArea=Tt(r).maybeAppendByClassName(Ti.brushArea,"rect").styles((0,_.pi)({x:l,y:u,fill:"transparent",cursor:h?"crosshair":"default"},this.shape))},n.prototype.renderSparkline=function(r){var s=this,l=this.attributes,u=l.x,h=l.y,f=l.orientation,d=Tt(r).maybeAppendByClassName(Ti.sparklineGroup,"g");or(f==="horizontal",d,function(v){var p=(0,_.pi)((0,_.pi)({},s.sparklineStyle),{x:u,y:h});v.maybeAppendByClassName(Ti.sparkline,function(){return new qI({style:p})}).update(p)})},n.prototype.renderHandles=function(){var r=this,s,l=this.attributes,u=l.showHandle,h=l.type,f=h==="range"?["start","end"]:["end"],d=u?f:[],v=this;(s=this.foregroundGroup)===null||s===void 0||s.selectAll(Ti.handle.class).data(d.map(function(p){return{type:p}}),function(p){return p.type}).join(function(p){return p.append(function(g){var y=g.type;return new QI({style:r.getHandleStyle(y)})}).each(function(g){var y=g.type;this.attr("class","".concat(Ti.handle.name," ").concat(y,"-handle"));var m="".concat(y,"Handle");v[m]=this,this.addEventListener("pointerdown",v.onDragStart(y))})},function(p){return p.each(function(g){var y=g.type;this.update(v.getHandleStyle(y))})},function(p){return p.each(function(g){var y=g.type,m="".concat(y,"Handle");v[m]=void 0}).remove()})},n.prototype.renderSelection=function(r){var s=this.attributes,l=s.x,u=s.y,h=s.type,f=s.selectionType;this.foregroundGroup=Tt(r).maybeAppendByClassName(Ti.foreground,"g");var d=Wt(this.attributes,"selection"),v=function(g){return g.style("visibility",function(y){return y.show?"visible":"hidden"}).style("cursor",function(y){return f==="select"?"grab":f==="invert"?"crosshair":"default"}).styles((0,_.pi)((0,_.pi)({},d),{transform:"translate(".concat(l,", ").concat(u,")")}))},p=this;this.foregroundGroup.selectAll(Ti.selection.class).data(h==="value"?[]:this.calcSelectionArea().map(function(g,y){return{style:(0,_.pi)({},g),index:y,show:f==="select"?y===1:y!==1}}),function(g){return g.index}).join(function(g){return g.append("rect").attr("className",Ti.selection.name).call(v).each(function(y,m){var b=this;m===1?(p.selectionShape=Tt(this),this.on("pointerdown",function(x){b.attr("cursor","grabbing"),p.onDragStart("selection")(x)}),p.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),p.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),p.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){b.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){b.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){b.attr("cursor","pointer")})):this.on("pointerdown",p.onDragStart("track"))})},function(g){return g.call(v)},function(g){return g.remove()}),this.updateSelectionArea(!1),this.renderHandles()},n.prototype.render=function(r,s){this.renderTrack(s),this.renderSparkline(s),this.renderBrushArea(s),this.renderSelection(s)},n.prototype.clampValues=function(r,s){var l;s===void 0&&(s=4);var u=(0,_.CR)(this.range,2),h=u[0],f=u[1],d=(0,_.CR)(this.getValues().map(function(E){return r0(E,s)}),2),v=d[0],p=d[1],g=Array.isArray(r)?r:[v,r!=null?r:p],y=(0,_.CR)((g||[v,p]).map(function(E){return r0(E,s)}),2),m=y[0],b=y[1];if(this.attributes.type==="value")return[0,Ze(b,h,f)];m>b&&(l=(0,_.CR)([b,m],2),m=l[0],b=l[1]);var x=b-m;return x>f-h?[h,f]:m<h?v===h&&p===b?[h,b]:[h,x+h]:b>f?p===f&&v===m?[m,f]:[f-x,f]:[m,b]},n.prototype.calcSelectionArea=function(r){var s=(0,_.CR)(this.clampValues(r),2),l=s[0],u=s[1],h=this.availableSpace,f=h.x,d=h.y,v=h.width,p=h.height;return this.getOrientVal([[{y:d,height:p,x:f,width:l*v},{y:d,height:p,x:l*v+f,width:(u-l)*v},{y:d,height:p,x:u*v,width:(1-u)*v}],[{x:f,width:v,y:d,height:l*p},{x:f,width:v,y:l*p+d,height:(u-l)*p},{x:f,width:v,y:u*p,height:(1-u)*p}]])},n.prototype.calcHandlePosition=function(r){var s=this.attributes.handleIconOffset,l=this.availableSpace,u=l.x,h=l.y,f=l.width,d=l.height,v=(0,_.CR)(this.clampValues(),2),p=v[0],g=v[1],y=r==="start"?-s:s,m=(r==="start"?p:g)*this.getOrientVal([f,d])+y;return{x:u+this.getOrientVal([m,f/2]),y:h+this.getOrientVal([d/2,m])}},n.prototype.inferTextStyle=function(r){var s=this.attributes.orientation;return s==="horizontal"?{}:r==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:r==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},n.prototype.calcHandleText=function(r){var s,l=this.attributes,u=l.type,h=l.orientation,f=l.formatter,d=l.autoFitLabel,v=Wt(this.attributes,"handle"),p=Wt(v,"label"),g=v.spacing,y=this.getHandleSize(),m=this.clampValues(),b=r==="start"?m[0]:m[1],x=f(b),E=new Iv({style:(0,_.pi)((0,_.pi)((0,_.pi)({},p),this.inferTextStyle(r)),{text:x})}),w=E.getBBox(),S=w.width,M=w.height;if(E.destroy(),!d){if(u==="value")return{text:x,x:0,y:-M-g};var C=g+y+(h==="horizontal"?S/2:0);return s={text:x},s[h==="horizontal"?"x":"y"]=r==="start"?-C:C,s}var T=0,O=0,k=this.availableSpace,P=k.width,A=k.height,N=this.calcSelectionArea()[1],L=N.x,R=N.y,z=N.width,Z=N.height,X=g+y;if(h==="horizontal"){var nt=X+S/2;if(r==="start"){var K=L-X-S;T=K>0?-nt:nt}else{var rt=P-L-z-X>S;T=rt?nt:-nt}}else{var U=X,at=M+X;r==="start"?O=R-y>M?-at:U:O=A-(R+Z)-y>M?at:-U}return{x:T,y:O,text:x}},n.prototype.getHandleLabelStyle=function(r){var s=Wt(this.attributes,"handleLabel");return(0,_.pi)((0,_.pi)((0,_.pi)({},s),this.calcHandleText(r)),this.inferTextStyle(r))},n.prototype.getHandleIconStyle=function(){var r=this.attributes.handleIconShape,s=Wt(this.attributes,"handleIcon"),l=this.getOrientVal(["ew-resize","ns-resize"]),u=this.getHandleSize();return(0,_.pi)({cursor:l,shape:r,size:u},s)},n.prototype.getHandleStyle=function(r){var s=this.attributes,l=s.x,u=s.y,h=s.showLabel,f=s.showLabelOnInteraction,d=s.orientation,v=this.calcHandlePosition(r),p=v.x,g=v.y,y=this.calcHandleText(r),m=h;return!h&&f&&(this.target?m=!0:m=!1),(0,_.pi)((0,_.pi)((0,_.pi)({},Ys(this.getHandleIconStyle(),"icon")),Ys((0,_.pi)((0,_.pi)({},this.getHandleLabelStyle(r)),y),"label")),{transform:"translate(".concat(p+l,", ").concat(g+u,")"),orientation:d,showLabel:m,type:r,zIndex:3})},n.prototype.getHandleSize=function(){var r=this.attributes,s=r.handleIconSize,l=r.width,u=r.height;return s||Math.floor((this.getOrientVal([+u,+l])+4)/2.4)},n.prototype.getOrientVal=function(r){var s=(0,_.CR)(r,2),l=s[0],u=s[1],h=this.attributes.orientation;return h==="horizontal"?l:u},n.prototype.setValuesOffset=function(r,s){s===void 0&&(s=0);var l=this.attributes.type,u=(0,_.CR)(this.getValues(),2),h=u[0],f=u[1],d=l==="range"?r:0,v=[h+d,f+s].sort();this.innerSetValues(v,!0)},n.prototype.getRatio=function(r){var s=this.availableSpace,l=s.width,u=s.height;return r/this.getOrientVal([l,u])},n.prototype.dispatchCustomEvent=function(r,s,l){var u=this;r.on(s,function(h){h.stopPropagation(),u.dispatchEvent(new sn(l,{detail:h}))})},n.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var r=this.brushArea;this.dispatchCustomEvent(r,"click","trackClick"),this.dispatchCustomEvent(r,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(r,"pointerleave","trackMouseleave"),r.on("pointerdown",this.onDragStart("track"))},n.prototype.onScroll=function(r){var s=this.attributes.scrollable;if(s){var l=r.deltaX,u=r.deltaY,h=u||l,f=this.getRatio(h);this.setValuesOffset(f,f)}},n.tag="slider",n}(Ve),t6={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(a){return a.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},v0=ti({background:"background",labelGroup:"label-group",label:"label"},"indicator"),e6=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,r,t6)||this;return s.point=[0,0],s.group=s.appendChild(new vn({})),s.isMutationObserved=!0,s}return n.prototype.renderBackground=function(){if(this.label){var r=this.attributes,s=r.position,l=r.padding,u=(0,_.CR)(Cn(l),4),h=u[0],f=u[1],d=u[2],v=u[3],p=this.label.node().getLocalBounds(),g=p.min,y=p.max,m=new Dn(g[0]-v,g[1]-h,y[0]+f-g[0]+v,y[1]+d-g[1]+h),b=this.getPath(s,m),x=Wt(this.attributes,"background");this.background=Tt(this.group).maybeAppendByClassName(v0.background,"path").styles((0,_.pi)((0,_.pi)({},x),{d:b})),this.group.appendChild(this.label.node())}},n.prototype.renderLabel=function(){var r=this.attributes,s=r.formatter,l=r.labelText,u=Wt(this.attributes,"label"),h=(0,_.CR)(Wi(u),2),f=h[0],d=h[1],v=f.text,p=(0,_._T)(f,["text"]);if(this.label=Tt(this.group).maybeAppendByClassName(v0.labelGroup,"g").styles(d),!!l){var g=this.label.maybeAppendByClassName(v0.label,function(){return ji(s(l))}).style("text",s(l).toString());g.selectAll("text").styles(p)}},n.prototype.adjustLayout=function(){var r=(0,_.CR)(this.point,2),s=r[0],l=r[1],u=this.attributes,h=u.x,f=u.y;this.group.attr("transform","translate(".concat(h-s,", ").concat(f-l,")"))},n.prototype.getPath=function(r,s){var l=this.attributes.radius,u=s.x,h=s.y,f=s.width,d=s.height,v=[["M",u+l,h],["L",u+f-l,h],["A",l,l,0,0,1,u+f,h+l],["L",u+f,h+d-l],["A",l,l,0,0,1,u+f-l,h+d],["L",u+l,h+d],["A",l,l,0,0,1,u,h+d-l],["L",u,h+l],["A",l,l,0,0,1,u+l,h],["Z"]],p={top:4,right:6,bottom:0,left:2},g=p[r],y=this.createCorner([v[g].slice(-2),v[g+1].slice(-2)]);return v.splice.apply(v,(0,_.ev)([g+1,1],(0,_.CR)(y),!1)),v[0][0]="M",v},n.prototype.createCorner=function(r,s){s===void 0&&(s=10);var l=.8,u=IL.apply(void 0,(0,_.ev)([],(0,_.CR)(r),!1)),h=(0,_.CR)(r,2),f=(0,_.CR)(h[0],2),d=f[0],v=f[1],p=(0,_.CR)(h[1],2),g=p[0],y=p[1],m=(0,_.CR)(u?[g-d,[d,g]]:[y-v,[v,y]],2),b=m[0],x=(0,_.CR)(m[1],2),E=x[0],w=x[1],S=b/2,M=b/Math.abs(b),C=s*M,T=C/2,O=C*Math.sqrt(3)/2*l,k=(0,_.CR)([E,E+S-T,E+S,E+S+T,w],5),P=k[0],A=k[1],N=k[2],L=k[3],R=k[4];return u?(this.point=[N,v-O],[["L",P,v],["L",A,v],["L",N,v-O],["L",L,v],["L",R,v]]):(this.point=[d+O,N],[["L",d,P],["L",d,A],["L",d+O,N],["L",d,L],["L",d,R]])},n.prototype.applyVisibility=function(){var r=this.attributes.visibility;r==="hidden"?Jr(this):Vl(this)},n.prototype.bindEvents=function(){this.label.on($t.BOUNDS_CHANGED,this.renderBackground)},n.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},n}(Ve),n6=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,cn({},n.defaultOptions,r))||this;return s.hoverColor="#f5f5f5",s.selectedColor="#e6f7ff",s.background=s.appendChild(new Sn({})),s.label=s.background.appendChild(new vn({})),s}return Object.defineProperty(n.prototype,"padding",{get:function(){return Cn(this.style.padding)},enumerable:!1,configurable:!0}),n.prototype.renderLabel=function(){var r=this.style,s=r.label,l=r.value,u=Wt(this.attributes,"label");Tt(this.label).maybeAppend(".label",function(){return ji(s)}).attr("className","label").styles(u),this.label.attr("__data__",l)},n.prototype.renderBackground=function(){var r=this.label.getBBox(),s=(0,_.CR)(this.padding,4),l=s[0],u=s[1],h=s[2],f=s[3],d=r.width,v=r.height,p=d+f+u,g=v+l+h,y=Wt(this.attributes,"background"),m=this.style,b=m.width,x=b===void 0?0:b,E=m.height,w=E===void 0?0:E,S=m.selected;this.background.attr((0,_.pi)((0,_.pi)({},y),{width:Math.max(p,x),height:Math.max(g,w),fill:S?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(f,", ").concat((g-v)/2,")")})},n.prototype.render=function(){this.renderLabel(),this.renderBackground()},n.prototype.bindEvents=function(){var r=this;this.addEventListener("pointerenter",function(){r.style.selected||r.background.attr("fill",r.hoverColor)}),this.addEventListener("pointerleave",function(){r.style.selected||r.background.attr("fill",r.style.backgroundFill)});var s=this;this.addEventListener("click",function(){var l=r.style,u=l.label,h=l.value,f=l.onClick;f==null||f(h,{label:u,value:h},s)})},n.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},n}(Ve),r6=function(a){(0,_.ZT)(n,a);function n(r){var s,l,u=a.call(this,cn({},n.defaultOptions,r))||this;u.currentValue=(s=n.defaultOptions.style)===null||s===void 0?void 0:s.defaultValue,u.isPointerInSelect=!1,u.select=u.appendChild(new Sn({className:"select",style:{cursor:"pointer",width:0,height:0}})),u.dropdown=u.appendChild(new Sn({className:"dropdown"}));var h=u.style.defaultValue;return h&&(!((l=u.style.options)===null||l===void 0)&&l.some(function(f){return f.value===h}))&&(u.currentValue=h),u}return n.prototype.setValue=function(r){this.currentValue=r,this.render()},n.prototype.getValue=function(){return this.currentValue},Object.defineProperty(n.prototype,"dropdownPadding",{get:function(){return Cn(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),n.prototype.renderSelect=function(){var r=this,s,l=this.style,u=l.x,h=l.y,f=l.width,d=l.height,v=l.bordered,p=l.showDropdownIcon,g=Wt(this.attributes,"select"),y=Wt(this.attributes,"placeholder");this.select.attr((0,_.pi)((0,_.pi)({x:u,y:h,width:f,height:d},g),{fill:"#fff",strokeWidth:v?1:0}));var m=this.dropdownPadding,b=10;p&&Tt(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(u+f-b-m[1]-m[3],", ").concat(h+d/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var x=(s=this.style.options)===null||s===void 0?void 0:s.find(function(M){return M.value===r.currentValue}),E=(0,_.pi)({x:u+m[3]},y);Tt(this.select).selectAll(".placeholder").data(x?[]:[1]).join(function(M){return M.append("text").attr("className","placeholder").styles(E).style("y",function(){var C=this.getBBox();return h+(d-C.height)/2})},function(M){return M.styles(E)},function(M){return M.remove()});var w=Wt(this.attributes,"optionLabel"),S=(0,_.pi)({x:u+m[3]},w);Tt(this.select).selectAll(".value").data(x?[x]:[]).join(function(M){return M.append(function(C){return ji(C.label)}).attr("className","value").styles(S).style("y",function(){var C=this.getBBox();return h+(d-C.height)/2})},function(M){return M.styles(S)},function(M){return M.remove()})},n.prototype.renderDropdown=function(){var r=this,s,l,u=this.style,h=u.x,f=u.y,d=u.width,v=u.height,p=u.options,g=u.onSelect,y=u.open,m=Wt(this.attributes,"dropdown"),b=Wt(this.attributes,"option"),x=this.dropdownPadding;Tt(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(p,function(S){return S.value}).join(function(S){return S.append(function(M){return new n6({className:"dropdown-item",style:(0,_.pi)((0,_.pi)((0,_.pi)({},M),b),{width:d-x[1]-x[3],selected:M.value===r.currentValue,onClick:function(C,T,O){r.setValue(C),g==null||g(C,T,O),r.dispatchEvent(new sn("change",{detail:{value:C,option:T,item:O}})),Jr(r.dropdown)}})})}).each(function(M,C){var T,O=(T=this.parentNode)===null||T===void 0?void 0:T.children,k=O.reduce(function(P,A,N){return N<C&&(P+=A.getBBox().height),P},0);this.attr("transform","translate(".concat(x[3],", ").concat(x[0]+k,")"))})},function(S){return S.update(function(M){return{selected:M.value===r.currentValue}})},function(S){return S.remove()});var E=(l=(s=this.dropdown.getElementsByClassName("dropdown-container"))===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.getBBox(),w=m.spacing;this.dropdown.attr((0,_.pi)({transform:"translate(".concat(h,", ").concat(f+v+w,")"),width:E.width+x[1]+x[3],height:E.height+x[0]+x[2]},m)),!y&&Jr(this.dropdown)},n.prototype.render=function(){this.renderSelect(),this.renderDropdown()},n.prototype.bindEvents=function(){var r=this;this.addEventListener("click",function(s){s.stopPropagation()}),this.select.addEventListener("click",function(){r.dropdown.style.visibility==="visible"?Jr(r.dropdown):Vl(r.dropdown)}),this.addEventListener("pointerenter",function(){r.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){r.isPointerInSelect=!1}),document==null||document.addEventListener("click",function(){r.isPointerInSelect||Jr(r.dropdown)})},n.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"\u8BF7\u9009\u62E9",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},n}(Ve),ni=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,cn({},{style:{backgroundOpacity:n.backgroundOpacities.default}},n.defaultOptions,r))||this;return s.showBackground=!0,s.background=s.appendChild(new Sn({})),s.icon=s.appendChild(new vn({})),s}return Object.defineProperty(n.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"padding",{get:function(){return Cn(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"iconSize",{get:function(){var r=this.attributes.size,s=(0,_.CR)(this.padding,4),l=s[0],u=s[1],h=s[2],f=s[3];return Math.max(r-Math.max(f+u,l+h),this.lineWidth*2+1)},enumerable:!1,configurable:!0}),n.prototype.renderBackground=function(){var r=this.attributes,s=r.x,l=r.y,u=r.size,h=u/2,f=Wt(this.attributes,"background");this.background.attr((0,_.pi)({x:s-h,y:l-h,width:u,height:u},f))},n.prototype.showIndicator=function(){if(this.label){var r=this.attributes.size,s=this.background.getBBox(),l=s.x,u=s.y;this.indicator.update({x:l+r/2,y:u-5,labelText:this.label,visibility:"visible"})}},n.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},n.prototype.connectedCallback=function(){var r;a.prototype.connectedCallback.call(this);var s=this.attributes.size,l=this.background.getBBox(),u=l.x,h=l.y,f=(r=this.ownerDocument)===null||r===void 0?void 0:r.defaultView;f&&(this.indicator=f.appendChild(new e6({style:{x:u+s/2,y:h-s/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},n.prototype.disconnectedCallback=function(){this.indicator.destroy()},n.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},n.prototype.bindEvents=function(){var r=this,s=this.attributes.onClick;if(this.addEventListener("click",function(){s==null||s(r)}),this.showBackground){var l=function(){return r.background.attr({opacity:n.backgroundOpacities.default})},u=function(){return r.background.attr({opacity:n.backgroundOpacities.hover})},h=function(){return r.background.attr({opacity:n.backgroundOpacities.active})};this.addEventListener("pointerenter",function(){u(),r.showIndicator()}),this.addEventListener("pointerleave",function(){l(),r.hideIndicator()}),this.addEventListener("pointerdown",function(){h()}),this.addEventListener("pointerup",function(){l()})}},n.tag="IconBase",n.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},n.backgroundOpacities={default:0,hover:.8,active:1},n}(Ve),ec=function(a,n){return n===void 0&&(n="#565758"),new dr({style:{fill:n,d:"M ".concat(a,",").concat(a," L -").concat(a,",0 L ").concat(a,",-").concat(a," Z"),transformOrigin:"center"}})},i6=function(a){(0,_.ZT)(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return n.prototype.arcPath=function(r,s,l){var u=(0,_.CR)([l,l],2),h=u[0],f=u[1],d=function(x){return[r+l*Math.cos(x),s+l*Math.sin(x)]},v=(0,_.CR)(d(-5/4*Math.PI),2),p=v[0],g=v[1],y=(0,_.CR)(d(1/4*Math.PI),2),m=y[0],b=y[1];return"M".concat(p,",").concat(g,",A").concat(h,",").concat(f,",0,1,1,").concat(m,",").concat(b)},Object.defineProperty(n.prototype,"label",{get:function(){return"\u91CD\u7F6E"},enumerable:!1,configurable:!0}),n.prototype.renderIcon=function(){var r=this.attributes,s=r.x,l=r.y,u=r.color,h=this.iconSize,f=this.lineWidth,d=f+.5;Tt(this.icon).maybeAppend(".reset","path").styles({stroke:u,lineWidth:f,d:this.arcPath(s,l,h/2-f),markerStart:ec(d,u)})},n}(ni),a6=function(a){(0,_.ZT)(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return Object.defineProperty(n.prototype,"label",{get:function(){return"\u5FEB\u9000"},enumerable:!1,configurable:!0}),n.prototype.renderIcon=function(){var r=this.attributes,s=r.x,l=r.y,u=r.color,h=this.iconSize,f=h/2,d=h/2/Math.pow(3,.5),v=[[s,l],[s,l-d],[s-f,l],[s,l+d],[s,l],[s+f,l-d],[s+f,l+d],[s,l]];Tt(this.icon).maybeAppend(".backward","polygon").styles({points:v,fill:u})},n}(ni),s6=function(a){(0,_.ZT)(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return Object.defineProperty(n.prototype,"label",{get:function(){return"\u5FEB\u8FDB"},enumerable:!1,configurable:!0}),n.prototype.renderIcon=function(){var r=this.attributes,s=r.x,l=r.y,u=r.color,h=this.iconSize,f=h/2,d=h/2/Math.pow(3,.5),v=[[s,l],[s,l-d],[s+f,l],[s,l+d],[s,l],[s-f,l-d],[s-f,l+d],[s,l]];Tt(this.icon).maybeAppend(".forward","polygon").styles({points:v,fill:u})},n}(ni),o6=function(a){(0,_.ZT)(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return Object.defineProperty(n.prototype,"label",{get:function(){return"\u64AD\u653E"},enumerable:!1,configurable:!0}),n.prototype.renderIcon=function(){var r=this.attributes,s=r.x,l=r.y,u=r.color,h=this.iconSize,f=h/3*Math.pow(3,.5)*.8,d=[[s+f,l],[s-f/2,l-h/2*.8],[s-f/2,l+h/2*.8],[s+f,l]];Tt(this.icon).maybeAppend(".play","polygon").styles({points:d,fill:u})},n}(ni),l6=function(a){(0,_.ZT)(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return Object.defineProperty(n.prototype,"label",{get:function(){return"\u6682\u505C"},enumerable:!1,configurable:!0}),n.prototype.renderIcon=function(){var r=this.attributes,s=r.x,l=r.y,u=r.color,h=this.iconSize,f=h/3,d=[[s-f,l-h/2],[s-f,l+h/2],[s-f/2,l+h/2],[s-f/2,l-h/2],[s-f,l-h/2],[s+f/2,l-h/2],[s+f/2,l+h/2],[s+f,l+h/2],[s+f,l-h/2]];Tt(this.icon).maybeAppend(".pause","polygon").styles({points:d,fill:u})},n}(ni),c6=function(a){(0,_.ZT)(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return Object.defineProperty(n.prototype,"label",{get:function(){return"\u8303\u56F4\u65F6\u95F4"},enumerable:!1,configurable:!0}),n.prototype.renderIcon=function(){var r=this.attributes,s=r.x,l=r.y,u=r.color,h=this,f=h.iconSize,d=h.lineWidth,v=d;Tt(this.icon).maybeAppend(".left-line","line").styles({x1:s-f/2,y1:l-f/2,x2:s-f/2,y2:l+f/2,stroke:u,lineWidth:d}),Tt(this.icon).maybeAppend(".right-line","line").styles({x1:s+f/2,y1:l-f/2,x2:s+f/2,y2:l+f/2,stroke:u,lineWidth:d}),Tt(this.icon).maybeAppend(".left-arrow","line").styles({x1:s,y1:l,x2:s-f/2+v*2,y2:l,stroke:u,lineWidth:d,markerEnd:ec(d*2,u)}),Tt(this.icon).maybeAppend(".right-arrow","line").styles({x1:s,y1:l,x2:s+f/2-v*2,y2:l,stroke:u,lineWidth:d,markerEnd:ec(d*2,u)})},n}(ni),u6=function(a){(0,_.ZT)(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return Object.defineProperty(n.prototype,"label",{get:function(){return"\u5355\u4E00\u65F6\u95F4"},enumerable:!1,configurable:!0}),n.prototype.renderIcon=function(){var r=this.attributes,s=r.x,l=r.y,u=r.color,h=this,f=h.iconSize,d=h.lineWidth;Tt(this.icon).maybeAppend(".line","line").styles({x1:s,y1:l-f/2,x2:s,y2:l+f/2,stroke:u,lineWidth:d});var v=d;Tt(this.icon).maybeAppend(".left-arrow","line").styles({x1:s-f/2-v*2,y1:l,x2:s-v*2,y2:l,stroke:u,lineWidth:d,markerEnd:ec(d*2,u)}),Tt(this.icon).maybeAppend(".right-arrow","line").styles({x1:s+f/2+v*2,y1:l,x2:s+v*2,y2:l,stroke:u,lineWidth:d,markerEnd:ec(d*2,u)})},n}(ni),sE=function(a){return[[-a/2,-a/2],[-a/2,a/2],[a/2,a/2]]},h6=function(a){(0,_.ZT)(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return Object.defineProperty(n.prototype,"label",{get:function(){return"\u6298\u7EBF\u56FE"},enumerable:!1,configurable:!0}),n.prototype.renderIcon=function(){var r=this.attributes,s=r.x,l=r.y,u=r.color,h=this,f=h.iconSize,d=h.lineWidth,v=d,p=(f-v*2-d)/4,g=(f-v*2-d)/2,y=(0,_.CR)([s-f/2+v,l+f/2-v*2],2),m=y[0],b=y[1];Tt(this.icon).maybeAppend(".coordinate","polyline").styles({points:sE(f).map(function(x){var E=(0,_.CR)(x,2),w=E[0],S=E[1];return[w+s,S+l]}),stroke:u,lineWidth:d}),Tt(this.icon).maybeAppend(".line","polyline").styles({points:[[m,b],[m+p,b-g],[m+p*2,b],[m+p*4,b-g*2]],stroke:u,lineWidth:d})},n}(ni),f6=function(a){(0,_.ZT)(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return Object.defineProperty(n.prototype,"label",{get:function(){return"\u6761\u5F62\u56FE"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),n.prototype.renderIcon=function(){var r=this.data,s=this.attributes,l=s.x,u=s.y,h=s.color,f=this,d=f.iconSize,v=f.lineWidth,p=v,g=(d-p)/r.length,y=(d-p*2)/4,m=(0,_.CR)([l-d/2+p*2,u+d/2-p],2),b=m[0],x=m[1];Tt(this.icon).maybeAppend(".coordinate","polyline").styles({points:sE(d).map(function(E){var w=(0,_.CR)(E,2),S=w[0],M=w[1];return[S+l,M+u]}),stroke:h,lineWidth:v}),Tt(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(E,w){return{value:E,index:w}})).join(function(E){return E.append("line").attr("className","column").style("x1",function(w){var S=w.index;return b+g*S}).style("y1",x).style("x2",function(w){var S=w.index;return b+g*S}).style("y2",function(w){var S=w.value;return x-y*S}).styles({y1:x,stroke:h,lineWidth:v})})},n}(ni),d6=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,cn({},{style:{color:"#d8d9d9"}},r))||this;return s.showBackground=!1,s}return n.prototype.renderIcon=function(){var r=this.attributes,s=r.x,l=r.y,u=r.color,h=this,f=h.iconSize,d=h.lineWidth;Tt(this.icon).maybeAppend(".split","line").styles({x1:s,y1:l-f/2,x2:s,y2:l+f/2,stroke:u,lineWidth:d})},n}(ni),p0=function(a){(0,_.ZT)(n,a);function n(){var r=a.apply(this,(0,_.ev)([],(0,_.CR)(arguments),!1))||this;return r.showBackground=!1,r}return Object.defineProperty(n.prototype,"padding",{get:function(){return Cn(0)},enumerable:!1,configurable:!0}),n.prototype.renderIcon=function(){var r=this.iconSize,s=this.attributes,l=s.x,u=s.y,h=s.speed,f=h===void 0?1:h,d=Tv(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),v=Ze(r,20,1/0),p=20,g=(0,_.pi)((0,_.pi)({},d),{x:l-v/2,y:u-p/2,width:v,height:p,defaultValue:f,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:r/5,placeholderFontSize:r/2,optionPadding:0,optionLabelFontSize:r/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});Tt(this.icon).maybeAppend(".speed",function(){return new r6({style:g})}).attr("className","speed").each(function(){this.update(g)})},n.tag="SpeedSelect",n}(ni),g0=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,r)||this;return s.icon=s.appendChild(new vn({})),s.currentType=s.attributes.type,s}return n.prototype.getType=function(){return this.currentType},n.prototype.render=function(){var r=this,s=this.attributes,l=s.onChange,u=(0,_._T)(s,["onChange"]);Tt(this.icon).selectAll(".icon").data([this.currentType]).join(function(h){return h.append(function(f){var d,v=(d=r.toggles.find(function(p){var g=(0,_.CR)(p,1),y=g[0];return y===f}))===null||d===void 0?void 0:d[1];if(!v)throw new Error("Invalid type: ".concat(f));return new v({})}).attr("className","icon").styles(u,!1).update({})},function(h){return h.styles({restStyles:u}).update({})},function(h){return h.remove()})},n.prototype.bindEvents=function(){var r=this,s=this.attributes.onChange;this.addEventListener("click",function(l){l.preventDefault(),l.stopPropagation();var u=(r.toggles.findIndex(function(f){var d=(0,_.CR)(f,1),v=d[0];return v===r.currentType})+1)%r.toggles.length,h=r.toggles[u][0];s==null||s(r.currentType),r.currentType=h,r.render()})},n.tag="ToggleIcon",n}(Ve),y0=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,cn({},{style:{type:"play"}},r))||this;return s.toggles=[["play",o6],["pause",l6]],s}return n}(g0),m0=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,cn({},{style:{type:"range"}},r))||this;return s.toggles=[["range",c6],["value",u6]],s}return n}(g0),b0=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,cn({},{style:{type:"column"}},r))||this;return s.toggles=[["line",h6],["column",f6]],s}return n}(g0),v6={reset:i6,speed:p0,backward:a6,playPause:y0,forward:s6,selectionType:m0,chartType:b0,split:d6},p6=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,cn({},n.defaultOptions,r))||this;return s.background=s.appendChild(new Sn({})),s.functions=s.appendChild(new vn({})),s}return Object.defineProperty(n.prototype,"padding",{get:function(){return Cn(this.attributes.padding)},enumerable:!1,configurable:!0}),n.prototype.renderBackground=function(){var r=this.style,s=r.x,l=r.y,u=r.width,h=r.height,f=Wt(this.attributes,"background");this.background.attr((0,_.pi)({x:s,y:l,width:u,height:h},f))},n.prototype.renderFunctions=function(){var r=this,s,l=this.attributes,u=l.functions,h=l.iconSize,f=l.iconSpacing,d=l.x,v=l.y,p=l.width,g=l.height,y=l.align,m=(0,_.CR)(this.padding,4),b=m[1],x=m[3],E=u.reduce(function(M,C){return M.length&&C.length?M.concat.apply(M,(0,_.ev)(["split"],(0,_.CR)(C),!1)):M.concat.apply(M,(0,_.ev)([],(0,_.CR)(C),!1))},[]),w=E.length*(h+f)-f,S={left:x+h/2,center:(p-w)/2+h/2,right:p-w-x-b+h/2}[y]||0;(s=this.speedSelect)===null||s===void 0||s.destroy(),this.functions.removeChildren(),E.forEach(function(M,C){var T,O=v6[M],k={x:d+C*(h+f)+S,y:v+g/2,size:h};if(O===p0?(k.speed=r.attributes.speed,k.onSelect=function(A){return r.handleFunctionChange(M,{value:A})}):[y0,m0,b0].includes(O)?(k.onChange=function(A){return r.handleFunctionChange(M,{value:A})},O===y0&&(k.type=r.attributes.state==="play"?"pause":"play"),O===m0&&(k.type=r.attributes.selectionType==="range"?"value":"range"),O===b0&&(k.type=r.attributes.chartType==="line"?"column":"line")):k.onClick=function(){return r.handleFunctionChange(M,{value:M})},O===p0){var P=(T=r.ownerDocument)===null||T===void 0?void 0:T.defaultView;P&&(r.speedSelect=new O({style:(0,_.pi)((0,_.pi)({},k),{zIndex:100})}),P.appendChild(r.speedSelect))}else r.functions.appendChild(new O({style:k}))})},n.prototype.disconnectedCallback=function(){var r;a.prototype.disconnectedCallback.call(this),(r=this.speedSelect)===null||r===void 0||r.destroy()},n.prototype.render=function(){this.renderBackground(),this.renderFunctions()},n.prototype.handleFunctionChange=function(r,s){var l=this.attributes.onChange;l==null||l(r,s)},n.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},n}(Ve),g6=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,cn({},n.defaultOptions,r))||this;return s.bindEvents(),s}return n.prototype.bindEvents=function(){var r=this;this.addEventListener("mouseenter",function(){r.attr("lineWidth",Math.ceil(+(r.style.r||0)/2))}),this.addEventListener("mouseleave",function(){r.attr("lineWidth",0)})},n.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},n}(gi),y6=function(a){(0,_.ZT)(n,a);function n(r){return a.call(this,cn({},n.defaultOptions,r))||this}return n.prototype.renderBackground=function(){var r=this.attributes,s=r.x,l=r.y,u=r.width,h=r.height,f=Wt(this.attributes,"background");Tt(this).maybeAppend("background","rect").attr("className","background").styles((0,_.pi)({x:s-u/2,y:l-h/2,width:u,height:h},f))},n.prototype.renderIcon=function(){var r=this.attributes,s=r.x,l=r.y,u=r.iconSize,h=Wt(this.attributes,"icon"),f=1,d=u/2;Tt(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles((0,_.pi)({x1:s-f,y1:l-d,x2:s-f,y2:l+d},h)),Tt(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles((0,_.pi)({x1:s+f,y1:l-d,x2:s+f,y2:l+d},h))},n.prototype.renderBorder=function(){var r=this.attributes,s=r.x,l=r.y,u=r.width,h=r.height,f=r.type,d=Wt(this.attributes,"border"),v=f==="start"?+u/2:-u/2;Tt(this).maybeAppend("border","line").attr("className","border").styles((0,_.pi)({x1:v+s,y1:l-h/2,x2:v+s,y2:l+h/2},d))},n.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},n.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},n}(Ve);function m6(a,n){return typeof a=="number"?oE(a):b6(a,n)}function b6(a,n){var r=new Date(a);switch(n){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(r.getHours())&&r.getMinutes()===0?Xn(r,`HH:mm
YYYY-MM-DD`):Xn(r,"HH:mm");case"half-day":return r.getHours()<12?`AM
`.concat(Xn(r,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(r.getDate())?Xn(r,`DD
YYYY-MM`):Xn(r,"DD");case"week":return r.getDate()<=7?Xn(r,`DD
YYYY-MM`):Xn(r,"DD");case"month":return[0,6].includes(r.getMonth())?Xn(r,`MM\u6708
YYYY`):Xn(r,"MM\u6708");case"season":return[0].includes(r.getMonth())?Xn(r,`MM\u6708
YYYY`):Xn(r,"MM\u6708");case"year":return Xn(r,"YYYY");default:return Xn(r,"YYYY-MM-DD HH:mm")}}function oE(a){var n=String(Math.floor(a/3600)).padStart(2,"0"),r=String(Math.floor(a%3600/60)).padStart(2,"0"),s=String(Math.floor(a%60)).padStart(2,"0");return a<3600?"".concat(r,":").concat(s):"".concat(n,":").concat(r,":").concat(s)}var x6=function(a){(0,_.ZT)(n,a);function n(r){var s=a.call(this,cn({},n.defaultOptions,r))||this;s.axis=s.appendChild(new yI({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),s.timeline=s.appendChild(new JI({style:{onChange:function(g){s.handleSliderChange(g)}}})),s.controller=s.appendChild(new p6({})),s.states={},s.handleSliderChange=function(g){var y=function(){var m=s.states.values;return Array.isArray(m)?(0,_.ev)([],(0,_.CR)(m),!1):m}();s.setBySliderValues(g),s.dispatchOnChange(y)};var l=s.attributes,u=l.selectionType,h=l.chartType,f=l.speed,d=l.state,v=l.playMode,p=l.values;return s.states={chartType:h,playMode:v,selectionType:u,speed:f,state:d},s.setByTimebarValues(p),s}return Object.defineProperty(n.prototype,"data",{get:function(){var r=this.attributes.data,s=function(l,u){return l.time<u.time?-1:l.time>u.time?1:0};return r.sort(s)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"space",{get:function(){var r=this.attributes,s=r.x,l=r.y,u=r.width,h=r.height,f=r.type,d=r.controllerHeight,v=Ze(+h-d,0,+h),p=new Dn(s,l+ +h-d,+u,d),g,y=0;f==="chart"?(y=35,g=new Dn(s,l+v-y,+u,y)):g=new Dn;var m=f==="time"?10:v,b=new Dn(s,l+(f==="time"?v:v-m),+u,m-y);return{axisBBox:g,controllerBBox:p,timelineBBox:b}},enumerable:!1,configurable:!0}),n.prototype.setBySliderValues=function(r){var s,l,u=this.data,h=(0,_.CR)(Array.isArray(r)?r:[0,r],2),f=h[0],d=h[1],v=u.length,p=u[Math.floor(f*v)],g=u[Math.ceil(d*v)-(Array.isArray(r)?0:1)];this.states.values=[(s=p==null?void 0:p.time)!==null&&s!==void 0?s:u[0].time,(l=g==null?void 0:g.time)!==null&&l!==void 0?l:1/0]},n.prototype.setByTimebarValues=function(r){var s,l,u,h=this.data,f=(0,_.CR)(Array.isArray(r)?r:[void 0,r],2),d=f[0],v=f[1],p=h.find(function(y){var m=y.time;return m===d}),g=h.find(function(y){var m=y.time;return m===v});this.states.values=[(s=p==null?void 0:p.time)!==null&&s!==void 0?s:(l=h[0])===null||l===void 0?void 0:l.time,(u=g==null?void 0:g.time)!==null&&u!==void 0?u:1/0]},n.prototype.setByIndex=function(r){var s,l,u,h,f=this.data,d=(0,_.CR)(r,2),v=d[0],p=d[1];this.states.values=[(l=(s=f[v])===null||s===void 0?void 0:s.time)!==null&&l!==void 0?l:f[0].time,(h=(u=this.data[p])===null||u===void 0?void 0:u.time)!==null&&h!==void 0?h:1/0]},Object.defineProperty(n.prototype,"sliderValues",{get:function(){var r=this.states,s=r.values,l=r.selectionType,u=(0,_.CR)(Array.isArray(s)?s:[void 0,s],2),h=u[0],f=u[1],d=this.data,v=d.length,p=l==="value",g=function(){var m=d.findIndex(function(b){var x=b.time;return x===h});return p?0:m>-1?m/v:0},y=function(){if(f===1/0)return 1;var m=d.findIndex(function(b){var x=b.time;return x===f});return m>-1?m/v:p?.5:1};return[g(),y()]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"values",{get:function(){var r=this.states,s=r.values,l=r.selectionType,u=(0,_.CR)(Array.isArray(s)?s:[this.data[0].time,s],2),h=u[0],f=u[1];return l==="value"?f:[h,f]},enumerable:!1,configurable:!0}),n.prototype.getDatumByRatio=function(r){var s=this.data,l=s.length,u=Math.floor(r*(l-1));return s[u]},Object.defineProperty(n.prototype,"chartHandleIconShape",{get:function(){var r=this.states.selectionType,s=this.space.timelineBBox.height;return r==="range"?function(l){return new y6({style:{type:l,height:s,iconSize:s/6}})}:function(){return new Ua({style:{x1:0,y1:-s/2,x2:0,y2:s/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),n.prototype.getChartStyle=function(r){var s=this,l=r.x,u=r.y,h=r.width,f=r.height,d=this.states,v=d.selectionType,p=d.chartType,g=this.data,y=this.attributes,m=y.type,b=y.labelFormatter,x=Wt(this.attributes,"chart"),E=x.type,w=(0,_._T)(x,["type"]),S=v==="range";if(m==="time")return(0,_.pi)({handleIconShape:function(){return new g6({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:S?-15:0,autoFitLabel:S,handleSpacing:S?-15:0,trackFill:"#edeeef",trackLength:h,trackOpacity:.5,trackRadius:f/2,trackSize:f/2,type:v,values:this.sliderValues,formatter:function(T){if(b)return b(T);var O=s.getDatumByRatio(T).time;return typeof O=="number"?oE(O):Xn(O,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(l,", ").concat(u,")"),zIndex:1},w);var M=v==="range"?5:0,C=g.map(function(T){var O=T.value;return O});return(0,_.pi)({handleIconOffset:M,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:C,sparklineType:p,sparklineScale:.8,trackLength:h,trackSize:f,type:v,values:this.sliderValues,transform:"translate(".concat(l,", ").concat(u,")"),zIndex:1},w)},n.prototype.renderChart=function(r){r===void 0&&(r=this.space.timelineBBox),this.timeline.update(this.getChartStyle(r))},n.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},n.prototype.getAxisStyle=function(r){var s=this.data,l=this.attributes,u=l.interval,h=l.labelFormatter,f=Wt(this.attributes,"axis"),d=r.x,v=r.y,p=r.width,g=(0,_.ev)((0,_.ev)([],(0,_.CR)(s),!1),[{time:0}],!1).map(function(m,b,x){var E=m.time;return{label:"".concat(E),value:b/(x.length-1),time:E}}),y=(0,_.pi)({startPos:[d,v],endPos:[d+p,v],data:g,labelFilter:function(m,b){return b<g.length-1},labelFormatter:function(m){var b=m.time;return h?h(b):m6(b,u)}},f);return y},n.prototype.renderAxis=function(r){r===void 0&&(r=this.space.axisBBox);var s=this.attributes.type;s==="chart"&&this.axis.update(this.getAxisStyle(r))},n.prototype.renderController=function(r){r===void 0&&(r=this.space.controllerBBox);var s=this.attributes.type,l=this.states,u=l.state,h=l.speed,f=l.selectionType,d=l.chartType,v=Wt(this.attributes,"controller"),p=this,g=(0,_.pi)((0,_.pi)((0,_.pi)({},r),{iconSize:20,speed:h,state:u,selectionType:f,chartType:d,onChange:function(y,m){var b=m.value;switch(y){case"reset":p.internalReset();break;case"speed":p.handleSpeedChange(b);break;case"backward":p.internalBackward();break;case"playPause":b==="play"?p.internalPlay():p.internalPause();break;case"forward":p.internalForward();break;case"selectionType":p.handleSelectionTypeChange(b);break;case"chartType":p.handleChartTypeChange(b);break;default:break}}}),v);s==="time"&&(g.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(g)},n.prototype.dispatchOnChange=function(r){var s=this.data,l=this.attributes.onChange,u=this.states,h=u.values,f=u.selectionType,d=(0,_.CR)(h,2),v=d[0],p=d[1],g=p===1/0?s.at(-1).time:p,y=f==="range"?[v,g]:g,m=function(b,x){return Array.isArray(b)?Array.isArray(x)?b[0]===x[0]&&(b[1]===x[1]||b[1]===1/0||x[1]===1/0):!1:Array.isArray(x)?!1:b===x};(!r||!m(r,y))&&(l==null||l(f==="range"?[v,g]:g))},n.prototype.internalReset=function(r){var s,l,u=this.states.selectionType;this.internalPause(),this.setBySliderValues(u==="range"?[0,1]:[0,0]),this.renderController(),this.updateSelection(),r||((l=(s=this.attributes)===null||s===void 0?void 0:s.onReset)===null||l===void 0||l.call(s),this.dispatchOnChange())},n.prototype.reset=function(){this.internalReset()},n.prototype.moveSelection=function(r,s){var l=this.data,u=l.length,h=this.states,f=h.values,d=h.selectionType,v=h.playMode,p=(0,_.CR)(f,2),g=p[0],y=p[1],m=l.findIndex(function(M){var C=M.time;return C===g}),b=l.findIndex(function(M){var C=M.time;return C===y});b===-1&&(b=u);var x=r==="backward"?-1:1,E;d==="range"?v==="acc"?(E=[m,b+x],x===-1&&m===b&&(E=[m,u])):E=[m+x,b+x]:E=[m,b+x];var w=function(M){var C=(0,_.CR)(M.sort(function(P,A){return P-A}),2),T=C[0],O=C[1],k=function(P){return Ze(P,0,u)};return O>u?d==="value"?[0,0]:v==="acc"?[k(T),k(T)]:[0,k(O-T)]:T<0?v==="acc"?[0,k(O)]:[k(T+u-O),u]:[k(T),k(O)]},S=w(E);return this.setByIndex(S),this.updateSelection(),S},n.prototype.internalBackward=function(r){var s,l,u=this.moveSelection("backward",r);return r||((l=(s=this.attributes)===null||s===void 0?void 0:s.onBackward)===null||l===void 0||l.call(s),this.dispatchOnChange()),u},n.prototype.backward=function(){this.internalBackward()},n.prototype.internalPlay=function(r){var s=this,l,u,h=this.data,f=this.attributes.loop,d=this.states.speed,v=d===void 0?1:d;this.playInterval=window.setInterval(function(){var p=s.internalForward();p[1]===h.length&&!f&&(s.internalPause(),s.renderController())},1e3/v),this.states.state="play",!r&&((u=(l=this.attributes)===null||l===void 0?void 0:l.onPlay)===null||u===void 0||u.call(l))},n.prototype.play=function(){this.internalPlay()},n.prototype.internalPause=function(r){var s,l;clearInterval(this.playInterval),this.states.state="pause",!r&&((l=(s=this.attributes)===null||s===void 0?void 0:s.onPause)===null||l===void 0||l.call(s))},n.prototype.pause=function(){this.internalPause()},n.prototype.internalForward=function(r){var s,l,u=this.moveSelection("forward",r);return r||((l=(s=this.attributes)===null||s===void 0?void 0:s.onForward)===null||l===void 0||l.call(s),this.dispatchOnChange()),u},n.prototype.forward=function(){this.internalForward()},n.prototype.handleSpeedChange=function(r){var s,l;this.states.speed=r;var u=this.states.state;u==="play"&&(this.internalPause(!0),this.internalPlay(!0)),(l=(s=this.attributes)===null||s===void 0?void 0:s.onSpeedChange)===null||l===void 0||l.call(s,r)},n.prototype.handleSelectionTypeChange=function(r){var s,l;this.states.selectionType=r,this.renderChart(),(l=(s=this.attributes)===null||s===void 0?void 0:s.onSelectionTypeChange)===null||l===void 0||l.call(s,r)},n.prototype.handleChartTypeChange=function(r){var s,l;this.states.chartType=r,this.renderChart(),(l=(s=this.attributes)===null||s===void 0?void 0:s.onChartTypeChange)===null||l===void 0||l.call(s,r)},n.prototype.render=function(){var r=this.space,s=r.axisBBox,l=r.controllerBBox,u=r.timelineBBox;this.renderController(l),this.renderAxis(s),this.renderChart(u),this.states.state==="play"&&this.internalPlay()},n.prototype.destroy=function(){a.prototype.destroy.call(this),this.internalPause(!0)},n.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},n}(Ve);function E6(a){return a instanceof Date}var w6=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})},S6=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};const M6=["timestamp","time","date","datetime"];class nc extends ln{get padding(){return yr(this.options.padding)}constructor(n,r){super(n,Object.assign({},nc.defaultOptions,r)),this.backup(),this.upsertTimebar()}play(){var n;(n=this.timebar)===null||n===void 0||n.play()}pause(){var n;(n=this.timebar)===null||n===void 0||n.pause()}forward(){var n;(n=this.timebar)===null||n===void 0||n.forward()}backward(){var n;(n=this.timebar)===null||n===void 0||n.backward()}reset(){var n;(n=this.timebar)===null||n===void 0||n.reset()}update(n){super.update(n),this.backup(),this.upsertTimebar()}backup(){this.originalData=lE(this.context.graph.getData())}upsertTimebar(){const{canvas:n}=this.context,r=this.options,{onChange:s,timebarType:l,data:u,x:h,y:f,width:d,height:v,mode:p}=r,g=S6(r,["onChange","timebarType","data","x","y","width","height","mode"]),y=n.getSize(),[m]=this.padding;this.upsertCanvas().ready.then(()=>{var b;const x=Object.assign(Object.assign({x:y[0]/2-d/2,y:m,onChange:E=>{const w=((0,Gr.Z)(E)?E:[E,E]).map(S=>E6(S)?S.getTime():S);this.options.mode==="modify"?this.filterElements(w):this.hiddenElements(w),s==null||s(w)}},g),{data:u.map(E=>(0,se.Z)(E)?{time:E,value:0}:E),width:d,height:v,type:l});this.timebar?this.timebar.update(x):(this.timebar=new x6({style:x}),(b=this.canvas)===null||b===void 0||b.appendChild(this.timebar))})}upsertCanvas(){if(this.canvas)return this.canvas;const{className:n,height:r,position:s}=this.options,l=this.context.canvas,[u]=l.getSize(),[h,,f]=this.padding,[d,v]=Th({width:u,height:r+h+f,graphCanvas:l,className:"timebar",placement:s});return this.container=d,n&&d.classList.add(n),this.canvas=v,this.canvas}filterElements(n){return w6(this,void 0,void 0,function*(){var r;if(!this.originalData)return;const{elementTypes:s,getTime:l}=this.options,{graph:u,element:h}=this.context,f=lE(this.originalData);s.forEach(v=>{const p=`${v}s`;f[p]=(this.originalData[p]||[]).filter(g=>{const y=l(g);return!!cE(y,n)})});const d=[...f.nodes,...f.combos].map(v=>V(v));f.edges=f.edges.filter(v=>{const p=v.source,g=v.target;return d.includes(p)&&d.includes(g)}),u.setData(f),yield(r=h.draw({animation:!1,silence:!0}))===null||r===void 0?void 0:r.finished})}hiddenElements(n){const{graph:r}=this.context,{elementTypes:s,getTime:l}=this.options,u=[],h=[];s.forEach(f=>{var d;const v=`${f}s`;(((d=this.originalData)===null||d===void 0?void 0:d[v])||[]).forEach(g=>{const y=V(g),m=l(g);cE(m,n)?h.push(y):u.push(y)})}),r.hideElement(u,!1),r.showElement(h,!1)}destroy(){var n,r,s;const{graph:l}=this.context;this.originalData&&l.setData(Object.assign({},this.originalData)),(n=this.timebar)===null||n===void 0||n.destroy(),(r=this.canvas)===null||r===void 0||r.destroy(),(s=this.container)===null||s===void 0||s.remove(),this.originalData=void 0,this.container=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}}nc.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:a=>T6(a,M6,void 0),loop:!1};const lE=a=>{const{nodes:n=[],edges:r=[],combos:s=[]}=a;return{nodes:[...n],edges:[...r],combos:[...s]}},cE=(a,n)=>{if((0,se.Z)(n))return a===n;const[r,s]=n;return a>=r&&a<=s},T6=(a,n,r)=>{var s;for(let l=0;l<n.length;l++){const u=n[l],h=(s=a.data)===null||s===void 0?void 0:s[u];if(h)return h}return r};var C6=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};const uE={fill:"#1D2129",wordWrap:!0,maxLines:1,textOverflow:"ellipsis",textBaseline:"top",textAlign:"start",x:0},O6=Object.assign(Object.assign({},uE),{fillOpacity:.9,fontSize:16,fontWeight:"bold"}),k6=Object.assign(Object.assign({},uE),{fillOpacity:.65,fontSize:12,fontWeight:"normal"}),_6={align:"left",spacing:8,size:44,padding:[16,24,0,24]},x0="title",hE="subtitle";class fE extends ln{get padding(){return yr(this.options.padding)}constructor(n,r){const s=Object.assign({},_6,r);super(n,s),this.onRender=()=>{const l=this.updateCanvas();this.renderTitle(l)},this.bindEvents()}bindEvents(){const{graph:n}=this.context;n.on(lt.AFTER_RENDER,this.onRender),n.on(lt.AFTER_ANIMATE,this.onRender)}unbindEvents(){const{graph:n}=this.context;n.off(lt.AFTER_RENDER,this.onRender),n.off(lt.AFTER_ANIMATE,this.onRender)}destroy(){var n,r;this.unbindEvents(),(n=this.canvas)===null||n===void 0||n.destroy(),(r=this.container)===null||r===void 0||r.remove(),super.destroy()}updateCanvas(){const{size:n,className:r,align:s}=this.options,[l]=this.context.canvas.getSize(),[u=0,,h=0]=this.padding,f=n+u+h;if(this.canvas){const{width:d,height:v}=this.canvas.getConfig();(l!==d||f!==v)&&this.canvas.resize(l,f)}else{const d={left:"left-top",center:"top",right:"right-top"},[v,p]=Th({width:l,height:f,placement:d[s]||d.left,className:"title-canvas",graphCanvas:this.context.canvas});r&&v.classList.add(r),this.container=v,this.canvas=p}return this.canvas}renderTitle(n){const r=new P6({options:this.options,ctx:this.context});n.removeChildren(),r.getTitle().forEach(s=>{s&&n.appendChild(s)})}}class P6{get padding(){return yr(this.options.padding)}constructor(n){const{options:r,ctx:s}=n;this.options=r,this.context=s}getTitle(){const n=this.options,r=x0,s=n[r],l=hE,u=n[l],{spacing:h=44,padding:f,align:d}=n,v=C6(n,[typeof r=="symbol"?r:r+"",typeof l=="symbol"?l:l+"","spacing","padding","align"]),p=s,g=u,y=We(v,x0),m=We(v,hE),[b]=this.context.graph.getSize(),[x=0,E=0,,w=0]=this.padding,S=b,M=S-w-E;let C=null,T=w,O="left";switch(d){case"left":T=w,O="left";break;case"center":T=S/2,O="center";break;case"right":T=S-E,O="right";break;default:T=w,O="left"}const k=new Kr({className:x0,style:Object.assign(Object.assign(Object.assign(Object.assign({},O6),{wordWrapWidth:M-5,x:T,y:x,textAlign:O}),y),{text:p})}),P=k.getBBox();return g&&(C=new Kr({className:"subTitle",style:Object.assign(Object.assign(Object.assign(Object.assign({},k6),{wordWrapWidth:M-5,x:T,y:P.height+h+x,textAlign:O}),m),{text:g})})),[k,C]}}function A6(a){const n={top:"unset",right:"unset",bottom:"unset",left:"unset"};return a.split("-").forEach(s=>{n[s]="8px"}),n.flexDirection=a.startsWith("top")||a.startsWith("bottom")?"row":"column",n}const N6=`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`,R6=`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`;var dE=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class rc extends ln{constructor(n,r){super(n,Object.assign({},rc.defaultOptions,r)),this.$element=Us("toolbar",!1),this.onToolbarItemClick=l=>{const{onClick:u}=this.options;if(l.target instanceof Element&&l.target.className.includes("g6-toolbar-item")){const h=l.target.getAttribute("value");u==null||u(h,l.target)}};const s=this.context.canvas.getContainer();this.$element.style.display="flex",s.appendChild(this.$element),Cv("g6-toolbar-css","style",{},N6,document.head),Cv("g6-toolbar-svgicon","div",{display:"none"},R6),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(r)}update(n){const r=Object.create(null,{update:{get:()=>super.update}});return dE(this,void 0,void 0,function*(){r.update.call(this,n);const{className:s,position:l,style:u}=this.options;this.$element.className=`g6-toolbar ${s||""}`,Object.assign(this.$element.style,u,A6(l)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return dE(this,void 0,void 0,function*(){return(yield this.options.getItems()).map(r=>{var s;return`
          <div class="g6-toolbar-item" value="${r.value}" title="${(s=r.title)!==null&&s!==void 0?s:""}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${r.id}"></use>
            </svg>
          </div>`}).join("")})}}rc.defaultOptions={position:"top-left"};function E0(a){var n=document.createElement("div");n.innerHTML=a;var r=n.childNodes[0];return r&&n.contains(r)&&n.removeChild(r),r}function L6(a,n){return!a||!n?a:a.replace(/\\?\{([^{}]+)\}/g,function(r,s){return r.charAt(0)==="\\"?r.slice(1):n[s]===void 0?"":n[s]})}var D6=L6,vE=function(a,n){if(n==null){a.innerHTML="";return}a.replaceChildren?Array.isArray(n)?a.replaceChildren.apply(a,(0,_.ev)([],(0,_.CR)(n),!1)):a.replaceChildren(n):(a.innerHTML="",Array.isArray(n)?n.forEach(function(r){return a.appendChild(r)}):a.appendChild(n))};function w0(a){return a===void 0&&(a=""),{CONTAINER:"".concat(a,"tooltip"),TITLE:"".concat(a,"tooltip-title"),LIST:"".concat(a,"tooltip-list"),LIST_ITEM:"".concat(a,"tooltip-list-item"),NAME:"".concat(a,"tooltip-list-item-name"),MARKER:"".concat(a,"tooltip-list-item-marker"),NAME_LABEL:"".concat(a,"tooltip-list-item-name-label"),VALUE:"".concat(a,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(a,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(a,"tooltip-crosshair-y")}}var pE={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function I6(a){var n;a===void 0&&(a="");var r=w0(a);return n={},n[".".concat(r.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},n[".".concat(r.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},n[".".concat(r.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},n[".".concat(r.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},n[".".concat(r.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},n[".".concat(r.NAME)]={display:"flex","align-items":"center","max-width":"216px"},n[".".concat(r.NAME_LABEL)]=(0,_.pi)({flex:1},pE),n[".".concat(r.VALUE)]=(0,_.pi)({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},pE),n[".".concat(r.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},n[".".concat(r.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},n}var B6=function(a){(0,_.ZT)(n,a);function n(r){var s=this,l,u,h=(u=(l=r.style)===null||l===void 0?void 0:l.template)===null||u===void 0?void 0:u.prefixCls,f=w0(h);return s=a.call(this,r,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(f.CONTAINER,'"></div>'),title:'<div class="'.concat(f.TITLE,'"></div>'),item:'<li class="'.concat(f.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(f.NAME,`">
          <span class="`).concat(f.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(f.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(f.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:I6(h)})||this,s.timestamp=-1,s.prevCustomContentKey=s.attributes.contentKey,s.initShape(),s.render(s.attributes,s),s}return Object.defineProperty(n.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),n.prototype.getContainer=function(){return this.element},Object.defineProperty(n.prototype,"elementSize",{get:function(){var r=this.element.offsetWidth,s=this.element.offsetHeight;return{width:r,height:s}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"HTMLTooltipItemsElements",{get:function(){var r=this.attributes,s=r.data,l=r.template;return s.map(function(u,h){var f=u.name,d=f===void 0?"":f,v=u.color,p=v===void 0?"black":v,g=u.index,y=(0,_._T)(u,["name","color","index"]),m=(0,_.pi)({name:d,color:p,index:g!=null?g:h},y);return E0(D6(l.item,m))})},enumerable:!1,configurable:!0}),n.prototype.render=function(r,s){this.renderHTMLTooltipElement(),this.updatePosition()},n.prototype.destroy=function(){var r;(r=this.element)===null||r===void 0||r.remove(),a.prototype.destroy.call(this)},n.prototype.show=function(r,s){var l=this;if(r!==void 0&&s!==void 0){var u=this.element.style.visibility==="hidden",h=function(){l.attributes.x=r!=null?r:l.attributes.x,l.attributes.y=s!=null?s:l.attributes.y,l.updatePosition()};u?this.closeTransition(h):h()}this.element.style.visibility="visible"},n.prototype.hide=function(r,s){r===void 0&&(r=0),s===void 0&&(s=0);var l=this.attributes.enterable;l&&this.isCursorEntered(r,s)||(this.element.style.visibility="hidden")},n.prototype.initShape=function(){var r=this.attributes.template;this.element=E0(r.container),this.id&&this.element.setAttribute("id",this.id)},n.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var r=this.attributes.content;r&&(typeof r=="string"?this.element.innerHTML=r:vE(this.element,r))}},n.prototype.renderHTMLTooltipElement=function(){var r,s,l=this.attributes,u=l.template,h=l.title,f=l.enterable,d=l.style,v=l.content,p=w0(u.prefixCls),g=this.element;if(this.element.style.pointerEvents=f?"auto":"none",v)this.renderCustomContent();else{h?(g.innerHTML=u.title,g.getElementsByClassName(p.TITLE)[0].innerHTML=h):(s=(r=g.getElementsByClassName(p.TITLE))===null||r===void 0?void 0:r[0])===null||s===void 0||s.remove();var y=this.HTMLTooltipItemsElements,m=document.createElement("ul");m.className=p.LIST,vE(m,y);var b=this.element.querySelector(".".concat(p.LIST));b?b.replaceWith(m):g.appendChild(m)}YR(g,d)},n.prototype.getRelativeOffsetFromCursor=function(r){var s=this.attributes,l=s.position,u=s.offset,h=r||l,f=h.split("-"),d={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},v=this.elementSize,p=v.width,g=v.height,y=[-p/2,-g/2];return f.forEach(function(m){var b=(0,_.CR)(y,2),x=b[0],E=b[1],w=(0,_.CR)(d[m],2),S=w[0],M=w[1];y=[x+(p/2+u[0])*S,E+(g/2+u[1])*M]}),y},n.prototype.setOffsetPosition=function(r){var s=(0,_.CR)(r,2),l=s[0],u=s[1],h=this.attributes,f=h.x,d=f===void 0?0:f,v=h.y,p=v===void 0?0:v,g=h.container,y=g.x,m=g.y;this.element.style.left="".concat(+d+y+l,"px"),this.element.style.top="".concat(+p+m+u,"px")},n.prototype.updatePosition=function(){var r=this.attributes.showDelay,s=r===void 0?60:r,l=Date.now();this.timestamp>0&&l-this.timestamp<s||(this.timestamp=l,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},n.prototype.autoPosition=function(r){var s=(0,_.CR)(r,2),l=s[0],u=s[1],h=this.attributes,f=h.x,d=h.y,v=h.bounding,p=h.position;if(!v)return[l,u];var g=this.element,y=g.offsetWidth,m=g.offsetHeight,b=(0,_.CR)([+f+l,+d+u],2),x=b[0],E=b[1],w={left:"right",right:"left",top:"bottom",bottom:"top"},S=v.x,M=v.y,C=v.width,T=v.height,O={left:x<S,right:x+y>S+C,top:E<M,bottom:E+m>M+T},k=[];p.split("-").forEach(function(A){O[A]?k.push(w[A]):k.push(A)});var P=k.join("-");return this.getRelativeOffsetFromCursor(P)},n.prototype.isCursorEntered=function(r,s){if(this.element){var l=this.element.getBoundingClientRect(),u=l.x,h=l.y,f=l.width,d=l.height;return new Dn(u,h,f,d).isPointIn(r,s)}return!1},n.prototype.closeTransition=function(r){var s=this,l=this.element.style.transition;this.element.style.transition="none",r(),setTimeout(function(){s.element.style.transition=l},10)},n.tag="tooltip",n}(Ve),gE=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class ic extends ln{constructor(n,r){super(n,Object.assign({},ic.defaultOptions,r)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=(s,l)=>{const{enable:u}=this.options;return typeof u=="function"?u(s,l):u},this.onClick=s=>{const{target:{id:l}}=s;this.currentTarget===l?this.hide(s):this.show(s)},this.onPointerMove=s=>{const{target:l}=s;!this.currentTarget||l.id===this.currentTarget||this.show(s)},this.onPointerLeave=s=>{this.hide(s)},this.onCanvasMove=s=>{this.hide(s)},this.onPointerOver=s=>{this.show(s)},this.showById=s=>gE(this,void 0,void 0,function*(){const l={target:{id:s}};yield this.show(l)}),this.getElementData=(s,l)=>{const{model:u}=this.context;switch(l){case"node":return u.getNodeData([s]);case"edge":return u.getEdgeData([s]);case"combo":return u.getComboData([s]);default:return[]}},this.show=s=>gE(this,void 0,void 0,function*(){var l,u;const{client:h,target:{id:f}}=s;if(ml(s.target))return;const d=this.context.graph.getElementType(f),{getContent:v,title:p}=this.options,g=this.getElementData(f,d);if(!this.tooltipElement||!this.isEnable(s,g))return;let y={};if(v){if(y.content=yield v(s,g),!y.content)return}else{const x=this.context.graph.getElementRenderStyle(f),E=d==="node"?x.fill:x.stroke;y={title:p||d,data:g.map(w=>({name:"ID",value:w.id||`${w.source} -> ${w.target}`,color:E}))}}this.currentTarget=f;let m,b;if(h)m=h.x,b=h.y;else{const x=Tn(g,"0.style",{x:0,y:0});m=x.x,b=x.y}(u=(l=this.options).onOpenChange)===null||u===void 0||u.call(l,!0),this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:m,y:b,style:{".tooltip":{visibility:"visible"}}}),y))}),this.hide=s=>{var l,u,h,f,d;if(!s){(u=(l=this.options).onOpenChange)===null||u===void 0||u.call(l,!1),(h=this.tooltipElement)===null||h===void 0||h.hide(),this.currentTarget=null;return}if(!this.tooltipElement||!this.currentTarget)return;const{client:{x:v,y:p}}=s;(d=(f=this.options).onOpenChange)===null||d===void 0||d.call(f,!1),this.tooltipElement.hide(v,p),this.currentTarget=null},this.initTooltip=()=>{var s;const l=new B6({className:"tooltip",style:this.tooltipStyleProps});return(s=this.container)===null||s===void 0||s.appendChild(l.HTMLTooltipElement),l},this.render(),this.bindEvents()}getEvents(){return this.options.trigger==="click"?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerover":this.onPointerOver,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerover":this.onPointerOver,"edge:pointermove":this.onPointerMove,"combo:pointerover":this.onPointerOver,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(n){var r;this.unbindEvents(),super.update(n),this.tooltipElement&&((r=this.container)===null||r===void 0||r.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:n}=this.context,r=n.getContainer();r&&(this.container=r,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:n}=this.context,r=this.getEvents();Object.keys(r).forEach(s=>{n.off(s,r[s])})}bindEvents(){const{graph:n}=this.context,r=this.getEvents();Object.keys(r).forEach(s=>{n.on(s,r[s])})}get tooltipStyleProps(){const{canvas:n}=this.context,{center:r}=n.getBounds(),s=n.getContainer(),{top:l,left:u}=s.getBoundingClientRect(),{style:h,position:f,enterable:d,container:v={x:-u,y:-l},title:p,offset:g}=this.options,[y,m]=r,[b,x]=n.getSize();return{x:y,y:m,container:v,title:p,bounding:{x:0,y:0,width:b,height:x},position:f,enterable:d,offset:g,style:h}}destroy(){var n;this.unbindEvents(),this.tooltipElement&&((n=this.container)===null||n===void 0||n.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}}ic.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};var yE=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};let Js;function mE(a,n){return Js||(Js=document.createElement("canvas")),Js.width=a,Js.height=n,Js.getContext("2d").clearRect(0,0,a,n),Js}function F6(a,n,r,s){return yE(this,void 0,void 0,function*(){const l=mE(a,n),u=l.getContext("2d"),{rotate:h,opacity:f,textFill:d,textFontSize:v,textFontFamily:p,textFontVariant:g,textFontWeight:y,textAlign:m,textBaseline:b}=s;return u.textAlign=m,u.textBaseline=b,u.translate(a/2,n/2),u.font=`${v}px ${p} ${g} ${y}`,h&&u.rotate(h),f&&(u.globalAlpha=f),d&&(u.fillStyle=d,u.fillText(`${r}`,0,0)),l.toDataURL()})}function z6(a,n,r,s){return yE(this,void 0,void 0,function*(){const l=mE(a,n),u=l.getContext("2d"),{rotate:h,opacity:f}=s;h&&u.rotate(h),f&&(u.globalAlpha=f);const d=new Image;return d.crossOrigin="anonymous",d.src=r,new Promise(v=>{d.onload=function(){const p=a>d.width?(a-d.width)/2:0,g=n>d.height?(n-d.height)/2:0;u.drawImage(d,0,0,d.width,d.height,p,g,a-p*2,n-g*2),v(l.toDataURL())}})})}var Z6=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})},G6=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class ac extends ln{constructor(n,r){super(n,Object.assign({},ac.defaultOptions,r)),this.$element=Us("watermark"),this.context.canvas.getContainer().appendChild(this.$element),this.update(r)}update(n){const r=Object.create(null,{update:{get:()=>super.update}});return Z6(this,void 0,void 0,function*(){r.update.call(this,n);const s=this.options,{width:l,height:u,text:h,imageURL:f}=s,d=G6(s,["width","height","text","imageURL"]);Object.keys(d).forEach(p=>{p.startsWith("background")&&(this.$element.style[p]=n[p])});const v=f?yield z6(l,u,f,d):yield F6(l,u,h,d);this.$element.style.backgroundImage=`url(${v})`})}destroy(){super.destroy(),this.$element.remove()}}ac.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};const W6=["#7E92B5","#F4664A","#FFBE3A"],j6={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},V6={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function bE(a){const{bgColor:n,textColor:r,nodeColor:s,nodeColorDisabled:l,nodeStroke:u,nodeHaloStrokeOpacityActive:h=.15,nodeHaloStrokeOpacitySelected:f=.25,nodeOpacityDisabled:d=.06,nodeIconOpacityInactive:v=.85,nodeOpacityInactive:p=.25,nodeBadgePalette:g=W6,nodePaletteOptions:y=j6,edgeColor:m,edgeColorDisabled:b,edgePaletteOptions:x=V6,comboColor:E,comboColorDisabled:w,comboStroke:S,comboStrokeDisabled:M,edgeColorInactive:C}=a;return{background:n,node:{palette:y,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:g,fill:s,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:n,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:r,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:s,portLineWidth:1,portStroke:u,portStrokeOpacity:.65,size:32,stroke:u,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:f,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:u},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:h},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:u,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:p,donutOpacity:p,fillOpacity:p,iconOpacity:v,labelFill:r,labelFillOpacity:p,strokeOpacity:p},disabled:{badgeBackgroundOpacity:.25,donutOpacity:d,fill:l,fillOpacity:d,iconFill:l,iconOpacity:.25,labelFill:r,labelFillOpacity:.25,strokeOpacity:d}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:x,style:{badgeBackgroundFill:m,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,badgeBackgroundOpacity:1,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:n,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:r,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:m,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:C,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:b,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:n,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:E,halo:!1,haloLineWidth:12,haloStroke:S,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:n,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:r,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:S},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:w,fillOpacity:.25,labelOpacity:.25,stroke:M,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const H6=bE({bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:{type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"}),$6=bE({bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"});class cr extends Wd{beforeDraw(n,r){return n}afterLayout(n,r){}}class U6 extends cr{beforeDraw(n){const{model:r}=this.context,s=n.add.combos,l=u=>{const h=[];return u.forEach((f,d)=>{const p=r.getAncestorsData(d,"combo").map(g=>V(g)).reverse();h.push([d,f,p.length])}),new Map(h.sort(([,,f],[,,d])=>d-f).map(([f,d])=>[f,d]))};return n.add.combos=l(s),n.update.combos=l(n.update.combos),n}}function xr(a,n,r,s,l){const u=V(s),h=`${r}s`,f=l?s:a.add[h].get(u)||a.update[h].get(u)||a.remove[h].get(u)||s;Object.entries(a).forEach(([d,v])=>{n===d?v[h].set(u,f):v[h].delete(u)})}function Ih(a,n){return Object.keys(a).every(r=>a[r]===n[r])}class Y6 extends cr{beforeDraw(n,r){if(r.stage==="visibility"||!this.context.model.model.hasTreeStructure(Oe))return n;const{model:s}=this.context,{add:l,update:u}=n,h=[...n.update.combos.entries(),...n.add.combos.entries()];for(;h.length;){const[f,d]=h.pop();if(Vn(d)){const v=s.getDescendantsData(f),p=v.map(V),{internal:g,external:y}=vv(p,m=>s.getRelatedEdgesData(m));v.forEach(m=>{const b=V(m),x=h.findIndex(([w])=>w===b);x!==-1&&h.splice(x,1);const E=s.getElementType(b);xr(n,"remove",E,m)}),g.forEach(m=>xr(n,"remove","edge",m)),y.forEach(m=>{var b;const x=V(m);((b=this.context.element)===null||b===void 0?void 0:b.getElement(x))?u.edges.set(x,m):l.edges.set(x,m)})}else{const v=s.getChildrenData(f),p=v.map(V),{edges:g}=vv(p,y=>s.getRelatedEdgesData(y));[...v,...g].forEach(y=>{var m;const b=V(y),x=s.getElementType(b);((m=this.context.element)===null||m===void 0?void 0:m.getElement(b))?xr(n,"update",x,y):xr(n,"add",x,y),x==="combo"&&h.push([b,y])})}}return n}}const xE=(a,n,r,s)=>{const l=`${r}s`,u=V(s);!a.add[l].has(u)&&!a.update[l].has(u)&&a[n][l].set(V(s),s)};class X6 extends cr{getElement(n){return this.context.element.getElement(n)}handleExpand(n,r){if(xE(r,"add","node",n),Vn(n))return;const s=V(n);xE(r,"add","node",n),this.context.model.getRelatedEdgesData(s).forEach(h=>{xr(r,"add","edge",h)}),this.context.model.getChildrenData(s).forEach(h=>{this.handleExpand(h,r)})}beforeDraw(n){const{graph:r,model:s}=this.context;if(!s.model.hasTreeStructure(gr))return n;const{add:{nodes:l,edges:u},update:{nodes:h}}=n,f=new Map,d=new Map;l.forEach((p,g)=>{Vn(p)&&f.set(g,p)}),u.forEach(p=>{if(r.getElementType(p.source)!=="node")return;const g=r.getNodeData(p.source);Vn(g)&&f.set(p.source,g)}),h.forEach((p,g)=>{const y=this.getElement(g);if(!y)return;const m=y.attributes.collapsed;Vn(p)?m||f.set(g,p):m&&d.set(g,p)});const v=new Set;return f.forEach((p,g)=>{s.getDescendantsData(g).forEach(m=>{const b=V(m);if(v.has(b))return;xr(n,"remove","node",m),s.getRelatedEdgesData(b).forEach(E=>{xr(n,"remove","edge",E)}),v.add(b)})}),d.forEach((p,g)=>{if(s.getAncestorsData(g,gr).some(Vn)){xr(n,"remove","node",p);return}this.handleExpand(p,n)}),n}}const S0=new WeakMap;function q6(a,n,r){S0.has(a)||S0.set(a,{});const s=S0.get(a);if(!s[n])return s[n]=r,!0;const l=s[n];return EE(l,r)?!1:(s[n]=r,!0)}const EE=(a,n,r=2)=>{if(typeof a!="object"||typeof n!="object")return a===n;const s=Object.keys(a),l=Object.keys(n);if(s.length!==l.length)return!1;for(const u of s){const h=a[u],f=n[u];if(r>1&&typeof h=="object"&&typeof f=="object"){if(!EE(h,f,r-1))return!1}else if(h!==f)return!1}return!0};function M0(a,n,r){Tu[a][n]&&ar.warn(`The extension ${n} of ${a} has been registered before, and will be overridden.`),Object.assign(Tu[a],{[n]:r})}var wE=function(){function a(n){(0,I.Z)(this,a),this.dragndropPluginOptions=n}return(0,D.Z)(a,[{key:"apply",value:function(r){var s=this,l=r.renderingService,u=r.renderingContext,h=u.root.ownerDocument,f=h.defaultView,d=function(p){var g=p.target,y=g===h,m=y&&s.dragndropPluginOptions.isDocumentDraggable?h:g.closest&&g.closest("[draggable=true]");if(m){var b=!1,x=p.timeStamp,E=[p.clientX,p.clientY],w=null,S=[p.clientX,p.clientY],M=function(){var T=(0,ia.Z)((0,Rn.Z)().mark(function O(k){var P,A,N,L,R,z;return(0,Rn.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(b){Z.next=2;break}if(P=k.timeStamp-x,A=Jn([k.clientX,k.clientY],E),!(P<=s.dragndropPluginOptions.dragstartTimeThreshold||A<=s.dragndropPluginOptions.dragstartDistanceThreshold)){Z.next=1;break}return Z.abrupt("return");case 1:k.type="dragstart",m.dispatchEvent(k),b=!0;case 2:if(k.type="drag",k.dx=k.clientX-S[0],k.dy=k.clientY-S[1],m.dispatchEvent(k),S=[k.clientX,k.clientY],y){Z.next=4;break}return N=s.dragndropPluginOptions.overlap==="pointer"?[k.canvasX,k.canvasY]:g.getBounds().center,Z.next=3,h.elementsFromPoint(N[0],N[1]);case 3:L=Z.sent,R=L[L.indexOf(g)+1],z=(R==null?void 0:R.closest("[droppable=true]"))||(s.dragndropPluginOptions.isDocumentDroppable?h:null),w!==z&&(w&&(k.type="dragleave",k.target=w,w.dispatchEvent(k)),z&&(k.type="dragenter",k.target=z,z.dispatchEvent(k)),w=z,w&&(k.type="dragover",k.target=w,w.dispatchEvent(k)));case 4:case"end":return Z.stop()}},O)}));return function(k){return T.apply(this,arguments)}}();f.addEventListener("pointermove",M);var C=function(O){if(b){O.detail={preventClick:!0};var k=O.clone();w&&(k.type="drop",k.target=w,w.dispatchEvent(k)),k.type="dragend",m.dispatchEvent(k),b=!1}f.removeEventListener("pointermove",M)};g.addEventListener("pointerup",C,{once:!0}),g.addEventListener("pointerupoutside",C,{once:!0})}};l.hooks.init.tap(a.tag,function(){f.addEventListener("pointerdown",d)}),l.hooks.destroy.tap(a.tag,function(){f.removeEventListener("pointerdown",d)})}}])}();wE.tag="Dragndrop";var K6=function(a){function n(){var r,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,I.Z)(this,n),r=(0,G.Z)(this,n),r.name="dragndrop",r.options=s,r}return(0,F.Z)(n,a),(0,D.Z)(n,[{key:"init",value:function(){this.addRenderingPlugin(new wE((0,$.Z)({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(s){Object.assign(this.plugins[0].dragndropPluginOptions,s)}}])}(aa),SE=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})},ME=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};const TE=["main"],CE=["background","main","label","transient"];function Q6(a){return a.main}class T0{getConfig(){return this.config}getLayer(n="main"){return this.extends.layers[n]||Q6(this.getLayers())}getLayers(){return this.extends.layers}getRenderer(n){return this.extends.renderers[n]}getCamera(n="main"){return this.getLayer(n).getCamera()}getRoot(n="main"){return this.getLayer(n).getRoot()}getContextService(n="main"){return this.getLayer(n).getContextService()}setCursor(n){this.config.cursor=n,this.getLayer().setCursor(n)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}constructor(n){this.config={enableMultiLayer:!0},Object.assign(this.config,n);const r=this.config,{renderer:s,background:l,cursor:u,enableMultiLayer:h}=r,f=ME(r,["renderer","background","cursor","enableMultiLayer"]),d=h?CE:TE,v=OE(s,d),p=Object.fromEntries(d.map(g=>{const y=new yd(Object.assign(Object.assign({},f),{supportsMutipleCanvasesInOneContainer:h,renderer:v[g],background:h?g==="background"?l:void 0:l}));return[g,y]}));kE(p),this.extends={config:this.config,renderer:s,renderers:v,layers:p}}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,n])=>n.ready))}resize(n,r){Object.assign(this.extends.config,{width:n,height:r}),Object.values(this.getLayers()).forEach(s=>{const l=s.getCamera(),u=l.getPosition(),h=l.getFocalPoint();s.resize(n,r),l.setPosition(u),l.setFocalPoint(h)})}getBounds(n){return Uo(Object.values(this.getLayers()).map(r=>n?r.getRoot().childNodes.find(l=>l.classList.includes(n)):r.getRoot()).filter(r=>(r==null?void 0:r.childNodes.length)>0).map(r=>r.getBounds()))}getContainer(){const n=this.extends.config.container;return typeof n=="string"?document.getElementById(n):n}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(n,r){var s;const l=((s=n.style)===null||s===void 0?void 0:s.$layer)||"main";return this.getLayer(l).appendChild(n,r)}setRenderer(n){if(n===this.extends.renderer)return;const r=OE(n,this.config.enableMultiLayer?CE:TE);this.extends.renderers=r,Object.entries(r).forEach(([s,l])=>this.getLayer(s).setRenderer(l)),kE(this.getLayers())}getCanvasByViewport(n){return Mn(this.getLayer().viewport2Canvas(qr(n)))}getViewportByCanvas(n){return Mn(this.getLayer().canvas2Viewport(qr(n)))}getViewportByClient(n){return Mn(this.getLayer().client2Viewport(qr(n)))}getClientByViewport(n){return Mn(this.getLayer().viewport2Client(qr(n)))}getClientByCanvas(n){return this.getClientByViewport(this.getViewportByCanvas(n))}getCanvasByClient(n){const r=this.getLayer(),s=r.client2Viewport(qr(n));return Mn(r.viewport2Canvas(s))}toDataURL(){return SE(this,arguments,void 0,function*(n={}){const r=globalThis.devicePixelRatio||1,{mode:s="viewport"}=n,l=ME(n,["mode"]);let[u,h,f,d]=[0,0,0,0];if(s==="viewport")[f,d]=this.getSize();else if(s==="overall"){const w=this.getBounds(),S=la(w);[u,h]=w.min,[f,d]=S}const v=E0('<div id="virtual-image"></div>'),p=new yd({width:f,height:d,renderer:new sl,devicePixelRatio:r,container:v,background:this.extends.config.background});yield p.ready,p.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),p.appendChild(this.getRoot().cloneNode(!0));const g=this.getLayer("label").getRoot().cloneNode(!0),y=p.viewport2Canvas({x:0,y:0}),m=this.getCanvasByViewport([0,0]);g.translate([m[0]-y.x,m[1]-y.y]),g.scale(1/this.getCamera().getZoom()),p.appendChild(g),p.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const b=this.getCamera(),x=p.getCamera();if(s==="viewport")x.setZoom(b.getZoom()),x.setPosition(b.getPosition()),x.setFocalPoint(b.getFocalPoint());else if(s==="overall"){const[w,S,M]=x.getPosition(),[C,T,O]=x.getFocalPoint();x.setPosition([w+u,S+h,M]),x.setFocalPoint([C+u,T+h,O])}const E=p.getContextService();return new Promise(w=>{p.addEventListener(vr.RERENDER,()=>SE(this,void 0,void 0,function*(){yield new Promise(M=>setTimeout(M,300));const S=yield E.toDataURL(l);w(S)}))})})}destroy(){Object.values(this.getLayers()).forEach(n=>{n.getCamera().cancelLandmarkAnimation(),n.destroy()})}}function OE(a,n){return Object.fromEntries(n.map(r=>{const s=(a==null?void 0:a(r))||new sl;return s instanceof sl&&s.setConfig({enableDirtyRectangleRendering:!1}),r==="main"?s.registerPlugin(new K6({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):s.unregisterPlugin(s.getPlugin("dom-interaction")),[r,s]}))}function kE(a){Object.entries(a).forEach(([n,r])=>{const s=r.getContextService().getDomElement();s!=null&&s.style&&(s.style.gridArea="1 / 1 / 2 / 2",s.style.outline="none",s.tabIndex=1,n!=="main"&&(s.style.pointerEvents="none")),s!=null&&s.parentElement&&(s.parentElement.style.display="grid",s.parentElement.style.isolation="isolate")})}const to=a=>a?parseInt(a):0;function J6(a){const n=getComputedStyle(a),r=a.clientWidth||to(n.width),s=a.clientHeight||to(n.height),l=to(n.paddingLeft)+to(n.paddingRight),u=to(n.paddingTop)+to(n.paddingBottom);return[r-l,s-u]}function _E(a){if(!a)return[0,0];let n=640,r=480;const[s,l]=J6(a);n=s||n,r=l||r;const u=1,h=1;return[Math.max((0,se.Z)(n)?n:u,u),Math.max((0,se.Z)(r)?r:h,h)]}class Bh{constructor(n){this.type=n}}class hn extends Bh{constructor(n,r){super(n),this.data=r}}class Ir extends Bh{constructor(n,r,s,l){super(n),this.animationType=r,this.animation=s,this.data=l}}class eo extends Bh{constructor(n,r,s){super(n),this.elementType=r,this.data=s}}class Fh extends Bh{constructor(n,r){super(n),this.data=r}}function pn(a,n){a.emit(n.type,n)}function t5(a){if(!a)return null;if(a instanceof Py)return{type:"canvas",element:a};let n=a;for(;n;){if(gl(n))return{type:"node",element:n};if(tb(n))return{type:"edge",element:n};if(pv(n))return{type:"combo",element:n};n=n.parentElement}return null}function PE(a){var n;return((n=a==null?void 0:a.style)===null||n===void 0?void 0:n.zIndex)||0}const no="cachedStyle",zh=a=>`__${a}__`;function e5(a,n){const r=Array.isArray(n)?n:[n];Tn(a,no)||el(a,no,{}),r.forEach(s=>{el(Tn(a,no),zh(s),a.attributes[s])})}function AE(a,n){return Tn(a,[no,zh(n)])}function n5(a,n){return zh(n)in(Tn(a,no)||{})}function LG(a,n,r){set(a,[no,zh(n)],r)}class r5{constructor(n){this.tasks=[],this.animations=new Set,this.context=n}getTasks(){const n=[...this.tasks];return this.tasks=[],n}add(n,r){this.tasks.push([n,r])}animate(n,r,s){var l,u,h;(l=r==null?void 0:r.before)===null||l===void 0||l.call(r);const f=this.getTasks().map(([v,p])=>{var g,y,m;const{element:b,elementType:x,stage:E}=v,w=Nk(this.context.options,x,E,n);(g=p==null?void 0:p.before)===null||g===void 0||g.call(p);const S=w.length?Lk(b,this.inferStyle(v,s),w):null;return S?((y=p==null?void 0:p.beforeAnimate)===null||y===void 0||y.call(p,S),S.finished.then(()=>{var M,C;(M=p==null?void 0:p.afterAnimate)===null||M===void 0||M.call(p,S),(C=p==null?void 0:p.after)===null||C===void 0||C.call(p),this.animations.delete(S)})):(m=p==null?void 0:p.after)===null||m===void 0||m.call(p),S}).filter(Boolean);f.forEach(v=>this.animations.add(v));const d=Od(f);return d?((u=r==null?void 0:r.beforeAnimate)===null||u===void 0||u.call(r,d),d.finished.then(()=>{var v,p;(v=r==null?void 0:r.afterAnimate)===null||v===void 0||v.call(r,d),(p=r==null?void 0:r.after)===null||p===void 0||p.call(r),this.release()})):(h=r==null?void 0:r.after)===null||h===void 0||h.call(r),d}inferStyle(n,r){var s,l;const{element:u,elementType:h,stage:f,originalStyle:d,updatedStyle:v={}}=n;n.modifiedStyle||(n.modifiedStyle=Object.assign(Object.assign({},d),v));const{modifiedStyle:p}=n,g={},y={};if(f==="enter")Object.assign(g,{opacity:0});else if(f==="exit")Object.assign(y,{opacity:0});else if(f==="show")Object.assign(g,{opacity:0}),Object.assign(y,{opacity:(s=AE(u,"opacity"))!==null&&s!==void 0?s:$o("opacity")});else if(f==="hide")Object.assign(g,{opacity:(l=AE(u,"opacity"))!==null&&l!==void 0?l:$o("opacity")}),Object.assign(y,{opacity:0});else if(f==="collapse"){const{collapse:m}=r||{},{target:b,descendants:x,position:E}=m;if(h==="node"){if(x.includes(u.id)){const[w,S,M]=E;Object.assign(y,{x:w,y:S,z:M})}}else if(h==="combo"){if(u.id===b||x.includes(u.id)){const[w,S]=E;Object.assign(y,{x:w,y:S,childrenNode:d.childrenNode})}}else h==="edge"&&Object.assign(y,{sourceNode:p.sourceNode,targetNode:p.targetNode})}else if(f==="expand"){const{expand:m}=r||{},{target:b,descendants:x,position:E}=m;if(h==="node"){if(u.id===b||x.includes(u.id)){const[w,S,M]=E;Object.assign(g,{x:w,y:S,z:M})}}else if(h==="combo"){if(u.id===b||x.includes(u.id)){const[w,S,M]=E;Object.assign(g,{x:w,y:S,z:M,childrenNode:p.childrenNode})}}else h==="edge"&&Object.assign(g,{sourceNode:p.sourceNode,targetNode:p.targetNode})}return[Object.keys(g).length>0?Object.assign({},d,g):d,Object.keys(y).length>0?Object.assign({},p,y):p]}stop(){this.animations.forEach(n=>n.cancel())}clear(){this.tasks=[]}release(){var n,r;const{canvas:s}=this.context,l=(r=(n=s.document)===null||n===void 0?void 0:n.timeline)===null||r===void 0?void 0:r.animationsWithPromises;l&&(s.document.timeline.animationsWithPromises=l.filter(u=>u.playState!=="finished"))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class i5{constructor(n){this.batchCount=0,this.context=n}emit(n){const{graph:r}=this.context;r.emit(n.type,n)}startBatch(n=!0){this.batchCount++,this.batchCount===1&&this.emit(new hn(lt.BATCH_START,{initiate:n}))}endBatch(){this.batchCount--,this.batchCount===0&&this.emit(new hn(lt.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class a5 extends Gd{constructor(n){super(n),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=r=>{const{target:s}=r,l=t5(s);if(!l)return;const{graph:u,canvas:h}=this.context,{type:f,element:d}=l;if("destroyed"in d&&(ml(d)||d.destroyed))return;const{type:v,detail:p,button:g}=r,y=Object.assign(Object.assign({},r),{target:d,targetType:f,originalTarget:s});v===tt.POINTER_MOVE&&(this.currentTarget!==d&&(this.currentTarget&&u.emit(`${this.currentTargetType}:${tt.POINTER_LEAVE}`,Object.assign(Object.assign({},y),{type:tt.POINTER_LEAVE,target:this.currentTarget,targetType:this.currentTargetType})),d&&(Object.assign(y,{type:tt.POINTER_ENTER}),u.emit(`${f}:${tt.POINTER_ENTER}`,y))),this.currentTarget=d,this.currentTargetType=f),v===tt.CLICK&&g===2||(u.emit(`${f}:${v}`,y),u.emit(v,y)),v===tt.CLICK&&p===2&&(Object.assign(y,{type:tt.DBLCLICK}),u.emit(`${f}:${tt.DBLCLICK}`,y),u.emit(tt.DBLCLICK,y)),v===tt.POINTER_DOWN&&g===2&&(Object.assign(y,{type:tt.CONTEXT_MENU,preventDefault:()=>{var m;(m=h.getContainer())===null||m===void 0||m.addEventListener(tt.CONTEXT_MENU,b=>b.preventDefault(),{once:!0})}}),u.emit(`${f}:${tt.CONTEXT_MENU}`,y),u.emit(tt.CONTEXT_MENU,y))},this.forwardContainerEvents=r=>{this.context.graph.emit(r.type,r)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(n){this.setExtensions(n)}forwardEvents(){const n=this.context.canvas.getContainer();n&&[qa.KEY_DOWN,qa.KEY_UP].forEach(s=>{n.addEventListener(s,this.forwardContainerEvents)});const r=this.context.canvas.document;r&&[tt.CLICK,tt.DBLCLICK,tt.POINTER_OVER,tt.POINTER_LEAVE,tt.POINTER_ENTER,tt.POINTER_MOVE,tt.POINTER_OUT,tt.POINTER_DOWN,tt.POINTER_UP,tt.CONTEXT_MENU,tt.DRAG_START,tt.DRAG,tt.DRAG_END,tt.DRAG_ENTER,tt.DRAG_OVER,tt.DRAG_LEAVE,tt.DROP,tt.WHEEL].forEach(s=>{r.addEventListener(s,this.forwardCanvasEvents)})}destroy(){const n=this.context.canvas.getContainer();n&&[qa.KEY_DOWN,qa.KEY_UP].forEach(r=>{n.removeEventListener(r,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}function s5(a,n){n===void 0&&(n=new Map);var r=[];if(Array.isArray(a))for(var s=0,l=a.length;s<l;s++){var u=a[s];n.has(u)||(r.push(u),n.set(u,!0))}return r}var sc=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};function Ma(a,n){const{data:r,style:s}=a,l=sc(a,["data","style"]),{data:u,style:h}=n,f=sc(n,["data","style"]),d=Object.assign(Object.assign({},l),f);return(r||u)&&Object.assign(d,{data:Object.assign(Object.assign({},r),u)}),(s||h)&&Object.assign(d,{style:Object.assign(Object.assign({},s),h)}),d}function C0(a){const{data:n,style:r}=a,l=sc(a,["data","style"]);return n&&(l.data=Object.assign({},n)),r&&(l.style=Object.assign({},r)),l}function DG(a){return!get(a,["nodes","length"])&&!get(a,["edges","length"])&&!get(a,["combos","length"])}function ro(a={},n={}){const{states:r=[],data:s={},style:l={},children:u=[]}=a,h=sc(a,["states","data","style","children"]),{states:f=[],data:d={},style:v={},children:p=[]}=n,g=sc(n,["states","data","style","children"]),y=(b,x)=>b.length!==x.length?!1:b.every((E,w)=>E===x[w]),m=(b,x)=>{const E=Object.keys(b),w=Object.keys(x);return E.length!==w.length?!1:E.every(S=>b[S]===x[S])};return!(!m(h,g)||!y(u,p)||!y(r,f)||!m(s,d)||!m(l,v))}var o5=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};function O0(a){const{id:n=V(a),style:r,data:s}=a,l=o5(a,["id","style","data"]),u=Object.assign(Object.assign({},a),{style:Object.assign({},r),data:Object.assign({},s)});return Wk(a)?Object.assign({id:n,data:u},l):{id:n,data:u}}function bn(a){return a.data}function l5(a){if(a.hasTreeStructure(gr))return;a.attachTreeStructure(gr);const n=a.getAllEdges();for(const r of n){const{source:s,target:l}=r;a.setParent(l,s,gr)}}class c5{constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new xv.k}pushChange(n){if(this.isTraceless)return;const{type:r}=n;if(r===Le.NodeUpdated||r===Le.EdgeUpdated||r===Le.ComboUpdated){const{value:s,original:l}=n;this.changes.push({value:C0(s),original:C0(l),type:r})}else this.changes.push({value:C0(n.value),type:r})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(n){this.batchCount++,this.model.batch(n),this.batchCount--}isBatching(){return this.batchCount>0}silence(n){this.isTraceless=!0,n(),this.isTraceless=!1}isCombo(n){return this.comboIds.has(n)||this.latestRemovedComboIds.has(n)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(n){return this.model.getAllNodes().reduce((r,s)=>{const l=bn(s);return this.isCombo(V(l))||(n===void 0||n.includes(V(l)))&&r.push(l),r},[])}getEdgeDatum(n){return bn(this.model.getEdge(n))}getEdgeData(n){return this.model.getAllEdges().reduce((r,s)=>{const l=bn(s);return(n===void 0||n.includes(V(l)))&&r.push(l),r},[])}getComboData(n){return this.model.getAllNodes().reduce((r,s)=>{const l=bn(s);return this.isCombo(V(l))&&(n===void 0||n.includes(V(l)))&&r.push(l),r},[])}getRootsData(n=gr){return this.model.getRoots(n).map(bn)}getAncestorsData(n,r){const{model:s}=this;return!s.hasNode(n)||!s.hasTreeStructure(r)?[]:s.getAncestors(n,r).map(bn)}getDescendantsData(n){const r=this.getElementDataById(n),s=[];return ns(r,l=>{l!==r&&s.push(l)},l=>this.getChildrenData(V(l)),"TB"),s}getParentData(n,r){const{model:s}=this;if(!r){ar.warn("The hierarchy structure key is not specified");return}if(!s.hasNode(n)||!s.hasTreeStructure(r))return;const l=s.getParent(n,r);return l?bn(l):void 0}getChildrenData(n){const r=this.getElementType(n)==="node"?gr:Oe,{model:s}=this;return!s.hasNode(n)||!s.hasTreeStructure(r)?[]:s.getChildren(n,r).map(bn)}getElementsDataByType(n){return n==="node"?this.getNodeData():n==="edge"?this.getEdgeData():n==="combo"?this.getComboData():[]}getElementDataById(n){return this.getElementType(n)==="edge"?this.getEdgeDatum(n):this.getNodeLikeDatum(n)}getNodeLikeDatum(n){const r=this.model.getNode(n);return bn(r)}getNodeLikeData(n){return this.model.getAllNodes().reduce((r,s)=>{const l=bn(s);return n?n.includes(V(l))&&r.push(l):r.push(l),r},[])}getElementDataByState(n,r){return this.getElementsDataByType(n).filter(l=>{var u;return(u=l.states)===null||u===void 0?void 0:u.includes(r)})}getElementState(n){var r;return((r=this.getElementDataById(n))===null||r===void 0?void 0:r.states)||[]}hasNode(n){return this.model.hasNode(n)&&!this.isCombo(n)}hasEdge(n){return this.model.hasEdge(n)}hasCombo(n){return this.model.hasNode(n)&&this.isCombo(n)}getRelatedEdgesData(n,r="both"){return this.model.getRelatedEdges(n,r).map(bn)}getNeighborNodesData(n){return this.model.getNeighbors(n).map(bn)}setData(n){const{nodes:r=[],edges:s=[],combos:l=[]}=n,{nodes:u,edges:h,combos:f}=this.getData(),d=ha(u,r,g=>V(g),ro),v=ha(h,s,g=>V(g),ro),p=ha(f,l,g=>V(g),ro);this.batch(()=>{const g={nodes:d.enter,edges:v.enter,combos:p.enter};this.addData(g),this.computeZIndex(g,"add",!0);const y={nodes:d.update,edges:v.update,combos:p.update};this.updateData(y),this.computeZIndex(y,"update",!0);const m={nodes:d.exit.map(V),edges:v.exit.map(V),combos:p.exit.map(V)};this.removeData(m)})}addData(n){const{nodes:r,edges:s,combos:l}=n;this.batch(()=>{this.addComboData(l),this.addNodeData(r),this.addEdgeData(s)}),this.computeZIndex(n,"add")}addNodeData(n=[]){n.length&&(this.model.addNodes(n.map(r=>(this.pushChange({value:r,type:Le.NodeAdded}),O0(r)))),this.updateNodeLikeHierarchy(n),this.computeZIndex({nodes:n},"add"))}addEdgeData(n=[]){n.length&&(this.model.addEdges(n.map(r=>(this.pushChange({value:r,type:Le.EdgeAdded}),O0(r)))),this.computeZIndex({edges:n},"add"))}addComboData(n=[]){if(!n.length)return;const{model:r}=this;r.hasTreeStructure(Oe)||r.attachTreeStructure(Oe),r.addNodes(n.map(s=>(this.comboIds.add(V(s)),this.pushChange({value:s,type:Le.ComboAdded}),O0(s)))),this.updateNodeLikeHierarchy(n),this.computeZIndex({combos:n},"add")}addChildrenData(n,r){const s=this.getNodeLikeDatum(n),l=r.map(V);this.addNodeData(r),this.updateNodeData([{id:n,children:[...s.children||[],...l]}]),this.addEdgeData(l.map(u=>({source:n,target:u})))}computeZIndex(n,r,s=!1){!s&&this.isBatching()||this.batch(()=>{const{nodes:l=[],edges:u=[],combos:h=[]}=n;h.forEach(f=>{var d,v,p;const g=V(f);if(r==="add"&&(0,se.Z)((d=f.style)===null||d===void 0?void 0:d.zIndex)||r==="update"&&!("combo"in f))return;const y=this.getParentData(g,Oe),m=y?((p=(v=y.style)===null||v===void 0?void 0:v.zIndex)!==null&&p!==void 0?p:0)+1:0;this.preventUpdateNodeLikeHierarchy(()=>{this.updateComboData([{id:g,style:{zIndex:m}}])})}),l.forEach(f=>{var d,v,p;const g=V(f);if(r==="add"&&(0,se.Z)((d=f.style)===null||d===void 0?void 0:d.zIndex)||r==="update"&&!("combo"in f)&&!("children"in f))return;let y=0;const m=this.getParentData(g,Oe);if(m)y=(((v=m.style)===null||v===void 0?void 0:v.zIndex)||0)+1;else{const b=this.getParentData(g,gr);b&&(y=((p=b==null?void 0:b.style)===null||p===void 0?void 0:p.zIndex)||0)}this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:g,style:{zIndex:y}}])})}),u.forEach(f=>{var d,v,p,g,y;if((0,se.Z)((d=f.style)===null||d===void 0?void 0:d.zIndex))return;let{id:m,source:b,target:x}=f;if(!m)m=V(f);else{const S=this.getEdgeDatum(m);b=S.source,x=S.target}if(!b||!x)return;const E=((p=(v=this.getNodeLikeDatum(b))===null||v===void 0?void 0:v.style)===null||p===void 0?void 0:p.zIndex)||0,w=((y=(g=this.getNodeLikeDatum(x))===null||g===void 0?void 0:g.style)===null||y===void 0?void 0:y.zIndex)||0;this.updateEdgeData([{id:V(f),style:{zIndex:Math.max(E,w)-1}}])})})}getFrontZIndex(n){var r;const s=this.getElementType(n),l=this.getElementDataById(n),u=this.getData();if(Object.assign(u,{[`${s}s`]:u[`${s}s`].filter(h=>V(h)!==n)}),s==="combo"&&!Vn(l)){const h=new Set(this.getAncestorsData(n,Oe).map(V));u.nodes=u.nodes.filter(f=>!h.has(V(f))),u.combos=u.combos.filter(f=>!h.has(V(f))),u.edges=u.edges.filter(({source:f,target:d})=>!h.has(f)&&!h.has(d))}return Math.max(((r=l.style)===null||r===void 0?void 0:r.zIndex)||0,0,...Object.values(u).flat().map(h=>{var f;return(((f=h==null?void 0:h.style)===null||f===void 0?void 0:f.zIndex)||0)+1}))}updateNodeLikeHierarchy(n){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:r}=this;n.forEach(s=>{const l=V(s),u=Gu(s);u!==void 0&&(r.hasTreeStructure(Oe)||r.attachTreeStructure(Oe),u===null&&this.refreshComboData(l),this.setParent(l,Gu(s),Oe));const h=s.children||[];if(h.length){r.hasTreeStructure(gr)||r.attachTreeStructure(gr);const f=h.filter(d=>r.hasNode(d));f.forEach(d=>this.setParent(d,l,gr)),f.length!==h.length&&this.updateNodeData([{id:l,children:f}])}})}preventUpdateNodeLikeHierarchy(n){this.enableUpdateNodeLikeHierarchy=!1,n(),this.enableUpdateNodeLikeHierarchy=!0}updateData(n){const{nodes:r,edges:s,combos:l}=n;this.batch(()=>{this.updateNodeData(r),this.updateComboData(l),this.updateEdgeData(s)}),this.computeZIndex(n,"update")}updateNodeData(n=[]){if(!n.length)return;const{model:r}=this;this.batch(()=>{const s=[];n.forEach(l=>{const u=V(l),h=bn(r.getNode(u));if(ro(h,l))return;const f=Ma(h,l);this.pushChange({value:f,original:h,type:Le.NodeUpdated}),r.mergeNodeData(u,f),s.push(f)}),this.updateNodeLikeHierarchy(s)}),this.computeZIndex({nodes:n},"update")}refreshData(){const{nodes:n,edges:r,combos:s}=this.getData();n.forEach(l=>{this.pushChange({value:l,original:l,type:Le.NodeUpdated})}),r.forEach(l=>{this.pushChange({value:l,original:l,type:Le.EdgeUpdated})}),s.forEach(l=>{this.pushChange({value:l,original:l,type:Le.ComboUpdated})})}syncNodeLikeDatum(n){const{model:r}=this,s=V(n);if(!r.hasNode(s))return;const l=bn(r.getNode(s)),u=Ma(l,n);r.mergeNodeData(s,u)}syncEdgeDatum(n){const{model:r}=this,s=V(n);if(!r.hasEdge(s))return;const l=bn(r.getEdge(s)),u=Ma(l,n);r.mergeEdgeData(s,u)}updateEdgeData(n=[]){if(!n.length)return;const{model:r}=this;this.batch(()=>{n.forEach(s=>{const l=V(s),u=bn(r.getEdge(l));if(ro(u,s))return;s.source&&u.source!==s.source&&r.updateEdgeSource(l,s.source),s.target&&u.target!==s.target&&r.updateEdgeTarget(l,s.target);const h=Ma(u,s);this.pushChange({value:h,original:u,type:Le.EdgeUpdated}),r.mergeEdgeData(l,h)})}),this.computeZIndex({edges:n},"update")}updateComboData(n=[]){if(!n.length)return;const{model:r}=this;r.batch(()=>{const s=[];n.forEach(l=>{const u=V(l),h=bn(r.getNode(u));if(ro(h,l))return;const f=Ma(h,l);this.pushChange({value:f,original:h,type:Le.ComboUpdated}),r.mergeNodeData(u,f),s.push(f)}),this.updateNodeLikeHierarchy(s)}),this.computeZIndex({combos:n},"update")}setParent(n,r,s,l=!0){if(n===r)return;const u=this.getNodeLikeDatum(n),h=Gu(u);if(h!==r&&s===Oe){const f={id:n,combo:r};this.isCombo(n)?this.syncNodeLikeDatum(f):this.syncNodeLikeDatum(f)}this.model.setParent(n,r,s),l&&s===Oe&&s5([h,r]).forEach(f=>{f!==void 0&&this.refreshComboData(f)})}refreshComboData(n){const r=this.getComboData([n])[0],s=this.getAncestorsData(n,Oe);r&&this.pushChange({value:r,original:r,type:Le.ComboUpdated}),s.forEach(l=>{this.pushChange({value:l,original:l,type:Le.ComboUpdated})})}getElementPosition(n){const r=this.getElementDataById(n);return Fe(r)}translateNodeLikeBy(n,r){this.isCombo(n)?this.translateComboBy(n,r):this.translateNodeBy(n,r)}translateNodeLikeTo(n,r){this.isCombo(n)?this.translateComboTo(n,r):this.translateNodeTo(n,r)}translateNodeBy(n,r){const s=this.getElementPosition(n),l=Gt(s,[...r,0].slice(0,3));this.translateNodeTo(n,l)}translateNodeTo(n,r){const[s=0,l=0,u=0]=r;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:n,style:{x:s,y:l,z:u}}])})}translateComboBy(n,r){const[s=0,l=0,u=0]=r;if([s,l,u].some(isNaN)||[s,l,u].every(d=>d===0))return;const h=this.getComboData([n])[0];if(!h)return;const f=new Set;ns(h,d=>{const v=V(d);if(f.has(v))return;f.add(v);const[p,g,y]=Fe(d),m=Ma(d,{style:{x:p+s,y:g+l,z:y+u}});this.pushChange({value:m,original:d,type:this.isCombo(v)?Le.ComboUpdated:Le.NodeUpdated}),this.model.mergeNodeData(v,m)},d=>this.getChildrenData(V(d)),"BT")}translateComboTo(n,r){var s;if(r.some(isNaN))return;const[l=0,u=0,h=0]=r,f=(s=this.getComboData([n]))===null||s===void 0?void 0:s[0];if(!f)return;const[d,v,p]=Fe(f),g=l-d,y=u-v,m=h-p;ns(f,b=>{const x=V(b),[E,w,S]=Fe(b),M=Ma(b,{style:{x:E+g,y:w+y,z:S+m}});this.pushChange({value:M,original:b,type:this.isCombo(x)?Le.ComboUpdated:Le.NodeUpdated}),this.model.mergeNodeData(x,M)},b=>this.getChildrenData(V(b)),"BT")}removeData(n){const{nodes:r,edges:s,combos:l}=n;this.batch(()=>{this.removeEdgeData(s),this.removeNodeData(r),this.removeComboData(l),this.latestRemovedComboIds=new Set(l)})}removeNodeData(n=[]){n.length&&this.batch(()=>{n.forEach(r=>{this.removeEdgeData(this.getRelatedEdgesData(r).map(V)),this.pushChange({value:this.getNodeData([r])[0],type:Le.NodeRemoved}),this.removeNodeLikeHierarchy(r)}),this.model.removeNodes(n)})}removeEdgeData(n=[]){n.length&&(n.forEach(r=>this.pushChange({value:this.getEdgeData([r])[0],type:Le.EdgeRemoved})),this.model.removeEdges(n))}removeComboData(n=[]){n.length&&this.batch(()=>{n.forEach(r=>{this.pushChange({value:this.getComboData([r])[0],type:Le.ComboRemoved}),this.removeNodeLikeHierarchy(r),this.comboIds.delete(r)}),this.model.removeNodes(n)})}removeNodeLikeHierarchy(n){if(this.model.hasTreeStructure(Oe)){const r=Gu(this.getNodeLikeDatum(n));this.setParent(n,void 0,Oe,!1),this.model.getChildren(n,Oe).forEach(s=>{const l=bn(s),u=V(l);this.setParent(V(l),r,Oe,!1);const h=Ma(l,{id:V(l),combo:r});this.pushChange({value:h,original:l,type:this.isCombo(u)?Le.ComboUpdated:Le.NodeUpdated}),this.model.mergeNodeData(V(l),h)}),(0,At.Z)(r)||this.refreshComboData(r)}}getElementType(n){if(this.model.hasNode(n))return this.isCombo(n)?"combo":"node";if(this.model.hasEdge(n))return"edge";throw new Error(Ii(`Unknown element type of id: ${n}`))}destroy(){const{model:n}=this,r=n.getAllNodes(),s=n.getAllEdges();n.removeEdges(s.map(l=>l.id)),n.removeNodes(r.map(l=>l.id)),this.context={}}}var oc=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class u5{constructor(n){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=n}init(){this.initContainer()}initContainer(){if(!this.container||this.container.destroyed){const{canvas:n}=this.context;this.container=n.appendChild(new vn({className:"elements"}))}}emit(n,r){r.silence||pn(this.context.graph,n)}forEachElementData(n){es.forEach(r=>{const s=this.context.model.getElementsDataByType(r);n(r,s)})}getElementType(n,r){var s;const{options:l,graph:u}=this.context,h=((s=l[n])===null||s===void 0?void 0:s.type)||r.type;return h?typeof h=="string"?h:h.call(u,r):n==="edge"?"line":"circle"}getTheme(n){return nm(this.context.options)[n]||{}}getThemeStyle(n){return this.getTheme(n).style||{}}getThemeStateStyle(n,r){const{state:s={}}=this.getTheme(n);return Object.assign({},...r.map(l=>s[l]||{}))}computePaletteStyle(){const{options:n}=this.context;this.paletteStyle={},this.forEachElementData((r,s)=>{var l,u;const h=Object.assign({},d1((l=this.getTheme(r))===null||l===void 0?void 0:l.palette),d1((u=n[r])===null||u===void 0?void 0:u.palette));h!=null&&h.field&&Object.assign(this.paletteStyle,qP(s,h))})}getPaletteStyle(n,r){const s=this.paletteStyle[r];return s?n==="edge"?{stroke:s}:{fill:s}:{}}computeElementDefaultStyle(n,r){var s;const{options:l}=this.context,u=((s=l[n])===null||s===void 0?void 0:s.style)||{};"transform"in u&&Array.isArray(u.transform)&&(u.transform=[...u.transform]),this.defaultStyle[V(r.datum)]=f1(u,r)}computeElementsDefaultStyle(n){const{graph:r}=this.context;this.forEachElementData((s,l)=>{const u=l.length;for(let h=0;h<u;h++){const f=l[h];(n===void 0||n.includes(V(f)))&&this.computeElementDefaultStyle(s,{datum:f,graph:r})}})}getDefaultStyle(n){return this.defaultStyle[n]||{}}getElementState(n){try{const{model:r}=this.context;return r.getElementState(n)}catch(r){return[]}}getElementStateStyle(n,r,s){var l,u;const{options:h}=this.context,f=((u=(l=h[n])===null||l===void 0?void 0:l.state)===null||u===void 0?void 0:u[r])||{};return f1(f,s)}computeElementStatesStyle(n,r,s){this.stateStyle[V(s.datum)]=Object.assign({},...r.map(l=>this.getElementStateStyle(n,l,s)))}computeElementsStatesStyle(n){const{graph:r}=this.context;this.forEachElementData((s,l)=>{const u=l.length;for(let h=0;h<u;h++){const f=l[h];if(n===void 0||n.includes(V(f))){const d=this.getElementState(V(f));this.computeElementStatesStyle(s,d,{datum:f,graph:r})}}})}getStateStyle(n){return this.stateStyle[n]||{}}computeStyle(n,r){n&&["translate","zIndex"].includes(n)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(r),this.computeElementsStatesStyle(r))}getElement(n){return this.elementMap[n]}getNodes(){return this.context.model.getNodeData().map(({id:n})=>this.elementMap[n])}getEdges(){return this.context.model.getEdgeData().map(n=>this.elementMap[V(n)])}getCombos(){return this.context.model.getComboData().map(({id:n})=>this.elementMap[n])}getElementComputedStyle(n,r){const s=V(r),l=this.getThemeStyle(n),u=this.getPaletteStyle(n,s),h=r.style||{},f=this.getDefaultStyle(s),d=this.getThemeStateStyle(n,this.getElementState(s)),v=this.getStateStyle(s),p=Object.assign({},l,u,h,f,d,v);if(n==="combo"){const g=this.context.model.getChildrenData(s),m=!!p.collapsed?[]:g.map(V).filter(b=>this.getElement(b));Object.assign(p,{childrenNode:m,childrenData:g})}return p}getDrawData(n){this.init();const r=this.computeChangesAndDrawData(n);if(!r)return null;const{type:s="draw",stage:l=s}=n;return this.markDestroyElement(r.drawData),this.computeStyle(l),{type:s,stage:l,data:r}}draw(n={animation:!0}){const r=this.getDrawData(n);if(!r)return;const{data:{drawData:{add:s,update:l,remove:u}}}=r;return this.destroyElements(u,n),this.createElements(s,n),this.updateElements(l,n),this.setAnimationTask(n,r)}preLayoutDraw(){return oc(this,arguments,void 0,function*(n={animation:!0}){var r,s;const l=this.getDrawData(n);if(!l)return;const{data:{drawData:u}}=l;yield(s=(r=this.context.layout)===null||r===void 0?void 0:r.preLayout)===null||s===void 0?void 0:s.call(r,u);const{add:h,update:f,remove:d}=u;return this.destroyElements(d,n),this.createElements(h,n),this.updateElements(f,n),this.setAnimationTask(n,l)})}setAnimationTask(n,r){const{animation:s,silence:l}=n,{data:{dataChanges:u,drawData:h},stage:f,type:d}=r;return this.context.animation.animate(s,l?{}:{before:()=>this.emit(new hn(lt.BEFORE_DRAW,{dataChanges:u,animation:s,stage:f,render:d==="render"}),n),beforeAnimate:v=>this.emit(new Ir(lt.BEFORE_ANIMATE,ir.DRAW,v,h),n),afterAnimate:v=>this.emit(new Ir(lt.AFTER_ANIMATE,ir.DRAW,v,h),n),after:()=>this.emit(new hn(lt.AFTER_DRAW,{dataChanges:u,animation:s,stage:f,render:d==="render",firstRender:this.context.graph.rendered===!1}),n)})}computeChangesAndDrawData(n){const{model:r}=this.context,s=r.getChanges(),l=Nv(s);if(l.length===0)return null;const{NodeAdded:u=[],NodeUpdated:h=[],NodeRemoved:f=[],EdgeAdded:d=[],EdgeUpdated:v=[],EdgeRemoved:p=[],ComboAdded:g=[],ComboUpdated:y=[],ComboRemoved:m=[]}=Cu(l,w=>w.type),b=w=>new Map(w.map(S=>{const M=S.value;return[V(M),M]})),x={add:{nodes:b(u),edges:b(d),combos:b(g)},update:{nodes:b(h),edges:b(v),combos:b(y)},remove:{nodes:b(f),edges:b(p),combos:b(m)}},E=this.transformData(x,n);return r.clearChanges(),{dataChanges:s,drawData:E}}transformData(n,r){const s=this.context.transform.getTransformInstance();return Object.values(s).reduce((l,u)=>u.beforeDraw(l,r),n)}createElement(n,r,s){var l;const u=V(r);if(this.getElement(u))return;const f=this.getElementType(n,r),d=this.getElementComputedStyle(n,r),v=mi(n,f);if(!v)return ar.warn(`The element ${f} of ${n} is not registered.`);this.emit(new eo(lt.BEFORE_ELEMENT_CREATE,n,r),s);const p=this.container.appendChild(new v({id:u,context:this.context,style:d}));this.shapeTypeMap[u]=f,this.elementMap[u]=p;const{stage:g="enter"}=s;(l=this.context.animation)===null||l===void 0||l.add({element:p,elementType:n,stage:g,originalStyle:Object.assign({},p.attributes),updatedStyle:d},{after:()=>{var y;this.emit(new eo(lt.AFTER_ELEMENT_CREATE,n,r),s),(y=p.onCreate)===null||y===void 0||y.call(p)}})}createElements(n,r){const{nodes:s,edges:l,combos:u}=n;[["node",s],["combo",u],["edge",l]].forEach(([f,d])=>{d.forEach(v=>this.createElement(f,v,r))})}getUpdateStageStyle(n,r,s){const{stage:l="update"}=s;if(l==="translate")if(n==="node"||n==="combo"){const{style:{x:u=0,y:h=0,z:f=0}={}}=r;return{x:u,y:h,z:f}}else return{};return this.getElementComputedStyle(n,r)}updateElement(n,r,s){var l;const u=V(r),{stage:h="update"}=s,f=this.getElement(u);if(!f)return()=>null;this.emit(new eo(lt.BEFORE_ELEMENT_UPDATE,n,r),s);const d=this.getElementType(n,r),v=this.getUpdateStageStyle(n,r,s);this.shapeTypeMap[u]!==d&&(f.destroy(),delete this.shapeTypeMap[u],delete this.elementMap[u],this.createElement(n,r,{animation:!1,silence:!0}));const p=h!=="visibility"?h:v.visibility==="hidden"?"hide":"show";p==="hide"&&delete v.visibility,(l=this.context.animation)===null||l===void 0||l.add({element:f,elementType:n,stage:p,originalStyle:Object.assign({},f.attributes),updatedStyle:v},{before:()=>{const g=this.elementMap[u];h!=="collapse"&&bv(g,v),h==="visibility"&&(n5(g,"opacity")||e5(g,"opacity"),this.visibilityCache.set(g,p==="show"?"visible":"hidden"),p==="show"&&fa(g,"visible"))},after:()=>{var g;const y=this.elementMap[u];h==="collapse"&&bv(y,v),p==="hide"&&fa(y,this.visibilityCache.get(y)),this.emit(new eo(lt.AFTER_ELEMENT_UPDATE,n,r),s),(g=y.onUpdate)===null||g===void 0||g.call(y)}})}updateElements(n,r){const{nodes:s,edges:l,combos:u}=n;[["node",s],["combo",u],["edge",l]].forEach(([f,d])=>{d.forEach(v=>this.updateElement(f,v,r))})}markDestroyElement(n){Object.values(n.remove).forEach(r=>{r.forEach(s=>{const l=V(s),u=this.getElement(l);u&&tN(u)})})}destroyElement(n,r,s){var l;const{stage:u="exit"}=s,h=V(r),f=this.elementMap[h];if(!f)return()=>null;this.emit(new eo(lt.BEFORE_ELEMENT_DESTROY,n,r),s),(l=this.context.animation)===null||l===void 0||l.add({element:f,elementType:n,stage:u,originalStyle:Object.assign({},f.attributes),updatedStyle:{}},{after:()=>{var d;this.clearElement(h),f.destroy(),(d=f.onDestroy)===null||d===void 0||d.call(f),this.emit(new eo(lt.AFTER_ELEMENT_DESTROY,n,r),s)}})}destroyElements(n,r){const{nodes:s,edges:l,combos:u}=n;[["combo",u],["edge",l],["node",s]].forEach(([f,d])=>{d.forEach(v=>this.destroyElement(f,v,r))})}clearElement(n){delete this.paletteStyle[n],delete this.defaultStyle[n],delete this.stateStyle[n],delete this.elementMap[n],delete this.shapeTypeMap[n]}alignLayoutResultToElement(n,r){var s,l;const u=(s=n.nodes)===null||s===void 0?void 0:s.find(h=>V(h)===r);if(u){const h=Fe(this.context.model.getNodeLikeDatum(r)),f=Fe(u),d=Te(h,f);(l=n.nodes)===null||l===void 0||l.forEach(v=>{var p,g,y;!((p=v.style)===null||p===void 0)&&p.x&&(v.style.x+=d[0]),!((g=v.style)===null||g===void 0)&&g.y&&(v.style.y+=d[1]),!((y=v.style)===null||y===void 0)&&y.z&&(v.style.z+=d[2]||0)})}}collapseNode(n,r){return oc(this,void 0,void 0,function*(){var s;const{animation:l}=r,{model:u}=this.context,h=this.computeChangesAndDrawData({stage:"collapse",animation:l});if(!h)return;const{drawData:f}=h,{add:d,remove:v,update:p}=f;this.markDestroyElement(f);const g={animation:l,stage:"collapse",data:f};this.destroyElements(v,g),this.createElements(d,g),this.updateElements(p,g),yield(s=this.context.animation.animate(l,{beforeAnimate:y=>this.emit(new Ir(lt.BEFORE_ANIMATE,ir.COLLAPSE,y,f),g),afterAnimate:y=>this.emit(new Ir(lt.AFTER_ANIMATE,ir.COLLAPSE,y,f),g)},{collapse:{target:n,descendants:Array.from(v.nodes).map(([,y])=>V(y)),position:Fe(p.nodes.get(n))}}))===null||s===void 0?void 0:s.finished})}expandNode(n,r){return oc(this,void 0,void 0,function*(){var s;const{model:l,layout:u}=this.context,{animation:h,align:f}=r,d=Fe(l.getNodeData([n])[0]),v=this.computeChangesAndDrawData({stage:"expand",animation:h});if(this.createElements(v.drawData.add,{animation:!1,stage:"expand",target:n}),this.context.animation.clear(),this.computeStyle("expand"),!v)return;const{drawData:p}=v,{update:g,add:y}=p,m={animation:h,stage:"expand",data:p};y.edges.forEach(b=>g.edges.set(V(b),b)),y.nodes.forEach(b=>g.nodes.set(V(b),b)),this.updateElements(g,m),yield(s=this.context.animation.animate(h,{beforeAnimate:b=>this.emit(new Ir(lt.BEFORE_ANIMATE,ir.EXPAND,b,p),m),afterAnimate:b=>this.emit(new Ir(lt.AFTER_ANIMATE,ir.EXPAND,b,p),m)},{expand:{target:n,descendants:Array.from(y.nodes).map(([,b])=>V(b)),position:d}}))===null||s===void 0?void 0:s.finished})}collapseCombo(n,r){return oc(this,void 0,void 0,function*(){var s;const{model:l,element:u}=this.context;if(l.getAncestorsData(n,Oe).some(x=>Vn(x)))return;const h=u.getElement(n),f=h.getComboPosition(Object.assign(Object.assign({},h.attributes),{collapsed:!0})),d=this.computeChangesAndDrawData({stage:"collapse",animation:r});if(!d)return;const{dataChanges:v,drawData:p}=d;this.markDestroyElement(p);const{update:g,remove:y}=p,m={animation:r,stage:"collapse",data:p};this.destroyElements(y,m),this.updateElements(g,m);const b=x=>Array.from(x).map(([,E])=>V(E));yield(s=this.context.animation.animate(r,{before:()=>this.emit(new hn(lt.BEFORE_DRAW,{dataChanges:v,animation:r}),m),beforeAnimate:x=>this.emit(new Ir(lt.BEFORE_ANIMATE,ir.COLLAPSE,x,p),m),afterAnimate:x=>this.emit(new Ir(lt.AFTER_ANIMATE,ir.COLLAPSE,x,p),m),after:()=>this.emit(new hn(lt.AFTER_DRAW,{dataChanges:v,animation:r}),m)},{collapse:{target:n,descendants:[...b(y.nodes),...b(y.combos)],position:f}}))===null||s===void 0?void 0:s.finished})}expandCombo(n,r){return oc(this,void 0,void 0,function*(){var s;const{model:l}=this.context,u=Fe(l.getComboData([n])[0]);this.computeStyle("expand");const h=this.computeChangesAndDrawData({stage:"expand",animation:r});if(!h)return;const{dataChanges:f,drawData:d}=h,{add:v,update:p}=d,g={animation:r,stage:"expand",data:d,target:n};this.createElements(v,g),this.updateElements(p,g);const y=m=>Array.from(m).map(([,b])=>V(b));yield(s=this.context.animation.animate(r,{before:()=>this.emit(new hn(lt.BEFORE_DRAW,{dataChanges:f,animation:r}),g),beforeAnimate:m=>this.emit(new Ir(lt.BEFORE_ANIMATE,ir.EXPAND,m,d),g),afterAnimate:m=>this.emit(new Ir(lt.AFTER_ANIMATE,ir.EXPAND,m,d),g),after:()=>this.emit(new hn(lt.AFTER_DRAW,{dataChanges:f,animation:r}),g)},{expand:{target:n,descendants:[...y(v.nodes),...y(v.combos)],position:u}}))===null||s===void 0?void 0:s.finished})}clear(){this.container.destroy(),this.initContainer(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={}}destroy(){this.clear(),this.container.destroy(),this.context={}}}const NE=Symbol("Comlink.proxy"),h5=Symbol("Comlink.endpoint"),RE=Symbol("Comlink.releaseProxy"),k0=Symbol("Comlink.finalizer"),Zh=Symbol("Comlink.thrown"),LE=a=>typeof a=="object"&&a!==null||typeof a=="function",f5={canHandle:a=>LE(a)&&a[NE],serialize(a){const{port1:n,port2:r}=new MessageChannel;return IE(a,n),[r,[r]]},deserialize(a){return a.start(),FE(a)}},d5={canHandle:a=>LE(a)&&Zh in a,serialize({value:a}){let n;return a instanceof Error?n={isError:!0,value:{message:a.message,name:a.name,stack:a.stack}}:n={isError:!1,value:a},[n,[]]},deserialize(a){throw a.isError?Object.assign(new Error(a.value.message),a.value):a.value}},DE=new Map([["proxy",f5],["throw",d5]]);function v5(a,n){for(const r of a)if(n===r||r==="*"||r instanceof RegExp&&r.test(n))return!0;return!1}function IE(a,n=globalThis,r=["*"]){n.addEventListener("message",function s(l){if(!l||!l.data)return;if(!v5(r,l.origin)){console.warn(`Invalid origin '${l.origin}' for comlink proxy`);return}const{id:u,type:h,path:f}=Object.assign({path:[]},l.data),d=(l.data.argumentList||[]).map(gs);let v;try{const p=f.slice(0,-1).reduce((y,m)=>y[m],a),g=f.reduce((y,m)=>y[m],a);switch(h){case"GET":v=g;break;case"SET":p[f.slice(-1)[0]]=gs(l.data.value),v=!0;break;case"APPLY":v=g.apply(p,d);break;case"CONSTRUCT":{const y=new g(...d);v=x5(y)}break;case"ENDPOINT":{const{port1:y,port2:m}=new MessageChannel;IE(a,m),v=b5(y,[y])}break;case"RELEASE":v=void 0;break;default:return}}catch(p){v={value:p,[Zh]:0}}Promise.resolve(v).catch(p=>({value:p,[Zh]:0})).then(p=>{const[g,y]=Vh(p);n.postMessage(Object.assign(Object.assign({},g),{id:u}),y),h==="RELEASE"&&(n.removeEventListener("message",s),BE(n),k0 in a&&typeof a[k0]=="function"&&a[k0]())}).catch(p=>{const[g,y]=Vh({value:new TypeError("Unserializable return value"),[Zh]:0});n.postMessage(Object.assign(Object.assign({},g),{id:u}),y)})}),n.start&&n.start()}function p5(a){return a.constructor.name==="MessagePort"}function BE(a){p5(a)&&a.close()}function FE(a,n){const r=new Map;return a.addEventListener("message",function(l){const{data:u}=l;if(!u||!u.id)return;const h=r.get(u.id);if(h)try{h(u)}finally{r.delete(u.id)}}),_0(a,r,[],n)}function Gh(a){if(a)throw new Error("Proxy has been released and is not useable")}function zE(a){return io(a,new Map,{type:"RELEASE"}).then(()=>{BE(a)})}const Wh=new WeakMap,jh="FinalizationRegistry"in globalThis&&new FinalizationRegistry(a=>{const n=(Wh.get(a)||0)-1;Wh.set(a,n),n===0&&zE(a)});function g5(a,n){const r=(Wh.get(n)||0)+1;Wh.set(n,r),jh&&jh.register(a,n,a)}function y5(a){jh&&jh.unregister(a)}function _0(a,n,r=[],s=function(){}){let l=!1;const u=new Proxy(s,{get(h,f){if(Gh(l),f===RE)return()=>{y5(u),zE(a),n.clear(),l=!0};if(f==="then"){if(r.length===0)return{then:()=>u};const d=io(a,n,{type:"GET",path:r.map(v=>v.toString())}).then(gs);return d.then.bind(d)}return _0(a,n,[...r,f])},set(h,f,d){Gh(l);const[v,p]=Vh(d);return io(a,n,{type:"SET",path:[...r,f].map(g=>g.toString()),value:v},p).then(gs)},apply(h,f,d){Gh(l);const v=r[r.length-1];if(v===h5)return io(a,n,{type:"ENDPOINT"}).then(gs);if(v==="bind")return _0(a,n,r.slice(0,-1));const[p,g]=ZE(d);return io(a,n,{type:"APPLY",path:r.map(y=>y.toString()),argumentList:p},g).then(gs)},construct(h,f){Gh(l);const[d,v]=ZE(f);return io(a,n,{type:"CONSTRUCT",path:r.map(p=>p.toString()),argumentList:d},v).then(gs)}});return g5(u,a),u}function m5(a){return Array.prototype.concat.apply([],a)}function ZE(a){const n=a.map(Vh);return[n.map(r=>r[0]),m5(n.map(r=>r[1]))]}const GE=new WeakMap;function b5(a,n){return GE.set(a,n),a}function x5(a){return Object.assign(a,{[NE]:!0})}function IG(a,n=globalThis,r="*"){return{postMessage:(s,l)=>a.postMessage(s,r,l),addEventListener:n.addEventListener.bind(n),removeEventListener:n.removeEventListener.bind(n)}}function Vh(a){for(const[n,r]of DE)if(r.canHandle(a)){const[s,l]=r.serialize(a);return[{type:"HANDLER",name:n,value:s},l]}return[{type:"RAW",value:a},GE.get(a)||[]]}function gs(a){switch(a.type){case"HANDLER":return DE.get(a.name).deserialize(a.value);case"RAW":return a.value}}function io(a,n,r,s){return new Promise(l=>{const u=E5();n.set(u,l),a.start&&a.start(),a.postMessage(Object.assign({id:u},r),s)})}function E5(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}class w5 extends Av.Z{constructor(n,r,s){super(),this.graph=n,this.layout=r,this.options=s,this.spawnWorker()}spawnWorker(){this.proxy=FE(new Worker(new URL(Y.p+Y.u(4277),Y.b),{type:void 0})),this.running&&(this.running=!1,this.execute())}execute(){var n;return(0,_.mG)(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;const r=this.layout.options,{onTick:s}=r,l=(0,_._T)(r,["onTick"]),u={};Object.keys(l).forEach(v=>{(0,_t.Z)(l[v])||(u[v]=l[v])});const h={layout:{id:this.layout.id,options:u,iterations:(n=this.options)===null||n===void 0?void 0:n.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},f=new Float32Array([0]),[d]=yield this.proxy.calculateLayout(h,[f]);return d})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[RE]()}isRunning(){return this.running}}var WE=Y(10779),ao=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})},S5=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};class M5{get presetOptions(){return{animation:!!rm(this.context.options,!0)}}get options(){const{options:n}=this.context;return n.layout}constructor(n){this.instances=[],this.context=n}getLayoutInstance(){return this.instances}preLayout(n){return ao(this,void 0,void 0,function*(){var r,s,l,u;const{graph:h,model:f}=this.context,{add:d}=n;pn(h,new hn(lt.BEFORE_LAYOUT,{type:"pre"}));const v=yield(r=this.context.layout)===null||r===void 0?void 0:r.simulate();(s=v==null?void 0:v.nodes)===null||s===void 0||s.forEach(p=>{const g=V(p),y=d.nodes.get(g);f.syncNodeLikeDatum(p),y&&Object.assign(y.style,p.style)}),(l=v==null?void 0:v.edges)===null||l===void 0||l.forEach(p=>{const g=V(p),y=d.edges.get(g);f.syncEdgeDatum(p),y&&Object.assign(y.style,p.style)}),(u=v==null?void 0:v.combos)===null||u===void 0||u.forEach(p=>{const g=V(p),y=d.combos.get(g);f.syncNodeLikeDatum(p),y&&Object.assign(y.style,p.style)}),pn(h,new hn(lt.AFTER_LAYOUT,{type:"pre"})),this.transformDataAfterLayout("pre",n)})}postLayout(){return ao(this,arguments,void 0,function*(n=this.options){if(!n)return;const r=Array.isArray(n)?n:[n],{graph:s}=this.context;pn(s,new hn(lt.BEFORE_LAYOUT,{type:"post"}));for(let l=0;l<r.length;l++){const u=r[l],h=this.getLayoutData(u),f=Object.assign(Object.assign({},this.presetOptions),u);pn(s,new hn(lt.BEFORE_STAGE_LAYOUT,{options:f,index:l}));const d=yield this.stepLayout(h,f,l);pn(s,new hn(lt.AFTER_STAGE_LAYOUT,{options:f,index:l})),u.animation||this.updateElementPosition(d,!1)}pn(s,new hn(lt.AFTER_LAYOUT,{type:"post"})),this.transformDataAfterLayout("post")})}transformDataAfterLayout(n,r){const s=this.context.transform.getTransformInstance();Object.values(s).forEach(l=>l.afterLayout(n,r))}simulate(){return ao(this,void 0,void 0,function*(){if(!this.options)return{};const n=Array.isArray(this.options)?this.options:[this.options];let r={};for(let s=0;s<n.length;s++){const l=n[s],u=this.getLayoutData(l);r=yield this.stepLayout(u,Object.assign(Object.assign(Object.assign({},this.presetOptions),l),{animation:!1}),s)}return r})}stepLayout(n,r,s){return ao(this,void 0,void 0,function*(){return oN(r)?yield this.treeLayout(n,r,s):yield this.graphLayout(n,r,s)})}graphLayout(n,r,s){return ao(this,void 0,void 0,function*(){const{animation:l,enableWorker:u,iterations:h=300}=r,f=this.initGraphLayout(r);if(!f)return{};if(this.instances[s]=f,this.instance=f,u){const v=f;return this.supervisor=new w5(v.graphData2LayoutModel(n),v.instance,{iterations:h}),lh(yield this.supervisor.execute())}if((0,WE.h)(f))return l?yield f.execute(n,{onTick:v=>{this.updateElementPosition(v,!1)}}):(f.execute(n),f.stop(),f.tick(h));const d=yield f.execute(n);if(l){const v=this.updateElementPosition(d,l);yield v==null?void 0:v.finished}return d})}treeLayout(n,r,s){return ao(this,void 0,void 0,function*(){const{type:l,animation:u}=r,h=mi("layout",l);if(!h)return{};const{nodes:f=[],edges:d=[]}=n,v=new xv.k({nodes:f.map(b=>({id:V(b),data:b.data||{}})),edges:d.map(b=>({id:V(b),source:b.source,target:b.target,data:b.data||{}}))});l5(v);const p={nodes:[],edges:[]},g={nodes:[],edges:[]};v.getRoots(gr).forEach(b=>{ns(b,M=>{M.children=v.getSuccessors(M.id)},M=>v.getSuccessors(M.id),"TB");const x=h(b,r),{x:E,y:w,z:S=0}=x;ns(x,M=>{const{id:C,x:T,y:O,z:k=0}=M;p.nodes.push({id:C,style:{x:E,y:w,z:S}}),g.nodes.push({id:C,style:{x:T,y:O,z:k}})},M=>M.children,"TB")});const m=this.inferTreeLayoutOffset(g);if(jE(g,m),u){jE(p,m),this.updateElementPosition(p,!1);const b=this.updateElementPosition(g,u);yield b==null?void 0:b.finished}return g})}inferTreeLayoutOffset(n){var r;let[s,l]=[1/0,-1/0],[u,h]=[1/0,-1/0];(r=n.nodes)===null||r===void 0||r.forEach(x=>{const{x:E=0,y:w=0}=x.style||{};s=Math.min(s,E),l=Math.max(l,E),u=Math.min(u,w),h=Math.max(h,w)});const{canvas:f}=this.context,d=f.getSize(),[v,p]=f.getCanvasByViewport([0,0]),[g,y]=f.getCanvasByViewport(d);if(s>=v&&l<=g&&u>=p&&h<=y)return[0,0];const m=(v+g)/2,b=(p+y)/2;return[m-(s+l)/2,b-(u+h)/2]}stopLayout(){this.instance&&(0,WE.h)(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(n){const{nodeFilter:r=()=>!0,comboFilter:s=()=>!0,preLayout:l=!1,isLayoutInvisibleNodes:u=!1}=n,{nodes:h,edges:f,combos:d}=this.context.model.getData(),{element:v,model:p}=this.context,g=w=>v.getElement(w),y=l?w=>{var S;return!u&&(((S=w.style)===null||S===void 0?void 0:S.visibility)==="hidden"||p.getAncestorsData(w.id,gr).some(Vn)||p.getAncestorsData(w.id,Oe).some(Vn))?!1:r(w)}:w=>{const S=V(w),M=g(S);return!M||ml(M)?!1:r(w)},m=h.filter(y),b=d.filter(s),x=new Map(m.map(w=>[V(w),w]));b.forEach(w=>x.set(V(w),w));const E=f.filter(({source:w,target:S})=>x.has(w)&&x.has(S));return{nodes:m,edges:E,combos:b}}initGraphLayout(n){var r;const{element:s,viewport:l}=this.context,{type:u,enableWorker:h,animation:f,iterations:d}=n,v=S5(n,["type","enableWorker","animation","iterations"]),[p,g]=l.getCanvasSize(),y=[p/2,g/2],m=(r=n==null?void 0:n.nodeSize)!==null&&r!==void 0?r:S=>{const M=s==null?void 0:s.getElement(S.id);return M?M.attributes.size:s==null?void 0:s.getElementComputedStyle("node",S).size},b=mi("layout",u);if(!b)return ar.warn(`The layout of ${u} is not registered.`);const x=Object.getPrototypeOf(b.prototype)===Sl.prototype?b:cN(b,this.context),E=new x(this.context),w={nodeSize:m,width:p,height:g,center:y};switch(E.id){case"d3-force":case"d3-force-3d":Object.assign(w,{center:{x:p/2,y:g/2,z:0}});break;default:break}return(0,jn.Z)(E.options,w,v),E}updateElementPosition(n,r){const{model:s,element:l}=this.context;return l?(s.updateData(n),l.draw({animation:r,silence:!0})):null}destroy(){var n;this.stopLayout(),this.context={},(n=this.supervisor)===null||n===void 0||n.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}const jE=(a,n)=>{var r;const[s,l]=n;(r=a.nodes)===null||r===void 0||r.forEach(u=>{if(u.style){const{x:h=0,y:f=0}=u.style;u.style.x=h+s,u.style.y=f+l}else u.style={x:s,y:l}})};function T5(a){return[C5].reduce((r,s)=>s(r),a)}function C5(a){return!a.layout||Array.isArray(a.layout)||"preLayout"in a.layout||["antv-dagre","combo-combined","compact-box","circular","concentric","dagre","fishbone","grid","indented","mds","radial","random","snake","dendrogram","mindmap"].includes(a.layout.type)&&(a.layout.preLayout=!0),a}class O5 extends Gd{constructor(n){super(n),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}setPlugins(n){this.setExtensions(n)}getPluginInstance(n){const r=this.extensionMap[n];if(r)return r;ar.warn(`Cannot find the plugin ${n}, will try to find it by type.`);const s=this.extensions.find(l=>l.type===n);if(s)return this.extensionMap[s.key]}}const Hh=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class k5 extends Gd{constructor(n){super(n),this.category="transform",this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(n){this.setExtensions([...Hh.slice(0,Hh.length-1),...n,Hh[Hh.length-1]])}getTransformInstance(n){return n?this.extensionMap[n]:this.extensionMap}}var lc=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class _5{get padding(){return yr(this.context.options.padding)}get paddingOffset(){const[n,r,s,l]=this.padding,[u,h,f]=[(l-r)/2,(n-s)/2,0];return[u,h,f]}constructor(n){this.landmarkCounter=0,this.context=n;const[r,s]=this.paddingOffset,{zoom:l,rotation:u,x:h=r,y:f=s}=n.options;this.transform({mode:"absolute",scale:l,translate:[h,f],rotate:u},!1)}get camera(){const{canvas:n}=this.context;return new Proxy(n.getCamera(),{get:(r,s)=>{const u=Object.entries(n.getLayers()).filter(([f])=>!["main"].includes(f)).map(([,f])=>f.getCamera()),h=r[s];if(typeof h=="function")return(...f)=>{const d=h.apply(r,f);return u.forEach(v=>{v[s].apply(v,f)}),d}}})}createLandmark(n){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,n)}getAnimation(n){const r=rm(this.context.options,n);return r?(0,ol.Z)(Object.assign({},r),["easing","duration"]):!1}getCanvasSize(){const{canvas:n}=this.context,{width:r=0,height:s=0}=n.getConfig();return[r,s]}getCanvasCenter(){const{canvas:n}=this.context,{width:r=0,height:s=0}=n.getConfig();return[r/2,s/2,0]}getViewportCenter(){const[n,r]=this.camera.getPosition();return[n,r,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(n){const{camera:r}=this,{mode:s,translate:l=[]}=n,u=this.getZoom(),h=r.getPosition(),f=r.getFocalPoint(),[d,v]=this.getCanvasCenter(),[p=0,g=0,y=0]=l,m=Xr([-p,-g,-y],u);return s==="relative"?{position:Gt(h,m),focalPoint:Gt(f,m)}:{position:Gt([d,v,h[2]],m),focalPoint:Gt([d,v,f[2]],m)}}getRotateOptions(n){const{mode:r,rotate:s=0}=n;return{roll:r==="relative"?this.camera.getRoll()+s:s}}getZoomOptions(n){const{zoomRange:r}=this.context.options,s=this.camera.getZoom(),{mode:l,scale:u=1}=n;return Ze(l==="relative"?s*u:u,...r)}transform(n,r){return lc(this,void 0,void 0,function*(){const{graph:s}=this.context,{translate:l,rotate:u,scale:h,origin:f}=n;this.cancelAnimation();const d=this.getAnimation(r);if(pn(s,new Fh(lt.BEFORE_TRANSFORM,n)),!u&&h&&!l&&f&&!d){this.camera.setZoomByViewportPoint(this.getZoomOptions(n),f),pn(s,new Fh(lt.AFTER_TRANSFORM,n));return}const v={};if(l&&Object.assign(v,this.getTranslateOptions(n)),(0,se.Z)(u)&&Object.assign(v,this.getRotateOptions(n)),(0,se.Z)(h)&&Object.assign(v,{zoom:this.getZoomOptions(n)}),d)return pn(s,new Ir(lt.BEFORE_ANIMATE,ir.TRANSFORM,null,n)),new Promise(p=>{this.transformResolver=p,this.camera.gotoLandmark(this.createLandmark(v),Object.assign(Object.assign({},d),{onfinish:()=>{pn(s,new Ir(lt.AFTER_ANIMATE,ir.TRANSFORM,null,n)),pn(s,new Fh(lt.AFTER_TRANSFORM,n)),this.transformResolver=void 0,p()}}))});this.camera.gotoLandmark(this.createLandmark(v),{duration:0}),pn(s,new Fh(lt.AFTER_TRANSFORM,n))})}fitView(n,r){return lc(this,void 0,void 0,function*(){const[s,l,u,h]=this.padding,{when:f="always",direction:d="both"}=n||{},[v,p]=this.context.canvas.getSize(),g=v-h-l,y=p-s-u,m=this.context.canvas.getBounds(),b=this.getBBoxInViewport(m),[x,E]=la(b),w=d==="x"&&x>=g||d==="y"&&E>=y||d==="both"&&x>=g&&E>=y;if(f==="overflow"&&!w)return yield this.fitCenter({animation:r});const S=g/x,M=y/E,C=d==="x"?S:d==="y"?M:Math.min(S,M),T=this.getAnimation(r);Number.isFinite(C)&&(yield this.transform({mode:"relative",scale:C,translate:Gt(Te(this.getCanvasCenter(),this.getBBoxInViewport(m).center),Xr(this.paddingOffset,C))},T))})}fitCenter(n){return lc(this,void 0,void 0,function*(){const r=this.context.canvas.getBounds();yield this.focus(r,n)})}focusElements(n){return lc(this,arguments,void 0,function*(r,s={}){const{element:l}=this.context;if(!l)return;const u=f=>s.shapes?f.getShape(s.shapes).getRenderBounds():f.getRenderBounds(),h=Uo(r.map(f=>u(l.getElement(f))));yield this.focus(h,s)})}focus(n,r){return lc(this,void 0,void 0,function*(){const s=this.context.graph.getViewportByCanvas(n.center),l=r.position||this.getCanvasCenter(),u=Te(l,s);yield this.transform({mode:"relative",translate:Gt(u,this.paddingOffset)},r.animation)})}getBBoxInViewport(n){const{min:r,max:s}=n,{graph:l}=this.context,[u,h]=l.getViewportByCanvas(r),[f,d]=l.getViewportByCanvas(s),v=new ke;return v.setMinMax([u,h,0],[f,d,0]),v}isInViewport(n,r=!1,s=0){const{graph:l}=this.context,u=this.getCanvasSize(),[h,f]=l.getCanvasByViewport([0,0]),[d,v]=l.getCanvasByViewport(u);let p=new ke;return p.setMinMax([h,f,0],[d,v,0]),s&&(p=ua(p,s)),zs(n)?$r(n,p):r?Hk(n,p):p.intersects(n)}cancelAnimation(){var n,r;!((n=this.camera.landmarks)===null||n===void 0)&&n.length&&this.camera.cancelLandmarkAnimation(),(r=this.transformResolver)===null||r===void 0||r.call(this)}}var _e=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};class cc extends Av.Z{constructor(n){var r;super(),this.options={},this.rendered=!1,this.destroyed=!1,this.context={model:new c5},this.isCollapsingExpanding=!1,this.onResize=El(()=>{this.resize()},300),this._setOptions(Object.assign({},cc.defaultOptions,n),!0),this.context.graph=this,this.options.autoResize&&((r=globalThis.addEventListener)===null||r===void 0||r.call(globalThis,"resize",this.onResize))}getOptions(){return this.options}setOptions(n){this._setOptions(n,!1)}_setOptions(n,r){if(this.updateCanvas(n),Object.assign(this.options,T5(n)),r){const{data:y}=n;y&&this.addData(y);return}const{behaviors:s,combo:l,data:u,edge:h,layout:f,node:d,plugins:v,theme:p,transforms:g}=n;s&&this.setBehaviors(s),u&&this.setData(u),d&&this.setNode(d),h&&this.setEdge(h),l&&this.setCombo(l),f&&this.setLayout(f),p&&this.setTheme(p),v&&this.setPlugins(v),g&&this.setTransforms(g)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(n,r){n&&(this.options.width=n),r&&(this.options.height=r),this.resize(n,r)}setZoomRange(n){this.options.zoomRange=n}getZoomRange(){return this.options.zoomRange}setNode(n){this.options.node=n,this.context.model.refreshData()}setEdge(n){this.options.edge=n,this.context.model.refreshData()}setCombo(n){this.options.combo=n,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(n){this.options.theme=(0,_t.Z)(n)?n(this.getTheme()):n}setLayout(n){this.options.layout=(0,_t.Z)(n)?n(this.getLayout()):n}getLayout(){return this.options.layout}setBehaviors(n){var r;this.options.behaviors=(0,_t.Z)(n)?n(this.getBehaviors()):n,(r=this.context.behavior)===null||r===void 0||r.setBehaviors(this.options.behaviors)}updateBehavior(n){this.setBehaviors(r=>r.map(s=>typeof s=="object"&&s.key===n.key?Object.assign(Object.assign({},s),n):s))}getBehaviors(){return this.options.behaviors||[]}setPlugins(n){var r;this.options.plugins=(0,_t.Z)(n)?n(this.getPlugins()):n,(r=this.context.plugin)===null||r===void 0||r.setPlugins(this.options.plugins)}updatePlugin(n){this.setPlugins(r=>r.map(s=>typeof s=="object"&&s.key===n.key?Object.assign(Object.assign({},s),n):s))}getPlugins(){return this.options.plugins||[]}getPluginInstance(n){return this.context.plugin.getPluginInstance(n)}setTransforms(n){var r;this.options.transforms=(0,_t.Z)(n)?n(this.getTransforms()):n,(r=this.context.transform)===null||r===void 0||r.setTransforms(this.options.transforms)}updateTransform(n){this.setTransforms(r=>r.map(s=>typeof s=="object"&&s.key===n.key?Object.assign(Object.assign({},s),n):s)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}hasNode(n){return this.context.model.hasNode(n)}hasEdge(n){return this.context.model.hasEdge(n)}hasCombo(n){return this.context.model.hasCombo(n)}getElementData(n){return Array.isArray(n)?n.map(r=>this.context.model.getElementDataById(r)):this.context.model.getElementDataById(n)}getNodeData(n){return n===void 0?this.context.model.getNodeData():Array.isArray(n)?this.context.model.getNodeData(n):this.context.model.getNodeLikeDatum(n)}getEdgeData(n){return n===void 0?this.context.model.getEdgeData():Array.isArray(n)?this.context.model.getEdgeData(n):this.context.model.getEdgeDatum(n)}getComboData(n){return n===void 0?this.context.model.getComboData():Array.isArray(n)?this.context.model.getComboData(n):this.context.model.getNodeLikeDatum(n)}setData(n){this.context.model.setData((0,_t.Z)(n)?n(this.getData()):n)}addData(n){this.context.model.addData((0,_t.Z)(n)?n(this.getData()):n)}addNodeData(n){this.context.model.addNodeData((0,_t.Z)(n)?n(this.getNodeData()):n)}addEdgeData(n){this.context.model.addEdgeData((0,_t.Z)(n)?n(this.getEdgeData()):n)}addComboData(n){this.context.model.addComboData((0,_t.Z)(n)?n(this.getComboData()):n)}addChildrenData(n,r){this.context.model.addChildrenData(n,r)}updateData(n){this.context.model.updateData((0,_t.Z)(n)?n(this.getData()):n)}updateNodeData(n){this.context.model.updateNodeData((0,_t.Z)(n)?n(this.getNodeData()):n)}updateEdgeData(n){this.context.model.updateEdgeData((0,_t.Z)(n)?n(this.getEdgeData()):n)}updateComboData(n){this.context.model.updateComboData((0,_t.Z)(n)?n(this.getComboData()):n)}removeData(n){this.context.model.removeData((0,_t.Z)(n)?n(this.getData()):n)}removeNodeData(n){this.context.model.removeNodeData((0,_t.Z)(n)?n(this.getNodeData()):n)}removeEdgeData(n){this.context.model.removeEdgeData((0,_t.Z)(n)?n(this.getEdgeData()):n)}removeComboData(n){this.context.model.removeComboData((0,_t.Z)(n)?n(this.getComboData()):n)}getElementType(n){return this.context.model.getElementType(n)}getRelatedEdgesData(n,r="both"){return this.context.model.getRelatedEdgesData(n,r)}getNeighborNodesData(n){return this.context.model.getNeighborNodesData(n)}getAncestorsData(n,r){return this.context.model.getAncestorsData(n,r)}getParentData(n,r){return this.context.model.getParentData(n,r)}getChildrenData(n){return this.context.model.getChildrenData(n)}getDescendantsData(n){return this.context.model.getDescendantsData(n)}getElementDataByState(n,r){return this.context.model.getElementDataByState(n,r)}initCanvas(){return _e(this,void 0,void 0,function*(){var n;if(this.context.canvas)return yield this.context.canvas.ready;const{container:r="container",width:s,height:l,renderer:u,cursor:h,background:f,canvas:d,devicePixelRatio:v=(n=globalThis.devicePixelRatio)!==null&&n!==void 0?n:1}=this.options;if(r instanceof T0)this.context.canvas=r,h&&r.setCursor(h),u&&r.setRenderer(u),yield r.ready;else{const p=(0,ve.Z)(r)?document.getElementById(r):r,g=_E(p);this.emit(lt.BEFORE_CANVAS_INIT,{container:p,width:s,height:l});const y=Object.assign(Object.assign({},d),{container:p,width:s||g[0],height:l||g[1],background:f,renderer:u,cursor:h,devicePixelRatio:v}),m=new T0(y);this.context.canvas=m,yield m.ready,this.emit(lt.AFTER_CANVAS_INIT,{canvas:m})}})}updateCanvas(n){var r,s;const{renderer:l,cursor:u,height:h,width:f}=n,d=this.context.canvas;d&&(l&&(this.emit(lt.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),d.setRenderer(l),this.emit(lt.AFTER_RENDERER_CHANGE,{renderer:l})),u&&d.setCursor(u),((0,se.Z)(f)||(0,se.Z)(h))&&this.setSize((r=f!=null?f:this.options.width)!==null&&r!==void 0?r:0,(s=h!=null?h:this.options.height)!==null&&s!==void 0?s:0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new i5(this.context)),this.context.plugin||(this.context.plugin=new O5(this.context)),this.context.viewport||(this.context.viewport=new _5(this.context)),this.context.transform||(this.context.transform=new k5(this.context)),this.context.element||(this.context.element=new u5(this.context)),this.context.animation||(this.context.animation=new r5(this.context)),this.context.layout||(this.context.layout=new M5(this.context)),this.context.behavior||(this.context.behavior=new a5(this.context))}prepare(){return _e(this,void 0,void 0,function*(){if(yield Promise.resolve(),this.destroyed){console.error(Ii("The graph instance has been destroyed"));return}yield this.initCanvas(),this.initRuntime()})}render(){return _e(this,void 0,void 0,function*(){if(yield this.prepare(),pn(this,new hn(lt.BEFORE_RENDER)),this.options.layout)if(!this.rendered&&lN(this.options.layout)){const n=yield this.context.element.preLayoutDraw({type:"render"});yield Promise.all([n==null?void 0:n.finished,this.autoFit()])}else{const n=this.context.element.draw({type:"render"});yield Promise.all([n==null?void 0:n.finished,this.context.layout.postLayout()]),yield this.autoFit()}else{const n=this.context.element.draw({type:"render"});yield Promise.all([n==null?void 0:n.finished,this.autoFit()])}this.rendered=!0,pn(this,new hn(lt.AFTER_RENDER))})}draw(){return _e(this,void 0,void 0,function*(){var n;yield this.prepare(),yield(n=this.context.element.draw())===null||n===void 0?void 0:n.finished})}layout(n){return _e(this,void 0,void 0,function*(){yield this.context.layout.postLayout(n)})}stopLayout(){this.context.layout.stopLayout()}clear(){return _e(this,void 0,void 0,function*(){const{model:n,element:r}=this.context;n.setData({}),n.clearChanges(),r==null||r.clear()})}destroy(){var n;pn(this,new hn(lt.BEFORE_DESTROY));const{layout:r,animation:s,element:l,model:u,canvas:h,behavior:f,plugin:d}=this.context;d==null||d.destroy(),f==null||f.destroy(),r==null||r.destroy(),s==null||s.destroy(),l==null||l.destroy(),u.destroy(),h==null||h.destroy(),this.options={},this.context={},this.off(),(n=globalThis.removeEventListener)===null||n===void 0||n.call(globalThis,"resize",this.onResize),this.destroyed=!0,pn(this,new hn(lt.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(n,r){var s;const l=_E((s=this.context.canvas)===null||s===void 0?void 0:s.getContainer()),u=[n||l[0],r||l[1]];if(!this.context.canvas)return;const h=this.context.canvas.getSize();Je(u,h)||(pn(this,new hn(lt.BEFORE_SIZE_CHANGE,{size:u})),this.context.canvas.resize(...u),pn(this,new hn(lt.AFTER_SIZE_CHANGE,{size:u})))}fitView(n,r){return _e(this,void 0,void 0,function*(){var s;yield(s=this.context.viewport)===null||s===void 0?void 0:s.fitView(n,r)})}fitCenter(n){return _e(this,void 0,void 0,function*(){var r;yield(r=this.context.viewport)===null||r===void 0?void 0:r.fitCenter({animation:n})})}autoFit(){return _e(this,void 0,void 0,function*(){const{autoFit:n}=this.context.options;if(n)if((0,ve.Z)(n))n==="view"?yield this.fitView():n==="center"&&(yield this.fitCenter());else{const{type:r,animation:s}=n;r==="view"?yield this.fitView(n.options,s):r==="center"&&(yield this.fitCenter(s))}})}focusElement(n,r){return _e(this,void 0,void 0,function*(){var s;yield(s=this.context.viewport)===null||s===void 0?void 0:s.focusElements(Array.isArray(n)?n:[n],{animation:r})})}zoomBy(n,r,s){return _e(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",scale:n,origin:s},r)})}zoomTo(n,r,s){return _e(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",scale:n,origin:s},r)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(n,r,s){return _e(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",rotate:n,origin:s},r)})}rotateTo(n,r,s){return _e(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",rotate:n,origin:s},r)})}getRotation(){return this.context.viewport.getRotation()}translateBy(n,r){return _e(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",translate:n},r)})}translateTo(n,r){return _e(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",translate:n},r)})}getPosition(){return Te([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(n,r){return _e(this,arguments,void 0,function*(s,l,u=!0){var h,f;const[d,v]=(0,Zn.Z)(s)?[s,(h=l)!==null&&h!==void 0?h:!0]:[{[s]:l},u];Object.entries(d).forEach(([p,g])=>this.context.model.translateNodeLikeBy(p,g)),yield(f=this.context.element.draw({animation:v,stage:"translate"}))===null||f===void 0?void 0:f.finished})}translateElementTo(n,r){return _e(this,arguments,void 0,function*(s,l,u=!0){var h,f;const[d,v]=(0,Zn.Z)(s)?[s,(h=l)!==null&&h!==void 0?h:!0]:[{[s]:l},u];Object.entries(d).forEach(([p,g])=>this.context.model.translateNodeLikeTo(p,g)),yield(f=this.context.element.draw({animation:v,stage:"translate"}))===null||f===void 0?void 0:f.finished})}getElementPosition(n){return this.context.model.getElementPosition(n)}getElementRenderStyle(n){return Tv(this.context.element.getElement(n).attributes,["context"])}setElementVisibility(n,r){return _e(this,arguments,void 0,function*(s,l,u=!0){var h,f;const[d,v]=(0,Zn.Z)(s)?[s,(h=l)!==null&&h!==void 0?h:!0]:[{[s]:l},u],p={nodes:[],edges:[],combos:[]};Object.entries(d).forEach(([m,b])=>{const x=this.getElementType(m);p[`${x}s`].push({id:m,style:{visibility:b}})});const{model:g,element:y}=this.context;g.preventUpdateNodeLikeHierarchy(()=>{g.updateData(p)}),yield(f=y.draw({animation:v,stage:"visibility"}))===null||f===void 0?void 0:f.finished})}showElement(n,r){return _e(this,void 0,void 0,function*(){const s=Array.isArray(n)?n:[n];yield this.setElementVisibility(Object.fromEntries(s.map(l=>[l,"visible"])),r)})}hideElement(n,r){return _e(this,void 0,void 0,function*(){const s=Array.isArray(n)?n:[n];yield this.setElementVisibility(Object.fromEntries(s.map(l=>[l,"hidden"])),r)})}getElementVisibility(n){var r,s;const l=this.context.element.getElement(n);return(s=(r=l==null?void 0:l.style)===null||r===void 0?void 0:r.visibility)!==null&&s!==void 0?s:"visible"}setElementZIndex(n,r){return _e(this,void 0,void 0,function*(){var s;const l={nodes:[],edges:[],combos:[]},u=(0,Zn.Z)(n)?n:{[n]:r};Object.entries(u).forEach(([d,v])=>{const p=this.getElementType(d);l[`${p}s`].push({id:d,style:{zIndex:v}})});const{model:h,element:f}=this.context;h.preventUpdateNodeLikeHierarchy(()=>h.updateData(l)),yield(s=f.draw({animation:!1,stage:"zIndex"}))===null||s===void 0?void 0:s.finished})}frontElement(n){return _e(this,void 0,void 0,function*(){const r=Array.isArray(n)?n:[n],{model:s}=this.context,l={};r.map(u=>{const h=s.getFrontZIndex(u);if(s.getElementType(u)==="combo"){const d=s.getAncestorsData(u,Oe).at(-1)||this.getComboData(u),v=[d,...s.getDescendantsData(V(d))],p=h-PE(d);v.forEach(y=>{l[V(y)]=this.getElementZIndex(V(y))+p});const{internal:g}=vv(v.map(V),y=>s.getRelatedEdgesData(y));g.forEach(y=>{const m=V(y);l[m]=this.getElementZIndex(m)+p})}else l[u]=h}),yield this.setElementZIndex(l)})}getElementZIndex(n){return PE(this.context.model.getElementDataById(n))}setElementState(n,r){return _e(this,arguments,void 0,function*(s,l,u=!0){var h,f;const[d,v]=(0,Zn.Z)(s)?[s,(h=l)!==null&&h!==void 0?h:!0]:[{[s]:l},u],p=y=>y?Array.isArray(y)?y:[y]:[],g={nodes:[],edges:[],combos:[]};Object.entries(d).forEach(([y,m])=>{const b=this.getElementType(y);g[`${b}s`].push({id:y,states:p(m)})}),this.updateData(g),yield(f=this.context.element.draw({animation:v,stage:"state"}))===null||f===void 0?void 0:f.finished})}getElementState(n){return this.context.model.getElementState(n)}getElementRenderBounds(n){return this.context.element.getElement(n).getRenderBounds()}collapseElement(n){return _e(this,arguments,void 0,function*(r,s=!0){const{model:l,element:u}=this.context;if(Vn(l.getNodeLikeData([r])[0])||this.isCollapsingExpanding)return;typeof s=="boolean"&&(s={animation:s,align:!0});const h=l.getElementType(r);yield this.frontElement(r),this.isCollapsingExpanding=!0,l.updateData(h==="node"?{nodes:[{id:r,style:{collapsed:!0}}]}:{combos:[{id:r,style:{collapsed:!0}}]}),h==="node"?yield u.collapseNode(r,s):h==="combo"&&(yield u.collapseCombo(r,!!s.animation)),this.isCollapsingExpanding=!1})}expandElement(n){return _e(this,arguments,void 0,function*(r,s=!0){const{model:l,element:u}=this.context;if(!Vn(l.getNodeLikeData([r])[0])||this.isCollapsingExpanding)return;typeof s=="boolean"&&(s={animation:s,align:!0});const h=l.getElementType(r);this.isCollapsingExpanding=!0,l.updateData(h==="node"?{nodes:[{id:r,style:{collapsed:!1}}]}:{combos:[{id:r,style:{collapsed:!1}}]}),h==="node"?yield u.expandNode(r,s):h==="combo"&&(yield u.expandCombo(r,!!s.animation)),this.isCollapsingExpanding=!1})}setElementCollapsibility(n,r){const s=this.getElementType(n);s==="node"?this.updateNodeData([{id:n,style:{collapsed:r}}]):s==="combo"&&this.updateComboData([{id:n,style:{collapsed:r}}])}toDataURL(){return _e(this,arguments,void 0,function*(n={}){return this.context.canvas.toDataURL(n)})}getCanvasByViewport(n){return this.context.canvas.getCanvasByViewport(n)}getViewportByCanvas(n){return this.context.canvas.getViewportByCanvas(n)}getClientByCanvas(n){return this.context.canvas.getClientByCanvas(n)}getCanvasByClient(n){return this.context.canvas.getCanvasByClient(n)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(n,r,s){return super.on(n,r,s)}once(n,r){return super.once(n,r)}off(n,r){return super.off(n,r)}}cc.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};var P5=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r};function VE(a,n){const{getNodeData:r=(f,d)=>{if(f.depth=d,!f.children)return f;const{children:v}=f,p=P5(f,["children"]);return Object.assign(Object.assign({},p),{children:v.map(g=>g.id)})},getEdgeData:s=(f,d)=>({source:f.id,target:d.id}),getChildren:l=f=>f.children||[]}=n||{},u=[],h=[];return ns(a,(f,d)=>{u.push(r(f,d));const v=l(f);for(const p of v)h.push(s(f,p))},f=>l(f),"TB"),{nodes:u,edges:h}}class A5 extends cr{beforeDraw(n){const{add:r,update:s}=n,{model:l}=this.context;return[...r.edges.entries(),...s.edges.entries()].forEach(([,u])=>{HE(l,u)}),n}}const HE=(a,n)=>{const{source:r,target:s}=n,l=a.getElementDataById(r),u=a.getElementDataById(s),h=Y1(l,g=>a.getParentData(g,Oe)),f=Y1(u,g=>a.getParentData(g,Oe)),d=V(h),v=V(f),p={sourceNode:d,targetNode:v};return n.style?Object.assign(n.style,p):n.style=p,n},N5=(a,n,r)=>{const[s,l]=n,[u,h]=r;if(l===s)return u;const f=(a-s)/(l-s);return u+f*(h-u)},R5=(a,n,r)=>{const[s,l]=n,[u,h]=r,f=Math.log(a-s+1)/Math.log(l-s+1);return u+f*(h-u)},L5=(a,n,r,s=2)=>{const[l,u]=n,[h,f]=r,d=Math.pow((a-l)/(u-l),s);return h+d*(f-h)},D5=(a,n,r)=>{const[s,l]=n,[u,h]=r,f=Math.sqrt((a-s)/(l-s));return u+f*(h-u)};class uc extends cr{constructor(n,r){super(n,(0,jn.Z)({},uc.defaultOptions,r)),this.assignSizeByCentrality=(s,l,u,h,f,d)=>{const v=[l,u],p=[h[0],f[0]],g=[h[1],f[1]],y=[h[2],f[2]],m=(b,x)=>{if(typeof d=="function")return d(b,v,x);switch(d){case"linear":return N5(b,v,x);case"log":return R5(b,v,x);case"pow":return L5(b,v,x,2);case"sqrt":return D5(b,v,x);default:return x[0]}};return[m(s,p),m(s,g),m(s,y)]}}beforeDraw(n){const{model:r}=this.context,s=r.getNodeData(),l=Hn(this.options.maxSize),u=Hn(this.options.minSize),h=this.getCentralities(this.options.centrality),f=h.size>0?Math.max(...h.values()):0,d=h.size>0?Math.min(...h.values()):0;return s.forEach(v=>{var p;const g=this.assignSizeByCentrality(h.get(V(v))||0,d,f,u,l,this.options.scale),y=(p=this.context.element)===null||p===void 0?void 0:p.getElement(V(v)),m={size:g};this.assignLabelStyle(m,g,v,y),(!y||!Ih(m,y.attributes))&&xr(n,y?"update":"add","node",(0,jn.Z)(v,{style:m}),!0)}),n}assignLabelStyle(n,r,s,l){var u;const h=l?l.config.style:(u=this.context.element)===null||u===void 0?void 0:u.getElementComputedStyle("node",s);if(Object.assign(n,(0,ol.Z)(h,["labelFontSize","labelLineHeight"])),this.options.mapLabelSize){const f=this.getLabelSizeByNodeSize(r,1/0,Number(n.labelFontSize));Object.assign(n,{labelFontSize:f,labelLineHeight:f+Vk(n.labelPadding)})}return n}getLabelSizeByNodeSize(n,r,s){const l=Math.min(...n)/2,[u,h]=Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[s,r];return Math.min(h,Math.max(l,u))}getCentralities(n){const{model:r}=this.context,s=r.getData();if(typeof n=="function")return n(s);const l=r.getRelatedEdgesData.bind(r);return Ym(s,l,n)}}uc.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"linear",mapLabelSize:!1};class hc extends cr{constructor(n,r){super(n,Object.assign({},hc.defaultOptions,r))}get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var n;const r=Fe(this.ref),{graph:s,model:l}=this.context;(n=l.getData().nodes)===null||n===void 0||n.forEach(h=>{var f;if(V(h)===V(this.ref))return;const d=Km(Te(Fe(h),r)),v=Math.abs(d)>Math.PI/2,p=!h.children||h.children.length===0,g=V(h),y=(f=this.context.element)===null||f===void 0?void 0:f.getElement(g);if(!y||!y.isVisible())return;const m=Hn(s.getElementRenderStyle(g).size)[0]/2,b=(p?1:-1)*(m+this.options.offset),x=[["translate",b*Math.cos(d),b*Math.sin(d)],["rotate",v?tr(d)+180:tr(d)]];l.updateNodeData([{id:V(h),style:{labelTextAlign:v===p?"right":"left",labelTextBaseline:"middle",labelTransform:x}}])}),s.draw()}}hc.defaultOptions={offset:5};const I5="quadratic",$E=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class fc extends cr{constructor(n,r){super(n,Object.assign({},fc.defaultOptions,r)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=s=>{const{add:{edges:l},update:{nodes:u,edges:h,combos:f},remove:{edges:d}}=s,{model:v}=this.context,p=new Map,g=(b,x)=>{v.getRelatedEdgesData(x).forEach(w=>!p.has(V(w))&&p.set(V(w),w))};u.forEach(g),f.forEach(g);const y=b=>{const x=new Set(s.remove.edges.keys()),E=v.getEdgeData().filter(w=>!x.has(V(w))).map(w=>HE(v,w));B5(b,E,!0).forEach(w=>{const S=V(w);p.has(S)||p.set(S,w)})};if(d.size&&d.forEach(y),l.size&&l.forEach(y),h.size){const b=jb(Nv(v.getChanges())).update.edges;h.forEach(x=>{var E;y(x);const w=(E=b.find(S=>V(S.value)===V(x)))===null||E===void 0?void 0:E.original;w&&!P0(x,w)&&y(w)})}Si(this.options.edges)||p.forEach((b,x)=>!this.options.edges.includes(x)&&p.delete(x));const m=v.getEdgeData().map(V);return new Map([...p].sort((b,x)=>m.indexOf(b[0])-m.indexOf(x[0])))},this.applyBundlingStyle=(s,l,u)=>{const{edgeMap:h,reverses:f}=UE(l);h.forEach(d=>{d.forEach((v,p,g)=>{var y;const m=g.length,b=v.style||{};if(v.source===v.target){const w=$E.length;b.loopPlacement=$E[p%w],b.loopDist=Math.floor(p/w)*u+50}else if(m===1)b.curveOffset=0;else{const w=(p%2===0?1:-1)*(f[`${v.source}|${v.target}|${p}`]?-1:1);b.curveOffset=m%2===1?w*Math.ceil(p/2)*u*2:w*(Math.floor(p/2)*u*2+u)}const x=Object.assign(v,{type:I5,style:b}),E=(y=this.context.element)===null||y===void 0?void 0:y.getElement(V(v));(!E||!Ih(x.style,E.attributes))&&xr(s,E?"update":"add","edge",x,!0)})})},this.resetEdgeStyle=s=>{const l=s.style||{},u=this.cacheMergeStyle.get(V(s))||{};return Object.keys(u).forEach(h=>{Je(l[h],u[h])&&(s[h]?l[h]=s[h]:delete l[h])}),Object.assign(s,{style:l})},this.applyMergingStyle=(s,l)=>{const{edgeMap:u,reverses:h}=UE(l);u.forEach(f=>{var d;if(f.length===1){const p=f[0],g=(d=this.context.element)===null||d===void 0?void 0:d.getElement(V(p)),y=this.resetEdgeStyle(p);(!g||!Ih(y,g.attributes))&&xr(s,g?"update":"add","edge",y);return}const v=f.map(({source:p,target:g,style:y={}},m)=>{const{startArrow:b,endArrow:x}=y,E={},[w,S]=h[`${p}|${g}|${m}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return Co(b)&&(E[w]=b),Co(x)&&(E[S]=x),E}).reduce((p,g)=>Object.assign(Object.assign({},p),g),{});f.forEach((p,g,y)=>{var m;if(g!==0){xr(s,"remove","edge",p);return}const b=Object.assign({},(0,_t.Z)(this.options.style)?this.options.style(y):this.options.style,{childrenData:y});this.cacheMergeStyle.set(V(p),b);const x=Object.assign(Object.assign({},p),{type:"line",style:Object.assign(Object.assign(Object.assign({},p.style),v),b)}),E=(m=this.context.element)===null||m===void 0?void 0:m.getElement(V(p));(!E||!Ih(x.style,E.attributes))&&xr(s,E?"update":"add","edge",x,!0)})})}}beforeDraw(n){const r=this.getAffectedParallelEdges(n);return r.size===0||(this.options.mode==="bundle"?this.applyBundlingStyle(n,r,this.options.distance):this.applyMergingStyle(n,r)),n}}fc.defaultOptions={mode:"bundle",distance:15};const UE=a=>{const n=new Map,r=new Set,s={},l=new Map;for(const[u,h]of a){if(r.has(u))continue;const{source:f,target:d}=h,v=`${f}-${d}`;n.has(v)||(n.set(v,[]),l.set(v,new Set));const p=n.get(v),g=l.get(v);p&&g&&!g.has(u)&&(p.push(h),g.add(u),r.add(u));for(const[y,m]of a)if(!(r.has(y)||y===u)&&P0(h,m)){const b=n.get(v),x=l.get(v);b&&x&&!x.has(y)&&(b.push(m),x.add(y),f===m.target&&d===m.source&&(s[`${m.source}|${m.target}|${b.length-1}`]=!0),r.add(y))}}return{edgeMap:n,reverses:s}},B5=(a,n,r)=>n.filter(s=>(r||V(s)!==V(a))&&P0(s,a)),P0=(a,n)=>{const{sourceNode:r,targetNode:s}=a.style||{},{sourceNode:l,targetNode:u}=n.style||{};return r===l&&s===u||r===u&&s===l};class F5 extends cr{beforeDraw(n,r){const{stage:s}=r;if(s==="visibility")return n;const{model:l}=this.context,{update:{nodes:u,edges:h,combos:f}}=n,d=(v,p)=>{l.getRelatedEdgesData(p).forEach(y=>!h.has(V(y))&&h.set(V(y),y))};return u.forEach(d),f.forEach(d),n}}const z5={animation:{"combo-collapse":om,"combo-expand":zk,"node-collapse":am,"node-expand":Bk,"path-in":sm,"path-out":Fk,fade:Dk,translate:Ik},behavior:{"brush-select":Zs,"click-select":tl,"collapse-expand":bl,"create-edge":xl,"drag-canvas":wl,"drag-element-force":cb,"drag-element":Hs,"fix-element-size":Ml,"focus-element":Tl,"hover-activate":os,"lasso-select":hb,"auto-adapt-label":Ko,"optimize-viewport-transform":Cl,"scroll-canvas":Ol,"zoom-canvas":kl},combo:{circle:F1,rect:z1},edge:{cubic:ya,line:vl,polyline:Vs,quadratic:pl,"cubic-horizontal":hl,"cubic-radial":fl,"cubic-vertical":dl},layout:{"antv-dagre":vb.b,"combo-combined":gb.u,"compact-box":ba.compactBox,"d3-force":mb.j,"force-atlas2":xb.E,circular:pb.S,concentric:yb.W,dagre:bb.V,dendrogram:ba.dendrogram,fishbone:_l,force:Eb.y,fruchterman:wb.O,grid:Sb.M,indented:ba.indented,mds:Mb.A,mindmap:ba.mindmap,radial:Tb.D,random:Cb._,snake:Pl},node:{circle:pa,diamond:E1,ellipse:al,hexagon:w1,html:js,image:ll,rect:D1,star:I1,donut:il,triangle:cl},palette:{spectral:gN,tableau:yN,oranges:mN,greens:bN,blues:xN},theme:{dark:H6,light:$6},plugin:{"bubble-sets":Ll,"edge-bundling":Il,"edge-filter-lens":Bl,"grid-line":Zl,background:Al,contextmenu:Dl,fisheye:Fl,fullscreen:zl,history:Gl,hull:jl,legend:Hl,minimap:$l,snapline:Ul,timebar:nc,title:fE,toolbar:rc,tooltip:ic,watermark:ac},transform:{"arrange-draw-order":U6,"collapse-expand-combo":Y6,"collapse-expand-node":X6,"get-edge-actual-ends":A5,"map-node-size":uc,"place-radial-labels":hc,"process-parallel-edges":fc,"update-related-edges":F5},shape:{circle:gi,ellipse:Zo,group:vn,html:$a,image:Qd,line:Ua,path:dr,polygon:Ya,polyline:au,rect:Sn,text:Xa,label:Kr,badge:rs}};function Z5(){Object.entries(z5).forEach(([a,n])=>{Object.entries(n).forEach(([r,s])=>{M0(a,r,s)})})}Z5();const G5={css:"//at.alicdn.com/t/a/font_470089_8hnbbf8n4u8.css",js:"//at.alicdn.com/t/a/font_470089_8hnbbf8n4u8.js"};var W5=Y(73935),YE=Y.t(W5,2),XE=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})};const{version:j5}=YE;function V5(){return Number((j5||"").split(".")[0])}const qE=(()=>{let a;return()=>(a||(V5()>=18?a=Y.e(1059).then(Y.bind(Y,91059)):a=Y.e(1796).then(Y.bind(Y,71796))),a)})();function KE(a,n){return XE(this,void 0,void 0,function*(){const{render:r}=yield qE();return r(a,n)})}function H5(a){return XE(this,void 0,void 0,function*(){const{unmount:n}=yield qE();return n(a)})}class $5 extends js{getKeyStyle(n){return Object.assign({},super.getKeyStyle(n))}constructor(n){super(n)}update(n){super.update(n)}connectedCallback(){super.connectedCallback();const{component:n}=this.attributes;KE(n,this.getDomElement())}attributeChangedCallback(n,r,s){super.attributeChangedCallback(n,r,s),n==="component"&&r!==s&&KE(this.attributes.component,this.getDomElement())}destroy(){H5(this.getDomElement()),super.destroy()}}class U5 extends os{getActiveIds(n){const{model:r,graph:s}=this.context,l=n.target.id,u=s.getElementType(l),h=[l];if(u==="edge"){const f=r.getEdgeDatum(l);this.collectChainNodes(f.source,"in",h),this.collectChainNodes(f.target,"out",h)}else u==="node"&&this.collectChainNodes(l,"both",h);return s.frontElement(h),h}collectChainNodes(n,r,s){const{model:l}=this.context;l.getRelatedEdgesData(n,r).forEach(h=>{s.includes(V(h))||s.push(V(h)),s.includes(h.source)||(s.push(h.source),this.collectChainNodes(h.source,"in",s)),s.includes(h.target)||(s.push(h.target),this.collectChainNodes(h.target,"out",s))})}}class Y5 extends os{getActiveIds(n){const{model:r,graph:s}=this.context,l=n.target.id,u=s.getElementType(l),h=[l];if(u==="edge"){const f=r.getEdgeDatum(l);h.push(f.source,f.target)}else u==="node"&&h.push(...r.getRelatedEdgesData(l).map(V));return s.frontElement(h),h}}class X5 extends Vs{getControlPoints(n){const[r,s]=this.getEndpoints(n,!1),[l]=r,[,u]=s;return[[l,u]]}}class q5 extends cr{beforeDraw(n){const{model:r}=this.context,{nodes:s,edges:l}=r.getData(),u=s.filter(f=>f.depth===1),h=u.map(f=>f.id);return l.forEach(f=>{h.includes(f.target)&&(f.style||(f.style={}),f.style.zIndex=u.length-u.findIndex(d=>d.id===f.target))}),n}}const gf=class gf extends cr{constructor(n,r){super(n,Object.assign({},gf.defaultOptions,r))}beforeDraw(n){const r=this.context.model.getNodeData();if(r.length===0)return n;let s=0;const l=(u,h)=>{var d;const f=r.find(v=>v.id==u);f&&(f.style||(f.style={}),f.style.color=h||this.options.colors[s++%this.options.colors.length],(d=f.children)==null||d.forEach(v=>{var p;return l(v,(p=f.style)==null?void 0:p.color)}))};return r.filter(u=>u.depth===1).forEach(u=>l(u.id)),n}};Ec(gf,"defaultOptions",{colors:["#1783FF","#F08F56","#D580FF","#00C9C9","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]});let A0=gf;var Xe=Y(96486),ct=Y(67294),N0=function(a,n){return N0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(r[l]=s[l])},N0(a,n)};function K5(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");N0(a,n);function r(){this.constructor=a}a.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}var Fn=function(){return Fn=Object.assign||function(n){for(var r,s=1,l=arguments.length;s<l;s++){r=arguments[s];for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(n[u]=r[u])}return n},Fn.apply(this,arguments)};function Q5(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r}function J5(a,n,r,s){var l=arguments.length,u=l<3?n:s===null?s=Object.getOwnPropertyDescriptor(n,r):s,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,n,r,s);else for(var f=a.length-1;f>=0;f--)(h=a[f])&&(u=(l<3?h(u):l>3?h(n,r,u):h(n,r))||u);return l>3&&u&&Object.defineProperty(n,r,u),u}function t4(a,n){return function(r,s){n(r,s,a)}}function BG(a,n,r,s,l,u){function h(w){if(w!==void 0&&typeof w!="function")throw new TypeError("Function expected");return w}for(var f=s.kind,d=f==="getter"?"get":f==="setter"?"set":"value",v=!n&&a?s.static?a:a.prototype:null,p=n||(v?Object.getOwnPropertyDescriptor(v,s.name):{}),g,y=!1,m=r.length-1;m>=0;m--){var b={};for(var x in s)b[x]=x==="access"?{}:s[x];for(var x in s.access)b.access[x]=s.access[x];b.addInitializer=function(w){if(y)throw new TypeError("Cannot add initializers after decoration has completed");u.push(h(w||null))};var E=(0,r[m])(f==="accessor"?{get:p.get,set:p.set}:p[d],b);if(f==="accessor"){if(E===void 0)continue;if(E===null||typeof E!="object")throw new TypeError("Object expected");(g=h(E.get))&&(p.get=g),(g=h(E.set))&&(p.set=g),(g=h(E.init))&&l.unshift(g)}else(g=h(E))&&(f==="field"?l.unshift(g):p[d]=g)}v&&Object.defineProperty(v,s.name,p),y=!0}function FG(a,n,r){for(var s=arguments.length>2,l=0;l<n.length;l++)r=s?n[l].call(a,r):n[l].call(a);return s?r:void 0}function zG(a){return typeof a=="symbol"?a:"".concat(a)}function ZG(a,n,r){return typeof n=="symbol"&&(n=n.description?"[".concat(n.description,"]"):""),Object.defineProperty(a,"name",{configurable:!0,value:r?"".concat(r," ",n):n})}function e4(a,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,n)}function n4(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})}function r4(a,n){var r={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,l,u,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(v){return function(p){return d([v,p])}}function d(v){if(s)throw new TypeError("Generator is already executing.");for(;h&&(h=0,v[0]&&(r=0)),r;)try{if(s=1,l&&(u=v[0]&2?l.return:v[0]?l.throw||((u=l.return)&&u.call(l),0):l.next)&&!(u=u.call(l,v[1])).done)return u;switch(l=0,u&&(v=[v[0]&2,u.value]),v[0]){case 0:case 1:u=v;break;case 4:return r.label++,{value:v[1],done:!1};case 5:r.label++,l=v[1],v=[0];continue;case 7:v=r.ops.pop(),r.trys.pop();continue;default:if(u=r.trys,!(u=u.length>0&&u[u.length-1])&&(v[0]===6||v[0]===2)){r=0;continue}if(v[0]===3&&(!u||v[1]>u[0]&&v[1]<u[3])){r.label=v[1];break}if(v[0]===6&&r.label<u[1]){r.label=u[1],u=v;break}if(u&&r.label<u[2]){r.label=u[2],r.ops.push(v);break}u[2]&&r.ops.pop(),r.trys.pop();continue}v=n.call(a,r)}catch(p){v=[6,p],l=0}finally{s=u=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}}var R0=Object.create?function(a,n,r,s){s===void 0&&(s=r);var l=Object.getOwnPropertyDescriptor(n,r);(!l||("get"in l?!n.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return n[r]}}),Object.defineProperty(a,s,l)}:function(a,n,r,s){s===void 0&&(s=r),a[s]=n[r]};function i4(a,n){for(var r in a)r!=="default"&&!Object.prototype.hasOwnProperty.call(n,r)&&R0(n,a,r)}function L0(a){var n=typeof Symbol=="function"&&Symbol.iterator,r=n&&a[n],s=0;if(r)return r.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&s>=a.length&&(a=void 0),{value:a&&a[s++],done:!a}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function QE(a,n){var r=typeof Symbol=="function"&&a[Symbol.iterator];if(!r)return a;var s=r.call(a),l,u=[],h;try{for(;(n===void 0||n-- >0)&&!(l=s.next()).done;)u.push(l.value)}catch(f){h={error:f}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(h)throw h.error}}return u}function a4(){for(var a=[],n=0;n<arguments.length;n++)a=a.concat(QE(arguments[n]));return a}function s4(){for(var a=0,n=0,r=arguments.length;n<r;n++)a+=arguments[n].length;for(var s=Array(a),l=0,n=0;n<r;n++)for(var u=arguments[n],h=0,f=u.length;h<f;h++,l++)s[l]=u[h];return s}function dc(a,n,r){if(r||arguments.length===2)for(var s=0,l=n.length,u;s<l;s++)(u||!(s in n))&&(u||(u=Array.prototype.slice.call(n,0,s)),u[s]=n[s]);return a.concat(u||Array.prototype.slice.call(n))}function vc(a){return this instanceof vc?(this.v=a,this):new vc(a)}function o4(a,n,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(a,n||[]),l,u=[];return l={},h("next"),h("throw"),h("return"),l[Symbol.asyncIterator]=function(){return this},l;function h(y){s[y]&&(l[y]=function(m){return new Promise(function(b,x){u.push([y,m,b,x])>1||f(y,m)})})}function f(y,m){try{d(s[y](m))}catch(b){g(u[0][3],b)}}function d(y){y.value instanceof vc?Promise.resolve(y.value.v).then(v,p):g(u[0][2],y)}function v(y){f("next",y)}function p(y){f("throw",y)}function g(y,m){y(m),u.shift(),u.length&&f(u[0][0],u[0][1])}}function l4(a){var n,r;return n={},s("next"),s("throw",function(l){throw l}),s("return"),n[Symbol.iterator]=function(){return this},n;function s(l,u){n[l]=a[l]?function(h){return(r=!r)?{value:vc(a[l](h)),done:!1}:u?u(h):h}:u}}function c4(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=a[Symbol.asyncIterator],r;return n?n.call(a):(a=typeof L0=="function"?L0(a):a[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(u){r[u]=a[u]&&function(h){return new Promise(function(f,d){h=a[u](h),l(f,d,h.done,h.value)})}}function l(u,h,f,d){Promise.resolve(d).then(function(v){u({value:v,done:f})},h)}}function u4(a,n){return Object.defineProperty?Object.defineProperty(a,"raw",{value:n}):a.raw=n,a}var h4=Object.create?function(a,n){Object.defineProperty(a,"default",{enumerable:!0,value:n})}:function(a,n){a.default=n};function f4(a){if(a&&a.__esModule)return a;var n={};if(a!=null)for(var r in a)r!=="default"&&Object.prototype.hasOwnProperty.call(a,r)&&R0(n,a,r);return h4(n,a),n}function d4(a){return a&&a.__esModule?a:{default:a}}function v4(a,n,r,s){if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?a!==n||!s:!n.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?s:r==="a"?s.call(a):s?s.value:n.get(a)}function p4(a,n,r,s,l){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!l)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?a!==n||!l:!n.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?l.call(a,r):l?l.value=r:n.set(a,r),r}function g4(a,n){if(n===null||typeof n!="object"&&typeof n!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof a=="function"?n===a:a.has(n)}function y4(a,n,r){if(n!=null){if(typeof n!="object"&&typeof n!="function")throw new TypeError("Object expected.");var s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=n[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=n[Symbol.dispose]}if(typeof s!="function")throw new TypeError("Object not disposable.");a.stack.push({value:n,dispose:s,async:r})}else r&&a.stack.push({async:!0});return n}var m4=typeof SuppressedError=="function"?SuppressedError:function(a,n,r){var s=new Error(r);return s.name="SuppressedError",s.error=a,s.suppressed=n,s};function b4(a){function n(s){a.error=a.hasError?new m4(s,a.error,"An error was suppressed during disposal."):s,a.hasError=!0}function r(){for(;a.stack.length;){var s=a.stack.pop();try{var l=s.dispose&&s.dispose.call(s.value);if(s.async)return Promise.resolve(l).then(r,function(u){return n(u),r()})}catch(u){n(u)}}if(a.hasError)throw a.error}return r()}var GG={__extends:K5,__assign:Fn,__rest:Q5,__decorate:J5,__param:t4,__metadata:e4,__awaiter:n4,__generator:r4,__createBinding:R0,__exportStar:i4,__values:L0,__read:QE,__spread:a4,__spreadArrays:s4,__spreadArray:dc,__await:vc,__asyncGenerator:o4,__asyncDelegator:l4,__asyncValues:c4,__makeTemplateObject:u4,__importStar:f4,__importDefault:d4,__classPrivateFieldGet:v4,__classPrivateFieldSet:p4,__classPrivateFieldIn:g4,__addDisposableResource:y4,__disposeResources:b4},x4=Y(96774),E4=Y.n(x4),Ie="-ms-",pc="-moz-",ye="-webkit-",JE="comm",$h="rule",D0="decl",WG="@page",jG="@media",w4="@import",VG="@charset",HG="@viewport",$G="@supports",UG="@document",YG="@namespace",t2="@keyframes",XG="@font-face",qG="@counter-style",KG="@font-feature-values",S4="@layer",QG="@scope",e2=Math.abs,I0=String.fromCharCode,B0=Object.assign;function M4(a,n){return xn(a,0)^45?(((n<<2^xn(a,0))<<2^xn(a,1))<<2^xn(a,2))<<2^xn(a,3):0}function n2(a){return a.trim()}function Hi(a,n){return(a=n.exec(a))?a[0]:a}function qt(a,n,r){return a.replace(n,r)}function Uh(a,n,r){return a.indexOf(n,r)}function xn(a,n){return a.charCodeAt(n)|0}function so(a,n,r){return a.slice(n,r)}function Ci(a){return a.length}function r2(a){return a.length}function gc(a,n){return n.push(a),a}function T4(a,n){return a.map(n).join("")}function i2(a,n){return a.filter(function(r){return!Hi(r,n)})}var Yh=1,oo=1,a2=0,Er=0,He=0,lo="";function Xh(a,n,r,s,l,u,h,f){return{value:a,root:n,parent:r,type:s,props:l,children:u,line:Yh,column:oo,length:h,return:"",siblings:f}}function Ta(a,n){return B0(Xh("",null,null,"",null,null,0,a.siblings),a,{length:-a.length},n)}function co(a){for(;a.root;)a=Ta(a.root,{children:[a]});gc(a,a.siblings)}function C4(){return He}function O4(){return He=Er>0?xn(lo,--Er):0,oo--,He===10&&(oo=1,Yh--),He}function Br(){return He=Er<a2?xn(lo,Er++):0,oo++,He===10&&(oo=1,Yh++),He}function ys(){return xn(lo,Er)}function qh(){return Er}function Kh(a,n){return so(lo,a,n)}function Qh(a){switch(a){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function s2(a){return Yh=oo=1,a2=Ci(lo=a),Er=0,[]}function o2(a){return lo="",a}function Jh(a){return n2(Kh(Er-1,F0(a===91?a+2:a===40?a+1:a)))}function JG(a){return o2(_4(s2(a)))}function k4(a){for(;(He=ys())&&He<33;)Br();return Qh(a)>2||Qh(He)>3?"":" "}function _4(a){for(;Br();)switch(Qh(He)){case 0:append(l2(Er-1),a);break;case 2:append(Jh(He),a);break;default:append(from(He),a)}return a}function P4(a,n){for(;--n&&Br()&&!(He<48||He>102||He>57&&He<65||He>70&&He<97););return Kh(a,qh()+(n<6&&ys()==32&&Br()==32))}function F0(a){for(;Br();)switch(He){case a:return Er;case 34:case 39:a!==34&&a!==39&&F0(He);break;case 40:a===41&&F0(a);break;case 92:Br();break}return Er}function A4(a,n){for(;Br()&&a+He!==57;)if(a+He===84&&ys()===47)break;return"/*"+Kh(n,Er-1)+"*"+I0(a===47?a:Br())}function l2(a){for(;!Qh(ys());)Br();return Kh(a,Er)}function tf(a,n){for(var r="",s=0;s<a.length;s++)r+=n(a[s],s,a,n)||"";return r}function N4(a,n,r,s){switch(a.type){case S4:if(a.children.length)break;case w4:case D0:return a.return=a.return||a.value;case JE:return"";case t2:return a.return=a.value+"{"+tf(a.children,s)+"}";case $h:if(!Ci(a.value=a.props.join(",")))return""}return Ci(r=tf(a.children,s))?a.return=a.value+"{"+r+"}":""}function c2(a,n,r){switch(M4(a,n)){case 5103:return ye+"print-"+a+a;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ye+a+a;case 4789:return pc+a+a;case 5349:case 4246:case 4810:case 6968:case 2756:return ye+a+pc+a+Ie+a+a;case 5936:switch(xn(a,n+11)){case 114:return ye+a+Ie+qt(a,/[svh]\w+-[tblr]{2}/,"tb")+a;case 108:return ye+a+Ie+qt(a,/[svh]\w+-[tblr]{2}/,"tb-rl")+a;case 45:return ye+a+Ie+qt(a,/[svh]\w+-[tblr]{2}/,"lr")+a}case 6828:case 4268:case 2903:return ye+a+Ie+a+a;case 6165:return ye+a+Ie+"flex-"+a+a;case 5187:return ye+a+qt(a,/(\w+).+(:[^]+)/,ye+"box-$1$2"+Ie+"flex-$1$2")+a;case 5443:return ye+a+Ie+"flex-item-"+qt(a,/flex-|-self/g,"")+(Hi(a,/flex-|baseline/)?"":Ie+"grid-row-"+qt(a,/flex-|-self/g,""))+a;case 4675:return ye+a+Ie+"flex-line-pack"+qt(a,/align-content|flex-|-self/g,"")+a;case 5548:return ye+a+Ie+qt(a,"shrink","negative")+a;case 5292:return ye+a+Ie+qt(a,"basis","preferred-size")+a;case 6060:return ye+"box-"+qt(a,"-grow","")+ye+a+Ie+qt(a,"grow","positive")+a;case 4554:return ye+qt(a,/([^-])(transform)/g,"$1"+ye+"$2")+a;case 6187:return qt(qt(qt(a,/(zoom-|grab)/,ye+"$1"),/(image-set)/,ye+"$1"),a,"")+a;case 5495:case 3959:return qt(a,/(image-set\([^]*)/,ye+"$1$`$1");case 4968:return qt(qt(a,/(.+:)(flex-)?(.*)/,ye+"box-pack:$3"+Ie+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ye+a+a;case 4200:if(!Hi(a,/flex-|baseline/))return Ie+"grid-column-align"+so(a,n)+a;break;case 2592:case 3360:return Ie+qt(a,"template-","")+a;case 4384:case 3616:return r&&r.some(function(s,l){return n=l,Hi(s.props,/grid-\w+-end/)})?~Uh(a+(r=r[n].value),"span",0)?a:Ie+qt(a,"-start","")+a+Ie+"grid-row-span:"+(~Uh(r,"span",0)?Hi(r,/\d+/):+Hi(r,/\d+/)-+Hi(a,/\d+/))+";":Ie+qt(a,"-start","")+a;case 4896:case 4128:return r&&r.some(function(s){return Hi(s.props,/grid-\w+-start/)})?a:Ie+qt(qt(a,"-end","-span"),"span ","")+a;case 4095:case 3583:case 4068:case 2532:return qt(a,/(.+)-inline(.+)/,ye+"$1$2")+a;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ci(a)-1-n>6)switch(xn(a,n+1)){case 109:if(xn(a,n+4)!==45)break;case 102:return qt(a,/(.+:)(.+)-([^]+)/,"$1"+ye+"$2-$3$1"+pc+(xn(a,n+3)==108?"$3":"$2-$3"))+a;case 115:return~Uh(a,"stretch",0)?c2(qt(a,"stretch","fill-available"),n,r)+a:a}break;case 5152:case 5920:return qt(a,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(s,l,u,h,f,d,v){return Ie+l+":"+u+v+(h?Ie+l+"-span:"+(f?d:+d-+u)+v:"")+a});case 4949:if(xn(a,n+6)===121)return qt(a,":",":"+ye)+a;break;case 6444:switch(xn(a,xn(a,14)===45?18:11)){case 120:return qt(a,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+ye+(xn(a,14)===45?"inline-":"")+"box$3$1"+ye+"$2$3$1"+Ie+"$2box$3")+a;case 100:return qt(a,":",":"+Ie)+a}break;case 5719:case 2647:case 2135:case 3927:case 2391:return qt(a,"scroll-","scroll-snap-")+a}return a}function R4(a){var n=r2(a);return function(r,s,l,u){for(var h="",f=0;f<n;f++)h+=a[f](r,s,l,u)||"";return h}}function L4(a){return function(n){n.root||(n=n.return)&&a(n)}}function D4(a,n,r,s){if(a.length>-1&&!a.return)switch(a.type){case D0:a.return=c2(a.value,a.length,r);return;case t2:return tf([Ta(a,{value:qt(a.value,"@","@"+ye)})],s);case $h:if(a.length)return T4(r=a.props,function(l){switch(Hi(l,s=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":co(Ta(a,{props:[qt(l,/:(read-\w+)/,":"+pc+"$1")]})),co(Ta(a,{props:[l]})),B0(a,{props:i2(r,s)});break;case"::placeholder":co(Ta(a,{props:[qt(l,/:(plac\w+)/,":"+ye+"input-$1")]})),co(Ta(a,{props:[qt(l,/:(plac\w+)/,":"+pc+"$1")]})),co(Ta(a,{props:[qt(l,/:(plac\w+)/,Ie+"input-$1")]})),co(Ta(a,{props:[l]})),B0(a,{props:i2(r,s)});break}return""})}}function tW(a){switch(a.type){case RULESET:a.props=a.props.map(function(n){return combine(tokenize(n),function(r,s,l){switch(charat(r,0)){case 12:return substr(r,1,strlen(r));case 0:case 40:case 43:case 62:case 126:return r;case 58:l[++s]==="global"&&(l[s]="",l[++s]="\f"+substr(l[s],s=1,-1));case 32:return s===1?"":r;default:switch(s){case 0:return a=r,sizeof(l)>1?"":r;case(s=sizeof(l)-1):case 2:return s===2?r+a+a:r+a;default:return r}}})})}}function I4(a){return o2(ef("",null,null,null,[""],a=s2(a),0,[0],a))}function ef(a,n,r,s,l,u,h,f,d){for(var v=0,p=0,g=h,y=0,m=0,b=0,x=1,E=1,w=1,S=0,M="",C=l,T=u,O=s,k=M;E;)switch(b=S,S=Br()){case 40:if(b!=108&&xn(k,g-1)==58){Uh(k+=qt(Jh(S),"&","&\f"),"&\f",e2(v?f[v-1]:0))!=-1&&(w=-1);break}case 34:case 39:case 91:k+=Jh(S);break;case 9:case 10:case 13:case 32:k+=k4(b);break;case 92:k+=P4(qh()-1,7);continue;case 47:switch(ys()){case 42:case 47:gc(B4(A4(Br(),qh()),n,r,d),d);break;default:k+="/"}break;case 123*x:f[v++]=Ci(k)*w;case 125*x:case 59:case 0:switch(S){case 0:case 125:E=0;case 59+p:w==-1&&(k=qt(k,/\f/g,"")),m>0&&Ci(k)-g&&gc(m>32?h2(k+";",s,r,g-1,d):h2(qt(k," ","")+";",s,r,g-2,d),d);break;case 59:k+=";";default:if(gc(O=u2(k,n,r,v,p,l,f,M,C=[],T=[],g,u),u),S===123)if(p===0)ef(k,n,O,O,C,u,g,f,T);else switch(y===99&&xn(k,3)===110?100:y){case 100:case 108:case 109:case 115:ef(a,O,O,s&&gc(u2(a,O,O,0,0,l,f,M,l,C=[],g,T),T),l,T,g,f,s?C:T);break;default:ef(k,O,O,O,[""],T,0,f,T)}}v=p=m=0,x=w=1,M=k="",g=h;break;case 58:g=1+Ci(k),m=b;default:if(x<1){if(S==123)--x;else if(S==125&&x++==0&&O4()==125)continue}switch(k+=I0(S),S*x){case 38:w=p>0?1:(k+="\f",-1);break;case 44:f[v++]=(Ci(k)-1)*w,w=1;break;case 64:ys()===45&&(k+=Jh(Br())),y=ys(),p=g=Ci(M=k+=l2(qh())),S++;break;case 45:b===45&&Ci(k)==2&&(x=0)}}return u}function u2(a,n,r,s,l,u,h,f,d,v,p,g){for(var y=l-1,m=l===0?u:[""],b=r2(m),x=0,E=0,w=0;x<s;++x)for(var S=0,M=so(a,y+1,y=e2(E=h[x])),C=a;S<b;++S)(C=n2(E>0?m[S]+" "+M:qt(M,/&\f/g,m[S])))&&(d[w++]=C);return Xh(a,n,r,l===0?$h:f,d,v,p,g)}function B4(a,n,r,s){return Xh(a,n,r,JE,I0(C4()),so(a,2,-2),0,s)}function h2(a,n,r,s,l){return Xh(a,n,r,D0,so(a,0,s),so(a,s+1,-1),s,l)}var F4={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},z0=Y(34155),$i=typeof z0!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/agentscope-spark-design/spark-chat/"}!==void 0&&({NODE_ENV:"production",PUBLIC_PATH:"/agentscope-spark-design/spark-chat/"}.REACT_APP_SC_ATTR||{NODE_ENV:"production",PUBLIC_PATH:"/agentscope-spark-design/spark-chat/"}.SC_ATTR)||"data-styled",f2="active",nf="data-styled-version",uo="6.1.19",Z0=`/*!sc*/
`,rf=typeof window!="undefined"&&typeof document!="undefined",z4=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof z0!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/agentscope-spark-design/spark-chat/"}!==void 0&&{NODE_ENV:"production",PUBLIC_PATH:"/agentscope-spark-design/spark-chat/"}.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&{NODE_ENV:"production",PUBLIC_PATH:"/agentscope-spark-design/spark-chat/"}.REACT_APP_SC_DISABLE_SPEEDY!==""?{NODE_ENV:"production",PUBLIC_PATH:"/agentscope-spark-design/spark-chat/"}.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&{NODE_ENV:"production",PUBLIC_PATH:"/agentscope-spark-design/spark-chat/"}.REACT_APP_SC_DISABLE_SPEEDY:typeof z0!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/agentscope-spark-design/spark-chat/"}!==void 0&&{NODE_ENV:"production",PUBLIC_PATH:"/agentscope-spark-design/spark-chat/"}.SC_DISABLE_SPEEDY!==void 0&&{NODE_ENV:"production",PUBLIC_PATH:"/agentscope-spark-design/spark-chat/"}.SC_DISABLE_SPEEDY!==""&&{NODE_ENV:"production",PUBLIC_PATH:"/agentscope-spark-design/spark-chat/"}.SC_DISABLE_SPEEDY!=="false"&&{NODE_ENV:"production",PUBLIC_PATH:"/agentscope-spark-design/spark-chat/"}.SC_DISABLE_SPEEDY),Z4={},eW=/invalid hook call/i,nW=new Set,rW=function(a,n){if(0)var r,s,l,u},af=Object.freeze([]),ho=Object.freeze({});function G0(a,n,r){return r===void 0&&(r=ho),a.theme!==r.theme&&a.theme||n||r.theme}var d2=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),G4=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,W4=/(^-|-$)/g;function v2(a){return a.replace(G4,"-").replace(W4,"")}var j4=/(a)(d)/gi,sf=52,p2=function(a){return String.fromCharCode(a+(a>25?39:97))};function W0(a){var n,r="";for(n=Math.abs(a);n>sf;n=n/sf|0)r=p2(n%sf)+r;return(p2(n%sf)+r).replace(j4,"$1-$2")}var j0,g2=5381,fo=function(a,n){for(var r=n.length;r;)a=33*a^n.charCodeAt(--r);return a},y2=function(a){return fo(g2,a)};function V0(a){return W0(y2(a)>>>0)}function m2(a){return a.displayName||a.name||"Component"}function H0(a){return typeof a=="string"&&!0}var b2=typeof Symbol=="function"&&Symbol.for,x2=b2?Symbol.for("react.memo"):60115,V4=b2?Symbol.for("react.forward_ref"):60112,H4={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},$4={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},E2={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},U4=((j0={})[V4]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},j0[x2]=E2,j0);function w2(a){return("type"in(n=a)&&n.type.$$typeof)===x2?E2:"$$typeof"in a?U4[a.$$typeof]:H4;var n}var Y4=Object.defineProperty,X4=Object.getOwnPropertyNames,S2=Object.getOwnPropertySymbols,q4=Object.getOwnPropertyDescriptor,K4=Object.getPrototypeOf,M2=Object.prototype;function $0(a,n,r){if(typeof n!="string"){if(M2){var s=K4(n);s&&s!==M2&&$0(a,s,r)}var l=X4(n);S2&&(l=l.concat(S2(n)));for(var u=w2(a),h=w2(n),f=0;f<l.length;++f){var d=l[f];if(!(d in $4||r&&r[d]||h&&d in h||u&&d in u)){var v=q4(n,d);try{Y4(a,d,v)}catch(p){}}}}return a}function ms(a){return typeof a=="function"}function U0(a){return typeof a=="object"&&"styledComponentId"in a}function bs(a,n){return a&&n?"".concat(a," ").concat(n):a||n||""}function yc(a,n){if(a.length===0)return"";for(var r=a[0],s=1;s<a.length;s++)r+=n?n+a[s]:a[s];return r}function mc(a){return a!==null&&typeof a=="object"&&a.constructor.name===Object.name&&!("props"in a&&a.$$typeof)}function Y0(a,n,r){if(r===void 0&&(r=!1),!r&&!mc(a)&&!Array.isArray(a))return n;if(Array.isArray(n))for(var s=0;s<n.length;s++)a[s]=Y0(a[s],n[s]);else if(mc(n))for(var s in n)a[s]=Y0(a[s],n[s]);return a}function X0(a,n){Object.defineProperty(a,"toString",{value:n})}var iW={};function aW(){for(var a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];for(var r=a[0],s=[],l=1,u=a.length;l<u;l+=1)s.push(a[l]);return s.forEach(function(h){r=r.replace(/%[a-z]/,h)}),r}function Fr(a){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(a," for more information.").concat(n.length>0?" Args: ".concat(n.join(", ")):""))}var Q4=function(){function a(n){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=n}return a.prototype.indexOfGroup=function(n){for(var r=0,s=0;s<n;s++)r+=this.groupSizes[s];return r},a.prototype.insertRules=function(n,r){if(n>=this.groupSizes.length){for(var s=this.groupSizes,l=s.length,u=l;n>=u;)if((u<<=1)<0)throw Fr(16,"".concat(n));this.groupSizes=new Uint32Array(u),this.groupSizes.set(s),this.length=u;for(var h=l;h<u;h++)this.groupSizes[h]=0}for(var f=this.indexOfGroup(n+1),d=(h=0,r.length);h<d;h++)this.tag.insertRule(f,r[h])&&(this.groupSizes[n]++,f++)},a.prototype.clearGroup=function(n){if(n<this.length){var r=this.groupSizes[n],s=this.indexOfGroup(n),l=s+r;this.groupSizes[n]=0;for(var u=s;u<l;u++)this.tag.deleteRule(s)}},a.prototype.getGroup=function(n){var r="";if(n>=this.length||this.groupSizes[n]===0)return r;for(var s=this.groupSizes[n],l=this.indexOfGroup(n),u=l+s,h=l;h<u;h++)r+="".concat(this.tag.getRule(h)).concat(Z0);return r},a}(),sW=null,of=new Map,lf=new Map,cf=1,uf=function(a){if(of.has(a))return of.get(a);for(;lf.has(cf);)cf++;var n=cf++;return of.set(a,n),lf.set(n,a),n},J4=function(a,n){cf=n+1,of.set(a,n),lf.set(n,a)},tB="style[".concat($i,"][").concat(nf,'="').concat(uo,'"]'),eB=new RegExp("^".concat($i,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),nB=function(a,n,r){for(var s,l=r.split(","),u=0,h=l.length;u<h;u++)(s=l[u])&&a.registerName(n,s)},rB=function(a,n){for(var r,s=((r=n.textContent)!==null&&r!==void 0?r:"").split(Z0),l=[],u=0,h=s.length;u<h;u++){var f=s[u].trim();if(f){var d=f.match(eB);if(d){var v=0|parseInt(d[1],10),p=d[2];v!==0&&(J4(p,v),nB(a,p,d[3]),a.getTag().insertRules(v,l)),l.length=0}else l.push(f)}}},T2=function(a){for(var n=document.querySelectorAll(tB),r=0,s=n.length;r<s;r++){var l=n[r];l&&l.getAttribute($i)!==f2&&(rB(a,l),l.parentNode&&l.parentNode.removeChild(l))}};function q0(){return Y.nc}var C2=function(a){var n=document.head,r=a||n,s=document.createElement("style"),l=function(f){var d=Array.from(f.querySelectorAll("style[".concat($i,"]")));return d[d.length-1]}(r),u=l!==void 0?l.nextSibling:null;s.setAttribute($i,f2),s.setAttribute(nf,uo);var h=q0();return h&&s.setAttribute("nonce",h),r.insertBefore(s,u),s},iB=function(){function a(n){this.element=C2(n),this.element.appendChild(document.createTextNode("")),this.sheet=function(r){if(r.sheet)return r.sheet;for(var s=document.styleSheets,l=0,u=s.length;l<u;l++){var h=s[l];if(h.ownerNode===r)return h}throw Fr(17)}(this.element),this.length=0}return a.prototype.insertRule=function(n,r){try{return this.sheet.insertRule(r,n),this.length++,!0}catch(s){return!1}},a.prototype.deleteRule=function(n){this.sheet.deleteRule(n),this.length--},a.prototype.getRule=function(n){var r=this.sheet.cssRules[n];return r&&r.cssText?r.cssText:""},a}(),aB=function(){function a(n){this.element=C2(n),this.nodes=this.element.childNodes,this.length=0}return a.prototype.insertRule=function(n,r){if(n<=this.length&&n>=0){var s=document.createTextNode(r);return this.element.insertBefore(s,this.nodes[n]||null),this.length++,!0}return!1},a.prototype.deleteRule=function(n){this.element.removeChild(this.nodes[n]),this.length--},a.prototype.getRule=function(n){return n<this.length?this.nodes[n].textContent:""},a}(),sB=function(){function a(n){this.rules=[],this.length=0}return a.prototype.insertRule=function(n,r){return n<=this.length&&(this.rules.splice(n,0,r),this.length++,!0)},a.prototype.deleteRule=function(n){this.rules.splice(n,1),this.length--},a.prototype.getRule=function(n){return n<this.length?this.rules[n]:""},a}(),O2=rf,oB={isServer:!rf,useCSSOMInjection:!z4},vo=function(){function a(n,r,s){n===void 0&&(n=ho),r===void 0&&(r={});var l=this;this.options=Fn(Fn({},oB),n),this.gs=r,this.names=new Map(s),this.server=!!n.isServer,!this.server&&rf&&O2&&(O2=!1,T2(this)),X0(this,function(){return function(u){for(var h=u.getTag(),f=h.length,d="",v=function(g){var y=function(w){return lf.get(w)}(g);if(y===void 0)return"continue";var m=u.names.get(y),b=h.getGroup(g);if(m===void 0||!m.size||b.length===0)return"continue";var x="".concat($i,".g").concat(g,'[id="').concat(y,'"]'),E="";m!==void 0&&m.forEach(function(w){w.length>0&&(E+="".concat(w,","))}),d+="".concat(b).concat(x,'{content:"').concat(E,'"}').concat(Z0)},p=0;p<f;p++)v(p);return d}(l)})}return a.registerId=function(n){return uf(n)},a.prototype.rehydrate=function(){!this.server&&rf&&T2(this)},a.prototype.reconstructWithOptions=function(n,r){return r===void 0&&(r=!0),new a(Fn(Fn({},this.options),n),this.gs,r&&this.names||void 0)},a.prototype.allocateGSInstance=function(n){return this.gs[n]=(this.gs[n]||0)+1},a.prototype.getTag=function(){return this.tag||(this.tag=(n=function(r){var s=r.useCSSOMInjection,l=r.target;return r.isServer?new sB(l):s?new iB(l):new aB(l)}(this.options),new Q4(n)));var n},a.prototype.hasNameForId=function(n,r){return this.names.has(n)&&this.names.get(n).has(r)},a.prototype.registerName=function(n,r){if(uf(n),this.names.has(n))this.names.get(n).add(r);else{var s=new Set;s.add(r),this.names.set(n,s)}},a.prototype.insertRules=function(n,r,s){this.registerName(n,r),this.getTag().insertRules(uf(n),s)},a.prototype.clearNames=function(n){this.names.has(n)&&this.names.get(n).clear()},a.prototype.clearRules=function(n){this.getTag().clearGroup(uf(n)),this.clearNames(n)},a.prototype.clearTag=function(){this.tag=void 0},a}(),lB=/&/g,cB=/^\s*\/\/.*$/gm;function k2(a,n){return a.map(function(r){return r.type==="rule"&&(r.value="".concat(n," ").concat(r.value),r.value=r.value.replaceAll(",",",".concat(n," ")),r.props=r.props.map(function(s){return"".concat(n," ").concat(s)})),Array.isArray(r.children)&&r.type!=="@keyframes"&&(r.children=k2(r.children,n)),r})}function _2(a){var n,r,s,l=a===void 0?ho:a,u=l.options,h=u===void 0?ho:u,f=l.plugins,d=f===void 0?af:f,v=function(y,m,b){return b.startsWith(r)&&b.endsWith(r)&&b.replaceAll(r,"").length>0?".".concat(n):y},p=d.slice();p.push(function(y){y.type===$h&&y.value.includes("&")&&(y.props[0]=y.props[0].replace(lB,r).replace(s,v))}),h.prefix&&p.push(D4),p.push(N4);var g=function(y,m,b,x){m===void 0&&(m=""),b===void 0&&(b=""),x===void 0&&(x="&"),n=x,r=m,s=new RegExp("\\".concat(r,"\\b"),"g");var E=y.replace(cB,""),w=I4(b||m?"".concat(b," ").concat(m," { ").concat(E," }"):E);h.namespace&&(w=k2(w,h.namespace));var S=[];return tf(w,R4(p.concat(L4(function(M){return S.push(M)})))),S};return g.hash=d.length?d.reduce(function(y,m){return m.name||Fr(15),fo(y,m.name)},g2).toString():"",g}var P2=new vo,K0=_2(),Q0=ct.createContext({shouldForwardProp:void 0,styleSheet:P2,stylis:K0}),oW=Q0.Consumer,uB=ct.createContext(void 0);function hf(){return(0,ct.useContext)(Q0)}function hB(a){var n=(0,ct.useState)(a.stylisPlugins),r=n[0],s=n[1],l=hf().styleSheet,u=(0,ct.useMemo)(function(){var d=l;return a.sheet?d=a.sheet:a.target&&(d=d.reconstructWithOptions({target:a.target},!1)),a.disableCSSOMInjection&&(d=d.reconstructWithOptions({useCSSOMInjection:!1})),d},[a.disableCSSOMInjection,a.sheet,a.target,l]),h=(0,ct.useMemo)(function(){return _2({options:{namespace:a.namespace,prefix:a.enableVendorPrefixes},plugins:r})},[a.enableVendorPrefixes,a.namespace,r]);(0,ct.useEffect)(function(){E4()(r,a.stylisPlugins)||s(a.stylisPlugins)},[a.stylisPlugins]);var f=(0,ct.useMemo)(function(){return{shouldForwardProp:a.shouldForwardProp,styleSheet:u,stylis:h}},[a.shouldForwardProp,u,h]);return ct.createElement(Q0.Provider,{value:f},ct.createElement(uB.Provider,{value:h},a.children))}var A2=function(){function a(n,r){var s=this;this.inject=function(l,u){u===void 0&&(u=K0);var h=s.name+u.hash;l.hasNameForId(s.id,h)||l.insertRules(s.id,h,u(s.rules,h,"@keyframes"))},this.name=n,this.id="sc-keyframes-".concat(n),this.rules=r,X0(this,function(){throw Fr(12,String(s.name))})}return a.prototype.getName=function(n){return n===void 0&&(n=K0),this.name+n.hash},a}(),fB=function(a){return a>="A"&&a<="Z"};function N2(a){for(var n="",r=0;r<a.length;r++){var s=a[r];if(r===1&&s==="-"&&a[0]==="-")return a;fB(s)?n+="-"+s.toLowerCase():n+=s}return n.startsWith("ms-")?"-"+n:n}var R2=function(a){return a==null||a===!1||a===""},L2=function(a){var n,r,s=[];for(var l in a){var u=a[l];a.hasOwnProperty(l)&&!R2(u)&&(Array.isArray(u)&&u.isCss||ms(u)?s.push("".concat(N2(l),":"),u,";"):mc(u)?s.push.apply(s,dc(dc(["".concat(l," {")],L2(u),!1),["}"],!1)):s.push("".concat(N2(l),": ").concat((n=l,(r=u)==null||typeof r=="boolean"||r===""?"":typeof r!="number"||r===0||n in F4||n.startsWith("--")?String(r).trim():"".concat(r,"px")),";")))}return s};function Ca(a,n,r,s){if(R2(a))return[];if(U0(a))return[".".concat(a.styledComponentId)];if(ms(a)){if(!ms(u=a)||u.prototype&&u.prototype.isReactComponent||!n)return[a];var l=a(n);return Ca(l,n,r,s)}var u;return a instanceof A2?r?(a.inject(r,s),[a.getName(s)]):[a]:mc(a)?L2(a):Array.isArray(a)?Array.prototype.concat.apply(af,a.map(function(h){return Ca(h,n,r,s)})):[a.toString()]}function D2(a){for(var n=0;n<a.length;n+=1){var r=a[n];if(ms(r)&&!U0(r))return!1}return!0}var dB=y2(uo),vB=function(){function a(n,r,s){this.rules=n,this.staticRulesId="",this.isStatic=(s===void 0||s.isStatic)&&D2(n),this.componentId=r,this.baseHash=fo(dB,r),this.baseStyle=s,vo.registerId(r)}return a.prototype.generateAndInjectStyles=function(n,r,s){var l=this.baseStyle?this.baseStyle.generateAndInjectStyles(n,r,s):"";if(this.isStatic&&!s.hash)if(this.staticRulesId&&r.hasNameForId(this.componentId,this.staticRulesId))l=bs(l,this.staticRulesId);else{var u=yc(Ca(this.rules,n,r,s)),h=W0(fo(this.baseHash,u)>>>0);if(!r.hasNameForId(this.componentId,h)){var f=s(u,".".concat(h),void 0,this.componentId);r.insertRules(this.componentId,h,f)}l=bs(l,h),this.staticRulesId=h}else{for(var d=fo(this.baseHash,s.hash),v="",p=0;p<this.rules.length;p++){var g=this.rules[p];if(typeof g=="string")v+=g;else if(g){var y=yc(Ca(g,n,r,s));d=fo(d,y+p),v+=y}}if(v){var m=W0(d>>>0);r.hasNameForId(this.componentId,m)||r.insertRules(this.componentId,m,s(v,".".concat(m),void 0,this.componentId)),l=bs(l,m)}}return l},a}(),xs=ct.createContext(void 0),lW=xs.Consumer;function cW(){var a=c(xs);if(!a)throw Fr(18);return a}function uW(a){var n=o.useContext(xs),r=i(function(){return function(s,l){if(!s)throw Fr(14);if(ms(s)){var u=s(l);return u}if(Array.isArray(s)||typeof s!="object")throw Fr(8);return l?t(t({},l),s):s}(a.theme,n)},[a.theme,n]);return a.children?o.createElement(xs.Provider,{value:r},a.children):null}var J0={},hW=new Set;function pB(a,n,r){var s=U0(a),l=a,u=!H0(a),h=n.attrs,f=h===void 0?af:h,d=n.componentId,v=d===void 0?function(C,T){var O=typeof C!="string"?"sc":v2(C);J0[O]=(J0[O]||0)+1;var k="".concat(O,"-").concat(V0(uo+O+J0[O]));return T?"".concat(T,"-").concat(k):k}(n.displayName,n.parentComponentId):d,p=n.displayName,g=p===void 0?function(C){return H0(C)?"styled.".concat(C):"Styled(".concat(m2(C),")")}(a):p,y=n.displayName&&n.componentId?"".concat(v2(n.displayName),"-").concat(n.componentId):n.componentId||v,m=s&&l.attrs?l.attrs.concat(f).filter(Boolean):f,b=n.shouldForwardProp;if(s&&l.shouldForwardProp){var x=l.shouldForwardProp;if(n.shouldForwardProp){var E=n.shouldForwardProp;b=function(C,T){return x(C,T)&&E(C,T)}}else b=x}var w=new vB(r,y,s?l.componentStyle:void 0);function S(C,T){return function(O,k,P){var A=O.attrs,N=O.componentStyle,L=O.defaultProps,R=O.foldedComponentIds,z=O.styledComponentId,Z=O.target,X=ct.useContext(xs),nt=hf(),K=O.shouldForwardProp||nt.shouldForwardProp,rt=G0(k,X,L)||ho,U=function(Nt,Pt,ie){for(var Kt,re=Fn(Fn({},Pt),{className:void 0,theme:ie}),te=0;te<Nt.length;te+=1){var ze=ms(Kt=Nt[te])?Kt(re):Kt;for(var Yt in ze)re[Yt]=Yt==="className"?bs(re[Yt],ze[Yt]):Yt==="style"?Fn(Fn({},re[Yt]),ze[Yt]):ze[Yt]}return Pt.className&&(re.className=bs(re.className,Pt.className)),re}(A,k,rt),at=U.as||Z,ht={};for(var pt in U)U[pt]===void 0||pt[0]==="$"||pt==="as"||pt==="theme"&&U.theme===rt||(pt==="forwardedAs"?ht.as=U.forwardedAs:K&&!K(pt,at)||(ht[pt]=U[pt]));var Ct=function(Nt,Pt){var ie=hf(),Kt=Nt.generateAndInjectStyles(Pt,ie.styleSheet,ie.stylis);return Kt}(N,U),Zt=bs(R,z);return Ct&&(Zt+=" "+Ct),U.className&&(Zt+=" "+U.className),ht[H0(at)&&!d2.has(at)?"class":"className"]=Zt,P&&(ht.ref=P),(0,ct.createElement)(at,ht)}(M,C,T)}S.displayName=g;var M=ct.forwardRef(S);return M.attrs=m,M.componentStyle=w,M.displayName=g,M.shouldForwardProp=b,M.foldedComponentIds=s?bs(l.foldedComponentIds,l.styledComponentId):"",M.styledComponentId=y,M.target=s?l.target:a,Object.defineProperty(M,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(C){this._foldedDefaultProps=s?function(T){for(var O=[],k=1;k<arguments.length;k++)O[k-1]=arguments[k];for(var P=0,A=O;P<A.length;P++)Y0(T,A[P],!0);return T}({},l.defaultProps,C):C}}),X0(M,function(){return".".concat(M.styledComponentId)}),u&&$0(M,a,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),M}function I2(a,n){for(var r=[a[0]],s=0,l=n.length;s<l;s+=1)r.push(n[s],a[s+1]);return r}var B2=function(a){return Object.assign(a,{isCss:!0})};function Ui(a){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(ms(a)||mc(a))return B2(Ca(I2(af,dc([a],n,!0))));var s=a;return n.length===0&&s.length===1&&typeof s[0]=="string"?Ca(s):B2(Ca(I2(s,n)))}function tp(a,n,r){if(r===void 0&&(r=ho),!n)throw Fr(1,n);var s=function(l){for(var u=[],h=1;h<arguments.length;h++)u[h-1]=arguments[h];return a(n,r,Ui.apply(void 0,dc([l],u,!1)))};return s.attrs=function(l){return tp(a,n,Fn(Fn({},r),{attrs:Array.prototype.concat(r.attrs,l).filter(Boolean)}))},s.withConfig=function(l){return tp(a,n,Fn(Fn({},r),l))},s}var F2=function(a){return tp(pB,a)},Es=F2;d2.forEach(function(a){Es[a]=F2(a)});var gB=function(){function a(n,r){this.rules=n,this.componentId=r,this.isStatic=D2(n),vo.registerId(this.componentId+1)}return a.prototype.createStyles=function(n,r,s,l){var u=l(yc(Ca(this.rules,r,s,l)),""),h=this.componentId+n;s.insertRules(h,h,u)},a.prototype.removeStyles=function(n,r){r.clearRules(this.componentId+n)},a.prototype.renderStyles=function(n,r,s,l){n>2&&vo.registerId(this.componentId+n),this.removeStyles(n,s),this.createStyles(n,r,s,l)},a}();function fW(a){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var s=Ui.apply(void 0,e([a],n,!1)),l="sc-global-".concat(V0(JSON.stringify(s))),u=new gB(s,l),h=function(d){var v=hf(),p=o.useContext(xs),g=o.useRef(v.styleSheet.allocateGSInstance(l)).current;return v.styleSheet.server&&f(g,d,v.styleSheet,p,v.stylis),o.useLayoutEffect(function(){if(!v.styleSheet.server)return f(g,d,v.styleSheet,p,v.stylis),function(){return u.removeStyles(g,v.styleSheet)}},[g,d,v.styleSheet,p,v.stylis]),null};function f(d,v,p,g,y){if(u.isStatic)u.renderStyles(d,Z4,p,y);else{var m=t(t({},v),{theme:G0(v,g,h.defaultProps)});u.renderStyles(d,m,p,y)}}return o.memo(h)}function dW(a){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var s=yc(Ui.apply(void 0,e([a],n,!1))),l=V0(s);return new A2(l,s)}function vW(a){var n=o.forwardRef(function(r,s){var l=G0(r,o.useContext(xs),a.defaultProps);return o.createElement(a,t({},r,{theme:l,ref:s}))});return n.displayName="WithTheme(".concat(m2(a),")"),$0(n,a)}var pW=function(){function a(){var n=this;this._emitSheetCSS=function(){var r=n.instance.toString();if(!r)return"";var s=q0(),l=yc([s&&'nonce="'.concat(s,'"'),"".concat($i,'="true"'),"".concat(nf,'="').concat(uo,'"')].filter(Boolean)," ");return"<style ".concat(l,">").concat(r,"</style>")},this.getStyleTags=function(){if(n.sealed)throw Fr(2);return n._emitSheetCSS()},this.getStyleElement=function(){var r;if(n.sealed)throw Fr(2);var s=n.instance.toString();if(!s)return[];var l=((r={})[$i]="",r[nf]=uo,r.dangerouslySetInnerHTML={__html:s},r),u=q0();return u&&(l.nonce=u),[ct.createElement("style",Fn({},l,{key:"sc-0-0"}))]},this.seal=function(){n.sealed=!0},this.instance=new vo({isServer:!0}),this.sealed=!1}return a.prototype.collectStyles=function(n){if(this.sealed)throw Fr(2);return ct.createElement(hB,{sheet:this.instance},n)},a.prototype.interleaveWithNodeStream=function(n){throw Fr(3)},a}(),gW={StyleSheet:vo,mainSheet:P2},yW="__sc-".concat($i,"__");const yB=Es.div`
  ${({$placement:a})=>{switch(a){case"top":return"transform: translate(-50%, -100%); flex-direction: column-reverse;";case"right":return"transform: translate(0, -50%);";case"left":return"transform: translate(-100%, -50%); flex-direction: row-reverse;";default:return"transform: translate(-50%, 0); flex-direction: column;"}}}

  .arrow-count-icon-bar {
    ${({$placement:a})=>a==="top"||a==="bottom"?"width: 3px; height: 8px; margin: 0 7px;":"width: 8px; height: 3px; margin: 7px 0;"}
    background-color: ${({$color:a})=>a};
  }

  .arrow-count-icon-circle {
    width: 16px;
    height: 16px;
    color: #fff;
    font-weight: 600;
    font-size: 10px;
    line-height: ${({$isCollapsed:a})=>a?"16px":"14px"};
    text-align: center;
    background-color: ${({$color:a})=>a};
    border-radius: 50%;
  }

  .arrow-count-icon-circle-arrow {
    width: 16px;
    height: 16px;
    transform: ${({$isCollapsed:a,$placement:n})=>{if(a)return"none";switch(n){case"top":return"translateY(1px) rotate(-90deg)";case"right":return"translateX(-1px) rotate(0deg)";case"left":return"translateX(1px) rotate(180deg)";default:return"translateY(-1px) rotate(90deg)"}}};
  }

  display: ${({$isCollapsed:a})=>a?"flex":"none"};

  .collapsible-node-wrapper:hover & {
    display: flex;
  }
`,mB=a=>{var p;const{className:n,style:r,graph:s,data:l,isCollapsed:u,countType:h="descendant",placement:f="bottom"}=a,d=((p=s.getNodeData(l.id).style)==null?void 0:p.color)||"#99ADD1",v=(h==="descendant"?s.getDescendantsData(l.id):s.getChildrenData(l.id)).length;return ct.createElement(yB,{$color:d,$isCollapsed:u,$placement:f,className:`arrow-count-icon ${u?"arrow-count-icon-collapsed":""} ${n||""}`,style:r},ct.createElement("div",{className:"arrow-count-icon-bar"}),ct.createElement("div",{className:"arrow-count-icon-circle"},u?v:ct.createElement("div",{className:"arrow-count-icon-circle-arrow"},ct.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},ct.createElement("path",{d:"M11,4 L5.5,8 L11,12",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})))))},bB=Es.div`
  height: 16px;
  width: 16px;
  transform: translate(-50%, -50%);
  background: #fff;
  border-radius: 50%;
  border: 2px solid #99add1;
  color: #99add1;
  font-weight: 800;
  line-height: 14px;
  text-align: center;
  box-sizing: content-box;
`,xB=a=>{const{isCollapsed:n,style:r,className:s}=a;return ct.createElement(bB,{className:s,style:r},n?"+":"-")},EB=Es.div`
  height: inherit;
  width: inherit;
  border-radius: 8px;
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.12), 0 2px 4px 0 rgba(0, 0, 0, 0.1);
  position: relative;
  border: none;
  background-color: #fff;
  box-sizing: content-box;

  ${a=>a.$isActive&&Ui`
      transform: translate(-3px, -3px);
      border: 2px solid #1783ff;
    `}

  .org-chart-node-line {
    width: 100%;
    height: 6px;
    background-color: ${a=>a.$color};
    border-radius: 8px 8px 0 0;
  }

  .org-chart-node-content {
    height: calc(100% - 6px);
    margin: 0 16px 3px;
    display: flex;
    align-items: center;

    &-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 16px;
      background-color: ${a=>a.$color};
      font-weight: 600;
      font-size: 18px;
      text-align: center;
      line-height: 40px;
      color: #fff;
    }

    &-detail {
      width: calc(100% - 56px);
    }

    &-name {
      color: #242424;
      font-weight: 600;
      font-size: 18px;
      margin-bottom: 5px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    &-post {
      color: #616161;
      font-size: 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }
`,wB=a=>{const{name:n,position:r,status:s="online",isActive:l,className:u,style:h}=a,f={online:"#1783FF",busy:"#00C9C9",offline:"#F08F56"};return ct.createElement(EB,{$color:f[s],$isActive:l,className:u,style:h},ct.createElement("div",{className:"org-chart-node-line"}),ct.createElement("div",{className:"org-chart-node-content"},ct.createElement("div",{className:"org-chart-node-content-avatar"},n.slice(0,1)),ct.createElement("div",{className:"org-chart-node-content-detail"},ct.createElement("div",{className:"org-chart-node-content-name"},n),r&&ct.createElement("div",{className:"org-chart-node-content-post"},r))))};var ep=function(){return ep=Object.assign||function(a){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])}return a},ep.apply(this,arguments)},z2=function(a,n,r,s){function l(u){return u instanceof r?u:new r(function(h){h(u)})}return new(r||(r=Promise))(function(u,h){function f(p){try{v(s.next(p))}catch(g){h(g)}}function d(p){try{v(s.throw(p))}catch(g){h(g)}}function v(p){p.done?u(p.value):l(p.value).then(f,d)}v((s=s.apply(a,n||[])).next())})},Z2=function(a,n){var r={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,l,u,h=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return h.next=f(0),h.throw=f(1),h.return=f(2),typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(v){return function(p){return d([v,p])}}function d(v){if(s)throw new TypeError("Generator is already executing.");for(;h&&(h=0,v[0]&&(r=0)),r;)try{if(s=1,l&&(u=v[0]&2?l.return:v[0]?l.throw||((u=l.return)&&u.call(l),0):l.next)&&!(u=u.call(l,v[1])).done)return u;switch(l=0,u&&(v=[v[0]&2,u.value]),v[0]){case 0:case 1:u=v;break;case 4:return r.label++,{value:v[1],done:!1};case 5:r.label++,l=v[1],v=[0];continue;case 7:v=r.ops.pop(),r.trys.pop();continue;default:if(u=r.trys,!(u=u.length>0&&u[u.length-1])&&(v[0]===6||v[0]===2)){r=0;continue}if(v[0]===3&&(!u||v[1]>u[0]&&v[1]<u[3])){r.label=v[1];break}if(v[0]===6&&r.label<u[1]){r.label=u[1],u=v;break}if(u&&r.label<u[2]){r.label=u[2],r.ops.push(v);break}u[2]&&r.ops.pop(),r.trys.pop();continue}v=n.call(a,r)}catch(p){v=[6,p],l=0}finally{s=u=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},bc=ep({},YE),SB=bc.version,MB=bc.render,TB=bc.unmountComponentAtNode,ff;try{var CB=Number((SB||"").split(".")[0]);CB>=18&&(ff=bc.createRoot)}catch(a){}function G2(a){var n=bc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;n&&typeof n=="object"&&(n.usingClientEntryPoint=a)}var df="__rc_react_root__";function OB(a,n){G2(!0);var r=n[df]||ff(n);G2(!1),r.render(a),n[df]=r}function kB(a,n){MB(a,n)}function mW(a,n){}function bW(a,n){if(ff){OB(a,n);return}kB(a,n)}function _B(a){return z2(this,void 0,void 0,function(){return Z2(this,function(n){return[2,Promise.resolve().then(function(){var r;(r=a[df])===null||r===void 0||r.unmount(),delete a[df]})]})})}function PB(a){TB(a)}function xW(a){}function EW(a){return z2(this,void 0,void 0,function(){return Z2(this,function(n){return ff!==void 0?[2,_B(a)]:(PB(a),[2])})})}var vf=new Map;typeof document!="undefined"&&vf.set("tooltip",document.createElement("div"));var wW=function(a,n){n===void 0&&(n=!1);var r=null;if(n)r=vf.get("tooltip");else if(r=document.createElement("div"),a!=null&&a.key){var s=vf.get(a.key);s?r=s:vf.set(a.key,r)}return render(a,r),r},AB=function(a){if(typeof document=="undefined")return"loading";var n=a.attachShadow({mode:"open"}),r=document.createElement("div"),s=document.createElement("style");s.innerHTML=`.loading {
    display: inline-block;
    position: relative;
    width: 80px;
    height: 80px;
  }
  .loading div {
    position: absolute;
    top: 33px;
    width: 13px;
    height: 13px;
    border-radius: 50%;
    background: #ccc;
    animation-timing-function: cubic-bezier(0, 1, 1, 0);
  }
  .loading div:nth-child(1) {
    left: 8px;
    animation: loading1 0.6s infinite;
  }
  .loading div:nth-child(2) {
    left: 8px;
    animation: loading2 0.6s infinite;
  }
  .loading div:nth-child(3) {
    left: 32px;
    animation: loading2 0.6s infinite;
  }
  .loading div:nth-child(4) {
    left: 56px;
    animation: loading3 0.6s infinite;
  }
  @keyframes loading1 {
    0% {
      transform: scale(0);
    }
    100% {
      transform: scale(1);
    }
  }
  @keyframes loading3 {
    0% {
      transform: scale(1);
    }
    100% {
      transform: scale(0);
    }
  }
  @keyframes loading2 {
    0% {
      transform: translate(0, 0);
    }
    100% {
      transform: translate(24px, 0);
    }
  }
  `,r.classList.add("loading"),r.innerHTML="<div></div><div></div><div></div><div></div>",n.appendChild(s),n.appendChild(r)},NB=function(a){var n=a.loadingTemplate,r=a.theme,s=r===void 0?"light":r,l=ct.useRef(null);ct.useEffect(function(){!n&&l.current&&AB(l.current)},[]);var u=function(){return n||ct.createElement("div",{ref:l})};return ct.createElement("div",{className:"charts-loading-container",style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:s==="dark"?"rgb(20, 20, 20)":"rgb(255, 255, 255)"}},u())},RB=function(){var a=function(n,r){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(s[u]=l[u])},a(n,r)};return function(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");a(n,r);function s(){this.constructor=n}n.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}(),LB=function(a){RB(n,a);function n(){var r=a!==null&&a.apply(this,arguments)||this;return r.state={hasError:!1},r.renderError=function(s){var l=r.props.errorTemplate;switch(s){default:return typeof l=="function"?l(s):l||ct.createElement("h5",null,"\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",s.message)}},r}return n.getDerivedStateFromError=function(r){return{hasError:!0,error:r}},n.getDerivedStateFromProps=function(r,s){return s.children!==r.children?{children:r.children,hasError:!1,error:void 0}:null},n.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):ct.createElement(ct.Fragment,null,this.props.children)},n}(ct.Component),np,DB=function(){return np||(np=document.createElement("canvas").getContext("2d")),np},IB=function(a,n,r){if(r||arguments.length===2)for(var s=0,l=n.length,u;s<l;s++)(u||!(s in n))&&(u||(u=Array.prototype.slice.call(n,0,s)),u[s]=n[s]);return a.concat(u||Array.prototype.slice.call(n))},W2=(0,Xe.memoize)(function(a,n){n===void 0&&(n={});var r=n.fontSize,s=n.fontFamily,l=s===void 0?"sans-serif":s,u=n.fontWeight,h=n.fontStyle,f=n.fontVariant,d=DB();return d.font=[h,u,f,"".concat(r,"px"),l].join(" "),d.measureText((0,Xe.isString)(a)?a:"")},function(a,n){return n===void 0&&(n={}),IB([a],(0,Xe.values)(n),!0).join("")}),j2=function(a,n){return n===void 0&&(n={}),W2(a,n).width},BB=function(a,n){n===void 0&&(n={});var r=W2(a,n);return r.actualBoundingBoxAscent+r.actualBoundingBoxDescent};function FB(a,n){let r=0,s=0,l=0;return a.length===4?(r=parseInt(a[1]+a[1],16),s=parseInt(a[2]+a[2],16),l=parseInt(a[3]+a[3],16)):a.length===7&&(r=parseInt(a[1]+a[2],16),s=parseInt(a[3]+a[4],16),l=parseInt(a[5]+a[6],16)),`rgba(${r}, ${s}, ${l}, ${n})`}function zB(a,n){let r=0,s=0,l=0;a.length===4?(r=parseInt(a[1]+a[1],16),s=parseInt(a[2]+a[2],16),l=parseInt(a[3]+a[3],16)):a.length===7&&(r=parseInt(a[1]+a[2],16),s=parseInt(a[3]+a[4],16),l=parseInt(a[5]+a[6],16)),r=Math.max(0,r-n),s=Math.max(0,s-n),l=Math.max(0,l-n);const u=h=>h.toString(16).padStart(2,"0");return`#${u(r)}${u(s)}${u(l)}`}const ZB=Es.div`
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow-wrap: anywhere;
  line-height: 1.5em;
  text-align: center;
  height: inherit;
  width: inherit;
  box-sizing: content-box;
  font-size: 14px;

  ${({$type:a,$color:n,$borderWidth:r})=>{switch(a){case"normal":return`
          color: ${n};
        `;case"filled":return Ui`
          color: #fff;
          background-color: ${n};
          border-radius: 8px;
        `;case"outlined":return Ui`
          height: calc(100% - 2 * ${r}px);
          width: calc(100% - 2 * ${r}px);
          color: ${n};
          background-color: #fff;
          border: ${r}px solid ${n};
          border-radius: 8px;
        `;case"underlined":return Ui`
          height: calc(100% - ${r}px / 2);
          width: inherit;
          border-bottom: ${r}px solid ${n};
          background-color: #fff;
          color: ${n};
        `}}}

  ${({$isActive:a,$isSelected:n,$borderWidth:r,$color:s})=>(a||n)&&Ui`
      height: calc(100% - 2 * ${r}px);
      width: calc(100% - 2 * ${r}px);
      border: ${r}px solid ${zB(s,100)};
      ${n&&`box-shadow: 0 0 0 2px ${FB(s,.1)};`}
    `}
`,GB=a=>{const{className:n,style:r={},type:s="normal",text:l="",font:u,color:h="#1783ff",borderWidth:f=3,maxWidth:d=1/0,isActive:v=!1,isSelected:p=!1}=a,g=j2(l,u)>d;return ct.createElement(ZB,{$type:s,$color:h,$borderWidth:f,$isActive:v,$isSelected:p,className:`text-node text-node-${s} ${n||""}`,style:$e($e({},r),u)},ct.createElement("div",{style:g?{width:"calc(100% - 12px)"}:{}},l))},WB=Es.div`
  position: relative;
  height: inherit;
  width: inherit;
`,jB=Es.div`
  position: absolute;
  z-index: 10;

  &:hover {
    cursor: pointer;
  }

  ${({$placement:a,$offsetX:n,$offsetY:r})=>{const s={top:`left: calc(50% + ${n}px); top: ${r}px;`,bottom:`left: calc(50% + ${n}px); top: calc(100% + ${r}px);`,right:`left: calc(100% + ${n}px); top: calc(50% + ${r}px);`,left:`left: ${n}px; top: calc(50% + ${r}px);`};return Ui`
      ${s[a]}
    `}}
`,VB=a=>n=>{const{data:r,graph:s,trigger:l,iconRender:u,iconPlacement:h,iconOffsetX:f,iconOffsetY:d,iconClassName:v,iconStyle:p,refreshLayout:g}=n,[y,m]=(0,ct.useState)((0,Xe.get)(r,"style.collapsed",!1)),b=(0,ct.useRef)(null),x=(0,ct.useRef)(null),E=l==="icon"&&!(0,Xe.isEmpty)(r.children),w=M=>iw(this,null,function*(){M.stopPropagation(),yield s[y?"expandElement":"collapseElement"](V(r)),m(T=>!T),g&&(yield s.layout())});(0,ct.useEffect)(()=>{const M=l==="icon"?x.current:l==="node"?b.current:l;return M==null||M.addEventListener("click",w),()=>{M==null||M.removeEventListener("click",w)}},[l,y]);const S=M=>typeof M=="function"?M.call(s,r):M;return ct.createElement(WB,{ref:b,className:"collapsible-node-wrapper"},E&&ct.createElement(jB,{ref:x,$placement:S(h),$offsetX:S(f),$offsetY:S(d),className:v,style:p},u==null?void 0:u.call(s,y,r)),a.call(s,r))},HB=(a,n,r)=>{const s=(l=!1)=>{const[u,h]=l?["target","source"]:["source","target"];return n.filter(f=>f[u]===a).map(f=>f[h])};return r==="out"?s():r==="in"?s(!0):s().concat(s(!0))},rp={nodes:[],edges:[]};function V2(a){if(typeof a!="object"||a===null||!("id"in a))return!1;if("children"in a){if(!Array.isArray(a.children))return!1;for(const n of a.children)if(!V2(n))return!1}return!0}function H2(a){if(typeof a!="object"||a===null||!Object.keys(a).every(u=>["nodes","edges","combos"].includes(u)))return!1;const{nodes:n=[],edges:r=[],combos:s=[]}=a;if(!Array.isArray(n)||!Array.isArray(r)||!Array.isArray(s))return!1;const l=new Set(n.map(u=>u.id));return!(!n.every(u=>typeof u=="object"&&u!==null&&"id"in u)||!r.every(u=>l.has(u.source)&&l.has(u.target)))}function $B(a){if(!H2(a))return;const{nodes:n=[],edges:r=[]}=a,s=Object.fromEntries(n.map(d=>[d.id,d])),l=Object.fromEntries(n.map(d=>[d.id,0])),u=Object.fromEntries(n.map(d=>[d.id,[]]));for(const{source:d,target:v}of r)u[d].push(v),l[v]=(l[v]||0)+1;const h=Object.entries(l).filter(([d,v])=>v===0).map(([d])=>d);if(h.length!==1)return;const f=d=>{const v=s[d];return hr($e({},v),{children:u[d].map(f)})};return f(h[0])}function UB(a,n){return V2(a)?VE(a,{getNodeData:(r,s)=>{if(r.depth=s,r.style||(r.style={}),n&&(r.style.collapsed=s>=n),!r.children)return r;const h=r,{children:l}=h,u=rn(h,["children"]);return hr($e({},u),{children:l.map(f=>f.id)})}}):rp}function pf(a,n){if(!a)return rp;const r=H2(a)?$B(a):a;return r?UB(r,n):rp}const{PlusMinusIcon:YB}=xt,yf=class yf extends cr{constructor(n,r){super(n,Object.assign({},yf.defaultOptions,r))}afterLayout(){const{graph:n,element:r,model:s}=this.context,{nodes:l=[],edges:u=[]}=n.getData(),v=this.options,{enable:h}=v,f=rn(v,["enable"]);l.forEach(p=>{const g=V(p);if(p.children&&p.children.length>0)return;const y=HB(g,u,this.options.direction);y.length!==0&&s.updateNodeData([{id:g,children:y}])});const d=n.getOptions().node;if((0,Xe.has)(d,"style.component")){const p=(0,Xe.get)(d,"style.component");(0,Xe.set)(d,"style.component",g=>{if(!(typeof h=="function"?h(g):h))return p.call(n,g);const y=VB(p);return ct.createElement(y,$e({data:g,graph:n},f))})}n.setNode(d),n.draw()}};Ec(yf,"defaultOptions",{enable:!0,trigger:"icon",direction:"out",iconRender:n=>ct.createElement(YB,{isCollapsed:n}),iconPlacement:"bottom",iconOffsetX:0,iconOffsetY:0,iconClassName:"",iconStyle:{},refreshLayout:!1});let ip=yf;const XB=(a,n,r)=>{const[s,l]=n,[u,h]=r;if(l===s)return u;const f=(a-s)/(l-s);return u+f*(h-u)},qB=(a,n,r)=>{const[s,l]=n,[u,h]=r,f=Math.log(a-s+1)/Math.log(l-s+1);return u+f*(h-u)},KB=(a,n,r,s=2)=>{const[l,u]=n,[h,f]=r,d=Math.pow((a-l)/(u-l),s);return h+d*(f-h)},QB=(a,n,r)=>{const[s,l]=n,[u,h]=r,f=Math.sqrt((a-s)/(l-s));return u+f*(h-u)},mf=class mf extends cr{constructor(r,s){super(r,Object.assign({},mf.defaultOptions,s));Ec(this,"assignLineWidthByValue",(r,s,l,u,h,f)=>{const d=[s,l],v=[u,h];if(r<s||r>l||s===l)return v[0];if(typeof f=="function")return f(r,d,v);switch(f){case"linear":return XB(r,d,v);case"log":return qB(r,d,v);case"pow":return KB(r,d,v,2);case"sqrt":return QB(r,d,v);default:return v[0]}})}beforeDraw(r){const{maxValue:s,minValue:l,maxLineWidth:u,minLineWidth:h,scale:f,value:d}=this.options,v=this.context.model.getEdgeData(),p=typeof d=="function"?d:()=>d,g=Object.fromEntries(v.map(b=>[V(b),p(b)])),{add:{edges:y},update:{edges:m}}=r;return[...y.values(),...m.values()].forEach(b=>{const x=this.assignLineWidthByValue(g[V(b)]||0,typeof l=="function"?l(b,g):l,typeof s=="function"?s(b,g):s,typeof h=="function"?h(b):h,typeof u=="function"?u(b):u,f);b.style||(b.style={}),b.style.lineWidth=x}),r}};Ec(mf,"defaultOptions",{minValue:(r,s)=>Math.min(...Object.values(s)),maxValue:(r,s)=>Math.max(...Object.values(s)),minLineWidth:1,maxLineWidth:10,scale:"linear"});let ap=mf;class JB extends cr{beforeDraw(n){const{graph:r,element:s}=this.context,{add:{nodes:l},update:{nodes:u}}=n;return[...l.values(),...u.values()].forEach(h=>{s.computeElementDefaultStyle("node",{graph:r,datum:h});const f=s.getDefaultStyle(h.id),[d,v]=Hn(f.size);h.style||(h.style={}),h.style.dx=-d/2,h.style.dy=-v/2}),n}}const tF={node:{react:$5},edge:{indented:X5},behavior:{"hover-activate-neighbors":Y5,"hover-activate-chain":U5},transform:{"translate-react-node-origin":JB,"collapse-expand-react-node":ip,"assign-color-by-branch":A0,"map-edge-line-width":ap,"arrange-edge-z-index":q5}};function eF(){Object.entries(tF).forEach(([a,n])=>{Object.entries(n).forEach(([r,s])=>{M0(a,r,s)})})}eF();var $2=ct.createContext({graph:null,isReady:!1}),SW=function(){var a=React.useContext($2);if(a===void 0||Object.keys(a).length===0)throw new Error("useGraphin must be used within a GraphinProvider.");return a},sp=function(){return sp=Object.assign||function(a){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])}return a},sp.apply(this,arguments)},nF=function(a,n){var r=typeof Symbol=="function"&&a[Symbol.iterator];if(!r)return a;var s=r.call(a),l,u=[],h;try{for(;(n===void 0||n-- >0)&&!(l=s.next()).done;)u.push(l.value)}catch(f){h={error:f}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(h)throw h.error}}return u};function rF(a){var n=a.onInit,r=a.onReady,s=a.onDestroy,l=a.options,u=nF((0,ct.useState)(!1),2),h=u[0],f=u[1],d=(0,ct.useRef)(null),v=(0,ct.useRef)(null);return(0,ct.useEffect)(function(){if(!(d.current||!v.current)){var p=new cc(sp({container:v.current},l));return d.current=p,f(!0),n==null||n(d.current),function(){var g=d.current;g&&(g.destroy(),s==null||s(),d.current=null)}}},[]),(0,ct.useEffect)(function(){var p=v.current,g=d.current;!l||!p||!g||g.destroyed||(g.setOptions(l),g.render().then(function(){return r==null?void 0:r(g)}))},[l]),{graph:d.current,containerRef:v,isReady:h}}var op=function(){return op=Object.assign||function(a){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])}return a},op.apply(this,arguments)},iF=function(a,n){var r={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&n.indexOf(s)<0&&(r[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(a);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(a,s[l])&&(r[s[l]]=a[s[l]]);return r},aF=(0,ct.forwardRef)(function(a,n){var r=a.style,s=a.children,l=iF(a,["style","children"]),u=rF(l),h=u.graph,f=u.containerRef,d=u.isReady;(0,ct.useImperativeHandle)(n,function(){return h},[h]);var v=op({height:"inherit",position:"relative"},r);return s?ct.createElement($2.Provider,{value:{graph:h,isReady:d}},ct.createElement("div",{ref:f,style:v},d&&s)):ct.createElement("div",{ref:f,style:v})}),sF=(0,ct.memo)(aF);const Oa=(0,ct.forwardRef)((s,r)=>{var l=s,{children:a}=l,n=rn(l,["children"]);const x=n,{containerStyle:u,className:h,onInit:f,onReady:d,onDestroy:v,errorTemplate:p,loading:g,loadingTemplate:y}=x,m=rn(x,["containerStyle","className","onInit","onReady","onDestroy","errorTemplate","loading","loadingTemplate"]),b=(0,ct.useRef)(null);return(0,ct.useImperativeHandle)(r,()=>b.current),ct.createElement(LB,{errorTemplate:p},g&&ct.createElement(NB,{loadingTemplate:y}),!(0,Xe.isEmpty)(m.data)&&ct.createElement(sF,{ref:E=>{b.current=E},className:h,style:u,options:m,onInit:f,onReady:d,onDestroy:v},a))}),ka={autoResize:!0,behaviors:[{key:"zoom-canvas",type:"zoom-canvas"},{key:"drag-canvas",type:"drag-canvas"}]};function ri(...a){if(a.length===0)return{};const n=$e({},a[0]);for(let r=1;r<a.length;r++){const s=a[r];for(const l in s)if(s.hasOwnProperty(l)){const u=s[l],h=n[l];["component","data"].includes(l)?n[l]=u:typeof u=="function"?["plugins","behaviors","transforms"].includes(l)?n[l]=u(h||[]):n[l]=function(f){const d=u.call(this,f);return(0,Xe.isPlainObject)(d)?ri(h,d):d}:(0,Xe.isPlainObject)(u)&&(0,Xe.isPlainObject)(h)?n[l]=ri(h,u):n[l]=u}}return n}const oF={node:{type:"circle",style:{labelText:a=>a.id}}},lF=({direction:a,compact:n})=>{const r=l=>(0,Xe.isEmpty)(l.children),s=n?"compact-box":"dendrogram";return a==="vertical"?{node:{style:{labelBackground:!0,labelPlacement:"right",labelTransform:l=>r(l)?"rotate(90deg) translate(18px)":"translate(18px)",ports:[{placement:"top"},{placement:"bottom"}]}},edge:{type:"cubic-vertical"},layout:{type:s,direction:"TB",nodeSep:40,rankSep:140,getVGap:()=>80,getHGap:()=>20}}:a==="horizontal"?{node:{style:{labelBackground:!0,labelPlacement:l=>r(l)?"right":"left",ports:[{placement:"left"},{placement:"right"}]}},edge:{type:"cubic-horizontal"},layout:{type:s,direction:"LR",nodeSep:40,rankSep:200,getVGap:()=>5,getHGap:()=>100}}:{node:{style:{labelBackground:!0}},edge:{type:"cubic-radial"},layout:{type:s,direction:"RL",radial:!0,nodeSep:40,rankSep:200,getVGap:()=>30,getHGap:()=>60},transforms:l=>[...l,"place-radial-labels"]}},cF=(0,ct.forwardRef)((s,r)=>{var l=s,{children:a}=l,n=rn(l,["children"]);const u=(0,ct.useMemo)(()=>{const g=n,{data:h,defaultExpandLevel:f,direction:d="horizontal",compact:v=!1}=g,p=rn(g,["data","defaultExpandLevel","direction","compact"]);return ri(ka,oF,{data:pf(h,f)},lF({direction:d,compact:v}),p)},[n]);return ct.createElement(Oa,hr($e({},u),{ref:r}),a)});function me(a,n){const r=n?typeof n=="function"?n(a):(0,Xe.get)(a,`data.${n}`,a.id):a.id;return String(r)}function ii(a,n=[0,0],r={fontSize:16,fontFamily:"PingFang SC"},s=0,l=1/0){const u=BB(a,r),h=j2(a,r)+4,f=l===1/0?1:Math.ceil(h/l),[d,v]=n;return[Math.max(s,Math.min(l,h))+d,v+u+u*1.5*(f-1)]}const uF={node:{style:{size:10,labelPlacement:"center"}},edge:{type:"polyline"},layout:{type:"fishbone",hGap:40,vGap:60},animation:!1},U2="system-ui, sans-serif",hF=(a,n)=>n===0?ii(a,[80,48],{fontSize:24,fontWeight:600,fontFamily:U2}):n===1?ii(a,[80,30],{fontSize:18,fontFamily:U2}):[2,30],fF=a=>{var r;const n=a.depth;return n===0?"#EFF0F0":n===1?((r=a.style)==null?void 0:r.color)||"#EFF0F0":"transparent"};function dF({type:a,labelField:n}){const r={node:{type:"rect",style:{fill:s=>fF(s),labelFill:s=>s.depth===1?"#fff":"#262626",labelFillOpacity:1,labelFontSize:s=>s.depth===0?24:s.depth===1?18:16,labelFontWeight:s=>s.depth===0?600:400,labelLineHeight:s=>s.depth===0?26:s.depth===1?20:18,labelText:s=>me(s,n),radius:8,size:s=>hF(s.id,s.depth)}},edge:{type:"polyline",style:{lineWidth:3,stroke:function(s){const l=this.getNodeData(s.target);return(0,Xe.get)(l,"style.color","#99ADD1")}}},transforms:s=>[...s,{type:"assign-color-by-branch",key:"assign-color-by-branch"},{type:"arrange-edge-z-index",key:"arrange-edge-z-index"}]};return r.layout||(r.layout={}),a==="decision"?(r.node.style.labelPlacement=s=>s.depth===0||s.depth===1?"center":"right",Object.assign(r.layout,{direction:"LR"})):a==="cause"&&(r.node.style.labelPlacement=s=>s.depth===0||s.depth===1?"center":"left",Object.assign(r.layout,{direction:"RL"})),r}const vF=(0,ct.forwardRef)((s,r)=>{var l=s,{children:a}=l,n=rn(l,["children"]);const g=n,{data:u,defaultExpandLevel:h,type:f="cause",labelField:d}=g,v=rn(g,["data","defaultExpandLevel","type","labelField"]),p=(0,ct.useMemo)(()=>ri(ka,uF,{data:pf(u)},dF({type:f,labelField:d}),v),[n]);return ct.createElement(Oa,hr($e({},p),{ref:r}),a)}),{TextNode:pF}=dt,gF={node:{type:"react",state:{active:{halo:!1},selected:{halo:!1}}},edge:{type:"cubic-horizontal",style:{strokeOpacity:.5},state:{active:{strokeOpacity:1}}},layout:{type:"dagre",rankdir:"LR",animation:!1},transforms:["translate-react-node-origin"]},yF=({labelField:a})=>({node:{style:{component:r=>{const s=me(r,a);return ct.createElement(pF,{type:"filled",text:s})},size:[100,40],ports:[{placement:"left"},{placement:"right"}]}}}),mF=(0,ct.forwardRef)((s,r)=>{var l=s,{children:a}=l,n=rn(l,["children"]);const d=n,{labelField:u}=d,h=rn(d,["labelField"]),f=(0,ct.useMemo)(()=>ri(ka,gF,yF({labelField:u}),h),[n]);return ct.createElement(Oa,hr($e({},f),{ref:r}),a)}),{TextNode:bF}=dt,xF={node:{type:"react",state:{active:{halo:!1},selected:{halo:!1}}},edge:{type:"polyline",style:{lineWidth:2,endArrow:!0,radius:8,router:{type:"orth"}}},layout:{type:"dagre",animation:!1},transforms:["translate-react-node-origin"]},EF=({direction:a,labelField:n})=>({node:{style:{component:s=>{const l=me(s,n);return ct.createElement(bF,{type:"filled",text:l})},size:[100,40],ports:a==="vertical"?[{placement:"top"},{placement:"bottom"}]:[{placement:"left"},{placement:"right"}]}},layout:{type:"dagre",rankdir:a==="vertical"?"TB":"LR"}}),wF=(0,ct.forwardRef)((s,r)=>{var l=s,{children:a}=l,n=rn(l,["children"]);const u=(0,ct.useMemo)(()=>{const v=n,{direction:h="horizontal",labelField:f}=v,d=rn(v,["direction","labelField"]);return ri(ka,xF,EF({direction:h,labelField:f}),d)},[n]);return ct.createElement(Oa,hr($e({},u),{ref:r}),a)}),SF=(0,Xe.memoize)((a,n)=>{if(!n)return"center";const r=Fe(a)[0];return Fe(n)[0]>r?"left":"right"},(a,n)=>n?[Fe(a),Fe(n)].flat().join("-"):"center"),Oi=(a,n)=>{const r=a.getParentData(V(n),"tree");return SF(n,r)},MW=a=>!a.children||a.children.length===0,ki=(0,Xe.memoize)((a,n,r,s=0)=>{const l={fontWeight:s===0?600:400,fontSize:s===0?24:16},h=ii(a,s===0?[64,30]:[12,12],l,n,r);return{font:l,size:h}}),_a=(0,Xe.memoize)((a,n,r,s=0)=>{const l={fontWeight:s===0||s===1?600:400,fontSize:s===0?24:16},h=ii(a,s===0?[64,30]:[36,24],l,n,r);return{font:l,size:h}}),{ArrowCountIcon:MF}=xt,{TextNode:lp}=dt,TF={node:{type:"react",state:{active:{halo:!1},selected:{halo:!1}}},edge:{type:"indented",style:{lineWidth:3}},transforms:a=>[...a,{type:"collapse-expand-react-node",key:"collapse-expand-react-node",enable:!1,trigger:"icon",iconRender:function(n,r){return ct.createElement(MF,{graph:this,data:r,isCollapsed:n})}}],layout:{type:"indented",direction:"LR",indent:a=>CF(a,20),getVGap:()=>14,preLayout:!1},animation:{duration:500}},CF=(a,n)=>{if(a.depth===0)return 0;let r=n,s=a.parent;for(;s;)r+=s.width/2,s=s.parent;return r/a.depth},Y2=(a,n)=>{const r=Oi(a,n);return r==="left"?"right":r==="center"?"center":"left"},OF=({type:a,nodeMinWidth:n,nodeMaxWidth:r,direction:s,labelField:l})=>{let u={};const h=n||0,f=r||300;if(a==="boxed")u={node:{style:{component:function(d){var b;const v=d.depth,p=(b=d.style)==null?void 0:b.color,g=me(d,l),{font:y}=_a(g,h,f,v),m={type:v===0||v===1?"filled":"outlined",text:g,color:v===0?"#f1f4f5":p,maxWidth:f,font:y,style:$e({textAlign:Y2(this,d)},v===0?{color:"#252525"}:{})};return ct.createElement(lp,$e({},m))},size:d=>{const v=me(d,l);return _a(v,h,f,d.depth).size}}},edge:{style:{stroke:function(d){const v=this.getNodeData(d.source);return(0,Xe.get)(v,"style.color","#99ADD1")},radius:16}},transforms:d=>[...d,{type:"assign-color-by-branch",key:"assign-color-by-branch"}],layout:{type:"indented",getWidth:d=>{const v=me(d,l),[p]=_a(v,h,f,d.depth).size;return p},getHeight:d=>{const v=me(d,l),[,p]=_a(v,h,f,d.depth).size;return p}}};else if(a==="linear")u={node:{style:{component:function(d){var b;const v=d.depth,p=(b=d.style)==null?void 0:b.color,g=me(d,l),{font:y}=ki(g,h,f,v),m={text:g,color:p,maxWidth:f,font:y};return Object.assign(m,v===0?{type:"filled",color:"#f1f4f5",style:{color:"#252525"}}:{type:"underlined",style:{textAlign:Y2(this,d)}}),ct.createElement(lp,$e({},m))},size:d=>{const v=me(d,l);return ki(v,h,f,d.depth).size},ports:function(d){const v=Oi(this,d);return v==="left"?[{placement:"bottom"},{placement:"bottom-right"}]:v==="center"?[{placement:"bottom"}]:[{placement:"bottom"},{placement:"bottom-left"}]}}},edge:{style:{stroke:function(d){const v=this.getNodeData(d.target);return(0,Xe.get)(v,"style.color","#99ADD1")},radius:24}},layout:{type:"indented",getWidth:d=>{const v=me(d,l),[p]=ki(v,h,f,d.depth).size;return p},getHeight:d=>{const v=me(d,l),[,p]=ki(v,h,f,d.depth).size;return p},getVGap:()=>12},transforms:d=>[...d,{type:"assign-color-by-branch",key:"assign-color-by-branch"},{type:"arrange-edge-z-index",key:"arrange-edge-z-index"}]};else{const d=[24,16];u={node:{style:{component:v=>{const p=me(v,l);return ct.createElement(lp,{type:"filled",text:p})},size:v=>{const p=me(v,l);return ii(p,d)}}},layout:{type:"indented",getWidth:v=>{const p=me(v,l),[g]=ii(p,d);return g},getHeight:v=>{const p=me(v,l),[,g]=ii(p,d);return g}}}}return s&&(u.layout||(u.layout={}),Object.assign(u.layout,{direction:s==="alternate"?"H":s==="left"?"RL":"LR"})),u},kF=(0,ct.forwardRef)((s,r)=>{var l=s,{children:a}=l,n=rn(l,["children"]);const b=n,{data:u,defaultExpandLevel:h,type:f="default",nodeMinWidth:d,nodeMaxWidth:v,direction:p="right",labelField:g}=b,y=rn(b,["data","defaultExpandLevel","type","nodeMinWidth","nodeMaxWidth","direction","labelField"]),m=(0,ct.useMemo)(()=>ri(ka,TF,{data:pf(u,h)},OF({type:f,nodeMinWidth:d,nodeMaxWidth:v,direction:p,labelField:g}),y),[n]);return ct.createElement(Oa,hr($e({},m),{ref:r}),a)}),{ArrowCountIcon:_F}=xt,{TextNode:cp}=dt,PF={node:{type:"react",state:{active:{halo:!1},selected:{halo:!1}}},edge:{type:"cubic-horizontal",style:{lineWidth:3}},transforms:a=>[...a,{type:"collapse-expand-react-node",key:"collapse-expand-react-node",enable:!1,trigger:"icon",iconRender:function(n,r){const s=Oi(this,r);return ct.createElement(_F,{graph:this,data:r,isCollapsed:n,placement:s==="left"?"left":"right"})},iconPlacement:function(n){return Oi(this,n)==="left"?"left":"right"}}],layout:{type:"mindmap",direction:"H",preLayout:!1,getWidth:()=>120,getHGap:()=>64},animation:{duration:500}};function AF({type:a,direction:n,nodeMinWidth:r,nodeMaxWidth:s,labelField:l}){let u={};if(a==="boxed"){const h=r||120,f=s||300;u={node:{style:{component:d=>{var b;const v=d.depth,p=(b=d.style)==null?void 0:b.color,g=me(d,l),{font:y}=_a(g,h,f,v),m={text:g,color:p,maxWidth:f,font:y};return Object.assign(m,v===0?{type:"filled",color:"#f1f4f5",style:{color:"#252525"}}:v===1?{type:"filled"}:{type:"outlined"}),ct.createElement(cp,$e({},m))},size:d=>{const v=me(d,l);return _a(v,h,f,d.depth).size},dx:function(d){const v=Oi(this,d),p=me(d,l),[g]=_a(p,h,f,d.depth).size;return v==="left"?-g:v==="center"?-g/2:0},ports:[{placement:"left"},{placement:"right"}]}},edge:{style:{stroke:function(d){const v=this.getNodeData(d.source);return(0,Xe.get)(v,"style.color","#99ADD1")}}},transforms:d=>[...d,{type:"assign-color-by-branch",key:"assign-color-by-branch"}],layout:{type:"mindmap",getHeight:d=>{const v=me(d,l),[,p]=_a(v,h,f,d.depth).size;return p},getVGap:()=>14}}}else if(a==="linear"){const h=r||0,f=s||300;u={node:{style:{component:function(d){var x;const v=Oi(this,d),p=d.depth,g=(x=d.style)==null?void 0:x.color,y=me(d,l),{font:m}=ki(y,h,f,p),b={text:y,color:g,maxWidth:f,font:m};return Object.assign(b,p===0?{type:"filled",color:"#f1f4f5",style:{color:"#252525"}}:{type:"underlined",style:v==="left"?{textAlign:"right"}:v==="center"?{textAlign:"center"}:{}}),ct.createElement(cp,$e({},b))},size:d=>{const v=me(d,l);return ki(v,h,f,d.depth).size},dx:function(d){const v=Oi(this,d),p=me(d,l),[g]=ki(p,h,f,d.depth).size;return v==="left"?-g:v==="center"?-g/2:0},dy:function(d){const v=me(d,l),[,p]=ki(v,h,f,d.depth).size;return p/2},ports:function(d){return Oi(this,d)==="center"?[{placement:"left"},{placement:"right"}]:[{placement:"left-bottom"},{placement:"right-bottom"}]}}},edge:{style:{stroke:function(d){const v=this.getNodeData(d.target);return(0,Xe.get)(v,"style.color","#99ADD1")}}},layout:{type:"mindmap",getHeight:d=>{const v=me(d,l),[,p]=ki(v,h,f,d.depth).size;return p},getVGap:()=>12},transforms:d=>[...d.filter(v=>v.key!=="collapse-expand-react-node"),{type:"assign-color-by-branch",key:"assign-color-by-branch"},hr($e({},d.find(v=>v.key==="collapse-expand-react-node")),{iconOffsetY:v=>{if(v.depth===0)return 0;const p=me(v,l),[,g]=ki(p,h,f,v.depth).size;return g/2}})]}}else{const h=[24,16];u={node:{style:{component:f=>{const d=me(f,l);return ct.createElement(cp,{type:"filled",text:d})},size:f=>{const d=me(f,l);return ii(d,h)},dx:function(f){const d=Oi(this,f),v=me(f,l),[p]=ii(v,h);return d==="left"?-p:d==="center"?-p/2:0},ports:[{placement:"left"},{placement:"right"}]}},layout:{type:"mindmap",getHeight:f=>{const d=me(f,l),[,v]=ii(d,h);return v}}}}return n&&(u.layout||(u.layout={}),u.layout.direction=n==="alternate"?"H":n==="left"?"RL":"LR"),u}const NF=(0,ct.forwardRef)((s,r)=>{var l=s,{children:a}=l,n=rn(l,["children"]);const u=(0,ct.useMemo)(()=>{const x=n,{data:h,type:f="default",nodeMinWidth:d,nodeMaxWidth:v,direction:p="alternate",labelField:g,defaultExpandLevel:y}=x,m=rn(x,["data","type","nodeMinWidth","nodeMaxWidth","direction","labelField","defaultExpandLevel"]);return ri(ka,PF,{data:pf(h,y)},AF({type:f,nodeMinWidth:d,nodeMaxWidth:v,direction:p,labelField:g}),m)},[n]);return ct.createElement(Oa,hr($e({},u),{ref:r}),a)}),up=32,RF={node:{type:"circle"},layout:{type:"d3-force",link:{distance:up*4},collide:{radius:up},manyBody:{strength:-up*22},x:{},y:{}}},LF=(0,ct.forwardRef)((s,r)=>{var l=s,{children:a}=l,n=rn(l,["children"]);const u=(0,ct.useMemo)(()=>ri(ka,RF,n),[n]);return ct.createElement(Oa,hr($e({},u),{ref:r}),a)}),{TextNode:DF}=dt,IF={node:{type:"react",state:{active:{halo:!1},selected:{halo:!1}}},edge:{type:"polyline",style:{lineWidth:2,router:{type:"orth"}}},layout:{type:"dagre",animation:!1},transforms:["translate-react-node-origin"]};function BF({direction:a,labelField:n}){return{node:{style:{component:s=>{const l=me(s,n);return ct.createElement(DF,{type:"filled",text:l})},size:[100,40],ports:a==="vertical"?[{placement:"top"},{placement:"bottom"}]:[{placement:"left"},{placement:"right"}]}},transforms:s=>[...s,{type:"collapse-expand-react-node",key:"collapse-expand-react-node",iconPlacement:a==="vertical"?"bottom":"right",enable:!1,refreshLayout:!0}],layout:{type:"dagre",rankdir:a==="vertical"?"TB":"LR"}}}const FF=(0,ct.forwardRef)((s,r)=>{var l=s,{children:a}=l,n=rn(l,["children"]);const u=(0,ct.useMemo)(()=>{const p=n,{direction:h="vertical",labelField:f}=p,d=rn(p,["direction","labelField"]);return ri(ka,IF,BF({direction:h,labelField:f}),d)},[n]);return ct.createElement(Oa,hr($e({},u),{ref:r}),a)})},81746:function(ee){(function(Y,Q){ee.exports=Q()})(typeof self!="undefined"?self:this,function(){return function(Ot){var Y={};function Q(wt){if(Y[wt])return Y[wt].exports;var yt=Y[wt]={i:wt,l:!1,exports:{}};return Ot[wt].call(yt.exports,yt,yt.exports,Q),yt.l=!0,yt.exports}return Q.m=Ot,Q.c=Y,Q.d=function(wt,yt,xt){Q.o(wt,yt)||Object.defineProperty(wt,yt,{configurable:!1,enumerable:!0,get:xt})},Q.n=function(wt){var yt=wt&&wt.__esModule?function(){return wt.default}:function(){return wt};return Q.d(yt,"a",yt),yt},Q.o=function(wt,yt){return Object.prototype.hasOwnProperty.call(wt,yt)},Q.p="",Q(Q.s=5)}([function(Ot,Y){function Q(wt,yt,xt,dt){return dt===void 0&&(dt="height"),xt==="center"?(wt[dt]+yt[dt])/2:wt.height}Ot.exports={assign:Object.assign,getHeight:Q}},function(Ot,Y,Q){var wt=Q(3),yt=function(){function xt($,I){I===void 0&&(I={});var D=this;D.options=I,D.rootNode=wt($,I)}var dt=xt.prototype;return dt.execute=function(){throw new Error("please override this method")},xt}();Ot.exports=yt},function(Ot,Y,Q){var wt=Q(4),yt=["LR","RL","TB","BT","H","V"],xt=["LR","RL","H"],dt=function(B){return xt.indexOf(B)>-1},$=yt[0];Ot.exports=function(D,B,G){var F=B.direction||$;if(B.isHorizontal=dt(F),F&&yt.indexOf(F)===-1)throw new TypeError("Invalid direction: "+F);if(F===yt[0])G(D,B);else if(F===yt[1])G(D,B),D.right2left();else if(F===yt[2])G(D,B);else if(F===yt[3])G(D,B),D.bottom2top();else if(F===yt[4]||F===yt[5]){var W=wt(D,B),ut=W.left,q=W.right;G(ut,B),G(q,B),B.isHorizontal?ut.right2left():ut.bottom2top(),q.translate(ut.x-q.x,ut.y-q.y),D.x=ut.x,D.y=q.y;var it=D.getBoundingBox();B.isHorizontal?it.top<0&&D.translate(0,-it.top):it.left<0&&D.translate(-it.left,0)}var ot=B.fixedRoot;return ot===void 0&&(ot=!0),ot&&D.translate(-(D.x+D.width/2+D.hgap),-(D.y+D.height/2+D.vgap)),I(D,B),D};function I(D,B){if(B.radial){var G=B.isHorizontal?["x","y"]:["y","x"],F=G[0],W=G[1],ut={x:1/0,y:1/0},q={x:-1/0,y:-1/0},it=0;D.DFTraverse(function(Rt){it++;var Vt=Rt.x,ue=Rt.y;ut.x=Math.min(ut.x,Vt),ut.y=Math.min(ut.y,ue),q.x=Math.max(q.x,Vt),q.y=Math.max(q.y,ue)});var ot=q[W]-ut[W];if(ot===0)return;var gt=Math.PI*2/it;D.DFTraverse(function(Rt){var Vt=(Rt[W]-ut[W])/ot*(Math.PI*2-gt)+gt,ue=Rt[F]-D[F];Rt.x=Math.cos(Vt)*ue,Rt.y=Math.sin(Vt)*ue})}}},function(Ot,Y,Q){var wt=Q(0),yt=18,xt=yt*2,dt=yt,$={getId:function(G){return G.id||G.name},getPreH:function(G){return G.preH||0},getPreV:function(G){return G.preV||0},getHGap:function(G){return G.hgap||dt},getVGap:function(G){return G.vgap||dt},getChildren:function(G){return G.children},getHeight:function(G){return G.height||xt},getWidth:function(G){var F=G.label||" ";return G.width||F.split("").length*yt}};function I(B,G){var F=this;if(F.vgap=F.hgap=0,B instanceof I)return B;F.data=B;var W=G.getHGap(B),ut=G.getVGap(B);return F.preH=G.getPreH(B),F.preV=G.getPreV(B),F.width=G.getWidth(B),F.height=G.getHeight(B),F.width+=F.preH,F.height+=F.preV,F.id=G.getId(B),F.x=F.y=0,F.depth=0,F.children||(F.children=[]),F.addGap(W,ut),F}wt.assign(I.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(G,F){var W=this;W.hgap+=G,W.vgap+=F,W.width+=2*G,W.height+=2*F},eachNode:function(G){for(var F=this,W=[F],ut;ut=W.shift();)G(ut),W=ut.children.concat(W)},DFTraverse:function(G){this.eachNode(G)},BFTraverse:function(G){for(var F=this,W=[F],ut;ut=W.shift();)G(ut),W=W.concat(ut.children)},getBoundingBox:function(){var G={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(F){G.left=Math.min(G.left,F.x),G.top=Math.min(G.top,F.y),G.width=Math.max(G.width,F.x+F.width),G.height=Math.max(G.height,F.y+F.height)}),G},translate:function(G,F){G===void 0&&(G=0),F===void 0&&(F=0),this.eachNode(function(W){W.x+=G,W.y+=F,W.x+=W.preH,W.y+=W.preV})},right2left:function(){var G=this,F=G.getBoundingBox();G.eachNode(function(W){W.x=W.x-(W.x-F.left)*2-W.width}),G.translate(F.width,0)},bottom2top:function(){var G=this,F=G.getBoundingBox();G.eachNode(function(W){W.y=W.y-(W.y-F.top)*2-W.height}),G.translate(0,F.height)}});function D(B,G,F){G===void 0&&(G={}),G=wt.assign({},$,G);var W=new I(B,G),ut=[W],q;if(!F&&!B.collapsed){for(;q=ut.shift();)if(!q.data.collapsed){var it=G.getChildren(q.data),ot=it?it.length:0;if(q.children=new Array(ot),it&&ot)for(var gt=0;gt<ot;gt++){var Rt=new I(it[gt],G);q.children[gt]=Rt,ut.push(Rt),Rt.parent=q,Rt.depth=q.depth+1}}}return W}Ot.exports=D},function(Ot,Y,Q){var wt=Q(3);Ot.exports=function(yt,xt){for(var dt=wt(yt.data,xt,!0),$=wt(yt.data,xt,!0),I=yt.children.length,D=Math.round(I/2),B=xt.getSide||function(ut,q){return q<D?"right":"left"},G=0;G<I;G++){var F=yt.children[G],W=B(F,G);W==="right"?$.children.push(F):dt.children.push(F)}return dt.eachNode(function(ut){ut.isRoot()||(ut.side="left")}),$.eachNode(function(ut){ut.isRoot()||(ut.side="right")}),{left:dt,right:$}}},function(Ot,Y,Q){var wt={compactBox:Q(6),dendrogram:Q(8),indented:Q(10),mindmap:Q(12)};Ot.exports=wt},function(Ot,Y,Q){function wt(F,W){F.prototype=Object.create(W.prototype),F.prototype.constructor=F,yt(F,W)}function yt(F,W){return yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ut,q){return ut.__proto__=q,ut},yt(F,W)}var xt=Q(1),dt=Q(7),$=Q(2),I=Q(0),D=function(F){function W(){return F.apply(this,arguments)||this}wt(W,F);var ut=W.prototype;return ut.execute=function(){var it=this;return $(it.rootNode,it.options,dt)},W}(xt),B={};function G(F,W){return W=I.assign({},B,W),new D(F,W).execute()}Ot.exports=G},function(Ot,Y){function Q(I,D,B,G){G===void 0&&(G=[]);var F=this;F.w=I||0,F.h=D||0,F.y=B||0,F.x=0,F.c=G||[],F.cs=G.length,F.prelim=0,F.mod=0,F.shift=0,F.change=0,F.tl=null,F.tr=null,F.el=null,F.er=null,F.msel=0,F.mser=0}Q.fromNode=function(I,D){if(!I)return null;var B=[];return I.children.forEach(function(G){B.push(Q.fromNode(G,D))}),D?new Q(I.height,I.width,I.x,B):new Q(I.width,I.height,I.y,B)};function wt(I,D,B){B?I.y+=D:I.x+=D,I.children.forEach(function(G){wt(G,D,B)})}function yt(I,D){var B=D?I.y:I.x;return I.children.forEach(function(G){B=Math.min(yt(G,D),B)}),B}function xt(I,D){var B=yt(I,D);wt(I,-B,D)}function dt(I,D,B){B?D.y=I.x:D.x=I.x,I.c.forEach(function(G,F){dt(G,D.children[F],B)})}function $(I,D,B){B===void 0&&(B=0),D?(I.x=B,B+=I.width):(I.y=B,B+=I.height),I.children.forEach(function(G){$(G,D,B)})}Ot.exports=function(I,D){D===void 0&&(D={});var B=D.isHorizontal;function G(H){if(H.cs===0){F(H);return}G(H.c[0]);for(var j=ne(ot(H.c[0].el),0,null),et=1;et<H.cs;++et){G(H.c[et]);var ft=ot(H.c[et].er);W(H,et,j),j=ne(ft,et,j)}Vt(H),F(H)}function F(H){H.cs===0?(H.el=H,H.er=H,H.msel=H.mser=0):(H.el=H.c[0].el,H.msel=H.c[0].msel,H.er=H.c[H.cs-1].er,H.mser=H.c[H.cs-1].mser)}function W(H,j,et){for(var ft=H.c[j-1],vt=ft.mod,Et=H.c[j],Dt=Et.mod;ft!==null&&Et!==null;){ot(ft)>et.low&&(et=et.nxt);var Jt=vt+ft.prelim+ft.w-(Dt+Et.prelim);Jt>0&&(Dt+=Jt,ut(H,j,et.index,Jt));var Ht=ot(ft),xe=ot(Et);Ht<=xe&&(ft=it(ft),ft!==null&&(vt+=ft.mod)),Ht>=xe&&(Et=q(Et),Et!==null&&(Dt+=Et.mod))}!ft&&Et?gt(H,j,Et,Dt):ft&&!Et&&Rt(H,j,ft,vt)}function ut(H,j,et,ft){H.c[j].mod+=ft,H.c[j].msel+=ft,H.c[j].mser+=ft,Lt(H,j,et,ft)}function q(H){return H.cs===0?H.tl:H.c[0]}function it(H){return H.cs===0?H.tr:H.c[H.cs-1]}function ot(H){return H.y+H.h}function gt(H,j,et,ft){var vt=H.c[0].el;vt.tl=et;var Et=ft-et.mod-H.c[0].msel;vt.mod+=Et,vt.prelim-=Et,H.c[0].el=H.c[j].el,H.c[0].msel=H.c[j].msel}function Rt(H,j,et,ft){var vt=H.c[j].er;vt.tr=et;var Et=ft-et.mod-H.c[j].mser;vt.mod+=Et,vt.prelim-=Et,H.c[j].er=H.c[j-1].er,H.c[j].mser=H.c[j-1].mser}function Vt(H){H.prelim=(H.c[0].prelim+H.c[0].mod+H.c[H.cs-1].mod+H.c[H.cs-1].prelim+H.c[H.cs-1].w)/2-H.w/2}function ue(H,j){j+=H.mod,H.x=H.prelim+j,Bt(H);for(var et=0;et<H.cs;et++)ue(H.c[et],j)}function Lt(H,j,et,ft){if(et!==j-1){var vt=j-et;H.c[et+1].shift+=ft/vt,H.c[j].shift-=ft/vt,H.c[j].change-=ft-ft/vt}}function Bt(H){for(var j=0,et=0,ft=0;ft<H.cs;ft++)j+=H.c[ft].shift,et+=j+H.c[ft].change,H.c[ft].mod+=et}function ne(H,j,et){for(;et!==null&&H>=et.low;)et=et.nxt;return{low:H,index:j,nxt:et}}$(I,B);var Mt=Q.fromNode(I,B);return G(Mt),ue(Mt,0),dt(Mt,I,B),xt(I,B),I}},function(Ot,Y,Q){function wt(F,W){F.prototype=Object.create(W.prototype),F.prototype.constructor=F,yt(F,W)}function yt(F,W){return yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ut,q){return ut.__proto__=q,ut},yt(F,W)}var xt=Q(1),dt=Q(9),$=Q(2),I=Q(0),D=function(F){function W(){return F.apply(this,arguments)||this}wt(W,F);var ut=W.prototype;return ut.execute=function(){var it=this;return it.rootNode.width=0,$(it.rootNode,it.options,dt)},W}(xt),B={};function G(F,W){return W=I.assign({},B,W),new D(F,W).execute()}Ot.exports=G},function(Ot,Y,Q){var wt=Q(0);function yt($,I){$===void 0&&($=0),I===void 0&&(I=[]);var D=this;D.x=D.y=0,D.leftChild=D.rightChild=null,D.height=0,D.children=I}var xt={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function dt($,I,D){D?(I.x=$.x,I.y=$.y):(I.x=$.y,I.y=$.x),$.children.forEach(function(B,G){dt(B,I.children[G],D)})}Ot.exports=function($,I){I===void 0&&(I={}),I=wt.assign({},xt,I);var D=0;function B(q){if(!q)return null;q.width=0,q.depth&&q.depth>D&&(D=q.depth);var it=q.children,ot=it.length,gt=new yt(q.height,[]);return it.forEach(function(Rt,Vt){var ue=B(Rt);gt.children.push(ue),Vt===0&&(gt.leftChild=ue),Vt===ot-1&&(gt.rightChild=ue)}),gt.originNode=q,gt.isLeaf=q.isLeaf(),gt}function G(q){if(q.isLeaf||q.children.length===0)q.drawingDepth=D;else{var it=q.children.map(function(gt){return G(gt)}),ot=Math.min.apply(null,it);q.drawingDepth=ot-1}return q.drawingDepth}var F;function W(q){q.x=q.drawingDepth*I.rankSep,q.isLeaf?(q.y=0,F&&(q.y=F.y+F.height+I.nodeSep,q.originNode.parent!==F.originNode.parent&&(q.y+=I.subTreeSep)),F=q):(q.children.forEach(function(it){W(it)}),q.y=(q.leftChild.y+q.rightChild.y)/2)}var ut=B($);return G(ut),W(ut),dt(ut,$,I.isHorizontal),$}},function(Ot,Y,Q){function wt(ut,q){ut.prototype=Object.create(q.prototype),ut.prototype.constructor=ut,yt(ut,q)}function yt(ut,q){return yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(it,ot){return it.__proto__=ot,it},yt(ut,q)}var xt=Q(1),dt=Q(11),$=Q(4),I=Q(0),D=["LR","RL","H"],B=D[0],G=function(ut){function q(){return ut.apply(this,arguments)||this}wt(q,ut);var it=q.prototype;return it.execute=function(){var gt=this,Rt=gt.options,Vt=gt.rootNode;Rt.isHorizontal=!0;var ue=Rt.indent,Lt=ue===void 0?20:ue,Bt=Rt.dropCap,ne=Bt===void 0?!0:Bt,Mt=Rt.direction,H=Mt===void 0?B:Mt,j=Rt.align;if(H&&D.indexOf(H)===-1)throw new TypeError("Invalid direction: "+H);if(H===D[0])dt(Vt,Lt,ne,j);else if(H===D[1])dt(Vt,Lt,ne,j),Vt.right2left();else if(H===D[2]){var et=$(Vt,Rt),ft=et.left,vt=et.right;dt(ft,Lt,ne,j),ft.right2left(),dt(vt,Lt,ne,j);var Et=ft.getBoundingBox();vt.translate(Et.width,0),Vt.x=vt.x-Vt.width/2}return Vt},q}(xt),F={};function W(ut,q){return q=I.assign({},F,q),new G(ut,q).execute()}Ot.exports=W},function(Ot,Y,Q){var wt=Q(0);function yt(xt,dt,$,I,D){var B=(typeof $=="function"?$(xt):$)*xt.depth;if(!I)try{if(xt.id===xt.parent.children[0].id){xt.x+=B,xt.y=dt?dt.y:0;return}}catch(W){}if(xt.x+=B,dt){if(xt.y=dt.y+wt.getHeight(dt,xt,D),dt.parent&&xt.parent.id!==dt.parent.id){var G=dt.parent,F=G.y+wt.getHeight(G,xt,D);xt.y=F>xt.y?F:xt.y}}else xt.y=0}Ot.exports=function(xt,dt,$,I){var D=null;xt.eachNode(function(B){yt(B,D,dt,$,I),D=B})}},function(Ot,Y,Q){function wt(F,W){F.prototype=Object.create(W.prototype),F.prototype.constructor=F,yt(F,W)}function yt(F,W){return yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ut,q){return ut.__proto__=q,ut},yt(F,W)}var xt=Q(1),dt=Q(13),$=Q(2),I=Q(0),D=function(F){function W(){return F.apply(this,arguments)||this}wt(W,F);var ut=W.prototype;return ut.execute=function(){var it=this;return $(it.rootNode,it.options,dt)},W}(xt),B={};function G(F,W){return W=I.assign({},B,W),new D(F,W).execute()}Ot.exports=G},function(Ot,Y,Q){var wt=Q(0);function yt($,I){var D=0;return $.children.length?$.children.forEach(function(B){D+=yt(B,I)}):D=$.height,$._subTreeSep=I.getSubTreeSep($.data),$.totalHeight=Math.max($.height,D)+2*$._subTreeSep,$.totalHeight}function xt($){var I=$.children,D=I.length;if(D){I.forEach(function(q){xt(q)});var B=I[0],G=I[D-1],F=G.y-B.y+G.height,W=0;if(I.forEach(function(q){W+=q.totalHeight}),F>$.height)$.y=B.y+F/2-$.height/2;else if(I.length!==1||$.height>W){var ut=$.y+($.height-F)/2-B.y;I.forEach(function(q){q.translate(0,ut)})}else $.y=(B.y+B.height/2+G.y+G.height/2)/2-$.height/2}}var dt={getSubTreeSep:function(){return 0}};Ot.exports=function($,I){I===void 0&&(I={}),I=wt.assign({},dt,I),$.parent={x:0,width:0,height:0,y:0},$.BFTraverse(function(D){D.x=D.parent.x+D.parent.width}),$.parent=null,yt($,I),$.startY=0,$.y=$.totalHeight/2-$.height/2,$.eachNode(function(D){var B=D.children,G=B.length;if(G){var F=B[0];if(F.startY=D.startY+D._subTreeSep,G===1)F.y=D.y+D.height/2-F.height/2;else{F.y=F.startY+F.totalHeight/2-F.height/2;for(var W=1;W<G;W++){var ut=B[W];ut.startY=B[W-1].startY+B[W-1].totalHeight,ut.y=ut.startY+ut.totalHeight/2-ut.height/2}}}}),xt($)}}])})},26367:function(ee,Ot,Y){"use strict";Y.r(Ot),Y.d(Ot,{Pagination:function(){return ne},ReadingProgress:function(){return W},Scrollspy:function(){return Rt},usePagination:function(){return Bt},useReadingProgress:function(){return F},useScrollspy:function(){return gt}});var Q=Y(67294),wt=function(H){var j=null,et=function(vt){return function(){H.apply(void 0,vt)}};return function(){j&&cancelAnimationFrame(j);for(var ft=arguments.length,vt=new Array(ft),Et=0;Et<ft;Et++)vt[Et]=arguments[Et];j=requestAnimationFrame(et(vt))}};function yt(Mt,H){for(var j=0;j<H.length;j++){var et=H[j];et.enumerable=et.enumerable||!1,et.configurable=!0,"value"in et&&(et.writable=!0),Object.defineProperty(Mt,et.key,et)}}function xt(Mt,H,j){return H&&yt(Mt.prototype,H),j&&yt(Mt,j),Mt}function dt(Mt,H){Mt.prototype=Object.create(H.prototype),Mt.prototype.constructor=Mt,$(Mt,H)}function $(Mt,H){return $=Object.setPrototypeOf||function(et,ft){return et.__proto__=ft,et},$(Mt,H)}var I=function(){},D=function(Mt){dt(H,Mt);function H(){var j;return j=Mt.apply(this,arguments)||this,j.measureWrapperHeight=function(){var et=document.body.getBoundingClientRect().height||0;return Math.round(et-j.getViewportHeight())},j.getViewportHeight=function(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)},j.getProgress=function(){var et=window.pageYOffset||document.documentElement.scrollTop;return Math.round(et/j.measureWrapperHeight()*100)},j}return xt(H,[{key:"rootSelector",get:function(){return window}}]),H}(I),B=function(Mt){dt(H,Mt);function H(j){var et,ft=j.rootEl,vt=j.targetEl;return et=Mt.call(this)||this,et.measureWrapperHeight=function(){var Et,Dt=((Et=et.targetEl)==null?void 0:Et.getBoundingClientRect().height)||0;return Math.round(Dt-et.getViewportHeight())},et.getViewportHeight=function(){var Et;return((Et=et.rootEl)==null?void 0:Et.clientHeight)||0},et.getProgress=function(){var Et,Dt=((Et=et.rootEl)==null?void 0:Et.scrollTop)||0;return Math.round(Dt/et.measureWrapperHeight()*100)},et.rootEl=document.querySelector(ft),et.targetEl=document.querySelector(vt),et}return xt(H,[{key:"rootSelector",get:function(){return this.rootEl}}]),H}(I),G=function(){function Mt(H){var j=this,et=H.rootEl,ft=H.targetEl;this.getViewportHeight=function(){return j.rp.getViewportHeight()},this.getProgress=function(){return j.rp.getProgress()},this.rp=typeof et=="string"&&typeof ft=="string"?new B({rootEl:et,targetEl:ft}):new D}return xt(Mt,[{key:"rootSelector",get:function(){return this.rp.rootSelector}}]),Mt}(),F=function(H){var j,et=(0,Q.useRef)();(0,Q.useEffect)(function(){et.current=new G({rootEl:H==null?void 0:H.rootEl,targetEl:H==null?void 0:H.targetEl})},[H]);var ft=(0,Q.useState)(((j=et.current)==null?void 0:j.getProgress())||0),vt=ft[0],Et=ft[1],Dt=(0,Q.useCallback)(function(){var Ht;Et(((Ht=et.current)==null?void 0:Ht.getProgress())||0)},[]),Jt=(0,Q.useCallback)(wt(function(){Dt()}),[]);return(0,Q.useEffect)(function(){var Ht;return(Ht=et.current)!=null&&Ht.rootSelector&&et.current.rootSelector.addEventListener("scroll",Jt),window.addEventListener("resize",Jt),Dt(),function(){var xe;(xe=et.current)!=null&&xe.rootSelector&&et.current.rootSelector.removeEventListener("scroll",Jt),window.removeEventListener("resize",Jt)}},[Dt,Jt]),{value:vt}},W=function(H){var j=H.targetEl,et=H.rootEl,ft=H.children,vt=F({targetEl:j,rootEl:et});return ft(vt)},ut=function(){},q=function(Mt){dt(H,Mt);function H(et){var ft;return ft=Mt.call(this)||this,ft.el=et,ft}var j=H.prototype;return j.isScrolledToBottom=function(){return this.scrollTop+this.outerHeight>=this.scrollHeight},j.registerScrollEvent=function(ft){this.el.addEventListener("scroll",ft)},j.unregisterScrollEvent=function(ft){this.el.removeEventListener("scroll",ft)},H.create=function(ft){var vt=document.querySelector(ft);if(!vt)throw new Error("element is not found.");return new H(vt)},xt(H,[{key:"top",get:function(){return this.el.getBoundingClientRect().top}},{key:"outerHeight",get:function(){return this.el.getBoundingClientRect().height}},{key:"scrollTop",get:function(){return this.el.scrollTop}},{key:"scrollHeight",get:function(){return this.el.scrollHeight}}]),H}(ut),it=function(Mt){dt(H,Mt);function H(){return Mt.apply(this,arguments)||this}var j=H.prototype;return j.isScrolledToBottom=function(){return this.scrollTop+this.outerHeight>=this.scrollHeight},j.registerScrollEvent=function(ft){document.addEventListener("scroll",ft)},j.unregisterScrollEvent=function(ft){document.removeEventListener("scroll",ft)},H.create=function(){return new H},xt(H,[{key:"outerHeight",get:function(){return window.innerHeight}},{key:"scrollTop",get:function(){return document.documentElement.scrollTop}},{key:"scrollHeight",get:function(){return document.documentElement.scrollHeight}}]),H}(ut),ot=function(){function Mt(){}return Mt.create=function(j){return j?q.create(j):it.create()},Mt}(),gt=function(H){var j=H.sectionRefs,et=H.rootSelector,ft=H.offset,vt=ft===void 0?0:ft,Et=(0,Q.useRef)(null);(0,Q.useEffect)(function(){Et.current=ot.create(et)},[et]);var Dt=(0,Q.useCallback)(function(){return Et.current?Et.current.isScrolledToBottom():!1},[Et]),Jt=(0,Q.useCallback)(function(Pn){if(!Et.current)return!1;var Tr=Et.current.scrollTop,Zr=Tr+Et.current.outerHeight,oi=Pn.getBoundingClientRect(),Ni=Et.current instanceof q?Tr+oi.top-Et.current.top+vt:Tr+oi.top+vt,Ki=Ni+oi.height;return[Ni<Zr,Ki>Tr].every(function(Qi){return Qi})},[Et,vt]),Ht=(0,Q.useCallback)(function(){return j.map(function(Pn){return Pn.current?Jt(Pn.current):!1})},[Jt,j]),xe=(0,Q.useState)([]),si=xe[0],go=xe[1],wc=(0,Q.useMemo)(function(){return si.findIndex(function(Pn){return Pn})},[si]),Ai=(0,Q.useCallback)(function(){var Pn=Dt()?[].concat(new Array(j.length-1).fill(!1).map(function(Tr){return Tr}),[!0]):Ht();go(Pn)},[Ht,Dt,j]);return(0,Q.useEffect)(function(){return Ai(),Et.current&&Et.current.registerScrollEvent(Ai),function(){Et.current&&Et.current.unregisterScrollEvent(Ai)}},[Ai]),{elementsStatusInViewport:si,currentElementIndexInViewport:wc}},Rt=function(H){var j=H.children,et=H.sectionRefs,ft=H.rootSelector,vt=H.offset,Et=gt({sectionRefs:et,rootSelector:ft,offset:vt}),Dt=Et.elementsStatusInViewport,Jt=Et.currentElementIndexInViewport;return j({elementsStatusInViewport:Dt,currentElementIndexInViewport:Jt})},Vt=function(H){var j=this,et=H.currentPage,ft=H.totalPage,vt=H.middlePagesSiblingCount,Et=vt===void 0?2:vt,Dt=H.edgePageCount,Jt=Dt===void 0?2:Dt;this.getAllPages=function(){return[].concat(Array(j.totalPage)).fill(1).map(function(Ht,xe){return xe+1})},this.getMiddlePageCount=function(){return j.middlePagesSiblingCount*2+1},this.isReachedToFirst=function(){return j.currentPage<=j.middlePagesSiblingCount},this.isReachedToLast=function(){return j.currentPage+j.middlePagesSiblingCount>=j.totalPage},this.getAllPreviousPages=function(){return j.getAllPages().slice(0,j.getMiddlePages()[0]-1)},this.getAllNextPages=function(){var Ht=j.getAllPages(),xe=j.getMiddlePages();return Ht.slice(xe[xe.length-1],Ht[Ht.length])},this.hasPreviousPage=function(){return j.currentPage>1},this.hasNextPage=function(){return j.totalPage>j.currentPage},this.getMiddlePages=function(){var Ht=j.getAllPages(),xe=j.getMiddlePageCount();return j.isReachedToFirst()?Ht.slice(0,xe):j.isReachedToLast()?Ht.slice(-xe):Ht.slice(j.currentPage-j.middlePagesSiblingCount-1,j.currentPage+j.middlePagesSiblingCount)},this.getPreviousPages=function(){return j.isReachedToFirst()?[]:j.getAllPreviousPages().length<1?[]:j.getAllPages().slice(0,j.edgePageCount).filter(function(Ht){return!j.getMiddlePages().includes(Ht)})},this.getNextPages=function(){if(j.isReachedToLast())return[];if(j.getAllNextPages().length<1)return[];var Ht=j.getAllPages();return Ht.slice(Ht.length-j.edgePageCount,Ht.length).filter(function(xe){return!j.getMiddlePages().includes(xe)})},this.isPreviousTruncable=function(){return j.getAllPreviousPages().filter(function(Ht){return!j.getPreviousPages().includes(Ht)&&!j.getMiddlePages().includes(Ht)}).length>0},this.isNextTruncable=function(){return j.getAllNextPages().filter(function(Ht){return!j.getNextPages().includes(Ht)&&!j.getMiddlePages().includes(Ht)}).length>0},this.currentPage=et,this.totalPage=ft,this.middlePagesSiblingCount=Et,this.edgePageCount=Jt},ue=2,Lt=2,Bt=function(H){var j=H.totalPage,et=H.currentPage,ft=H.middlePagesSiblingCount,vt=ft===void 0?ue:ft,Et=H.edgePageCount,Dt=Et===void 0?Lt:Et,Jt=(0,Q.useMemo)(function(){return new Vt({totalPage:j,currentPage:et,middlePagesSiblingCount:vt,edgePageCount:Dt})},[j,et,vt,Dt]);return{getMiddlePages:Jt.getMiddlePages,hasPreviousPage:Jt.hasPreviousPage,hasNextPage:Jt.hasNextPage,getPreviousPages:Jt.getPreviousPages,getNextPages:Jt.getNextPages,isPreviousTruncable:Jt.isPreviousTruncable,isNextTruncable:Jt.isNextTruncable,totalPage:j,currentPage:et}},ne=function(H){var j=H.children,et=H.totalPage,ft=H.currentPage,vt=H.middlePagesSiblingCount,Et=H.edgePageCount,Dt=Bt({totalPage:et,currentPage:ft,middlePagesSiblingCount:vt,edgePageCount:Et});return j(Dt)}},8874:function(ee){"use strict";ee.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},19818:function(ee,Ot,Y){var Q=Y(8874),wt=Y(86851),yt=Object.hasOwnProperty,xt=Object.create(null);for(var dt in Q)yt.call(Q,dt)&&(xt[Q[dt]]=dt);var $=ee.exports={to:{},get:{}};$.get=function(B){var G=B.substring(0,3).toLowerCase(),F,W;switch(G){case"hsl":F=$.get.hsl(B),W="hsl";break;case"hwb":F=$.get.hwb(B),W="hwb";break;default:F=$.get.rgb(B),W="rgb";break}return F?{model:W,value:F}:null},$.get.rgb=function(B){if(!B)return null;var G=/^#([a-f0-9]{3,4})$/i,F=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,W=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,ut=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,q=/^(\w+)$/,it=[0,0,0,1],ot,gt,Rt;if(ot=B.match(F)){for(Rt=ot[2],ot=ot[1],gt=0;gt<3;gt++){var Vt=gt*2;it[gt]=parseInt(ot.slice(Vt,Vt+2),16)}Rt&&(it[3]=parseInt(Rt,16)/255)}else if(ot=B.match(G)){for(ot=ot[1],Rt=ot[3],gt=0;gt<3;gt++)it[gt]=parseInt(ot[gt]+ot[gt],16);Rt&&(it[3]=parseInt(Rt+Rt,16)/255)}else if(ot=B.match(W)){for(gt=0;gt<3;gt++)it[gt]=parseInt(ot[gt+1],0);ot[4]&&(ot[5]?it[3]=parseFloat(ot[4])*.01:it[3]=parseFloat(ot[4]))}else if(ot=B.match(ut)){for(gt=0;gt<3;gt++)it[gt]=Math.round(parseFloat(ot[gt+1])*2.55);ot[4]&&(ot[5]?it[3]=parseFloat(ot[4])*.01:it[3]=parseFloat(ot[4]))}else return(ot=B.match(q))?ot[1]==="transparent"?[0,0,0,0]:yt.call(Q,ot[1])?(it=Q[ot[1]],it[3]=1,it):null:null;for(gt=0;gt<3;gt++)it[gt]=I(it[gt],0,255);return it[3]=I(it[3],0,1),it},$.get.hsl=function(B){if(!B)return null;var G=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,F=B.match(G);if(F){var W=parseFloat(F[4]),ut=(parseFloat(F[1])%360+360)%360,q=I(parseFloat(F[2]),0,100),it=I(parseFloat(F[3]),0,100),ot=I(isNaN(W)?1:W,0,1);return[ut,q,it,ot]}return null},$.get.hwb=function(B){if(!B)return null;var G=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,F=B.match(G);if(F){var W=parseFloat(F[4]),ut=(parseFloat(F[1])%360+360)%360,q=I(parseFloat(F[2]),0,100),it=I(parseFloat(F[3]),0,100),ot=I(isNaN(W)?1:W,0,1);return[ut,q,it,ot]}return null},$.to.hex=function(){var B=wt(arguments);return"#"+D(B[0])+D(B[1])+D(B[2])+(B[3]<1?D(Math.round(B[3]*255)):"")},$.to.rgb=function(){var B=wt(arguments);return B.length<4||B[3]===1?"rgb("+Math.round(B[0])+", "+Math.round(B[1])+", "+Math.round(B[2])+")":"rgba("+Math.round(B[0])+", "+Math.round(B[1])+", "+Math.round(B[2])+", "+B[3]+")"},$.to.rgb.percent=function(){var B=wt(arguments),G=Math.round(B[0]/255*100),F=Math.round(B[1]/255*100),W=Math.round(B[2]/255*100);return B.length<4||B[3]===1?"rgb("+G+"%, "+F+"%, "+W+"%)":"rgba("+G+"%, "+F+"%, "+W+"%, "+B[3]+")"},$.to.hsl=function(){var B=wt(arguments);return B.length<4||B[3]===1?"hsl("+B[0]+", "+B[1]+"%, "+B[2]+"%)":"hsla("+B[0]+", "+B[1]+"%, "+B[2]+"%, "+B[3]+")"},$.to.hwb=function(){var B=wt(arguments),G="";return B.length>=4&&B[3]!==1&&(G=", "+B[3]),"hwb("+B[0]+", "+B[1]+"%, "+B[2]+"%"+G+")"},$.to.keyword=function(B){return xt[B.slice(0,3)]};function I(B,G,F){return Math.min(Math.max(G,B),F)}function D(B){var G=Math.round(B).toString(16).toUpperCase();return G.length<2?"0"+G:G}},26729:function(ee){"use strict";var Ot=Object.prototype.hasOwnProperty,Y="~";function Q(){}Object.create&&(Q.prototype=Object.create(null),new Q().__proto__||(Y=!1));function wt($,I,D){this.fn=$,this.context=I,this.once=D||!1}function yt($,I,D,B,G){if(typeof D!="function")throw new TypeError("The listener must be a function");var F=new wt(D,B||$,G),W=Y?Y+I:I;return $._events[W]?$._events[W].fn?$._events[W]=[$._events[W],F]:$._events[W].push(F):($._events[W]=F,$._eventsCount++),$}function xt($,I){--$._eventsCount===0?$._events=new Q:delete $._events[I]}function dt(){this._events=new Q,this._eventsCount=0}dt.prototype.eventNames=function(){var I=[],D,B;if(this._eventsCount===0)return I;for(B in D=this._events)Ot.call(D,B)&&I.push(Y?B.slice(1):B);return Object.getOwnPropertySymbols?I.concat(Object.getOwnPropertySymbols(D)):I},dt.prototype.listeners=function(I){var D=Y?Y+I:I,B=this._events[D];if(!B)return[];if(B.fn)return[B.fn];for(var G=0,F=B.length,W=new Array(F);G<F;G++)W[G]=B[G].fn;return W},dt.prototype.listenerCount=function(I){var D=Y?Y+I:I,B=this._events[D];return B?B.fn?1:B.length:0},dt.prototype.emit=function(I,D,B,G,F,W){var ut=Y?Y+I:I;if(!this._events[ut])return!1;var q=this._events[ut],it=arguments.length,ot,gt;if(q.fn){switch(q.once&&this.removeListener(I,q.fn,void 0,!0),it){case 1:return q.fn.call(q.context),!0;case 2:return q.fn.call(q.context,D),!0;case 3:return q.fn.call(q.context,D,B),!0;case 4:return q.fn.call(q.context,D,B,G),!0;case 5:return q.fn.call(q.context,D,B,G,F),!0;case 6:return q.fn.call(q.context,D,B,G,F,W),!0}for(gt=1,ot=new Array(it-1);gt<it;gt++)ot[gt-1]=arguments[gt];q.fn.apply(q.context,ot)}else{var Rt=q.length,Vt;for(gt=0;gt<Rt;gt++)switch(q[gt].once&&this.removeListener(I,q[gt].fn,void 0,!0),it){case 1:q[gt].fn.call(q[gt].context);break;case 2:q[gt].fn.call(q[gt].context,D);break;case 3:q[gt].fn.call(q[gt].context,D,B);break;case 4:q[gt].fn.call(q[gt].context,D,B,G);break;default:if(!ot)for(Vt=1,ot=new Array(it-1);Vt<it;Vt++)ot[Vt-1]=arguments[Vt];q[gt].fn.apply(q[gt].context,ot)}}return!0},dt.prototype.on=function(I,D,B){return yt(this,I,D,B,!1)},dt.prototype.once=function(I,D,B){return yt(this,I,D,B,!0)},dt.prototype.removeListener=function(I,D,B,G){var F=Y?Y+I:I;if(!this._events[F])return this;if(!D)return xt(this,F),this;var W=this._events[F];if(W.fn)W.fn===D&&(!G||W.once)&&(!B||W.context===B)&&xt(this,F);else{for(var ut=0,q=[],it=W.length;ut<it;ut++)(W[ut].fn!==D||G&&!W[ut].once||B&&W[ut].context!==B)&&q.push(W[ut]);q.length?this._events[F]=q.length===1?q[0]:q:xt(this,F)}return this},dt.prototype.removeAllListeners=function(I){var D;return I?(D=Y?Y+I:I,this._events[D]&&xt(this,D)):(this._events=new Q,this._eventsCount=0),this},dt.prototype.off=dt.prototype.removeListener,dt.prototype.addListener=dt.prototype.on,dt.prefixed=Y,dt.EventEmitter=dt,ee.exports=dt},86851:function(ee,Ot,Y){"use strict";var Q=Y(89594),wt=Array.prototype.concat,yt=Array.prototype.slice,xt=ee.exports=function($){for(var I=[],D=0,B=$.length;D<B;D++){var G=$[D];Q(G)?I=wt.call(I,yt.call(G)):I.push(G)}return I};xt.wrap=function(dt){return function(){return dt(xt(arguments))}}},89594:function(ee){ee.exports=function(Y){return!Y||typeof Y=="string"?!1:Y instanceof Array||Array.isArray(Y)||Y.length>=0&&(Y.splice instanceof Function||Object.getOwnPropertyDescriptor(Y,Y.length-1)&&Y.constructor.name!=="String")}},91739:function(ee,Ot,Y){"use strict";Y.d(Ot,{B7:function(){return q},HT:function(){return it},zO:function(){return W}});var Q=0,wt=0,yt=0,xt=1e3,dt,$,I=0,D=0,B=0,G=typeof performance=="object"&&performance.now?performance:Date,F=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(Lt){setTimeout(Lt,17)};function W(){return D||(F(ut),D=G.now()+B)}function ut(){D=0}function q(){this._call=this._time=this._next=null}q.prototype=it.prototype={constructor:q,restart:function(Lt,Bt,ne){if(typeof Lt!="function")throw new TypeError("callback is not a function");ne=(ne==null?W():+ne)+(Bt==null?0:+Bt),!this._next&&$!==this&&($?$._next=this:dt=this,$=this),this._call=Lt,this._time=ne,ue()},stop:function(){this._call&&(this._call=null,this._time=1/0,ue())}};function it(Lt,Bt,ne){var Mt=new q;return Mt.restart(Lt,Bt,ne),Mt}function ot(){W(),++Q;for(var Lt=dt,Bt;Lt;)(Bt=D-Lt._time)>=0&&Lt._call.call(void 0,Bt),Lt=Lt._next;--Q}function gt(){D=(I=G.now())+B,Q=wt=0;try{ot()}finally{Q=0,Vt(),D=0}}function Rt(){var Lt=G.now(),Bt=Lt-I;Bt>xt&&(B-=Bt,I=Lt)}function Vt(){for(var Lt,Bt=dt,ne,Mt=1/0;Bt;)Bt._call?(Mt>Bt._time&&(Mt=Bt._time),Lt=Bt,Bt=Bt._next):(ne=Bt._next,Bt._next=null,Bt=Lt?Lt._next=ne:dt=ne);$=Lt,ue(Mt)}function ue(Lt){if(!Q){wt&&(wt=clearTimeout(wt));var Bt=Lt-D;Bt>24?(Lt<1/0&&(wt=setTimeout(gt,Lt-G.now()-B)),yt&&(yt=clearInterval(yt))):(yt||(I=G.now(),yt=setInterval(Rt,xt)),Q=1,F(gt))}}},16288:function(ee,Ot,Y){"use strict";Y.r(Ot),Y.d(Ot,{Vaso:function(){return ut}});var Q=Y(67294);const wt=.15,yt=.6,xt=.3,dt=.2,$=typeof window!="undefined"?window.requestAnimationFrame||setTimeout:()=>0,I=(q,it)=>`url(#${q}_filter) blur(${it}px) contrast(1.1) brightness(1.05) saturate(1.1)`;function D(q,it,ot){return ot=Math.max(0,Math.min(1,(ot-q)/(it-q))),ot*ot*(3-2*ot)}function B(q,it){return Math.sqrt(q*q+it*it)}function G(q,it,ot,gt,Rt){const Vt=Math.abs(ot),ue=Math.abs(gt),Lt=Math.abs(Rt),Bt=Math.abs(q)-Vt+Lt,ne=Math.abs(it)-ue+Lt,Mt=Math.min(Math.max(Bt,ne),0)+B(Math.max(Bt,0),Math.max(ne,0))-Lt;return ot<0||gt<0?-Mt:Mt}function F(q,it=.15,ot=0){const gt=q.x-.5,Rt=q.y-.5,Vt=G(gt,Rt,Math.abs(xt),Math.abs(dt),Math.abs(yt)),ue=D(.8,0,Vt-Math.abs(it)),Lt=D(0,1,ue),Bt=ot<0,ne=it<0;let Mt=Lt;(Bt||ne)&&(Mt=1-Lt*.7);const H=gt*Mt+.5,j=Rt*Mt+.5;return{x:H,y:j}}const W=(()=>{const q=new Map;return(it,ot,gt=.15,Rt=.3,Vt=.2,ue=1)=>{const Lt=`${it}-${ot}-${gt}-${Rt}-${Vt}-${ue}`;if(q.has(Lt))return q.get(Lt);if(!it||!ot||it<=0||ot<=0||!Number.isFinite(it)||!Number.isFinite(ot))return console.warn("Invalid canvas dimensions:",{width:it,height:ot}),{data:new Uint8ClampedArray(4),maxScale:0};const Bt=Math.floor(it),ne=Math.floor(ot),Mt=new Uint8ClampedArray(Bt*ne*4),H=[];let j=0;for(let vt=0;vt<Mt.length;vt+=4){const Et=vt/4%Bt,Dt=Math.floor(vt/4/Bt),Jt={x:Et/Bt,y:Dt/ne},Ht=F(Jt,gt,ue),xe=Ht.x*Bt-Et,si=Ht.y*ne-Dt;j=Math.max(j,Math.abs(xe),Math.abs(si)),H.push(xe,si)}j*=.5;let et=0;for(let vt=0;vt<Mt.length;vt+=4){const Et=H[et++]/j+.5,Dt=H[et++]/j+.5;Mt[vt]=Et*255,Mt[vt+1]=Dt*255,Mt[vt+2]=0,Mt[vt+3]=255}const ft={data:Mt,maxScale:j};if(q.size>10){const vt=q.keys().next().value;q.delete(vt)}return q.set(Lt,ft),ft}})(),ut=H=>{var j=H,{component:q="div",children:it,width:ot,height:gt,px:Rt=0,py:Vt=0,radius:ue=0,depth:Lt=0,blur:Bt=.1,dispersion:ne=.5}=j,Mt=rn(j,["component","children","width","height","px","py","radius","depth","blur","dispersion"]);var go;const et=(0,Q.useId)(),ft=(0,Q.useRef)(null),vt=(0,Q.useRef)(null),Et=(0,Q.useRef)(null),Dt=(0,Q.useRef)(null),Jt=(0,Q.useRef)(null),Ht=(0,Q.useRef)(null),xe=(0,Q.useRef)(null),si=(0,Q.useCallback)(()=>{xe.current&&cancelAnimationFrame(xe.current);const wc=()=>{var Mc,Tc;const Ai=ft.current,Pn=vt.current,Tr=Dt.current,Zr=Jt.current,oi=Et.current;if(!Ai||!Pn||!Tr||!Zr||!oi)return;const Ni=Ai.getBoundingClientRect();ot!==void 0&&(Ni.width=ot),gt!==void 0&&(Ni.height=gt);const Ki=Math.max(1,Ni.width+2*Rt),Qi=Math.max(1,Ni.height+2*Vt);oi.style.width=`${Ki}px`,oi.style.height=`${Qi}px`;const Cr=Math.min(Math.max(Ki+Qi,100),800)/400,Qn=Math.round(4*Cr),Ms=Math.round(8*Cr),yo=Math.round(20*Cr),vp=Math.round(-10*Cr);oi.style.boxShadow=`0 ${Qn}px ${Ms}px rgba(0, 0, 0, 0.2), 0 ${vp}px ${yo}px inset rgba(0, 0, 0, 0.15)`;const Sc=.75,mo=Math.max(1,Math.floor(Ki*Sc)),bo=Math.max(1,Math.floor(Qi*Sc));Pn.width=mo,Pn.height=bo;const dn=Pn.getContext("2d");if(dn)try{const{data:xo,maxScale:pp}=W(mo,bo,wt,xt,dt,Lt);if(xo.length>=4&&mo>0&&bo>0){const gp=new ImageData(xo,mo,bo);dn.putImageData(gp,0,0),Tr.setAttributeNS("http://www.w3.org/1999/xlink","href",Pn.toDataURL()),Tr.setAttribute("width",`${Ki}`),Tr.setAttribute("height",`${Qi}`);const yp=Math.max(0,pp*Math.abs(Lt)/Sc);Zr.setAttribute("scale",yp.toString()),(Mc=Zr.parentElement)==null||Mc.setAttribute("width",`${Ki}`),(Tc=Zr.parentElement)==null||Tc.setAttribute("height",`${Qi}`),oi.style.backdropFilter=I(et,Bt)}}catch(xo){console.error(xo)}};xe.current=$(wc)},[ot,gt,Rt,Vt,Lt,Bt,ne,wt,yt,xt,dt,et]);return(0,Q.useLayoutEffect)(()=>{si()},[si]),(0,Q.useEffect)(()=>()=>{Ht.current&&cancelAnimationFrame(Ht.current),xe.current&&cancelAnimationFrame(xe.current)},[]),Q.createElement(q,hr($e({},Mt),{style:{position:"relative"},ref:ft}),Q.createElement(q,{"data-vaso":et,ref:Et,style:hr($e({position:"absolute",top:-Vt,left:-Rt,width:`calc(100% + ${Rt*2}px)`,height:`calc(100% + ${Vt*2}px)`,overflow:"hidden",backdropFilter:I(et,Bt)},ue&&{borderRadius:ue}),{cursor:"default",userSelect:"none"})}),Q.createElement("svg",{width:"0",height:"0",style:{position:"fixed",top:0,left:0,zIndex:((go=Mt.style)==null?void 0:go.zIndex)||999}},Q.createElement("defs",null,Q.createElement("filter",{id:`${et}_filter`,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",x:"-5%",y:"-5%",width:"110%",height:"110%"},Q.createElement("feImage",{ref:Dt,id:`${et}_map`}),Q.createElement("feDisplacementMap",{ref:Jt,in:"SourceGraphic",in2:`${et}_map`,xChannelSelector:"R",yChannelSelector:"G",result:"displaced"}),ne&&Q.createElement(Q.Fragment,null,Q.createElement("feOffset",{dx:ne,dy:ne,in:"displaced",result:"redShift"}),Q.createElement("feOffset",{dx:"0",dy:"0",in:"displaced",result:"greenCenter"}),Q.createElement("feOffset",{dx:-ne,dy:-ne,in:"displaced",result:"blueShift"}),Q.createElement("feColorMatrix",{in:"redShift",type:"matrix",values:"1 0 0 0 0  0 0 0 0 0  0 0 0 0 0  0 0 0 1 0",result:"redOnly"}),Q.createElement("feColorMatrix",{in:"greenCenter",type:"matrix",values:"0 0 0 0 0  0 1 0 0 0  0 0 0 0 0  0 0 0 1 0",result:"greenOnly"}),Q.createElement("feColorMatrix",{in:"blueShift",type:"matrix",values:"0 0 0 0 0  0 0 0 0 0  0 0 1 0 0  0 0 0 1 0",result:"blueOnly"}),Q.createElement("feComposite",{in:"redOnly",in2:"greenOnly",operator:"lighter",result:"redGreen"}),Q.createElement("feComposite",{in:"redGreen",in2:"blueOnly",operator:"lighter"}))))),Q.createElement("canvas",{ref:vt,style:{display:"none"}}),it)}}}]);
}());