"use strict";(self.webpackChunk_agentscope_ai_chat=self.webpackChunk_agentscope_ai_chat||[]).push([[5984],{27101:function(c,a,e){e.r(a);var d=e(76311),_=e(93359),p=e(93612),s=e(57415),g=e(63032),r=e(10294),i=e(96057),u=e(76387),o=e(58041),m=e(19482),l=e(36711),h=e(12068),E=e(33456),C=e(50),x=e(58542),f=e(48936),v=e(67294),t=e(30189),n=e(85893);function k(){return(0,n.jsx)(x.dY,{children:(0,n.jsx)(v.Suspense,{fallback:(0,n.jsx)(f.Z,{}),children:(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"markdown",children:[(0,n.jsxs)("h1",{id:"\u767E\u70BC",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u767E\u70BC",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u767E\u70BC"]}),(0,n.jsx)("p",{children:t.texts[0].value}),(0,n.jsxs)("h2",{id:"\u524D\u7F6E\u51C6\u5907",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u524D\u7F6E\u51C6\u5907",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u524D\u7F6E\u51C6\u5907"]}),(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[t.texts[1].value,(0,n.jsx)("a",{href:"https://help.aliyun.com/zh/model-studio/getting-started/what-is-model-studio",children:t.texts[2].value})]}),(0,n.jsxs)("li",{children:[t.texts[3].value,(0,n.jsx)("a",{href:"https://help.aliyun.com/zh/model-studio/developer-reference/get-api-key",children:t.texts[4].value})]}),(0,n.jsxs)("li",{children:[t.texts[5].value,(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"https://help.aliyun.com/zh/model-studio/single-agent-application",children:t.texts[6].value})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"https://bailian.console.aliyun.com/?tab=app#/app-center",children:t.texts[7].value})})]})]})]}),(0,n.jsxs)("h2",{id:"\u5DE5\u4F5C\u6D41\u8C03\u7528",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u5DE5\u4F5C\u6D41\u8C03\u7528",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u5DE5\u4F5C\u6D41\u8C03\u7528"]}),(0,n.jsxs)("h3",{id:"\u5DE5\u4F5C\u6D41\u642D\u5EFA",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u5DE5\u4F5C\u6D41\u642D\u5EFA",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u5DE5\u4F5C\u6D41\u642D\u5EFA"]}),(0,n.jsx)("blockquote",{children:(0,n.jsx)("p",{children:t.texts[8].value})}),(0,n.jsx)("img",{src:"https://gw.alicdn.com/imgextra/i1/O1CN01djpE1e280W7hW930J_!!6000000007870-2-tps-2452-1654.png",width:"50%"}),(0,n.jsxs)("h3",{id:"\u4EE3\u7801\u7F16\u5199",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u4EE3\u7801\u7F16\u5199",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u4EE3\u7801\u7F16\u5199"]}),(0,n.jsx)("blockquote",{children:(0,n.jsx)("p",{children:t.texts[9].value})}),(0,n.jsx)("img",{src:"https://gw.alicdn.com/imgextra/i1/O1CN01n0tmbe1kYp0hcR83z_!!6000000004696-1-tps-1068-720.gif",width:"50%"}),(0,n.jsx)(r.Z,{lang:"tsx",children:t.texts[10].value}),(0,n.jsxs)("h2",{id:"\u667A\u80FD\u4F53\u8C03\u7528",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u667A\u80FD\u4F53\u8C03\u7528",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u667A\u80FD\u4F53\u8C03\u7528"]}),(0,n.jsxs)("h3",{id:"\u667A\u80FD\u4F53\u642D\u5EFA",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u667A\u80FD\u4F53\u642D\u5EFA",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u667A\u80FD\u4F53\u642D\u5EFA"]}),(0,n.jsx)("blockquote",{children:(0,n.jsx)("p",{children:t.texts[11].value})}),(0,n.jsx)("img",{src:"https://gw.alicdn.com/imgextra/i2/O1CN01oduDVS1cOjMACqWMp_!!6000000003591-2-tps-2452-1654.png",width:"50%"}),(0,n.jsxs)("h3",{id:"\u4EE3\u7801\u7F16\u5199-1",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u4EE3\u7801\u7F16\u5199-1",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u4EE3\u7801\u7F16\u5199"]}),(0,n.jsx)(r.Z,{lang:"tsx",children:t.texts[12].value}),(0,n.jsx)("img",{src:"https://gw.alicdn.com/imgextra/i2/O1CN01tAh5r71D07gMq9kfP_!!6000000000153-2-tps-2452-1654.png",width:"50%"})]})})})})}a.default=k},50:function(c,a,e){var d=e(58542),_=e(2487),p=e(9053),s=e(85893),g=(0,p.kc)(function(r){var i=r.token;return{list:{display:"flex",gap:i.marginMD},title:{color:i.colorText,transition:"color 0.3s ease","&:hover":{color:i.colorTextSecondary,textDecoration:"underline"}}}});a.Z=function(){var r=(0,d.tx)(),i=g(),u=i.styles;return(0,s.jsx)("div",{className:u.list,children:r.filter(function(o){return o.title}).map(function(o){return(0,s.jsx)(_.Z,{style:{flex:1},header:(0,s.jsx)("h3",{children:o.title}),itemLayout:"horizontal",dataSource:o.children,renderItem:function(l,h){return(0,s.jsx)(_.Z.Item,{children:(0,s.jsx)(d.rU,{to:l.link,style:{display:"block",width:"100%"},children:(0,s.jsx)(_.Z.Item.Meta,{title:(0,s.jsx)("div",{className:u.title,children:l.title}),description:l.frontmatter.description})})},h)}},o.title)})})}},30189:function(c,a,e){e.r(a),e.d(a,{texts:function(){return d}});const d=[{value:"\u8FD9\u7BC7\u6307\u5357\u5C06\u4ECB\u7ECD\u5982\u4F55\u5728\u4F7F\u7528 Alibaba Cloud Spark Chat \u63A5\u5165\u5728\u963F\u91CC\u4E91\u767E\u70BC\u4E0A\u642D\u5EFA\u7684\u667A\u80FD\u4F53\u3002",paraId:0,tocIndex:0},{value:"\u5982\u4F55\u83B7\u53D6 baseURL - ",paraId:1,tocIndex:1},{value:"https://help.aliyun.com/zh/model-studio/getting-started/what-is-model-studio",paraId:1,tocIndex:1},{value:"\u5982\u4F55\u83B7\u53D6 API Key - ",paraId:1,tocIndex:1},{value:"https://help.aliyun.com/zh/model-studio/developer-reference/get-api-key",paraId:1,tocIndex:1},{value:`\u5DF2\u521B\u5EFA\u667A\u80FD\u4F53\u5E94\u7528\uFF0C\u5E76\u5DF2\u83B7\u53D6 APP_ID\uFF08\u963F\u91CC\u4E91\u767E\u70BC\u5E94\u7528 ID\uFF09\uFF1A\u5728\u5E94\u7528\u7BA1\u7406\u9875\u9762\u7684\u5E94\u7528\u5361\u7247\u4E0A\u83B7\u53D6\u3002
`,paraId:1,tocIndex:1},{value:"https://help.aliyun.com/zh/model-studio/single-agent-application",paraId:2,tocIndex:1},{value:"https://bailian.console.aliyun.com/?tab=app#/app-center",paraId:2,tocIndex:1},{value:"demo \u6BD4\u8F83\u7B80\u5355\uFF0C\u5B9E\u9645\u53EF\u4EE5\u5F00\u542F\u5404\u79CD RAG\u3001MCP\u3001\u5FAA\u73AF\u8C03\u7528 \u7B49\u76F8\u5173\u529F\u80FD",paraId:3,tocIndex:3},{value:"demo \u4F7F\u7528\u4E86\u81EA\u5B9A\u4E49\u5361\u7247\u5B9E\u73B0\u4E86\u4E00\u4E2A\u8868\u5355\uFF0C\u7528\u6765\u83B7\u53D6\u7528\u6237\u8F93\u5165\u7684\u53C2\u6570\uFF0C\u5E76\u8C03\u7528\u5DE5\u4F5C\u6D41\u8FDB\u884C\u6267\u884C",paraId:4,tocIndex:4},{value:`import { ConfigProvider, carbonTheme, Card, Input, Select, Button } from '@agentscope-ai/design';
import { Bubble, ChatInput, Stream, type TMessage, CustomCardsProvider } from '@agentscope-ai/chat';
import { useRef, useState } from 'react';
import { produce } from 'immer';
import './App.css';
import { Flex, Space } from 'antd';
import React from 'react';

const MessagesContext = React.createContext<{
  messages: TMessage[];
  setMessages: React.Dispatch<React.SetStateAction<TMessage[]>>;
  loading?: boolean;
  setLoading: React.Dispatch<React.SetStateAction<boolean>>;
}>({
  messages: [],
  setMessages: () => { },
  setLoading: () => { },
  loading: false,
});

function Sender({
  handleSend,
  loading,
}: {
  handleSend: (input: string) => void;
  loading: boolean;
}) {
  const [input, setInput] = useState('');

  return (
    <ChatInput
      value={input}
      onChange={setInput}
      onSubmit={(input) => {
        handleSend(input);
        setInput('');
      }}
      loading={loading}
    />
  );
}

function TranslateStart() {
  const { setMessages, loading, setLoading } = React.useContext(MessagesContext);
  const [originText, setOriginText] = useState('');
  const [targetLang, setTargetLang] = useState('\u82F1\u8BED');
  const currentAnswer = useRef<TMessage | null>(null);
  const [disabled, setDisabled] = useState(false);

  return <Card title="Translate Start">
    <Space direction="vertical" size={8}>
      <Flex align='center'>
        <label className='w-[80px] flex-none'>originText</label>
        <Input placeholder="\u8BF7\u8F93\u5165\u7FFB\u8BD1\u5185\u5BB9" value={originText} onChange={(e) => setOriginText(e.target.value)} />
      </Flex>
      <Flex align='center'>
        <label className='w-[80px] flex-none'>targetLang</label>
        <Select placeholder="\u8BF7\u9009\u62E9\u76EE\u6807\u8BED\u8A00"
          value={targetLang}
          onChange={(value) => setTargetLang(value)}
          options={[
            { label: '\u82F1\u8BED', value: '\u82F1\u8BED' },
            { label: '\u65E5\u8BED', value: '\u65E5\u8BED' },
            { label: '\u6CD5\u8BED', value: '\u6CD5\u8BED' },
          ]}
        />
      </Flex>

      <Button type="primary"

        disabled={disabled}
        loading={!disabled && loading} onClick={async () => {
          setLoading(true);
          const id = 'a' + Date.now().toString();


          currentAnswer.current = {
            role: 'assistant',
            content: '',
            msgStatus: 'generating',
            id,
          };

          setMessages((v) => [...v, currentAnswer.current as TMessage]);



          const response = await fetch(\`https://dashscope.aliyuncs.com/api/v1/apps/YOUR_APP_ID/completion\`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': \`Bearer sk-xxxx\`,
              'X-DashScope-SSE': 'enable',
            },
            body: JSON.stringify({
              session_id: Date.now().toString(),
              input: {
                prompt: '\u5F00\u59CB\u7FFB\u8BD1', biz_params: {
                  originText: originText,
                  targetLang: targetLang
                }
              },
              parameters: {
                incremental_output: false
              },
            }),
          });

          if (response.body) {
            for await (const chunk of Stream({
              readableStream: response.body,
            }, {})) {

              const data = JSON.parse(chunk.data);

              currentAnswer.current = produce(currentAnswer.current, (draft) => {
                if (data.output?.finish_reason === 'stop') {
                  draft.msgStatus = 'finished';
                }
                draft.content = data.output?.text || '';
              });
              setMessages((v) => v.map((item) => item.id === currentAnswer.current?.id ? currentAnswer.current : item));

            }
          };

          setLoading(false);
          setDisabled(true);
        }}>\u7FFB\u8BD1</Button>
    </Space>
  </Card>;
}

function App() {
  const [messages, setMessages] = useState<TMessage[]>([]);
  const [loading, setLoading] = useState(false);

  const handleSend = async (input: string) => {
    const query = {
      role: 'user',
      content: input,
      id: 'q' + Date.now().toString(),
    } as TMessage;

    setMessages((v) => [...v, query]);
  };

  return (
    <ConfigProvider {...carbonTheme} prefix="spark-chat" prefixCls="spark-chat">
      <CustomCardsProvider cardConfig={{
        TranslateStart,
      }}>
        <MessagesContext.Provider value={{ messages, setMessages, loading, setLoading }}>
          <div className="h-[100vh] p-[20px] flex flex-col">
            <Bubble.List
              items={messages}
              classNames={{
                wrapper: 'flex-1 h-[0]',
              }}
            />
            <div className='mb-[8px]'>
              <Button onClick={() => {
                setMessages((v) => [...v, {
                  role: 'assistant',
                  cards: [{ code: 'TranslateStart', }],
                  id: 'q' + Date.now().toString(),
                }]);

              }}>\u7FFB\u8BD1\u6A21\u5F0F</Button>
            </div>
            <Sender handleSend={handleSend} loading={loading} />
          </div>
        </MessagesContext.Provider>
      </CustomCardsProvider>
    </ConfigProvider>
  );
}

export default App;
`,paraId:5,tocIndex:4},{value:"demo \u6BD4\u8F83\u7B80\u5355\uFF0C\u5B9E\u9645\u53EF\u4EE5\u5F00\u542F\u5404\u79CD RAG\u3001MCP \u7B49\u76F8\u5173\u529F\u80FD",paraId:6,tocIndex:6},{value:`import { ConfigProvider, carbonTheme } from '@agentscope-ai/design';
import { Bubble, ChatInput, Stream, type TMessage } from '@agentscope-ai/chat';
import { useRef, useState } from 'react';
import { produce } from 'immer';
import './App.css';

function Sender({
  handleSend,
  loading,
}: {
  handleSend: (input: string) => void;
  loading: boolean;
}) {
  const [input, setInput] = useState('');

  return (
    <ChatInput
      value={input}
      onChange={setInput}
      onSubmit={(input) => {
        handleSend(input);
        setInput('');
      }}
      loading={loading}
    />
  );
}

function App() {
  const [messages, setMessages] = useState<TMessage[]>([]);
  const [loading, setLoading] = useState(false);
  const sessionIdRef = useRef<string>(Date.now().toString());
  const currentAnswer = useRef<TMessage | null>(null);

  const handleSend = async (input: string) => {
    const query = {
      role: 'user',
      content: input,
      id: 'q' + Date.now().toString(),
    } as TMessage;

    const id = 'a' + Date.now().toString();

    currentAnswer.current = {
      role: 'assistant',
      content: '',
      msgStatus: 'generating',
      id,
    };

    setMessages((v) => [...v, query, currentAnswer.current as TMessage]);
    setLoading(true);

    const response = await fetch(
      \`https://dashscope.aliyuncs.com/api/v1/apps/YOUR_APP_ID/completion\`,
      {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: \`Bearer sk-xxxx\`,
          'X-DashScope-SSE': 'enable',
        },
        body: JSON.stringify({
          session_id: sessionIdRef.current,
          input: {
            prompt: '\u63A8\u8350\u4E00\u4E0B\u7F8E\u98DF',
            biz_params: {
              user_prompt_params: {
                city: input,
              },
            },
          },
          parameters: {
            incremental_output: false,
          },
        }),
      },
    );

    if (response.body) {
      for await (const chunk of Stream(
        {
          readableStream: response.body,
        },
        {},
      )) {
        const data = JSON.parse(chunk.data);
        currentAnswer.current = produce(currentAnswer.current, (draft) => {
          if (data.output?.finish_reason === 'stop') {
            draft.msgStatus = 'finished';
          }
          draft.content = data.output?.text || '';
        });
        setMessages((v) =>
          v.map((item) =>
            item.id === currentAnswer.current?.id
              ? currentAnswer.current
              : item,
          ),
        );
      }
    }

    setLoading(false);
  };

  return (
    <ConfigProvider {...carbonTheme} prefix="spark-chat" prefixCls="spark-chat">
      <div className="h-[100vh] p-[20px] flex flex-col">
        <Bubble.List
          items={messages}
          classNames={{
            wrapper: 'flex-1 h-[0]',
          }}
        />
        <Sender handleSend={handleSend} loading={loading} />
      </div>
    </ConfigProvider>
  );
}

export default App;
`,paraId:7,tocIndex:7}]}}]);
